/*! For license information please see 2.98b32324.chunk.js.LICENSE.txt */
(this["webpackJsonpcra-ts"]=this["webpackJsonpcra-ts"]||[]).push([[2],[function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(0),i=n(27),o=n(55),a=n(5),s=n(40),u=n(17),c=n(35),l=function(t){function e(n,r,i){var a=t.call(this)||this;switch(a.syncErrorValue=null,a.syncErrorThrown=!1,a.syncErrorThrowable=!1,a.isStopped=!1,arguments.length){case 0:a.destination=o.a;break;case 1:if(!n){a.destination=o.a;break}if("object"===typeof n){n instanceof e?(a.syncErrorThrowable=n.syncErrorThrowable,a.destination=n,n.add(a)):(a.syncErrorThrowable=!0,a.destination=new d(a,n));break}default:a.syncErrorThrowable=!0,a.destination=new d(a,n,r,i)}return a}return r.a(e,t),e.prototype[s.a]=function(){return this},e.create=function(t,n,r){var i=new e(t,n,r);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(a.a),d=function(t){function e(e,n,r,a){var s,u=t.call(this)||this;u._parentSubscriber=e;var c=u;return Object(i.a)(n)?s=n:n&&(s=n.next,r=n.error,a=n.complete,n!==o.a&&(c=Object.create(n),Object(i.a)(c.unsubscribe)&&u.add(c.unsubscribe.bind(c)),c.unsubscribe=u.unsubscribe.bind(u))),u._context=c,u._next=s,u._error=r,u._complete=a,u}return r.a(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;u.a.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,n=u.a.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):Object(c.a)(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;Object(c.a)(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};u.a.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),u.a.useDeprecatedSynchronousErrorHandling)throw n;Object(c.a)(n)}},e.prototype.__tryOrSetError=function(t,e,n){if(!u.a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return u.a.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(Object(c.a)(r),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(l)},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(52),i=n(1),o=n(40),a=n(55);var s=n(23),u=n(39),c=n(17),l=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r=this.operator,s=function(t,e,n){if(t){if(t instanceof i.a)return t;if(t[o.a])return t[o.a]()}return t||e||n?new i.a(t,e,n):new i.a(a.a)}(t,e,n);if(r?s.add(r.call(s,this.source)):s.add(this.source||c.a.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),c.a.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){c.a.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),Object(r.a)(t)?t.error(e):console.warn(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=d(e))((function(e,r){var i;i=n.subscribe((function(e){try{t(e)}catch(n){r(n),i&&i.unsubscribe()}}),r,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[s.a]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:Object(u.b)(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=d(t))((function(t,n){var r;e.subscribe((function(t){return r=t}),(function(t){return n(t)}),(function(){return t(r)}))}))},t.create=function(e){return new t(e)},t}();function d(t){if(t||(t=c.a.Promise||Promise),!t)throw new Error("no Promise impl found");return t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(16),i=n(42),o=n(2);function a(t,e,n,a,s){if(void 0===s&&(s=new r.a(t,n,a)),!s.closed)return e instanceof o.a?e.subscribe(s):Object(i.a)(e)(s)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.a(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(n(1).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(8),i=n(51),o=n(27),a=n(41),s=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n=this._parentOrParents,s=this._unsubscribe,c=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(var l=0;l<n.length;++l){n[l].remove(this)}if(Object(o.a)(s))try{s.call(this)}catch(h){e=h instanceof a.a?u(h.errors):[h]}if(Object(r.a)(c)){l=-1;for(var d=c.length;++l<d;){var f=c[l];if(Object(i.a)(f))try{f.unsubscribe()}catch(h){e=e||[],h instanceof a.a?e=e.concat(u(h.errors)):e.push(h)}}}if(e)throw new a.a(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!==typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var r=n;(n=new t)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof t){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=((e=new t).closed=!0,e),t}();function u(t){return t.reduce((function(t,e){return t.concat(e instanceof a.a?e.errors:e)}),[])}},function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return d}));var r=n(0),i=n(2),o=n(1),a=n(5),s=n(24),u=n(76),c=n(40),l=function(t){function e(e){var n=t.call(this,e)||this;return n.destination=e,n}return r.a(e,t),e}(o.a),d=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return r.a(e,t),e.prototype[c.a]=function(){return new l(this)},e.prototype.lift=function(t){var e=new f(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new s.a;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new s.a;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new s.a;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new s.a;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new s.a;return this.hasError?(t.error(this.thrownError),a.a.EMPTY):this.isStopped?(t.complete(),a.a.EMPTY):(this.observers.push(t),new u.a(this,t))},e.prototype.asObservable=function(){var t=new i.a;return t.source=this,t},e.create=function(t,e){return new f(t,e)},e}(i.a),f=function(t){function e(e,n){var r=t.call(this)||this;return r.destination=e,r.source=n,r}return r.a(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):a.a.EMPTY},e}(d)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){return Array.isArray||function(t){return t&&"number"===typeof t.length}}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(32),i=new(n(29).a)(r.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=n(1);function o(t,e){return function(n){if("function"!==typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new a(t,e))}}var a=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.project,this.thisArg))},t}(),s=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return r.a(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)},e}(i.a)},function(t,e,n){"use strict";function r(t){return t&&"function"===typeof t.schedule}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(2),i=new r.a((function(t){return t.complete()}));function o(t){return t?function(t){return new r.a((function(e){return t.schedule((function(){return e.complete()}))}))}(t):i}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(42),o=n(69);function a(t,e){return e?Object(o.a)(t,e):t instanceof r.a?t:new r.a(Object(i.a)(t))}},function(t,e,n){"use strict";n.r(e),n.d(e,"ACESFilmicToneMapping",(function(){return vt})),n.d(e,"AddEquation",(function(){return G})),n.d(e,"AddOperation",(function(){return lt})),n.d(e,"AdditiveBlending",(function(){return N})),n.d(e,"AlphaFormat",(function(){return Jt})),n.d(e,"AlwaysDepth",(function(){return et})),n.d(e,"AlwaysStencilFunc",(function(){return Un})),n.d(e,"AmbientLight",(function(){return wd})),n.d(e,"AmbientLightProbe",(function(){return Wd})),n.d(e,"AnimationClip",(function(){return Bl})),n.d(e,"AnimationLoader",(function(){return Ll})),n.d(e,"AnimationMixer",(function(){return wf})),n.d(e,"AnimationObjectGroup",(function(){return xf})),n.d(e,"AnimationUtils",(function(){return vl})),n.d(e,"ArcCurve",(function(){return Wl})),n.d(e,"ArrayCamera",(function(){return Vs})),n.d(e,"ArrowHelper",(function(){return lh})),n.d(e,"Audio",(function(){return ef})),n.d(e,"AudioAnalyser",(function(){return uf})),n.d(e,"AudioContext",(function(){return Vd})),n.d(e,"AudioListener",(function(){return tf})),n.d(e,"AudioLoader",(function(){return Hd})),n.d(e,"AxesHelper",(function(){return dh})),n.d(e,"AxisHelper",(function(){return vp})),n.d(e,"BackSide",(function(){return I})),n.d(e,"BasicDepthPacking",(function(){return gn})),n.d(e,"BasicShadowMap",(function(){return T})),n.d(e,"BinaryTextureLoader",(function(){return _p})),n.d(e,"Bone",(function(){return yu})),n.d(e,"BooleanKeyframeTrack",(function(){return wl})),n.d(e,"BoundingBoxHelper",(function(){return gp})),n.d(e,"Box2",(function(){return Cf})),n.d(e,"Box3",(function(){return Yr})),n.d(e,"Box3Helper",(function(){return oh})),n.d(e,"BoxBufferGeometry",(function(){return Ro})),n.d(e,"BoxGeometry",(function(){return Eo})),n.d(e,"BoxHelper",(function(){return ih})),n.d(e,"BufferAttribute",(function(){return Ni})),n.d(e,"BufferGeometry",(function(){return $i})),n.d(e,"BufferGeometryLoader",(function(){return Id})),n.d(e,"ByteType",(function(){return Dt})),n.d(e,"Cache",(function(){return Cl})),n.d(e,"Camera",(function(){return Fo})),n.d(e,"CameraHelper",(function(){return eh})),n.d(e,"CanvasRenderer",(function(){return Sp})),n.d(e,"CanvasTexture",(function(){return Xu})),n.d(e,"CatmullRomCurve3",(function(){return ql})),n.d(e,"CineonToneMapping",(function(){return mt})),n.d(e,"CircleBufferGeometry",(function(){return rl})),n.d(e,"CircleGeometry",(function(){return nl})),n.d(e,"ClampToEdgeWrapping",(function(){return Et})),n.d(e,"Clock",(function(){return Yd})),n.d(e,"ClosedSplineCurve3",(function(){return hp})),n.d(e,"Color",(function(){return Mi})),n.d(e,"ColorKeyframeTrack",(function(){return Tl})),n.d(e,"CompressedTexture",(function(){return zu})),n.d(e,"CompressedTextureLoader",(function(){return Gl})),n.d(e,"ConeBufferGeometry",(function(){return el})),n.d(e,"ConeGeometry",(function(){return tl})),n.d(e,"CubeCamera",(function(){return No})),n.d(e,"CubeGeometry",(function(){return Eo})),n.d(e,"CubeReflectionMapping",(function(){return yt})),n.d(e,"CubeRefractionMapping",(function(){return bt})),n.d(e,"CubeTexture",(function(){return ia})),n.d(e,"CubeTextureLoader",(function(){return Hl})),n.d(e,"CubeUVReflectionMapping",(function(){return Tt})),n.d(e,"CubeUVRefractionMapping",(function(){return St})),n.d(e,"CubicBezierCurve",(function(){return ed})),n.d(e,"CubicBezierCurve3",(function(){return nd})),n.d(e,"CubicInterpolant",(function(){return yl})),n.d(e,"CullFaceBack",(function(){return y})),n.d(e,"CullFaceFront",(function(){return b})),n.d(e,"CullFaceFrontBack",(function(){return x})),n.d(e,"CullFaceNone",(function(){return g})),n.d(e,"Curve",(function(){return zl})),n.d(e,"CurvePath",(function(){return cd})),n.d(e,"CustomBlending",(function(){return L})),n.d(e,"CylinderBufferGeometry",(function(){return $c})),n.d(e,"CylinderGeometry",(function(){return Kc})),n.d(e,"Cylindrical",(function(){return Bf})),n.d(e,"DataTexture",(function(){return Uo})),n.d(e,"DataTexture2DArray",(function(){return oa})),n.d(e,"DataTexture3D",(function(){return aa})),n.d(e,"DataTextureLoader",(function(){return Dl})),n.d(e,"DecrementStencilOp",(function(){return Mn})),n.d(e,"DecrementWrapStencilOp",(function(){return Rn})),n.d(e,"DefaultLoadingManager",(function(){return Pl})),n.d(e,"DepthFormat",(function(){return ne})),n.d(e,"DepthStencilFormat",(function(){return re})),n.d(e,"DepthTexture",(function(){return Wu})),n.d(e,"DirectionalLight",(function(){return _d})),n.d(e,"DirectionalLightHelper",(function(){return Kf})),n.d(e,"DirectionalLightShadow",(function(){return xd})),n.d(e,"DiscreteInterpolant",(function(){return xl})),n.d(e,"DodecahedronBufferGeometry",(function(){return ic})),n.d(e,"DodecahedronGeometry",(function(){return rc})),n.d(e,"DoubleSide",(function(){return B})),n.d(e,"DstAlphaFactor",(function(){return Y})),n.d(e,"DstColorFactor",(function(){return q})),n.d(e,"DynamicBufferAttribute",(function(){return rp})),n.d(e,"DynamicCopyUsage",(function(){return Xn})),n.d(e,"DynamicDrawUsage",(function(){return Gn})),n.d(e,"DynamicReadUsage",(function(){return Hn})),n.d(e,"EdgesGeometry",(function(){return qc})),n.d(e,"EdgesHelper",(function(){return yp})),n.d(e,"EllipseCurve",(function(){return Xl})),n.d(e,"EqualDepth",(function(){return it})),n.d(e,"EqualStencilFunc",(function(){return Cn})),n.d(e,"EquirectangularReflectionMapping",(function(){return xt})),n.d(e,"EquirectangularRefractionMapping",(function(){return _t})),n.d(e,"Euler",(function(){return br})),n.d(e,"EventDispatcher",(function(){return jn})),n.d(e,"ExtrudeBufferGeometry",(function(){return Lc})),n.d(e,"ExtrudeGeometry",(function(){return Uc})),n.d(e,"Face3",(function(){return Bi})),n.d(e,"Face4",(function(){return kh})),n.d(e,"FaceColors",(function(){return jh})),n.d(e,"FileLoader",(function(){return Ul})),n.d(e,"FlatShading",(function(){return A})),n.d(e,"Float32Attribute",(function(){return dp})),n.d(e,"Float32BufferAttribute",(function(){return ki})),n.d(e,"Float64Attribute",(function(){return fp})),n.d(e,"Float64BufferAttribute",(function(){return zi})),n.d(e,"FloatType",(function(){return Xt})),n.d(e,"Fog",(function(){return Ws})),n.d(e,"FogExp2",(function(){return Xs})),n.d(e,"Font",(function(){return Ld})),n.d(e,"FontLoader",(function(){return Dd})),n.d(e,"FrontFaceDirectionCCW",(function(){return w})),n.d(e,"FrontFaceDirectionCW",(function(){return _})),n.d(e,"FrontSide",(function(){return R})),n.d(e,"Frustum",(function(){return Do})),n.d(e,"GammaEncoding",(function(){return dn})),n.d(e,"Geometry",(function(){return Mo})),n.d(e,"GeometryUtils",(function(){return Tp})),n.d(e,"GreaterDepth",(function(){return at})),n.d(e,"GreaterEqualDepth",(function(){return ot})),n.d(e,"GreaterEqualStencilFunc",(function(){return On})),n.d(e,"GreaterStencilFunc",(function(){return Pn})),n.d(e,"GridHelper",(function(){return Zf})),n.d(e,"Group",(function(){return Hs})),n.d(e,"HalfFloatType",(function(){return Wt})),n.d(e,"HemisphereLight",(function(){return hd})),n.d(e,"HemisphereLightHelper",(function(){return jf})),n.d(e,"HemisphereLightProbe",(function(){return Xd})),n.d(e,"IcosahedronBufferGeometry",(function(){return nc})),n.d(e,"IcosahedronGeometry",(function(){return ec})),n.d(e,"ImageBitmapLoader",(function(){return Od})),n.d(e,"ImageLoader",(function(){return Vl})),n.d(e,"ImageUtils",(function(){return $n})),n.d(e,"ImmediateRenderObject",(function(){return Of})),n.d(e,"IncrementStencilOp",(function(){return Sn})),n.d(e,"IncrementWrapStencilOp",(function(){return En})),n.d(e,"InstancedBufferAttribute",(function(){return Rd})),n.d(e,"InstancedBufferGeometry",(function(){return Ed})),n.d(e,"InstancedInterleavedBuffer",(function(){return Sf})),n.d(e,"InstancedMesh",(function(){return Tu})),n.d(e,"Int16Attribute",(function(){return sp})),n.d(e,"Int16BufferAttribute",(function(){return Gi})),n.d(e,"Int32Attribute",(function(){return cp})),n.d(e,"Int32BufferAttribute",(function(){return Vi})),n.d(e,"Int8Attribute",(function(){return ip})),n.d(e,"Int8BufferAttribute",(function(){return Oi})),n.d(e,"IntType",(function(){return kt})),n.d(e,"InterleavedBuffer",(function(){return js})),n.d(e,"InterleavedBufferAttribute",(function(){return Ys})),n.d(e,"Interpolant",(function(){return gl})),n.d(e,"InterpolateDiscrete",(function(){return $e})),n.d(e,"InterpolateLinear",(function(){return tn})),n.d(e,"InterpolateSmooth",(function(){return en})),n.d(e,"InvertStencilOp",(function(){return In})),n.d(e,"JSONLoader",(function(){return Mp})),n.d(e,"KeepStencilOp",(function(){return wn})),n.d(e,"KeyframeTrack",(function(){return _l})),n.d(e,"LOD",(function(){return hu})),n.d(e,"LatheBufferGeometry",(function(){return Zc})),n.d(e,"LatheGeometry",(function(){return jc})),n.d(e,"Layers",(function(){return xr})),n.d(e,"LensFlare",(function(){return Rp})),n.d(e,"LessDepth",(function(){return nt})),n.d(e,"LessEqualDepth",(function(){return rt})),n.d(e,"LessEqualStencilFunc",(function(){return Fn})),n.d(e,"LessStencilFunc",(function(){return An})),n.d(e,"Light",(function(){return fd})),n.d(e,"LightProbe",(function(){return zd})),n.d(e,"LightShadow",(function(){return pd})),n.d(e,"Line",(function(){return Au})),n.d(e,"Line3",(function(){return Nf})),n.d(e,"LineBasicMaterial",(function(){return Su})),n.d(e,"LineCurve",(function(){return rd})),n.d(e,"LineCurve3",(function(){return id})),n.d(e,"LineDashedMaterial",(function(){return pl})),n.d(e,"LineLoop",(function(){return Nu})),n.d(e,"LinePieces",(function(){return Xh})),n.d(e,"LineSegments",(function(){return Pu})),n.d(e,"LineStrip",(function(){return zh})),n.d(e,"LinearEncoding",(function(){return cn})),n.d(e,"LinearFilter",(function(){return Pt})),n.d(e,"LinearInterpolant",(function(){return bl})),n.d(e,"LinearMipMapLinearFilter",(function(){return Lt})),n.d(e,"LinearMipMapNearestFilter",(function(){return Ot})),n.d(e,"LinearMipmapLinearFilter",(function(){return Ut})),n.d(e,"LinearMipmapNearestFilter",(function(){return Nt})),n.d(e,"LinearToneMapping",(function(){return ft})),n.d(e,"Loader",(function(){return Nl})),n.d(e,"LoaderUtils",(function(){return Md})),n.d(e,"LoadingManager",(function(){return Fl})),n.d(e,"LogLuvEncoding",(function(){return hn})),n.d(e,"LoopOnce",(function(){return Je})),n.d(e,"LoopPingPong",(function(){return Ke})),n.d(e,"LoopRepeat",(function(){return qe})),n.d(e,"LuminanceAlphaFormat",(function(){return te})),n.d(e,"LuminanceFormat",(function(){return $t})),n.d(e,"MOUSE",(function(){return m})),n.d(e,"Material",(function(){return Ci})),n.d(e,"MaterialLoader",(function(){return Sd})),n.d(e,"Math",(function(){return Jn})),n.d(e,"MathUtils",(function(){return Jn})),n.d(e,"Matrix3",(function(){return Kn})),n.d(e,"Matrix4",(function(){return vr})),n.d(e,"MaxEquation",(function(){return k})),n.d(e,"Mesh",(function(){return yo})),n.d(e,"MeshBasicMaterial",(function(){return Fi})),n.d(e,"MeshDepthMaterial",(function(){return Ns})),n.d(e,"MeshDistanceMaterial",(function(){return Os})),n.d(e,"MeshFaceMaterial",(function(){return Qh})),n.d(e,"MeshLambertMaterial",(function(){return fl})),n.d(e,"MeshMatcapMaterial",(function(){return hl})),n.d(e,"MeshNormalMaterial",(function(){return dl})),n.d(e,"MeshPhongMaterial",(function(){return cl})),n.d(e,"MeshPhysicalMaterial",(function(){return ul})),n.d(e,"MeshStandardMaterial",(function(){return sl})),n.d(e,"MeshToonMaterial",(function(){return ll})),n.d(e,"MinEquation",(function(){return H})),n.d(e,"MirroredRepeatWrapping",(function(){return Rt})),n.d(e,"MixOperation",(function(){return ct})),n.d(e,"MultiMaterial",(function(){return Yh})),n.d(e,"MultiplyBlending",(function(){return U})),n.d(e,"MultiplyOperation",(function(){return ut})),n.d(e,"NearestFilter",(function(){return It})),n.d(e,"NearestMipMapLinearFilter",(function(){return Ft})),n.d(e,"NearestMipMapNearestFilter",(function(){return At})),n.d(e,"NearestMipmapLinearFilter",(function(){return Ct})),n.d(e,"NearestMipmapNearestFilter",(function(){return Bt})),n.d(e,"NeverDepth",(function(){return tt})),n.d(e,"NeverStencilFunc",(function(){return Bn})),n.d(e,"NoBlending",(function(){return F})),n.d(e,"NoColors",(function(){return Wh})),n.d(e,"NoToneMapping",(function(){return dt})),n.d(e,"NormalBlending",(function(){return P})),n.d(e,"NotEqualDepth",(function(){return st})),n.d(e,"NotEqualStencilFunc",(function(){return Nn})),n.d(e,"NumberKeyframeTrack",(function(){return Sl})),n.d(e,"Object3D",(function(){return Nr})),n.d(e,"ObjectLoader",(function(){return Ad})),n.d(e,"ObjectSpaceNormalMap",(function(){return xn})),n.d(e,"OctahedronBufferGeometry",(function(){return tc})),n.d(e,"OctahedronGeometry",(function(){return $u})),n.d(e,"OneFactor",(function(){return X})),n.d(e,"OneMinusDstAlphaFactor",(function(){return J})),n.d(e,"OneMinusDstColorFactor",(function(){return K})),n.d(e,"OneMinusSrcAlphaFactor",(function(){return Q})),n.d(e,"OneMinusSrcColorFactor",(function(){return j})),n.d(e,"OrthographicCamera",(function(){return bd})),n.d(e,"PCFShadowMap",(function(){return S})),n.d(e,"PCFSoftShadowMap",(function(){return M})),n.d(e,"PMREMGenerator",(function(){return Ah})),n.d(e,"ParametricBufferGeometry",(function(){return Qu})),n.d(e,"ParametricGeometry",(function(){return Zu})),n.d(e,"Particle",(function(){return qh})),n.d(e,"ParticleBasicMaterial",(function(){return tp})),n.d(e,"ParticleSystem",(function(){return Kh})),n.d(e,"ParticleSystemMaterial",(function(){return ep})),n.d(e,"Path",(function(){return ld})),n.d(e,"PerspectiveCamera",(function(){return Po})),n.d(e,"Plane",(function(){return li})),n.d(e,"PlaneBufferGeometry",(function(){return Xo})),n.d(e,"PlaneGeometry",(function(){return zo})),n.d(e,"PlaneHelper",(function(){return ah})),n.d(e,"PointCloud",(function(){return Jh})),n.d(e,"PointCloudMaterial",(function(){return $h})),n.d(e,"PointLight",(function(){return yd})),n.d(e,"PointLightHelper",(function(){return kf})),n.d(e,"Points",(function(){return Vu})),n.d(e,"PointsMaterial",(function(){return Ou})),n.d(e,"PolarGridHelper",(function(){return Qf})),n.d(e,"PolyhedronBufferGeometry",(function(){return Ju})),n.d(e,"PolyhedronGeometry",(function(){return Yu})),n.d(e,"PositionalAudio",(function(){return sf})),n.d(e,"PropertyBinding",(function(){return bf})),n.d(e,"PropertyMixer",(function(){return cf})),n.d(e,"QuadraticBezierCurve",(function(){return od})),n.d(e,"QuadraticBezierCurve3",(function(){return ad})),n.d(e,"Quaternion",(function(){return or})),n.d(e,"QuaternionKeyframeTrack",(function(){return El})),n.d(e,"QuaternionLinearInterpolant",(function(){return Ml})),n.d(e,"REVISION",(function(){return p})),n.d(e,"RGBADepthPacking",(function(){return yn})),n.d(e,"RGBAFormat",(function(){return Kt})),n.d(e,"RGBAIntegerFormat",(function(){return ce})),n.d(e,"RGBA_ASTC_10x10_Format",(function(){return Fe})),n.d(e,"RGBA_ASTC_10x5_Format",(function(){return Be})),n.d(e,"RGBA_ASTC_10x6_Format",(function(){return Ae})),n.d(e,"RGBA_ASTC_10x8_Format",(function(){return Ce})),n.d(e,"RGBA_ASTC_12x10_Format",(function(){return Pe})),n.d(e,"RGBA_ASTC_12x12_Format",(function(){return Ne})),n.d(e,"RGBA_ASTC_4x4_Format",(function(){return _e})),n.d(e,"RGBA_ASTC_5x4_Format",(function(){return we})),n.d(e,"RGBA_ASTC_5x5_Format",(function(){return Te})),n.d(e,"RGBA_ASTC_6x5_Format",(function(){return Se})),n.d(e,"RGBA_ASTC_6x6_Format",(function(){return Me})),n.d(e,"RGBA_ASTC_8x5_Format",(function(){return Ee})),n.d(e,"RGBA_ASTC_8x6_Format",(function(){return Re})),n.d(e,"RGBA_ASTC_8x8_Format",(function(){return Ie})),n.d(e,"RGBA_BPTC_Format",(function(){return Oe})),n.d(e,"RGBA_ETC2_EAC_Format",(function(){return xe})),n.d(e,"RGBA_PVRTC_2BPPV1_Format",(function(){return ge})),n.d(e,"RGBA_PVRTC_4BPPV1_Format",(function(){return ve})),n.d(e,"RGBA_S3TC_DXT1_Format",(function(){return de})),n.d(e,"RGBA_S3TC_DXT3_Format",(function(){return fe})),n.d(e,"RGBA_S3TC_DXT5_Format",(function(){return he})),n.d(e,"RGBDEncoding",(function(){return vn})),n.d(e,"RGBEEncoding",(function(){return fn})),n.d(e,"RGBEFormat",(function(){return ee})),n.d(e,"RGBFormat",(function(){return qt})),n.d(e,"RGBIntegerFormat",(function(){return ue})),n.d(e,"RGBM16Encoding",(function(){return mn})),n.d(e,"RGBM7Encoding",(function(){return pn})),n.d(e,"RGB_ETC1_Format",(function(){return ye})),n.d(e,"RGB_ETC2_Format",(function(){return be})),n.d(e,"RGB_PVRTC_2BPPV1_Format",(function(){return me})),n.d(e,"RGB_PVRTC_4BPPV1_Format",(function(){return pe})),n.d(e,"RGB_S3TC_DXT1_Format",(function(){return le})),n.d(e,"RGFormat",(function(){return ae})),n.d(e,"RGIntegerFormat",(function(){return se})),n.d(e,"RawShaderMaterial",(function(){return al})),n.d(e,"Ray",(function(){return ai})),n.d(e,"Raycaster",(function(){return Mf})),n.d(e,"RectAreaLight",(function(){return Td})),n.d(e,"RedFormat",(function(){return ie})),n.d(e,"RedIntegerFormat",(function(){return oe})),n.d(e,"ReinhardToneMapping",(function(){return ht})),n.d(e,"RepeatWrapping",(function(){return Mt})),n.d(e,"ReplaceStencilOp",(function(){return Tn})),n.d(e,"ReverseSubtractEquation",(function(){return V})),n.d(e,"RingBufferGeometry",(function(){return Wc})),n.d(e,"RingGeometry",(function(){return Xc})),n.d(e,"SRGB8_ALPHA8_ASTC_10x10_Format",(function(){return Ze})),n.d(e,"SRGB8_ALPHA8_ASTC_10x5_Format",(function(){return Xe})),n.d(e,"SRGB8_ALPHA8_ASTC_10x6_Format",(function(){return We})),n.d(e,"SRGB8_ALPHA8_ASTC_10x8_Format",(function(){return je})),n.d(e,"SRGB8_ALPHA8_ASTC_12x10_Format",(function(){return Qe})),n.d(e,"SRGB8_ALPHA8_ASTC_12x12_Format",(function(){return Ye})),n.d(e,"SRGB8_ALPHA8_ASTC_4x4_Format",(function(){return Ue})),n.d(e,"SRGB8_ALPHA8_ASTC_5x4_Format",(function(){return Le})),n.d(e,"SRGB8_ALPHA8_ASTC_5x5_Format",(function(){return Ge})),n.d(e,"SRGB8_ALPHA8_ASTC_6x5_Format",(function(){return De})),n.d(e,"SRGB8_ALPHA8_ASTC_6x6_Format",(function(){return Ve})),n.d(e,"SRGB8_ALPHA8_ASTC_8x5_Format",(function(){return He})),n.d(e,"SRGB8_ALPHA8_ASTC_8x6_Format",(function(){return ke})),n.d(e,"SRGB8_ALPHA8_ASTC_8x8_Format",(function(){return ze})),n.d(e,"Scene",(function(){return Or})),n.d(e,"SceneUtils",(function(){return Ep})),n.d(e,"ShaderChunk",(function(){return Wo})),n.d(e,"ShaderLib",(function(){return jo})),n.d(e,"ShaderMaterial",(function(){return Co})),n.d(e,"ShadowMaterial",(function(){return ol})),n.d(e,"Shape",(function(){return dd})),n.d(e,"ShapeBufferGeometry",(function(){return Yc})),n.d(e,"ShapeGeometry",(function(){return Qc})),n.d(e,"ShapePath",(function(){return Ud})),n.d(e,"ShapeUtils",(function(){return Pc})),n.d(e,"ShortType",(function(){return Vt})),n.d(e,"Skeleton",(function(){return gu})),n.d(e,"SkeletonHelper",(function(){return Hf})),n.d(e,"SkinnedMesh",(function(){return pu})),n.d(e,"SmoothShading",(function(){return C})),n.d(e,"Sphere",(function(){return Kr})),n.d(e,"SphereBufferGeometry",(function(){return zc})),n.d(e,"SphereGeometry",(function(){return kc})),n.d(e,"Spherical",(function(){return If})),n.d(e,"SphericalHarmonics3",(function(){return kd})),n.d(e,"SphericalReflectionMapping",(function(){return wt})),n.d(e,"Spline",(function(){return mp})),n.d(e,"SplineCurve",(function(){return sd})),n.d(e,"SplineCurve3",(function(){return pp})),n.d(e,"SpotLight",(function(){return vd})),n.d(e,"SpotLightHelper",(function(){return Lf})),n.d(e,"SpotLightShadow",(function(){return md})),n.d(e,"Sprite",(function(){return cu})),n.d(e,"SpriteMaterial",(function(){return Js})),n.d(e,"SrcAlphaFactor",(function(){return Z})),n.d(e,"SrcAlphaSaturateFactor",(function(){return $})),n.d(e,"SrcColorFactor",(function(){return W})),n.d(e,"StaticCopyUsage",(function(){return zn})),n.d(e,"StaticDrawUsage",(function(){return Ln})),n.d(e,"StaticReadUsage",(function(){return Vn})),n.d(e,"StereoCamera",(function(){return Qd})),n.d(e,"StreamCopyUsage",(function(){return Wn})),n.d(e,"StreamDrawUsage",(function(){return Dn})),n.d(e,"StreamReadUsage",(function(){return kn})),n.d(e,"StringKeyframeTrack",(function(){return Rl})),n.d(e,"SubtractEquation",(function(){return D})),n.d(e,"SubtractiveBlending",(function(){return O})),n.d(e,"TOUCH",(function(){return v})),n.d(e,"TangentSpaceNormalMap",(function(){return bn})),n.d(e,"TetrahedronBufferGeometry",(function(){return Ku})),n.d(e,"TetrahedronGeometry",(function(){return qu})),n.d(e,"TextBufferGeometry",(function(){return Hc})),n.d(e,"TextGeometry",(function(){return Vc})),n.d(e,"Texture",(function(){return er})),n.d(e,"TextureLoader",(function(){return kl})),n.d(e,"TorusBufferGeometry",(function(){return lc})),n.d(e,"TorusGeometry",(function(){return cc})),n.d(e,"TorusKnotBufferGeometry",(function(){return uc})),n.d(e,"TorusKnotGeometry",(function(){return sc})),n.d(e,"Triangle",(function(){return _i})),n.d(e,"TriangleFanDrawMode",(function(){return un})),n.d(e,"TriangleStripDrawMode",(function(){return sn})),n.d(e,"TrianglesDrawMode",(function(){return an})),n.d(e,"TubeBufferGeometry",(function(){return ac})),n.d(e,"TubeGeometry",(function(){return oc})),n.d(e,"UVMapping",(function(){return gt})),n.d(e,"Uint16Attribute",(function(){return up})),n.d(e,"Uint16BufferAttribute",(function(){return Di})),n.d(e,"Uint32Attribute",(function(){return lp})),n.d(e,"Uint32BufferAttribute",(function(){return Hi})),n.d(e,"Uint8Attribute",(function(){return op})),n.d(e,"Uint8BufferAttribute",(function(){return Ui})),n.d(e,"Uint8ClampedAttribute",(function(){return ap})),n.d(e,"Uint8ClampedBufferAttribute",(function(){return Li})),n.d(e,"Uncharted2ToneMapping",(function(){return pt})),n.d(e,"Uniform",(function(){return Tf})),n.d(e,"UniformsLib",(function(){return Vo})),n.d(e,"UniformsUtils",(function(){return Ao})),n.d(e,"UnsignedByteType",(function(){return Gt})),n.d(e,"UnsignedInt248Type",(function(){return Yt})),n.d(e,"UnsignedIntType",(function(){return zt})),n.d(e,"UnsignedShort4444Type",(function(){return jt})),n.d(e,"UnsignedShort5551Type",(function(){return Zt})),n.d(e,"UnsignedShort565Type",(function(){return Qt})),n.d(e,"UnsignedShortType",(function(){return Ht})),n.d(e,"VSMShadowMap",(function(){return E})),n.d(e,"Vector2",(function(){return qn})),n.d(e,"Vector3",(function(){return ur})),n.d(e,"Vector4",(function(){return nr})),n.d(e,"VectorKeyframeTrack",(function(){return Il})),n.d(e,"Vertex",(function(){return np})),n.d(e,"VertexColors",(function(){return Zh})),n.d(e,"VideoTexture",(function(){return ku})),n.d(e,"WebGLCubeRenderTarget",(function(){return Oo})),n.d(e,"WebGLMultisampleRenderTarget",(function(){return ir})),n.d(e,"WebGLRenderTarget",(function(){return rr})),n.d(e,"WebGLRenderTargetCube",(function(){return wp})),n.d(e,"WebGLRenderer",(function(){return zs})),n.d(e,"WebGLUtils",(function(){return Ds})),n.d(e,"WireframeGeometry",(function(){return ju})),n.d(e,"WireframeHelper",(function(){return bp})),n.d(e,"WrapAroundEnding",(function(){return on})),n.d(e,"XHRLoader",(function(){return xp})),n.d(e,"ZeroCurvatureEnding",(function(){return nn})),n.d(e,"ZeroFactor",(function(){return z})),n.d(e,"ZeroSlopeEnding",(function(){return rn})),n.d(e,"ZeroStencilOp",(function(){return _n})),n.d(e,"sRGBEncoding",(function(){return ln}));var r=n(6);function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=n(71);function s(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Object(a.a)(t,e)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c,l=n(72);function d(t){return(d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){return!e||"object"!==d(e)&&"function"!==typeof e?i(t):e}function h(t){return function(){var e,n=u(t);if(Object(l.a)()){var r=u(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return f(this,e)}}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"===typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype===!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e});var p="115",m={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},v={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},g=0,y=1,b=2,x=3,_=0,w=1,T=0,S=1,M=2,E=3,R=0,I=1,B=2,A=1,C=2,F=0,P=1,N=2,O=3,U=4,L=5,G=100,D=101,V=102,H=103,k=104,z=200,X=201,W=202,j=203,Z=204,Q=205,Y=206,J=207,q=208,K=209,$=210,tt=0,et=1,nt=2,rt=3,it=4,ot=5,at=6,st=7,ut=0,ct=1,lt=2,dt=0,ft=1,ht=2,pt=3,mt=4,vt=5,gt=300,yt=301,bt=302,xt=303,_t=304,wt=305,Tt=306,St=307,Mt=1e3,Et=1001,Rt=1002,It=1003,Bt=1004,At=1004,Ct=1005,Ft=1005,Pt=1006,Nt=1007,Ot=1007,Ut=1008,Lt=1008,Gt=1009,Dt=1010,Vt=1011,Ht=1012,kt=1013,zt=1014,Xt=1015,Wt=1016,jt=1017,Zt=1018,Qt=1019,Yt=1020,Jt=1021,qt=1022,Kt=1023,$t=1024,te=1025,ee=Kt,ne=1026,re=1027,ie=1028,oe=1029,ae=1030,se=1031,ue=1032,ce=1033,le=33776,de=33777,fe=33778,he=33779,pe=35840,me=35841,ve=35842,ge=35843,ye=36196,be=37492,xe=37496,_e=37808,we=37809,Te=37810,Se=37811,Me=37812,Ee=37813,Re=37814,Ie=37815,Be=37816,Ae=37817,Ce=37818,Fe=37819,Pe=37820,Ne=37821,Oe=36492,Ue=37840,Le=37841,Ge=37842,De=37843,Ve=37844,He=37845,ke=37846,ze=37847,Xe=37848,We=37849,je=37850,Ze=37851,Qe=37852,Ye=37853,Je=2200,qe=2201,Ke=2202,$e=2300,tn=2301,en=2302,nn=2400,rn=2401,on=2402,an=0,sn=1,un=2,cn=3e3,ln=3001,dn=3007,fn=3002,hn=3003,pn=3004,mn=3005,vn=3006,gn=3200,yn=3201,bn=0,xn=1,_n=0,wn=7680,Tn=7681,Sn=7682,Mn=7683,En=34055,Rn=34056,In=5386,Bn=512,An=513,Cn=514,Fn=515,Pn=516,Nn=517,On=518,Un=519,Ln=35044,Gn=35048,Dn=35040,Vn=35045,Hn=35049,kn=35041,zn=35046,Xn=35050,Wn=35042;function jn(){}Object.assign(jn.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}});for(var Zn=[],Qn=0;Qn<256;Qn++)Zn[Qn]=(Qn<16?"0":"")+Qn.toString(16);var Yn,Jn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Zn[255&t]+Zn[t>>8&255]+Zn[t>>16&255]+Zn[t>>24&255]+"-"+Zn[255&e]+Zn[e>>8&255]+"-"+Zn[e>>16&15|64]+Zn[e>>24&255]+"-"+Zn[63&n|128]+Zn[n>>8&255]+"-"+Zn[n>>16&255]+Zn[n>>24&255]+Zn[255&r]+Zn[r>>8&255]+Zn[r>>16&255]+Zn[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Jn.DEG2RAD},radToDeg:function(t){return t*Jn.RAD2DEG},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var o=Math.cos,a=Math.sin,s=o(n/2),u=a(n/2),c=o((e+r)/2),l=a((e+r)/2),d=o((e-r)/2),f=a((e-r)/2),h=o((r-e)/2),p=a((r-e)/2);"XYX"===i?t.set(s*l,u*d,u*f,s*c):"YZY"===i?t.set(u*f,s*l,u*d,s*c):"ZXZ"===i?t.set(u*d,u*f,s*l,s*c):"XZX"===i?t.set(s*l,u*p,u*h,s*c):"YXY"===i?t.set(u*h,s*l,u*p,s*c):"ZYZ"===i?t.set(u*p,u*h,s*l,s*c):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function qn(t,e){this.x=t||0,this.y=e||0}function Kn(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(qn.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(qn.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(-this.y,-this.x)+Math.PI;return t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}}),Object.assign(Kn.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,o,a,s,u){var c=this.elements;return c[0]=t,c[1]=r,c[2]=a,c[3]=e,c[4]=i,c[5]=s,c[6]=n,c[7]=o,c[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},extractBasis:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[3],s=n[6],u=n[1],c=n[4],l=n[7],d=n[2],f=n[5],h=n[8],p=r[0],m=r[3],v=r[6],g=r[1],y=r[4],b=r[7],x=r[2],_=r[5],w=r[8];return i[0]=o*p+a*g+s*x,i[3]=o*m+a*y+s*_,i[6]=o*v+a*b+s*w,i[1]=u*p+c*g+l*x,i[4]=u*m+c*y+l*_,i[7]=u*v+c*b+l*w,i[2]=d*p+f*g+h*x,i[5]=d*m+f*y+h*_,i[8]=d*v+f*b+h*w,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*o*c-e*a*u-n*i*c+n*a*s+r*i*u-r*o*s},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var n=t.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],u=n[4],c=n[5],l=n[6],d=n[7],f=n[8],h=f*u-c*d,p=c*l-f*s,m=d*s-u*l,v=i*h+o*p+a*m;if(0===v)return this.set(0,0,0,0,0,0,0,0,0);var g=1/v;return r[0]=h*g,r[1]=(a*d-f*o)*g,r[2]=(c*o-a*u)*g,r[3]=p*g,r[4]=(f*i-a*l)*g,r[5]=(a*s-c*i)*g,r[6]=m*g,r[7]=(o*l-d*i)*g,r[8]=(u*i-o*s)*g,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,o,a){var s=Math.cos(i),u=Math.sin(i);this.set(n*s,n*u,-n*(s*o+u*a)+o+t,-r*u,r*s,-r*(-u*o+s*a)+a+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],u=r[4],c=r[7];return r[0]=e*i+n*s,r[3]=e*o+n*u,r[6]=e*a+n*c,r[1]=-n*i+e*s,r[4]=-n*o+e*u,r[7]=-n*a+e*c,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var $n={getDataURL:function(t){var e;if("undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Yn&&(Yn=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Yn.width=t.width,Yn.height=t.height;var n=Yn.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Yn}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},tr=0;function er(t,e,n,r,i,o,a,s,u,c){Object.defineProperty(this,"id",{value:tr++}),this.uuid=Jn.generateUUID(),this.name="",this.image=void 0!==t?t:er.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:er.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:Et,this.wrapT=void 0!==r?r:Et,this.magFilter=void 0!==i?i:Pt,this.minFilter=void 0!==o?o:Ut,this.anisotropy=void 0!==u?u:1,this.format=void 0!==a?a:Kt,this.internalFormat=null,this.type=void 0!==s?s:Gt,this.offset=new qn(0,0),this.repeat=new qn(1,1),this.center=new qn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Kn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==c?c:cn,this.version=0,this.onUpdate=null}function nr(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function rr(t,e,n){this.width=t,this.height=e,this.scissor=new nr(0,0,t,e),this.scissorTest=!1,this.viewport=new nr(0,0,t,e),n=n||{},this.texture=new er(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Pt,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function ir(t,e,n){rr.call(this,t,e,n),this.samples=4}function or(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}er.DEFAULT_IMAGE=void 0,er.DEFAULT_MAPPING=gt,er.prototype=Object.assign(Object.create(jn.prototype),{constructor:er,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=Jn.generateUUID()),!e&&void 0===t.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var o=0,a=r.length;o<a;o++)i.push($n.getDataURL(r[o]))}else i=$n.getDataURL(r);t.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==gt)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Mt:t.x=t.x-Math.floor(t.x);break;case Et:t.x=t.x<0?0:1;break;case Rt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Mt:t.y=t.y-Math.floor(t.y);break;case Et:t.y=t.y<0?0:1;break;case Rt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(er.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties(nr.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(nr.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,o=t.elements,a=o[0],s=o[4],u=o[8],c=o[1],l=o[5],d=o[9],f=o[2],h=o[6],p=o[10];if(Math.abs(s-c)<.01&&Math.abs(u-f)<.01&&Math.abs(d-h)<.01){if(Math.abs(s+c)<.1&&Math.abs(u+f)<.1&&Math.abs(d+h)<.1&&Math.abs(a+l+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(a+1)/2,v=(l+1)/2,g=(p+1)/2,y=(s+c)/4,b=(u+f)/4,x=(d+h)/4;return m>v&&m>g?m<.01?(n=0,r=.707106781,i=.707106781):(r=y/(n=Math.sqrt(m)),i=b/n):v>g?v<.01?(n=.707106781,r=0,i=.707106781):(n=y/(r=Math.sqrt(v)),i=x/r):g<.01?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(g)),r=x/i),this.set(n,r,i,e),this}var _=Math.sqrt((h-d)*(h-d)+(u-f)*(u-f)+(c-s)*(c-s));return Math.abs(_)<.001&&(_=1),this.x=(h-d)/_,this.y=(u-f)/_,this.z=(c-s)/_,this.w=Math.acos((a+l+p-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),rr.prototype=Object.assign(Object.create(jn.prototype),{constructor:rr,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),ir.prototype=Object.assign(Object.create(rr.prototype),{constructor:ir,isWebGLMultisampleRenderTarget:!0,copy:function(t){return rr.prototype.copy.call(this,t),this.samples=t.samples,this}}),Object.assign(or,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,o,a){var s=n[r+0],u=n[r+1],c=n[r+2],l=n[r+3],d=i[o+0],f=i[o+1],h=i[o+2],p=i[o+3];if(l!==p||s!==d||u!==f||c!==h){var m=1-a,v=s*d+u*f+c*h+l*p,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var b=Math.sqrt(y),x=Math.atan2(b,v*g);m=Math.sin(m*x)/b,a=Math.sin(a*x)/b}var _=a*g;if(s=s*m+d*_,u=u*m+f*_,c=c*m+h*_,l=l*m+p*_,m===1-a){var w=1/Math.sqrt(s*s+u*u+c*c+l*l);s*=w,u*=w,c*=w,l*=w}}t[e]=s,t[e+1]=u,t[e+2]=c,t[e+3]=l}}),Object.defineProperties(or.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(or.prototype,{isQuaternion:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,o=t.order,a=Math.cos,s=Math.sin,u=a(n/2),c=a(r/2),l=a(i/2),d=s(n/2),f=s(r/2),h=s(i/2);return"XYZ"===o?(this._x=d*c*l+u*f*h,this._y=u*f*l-d*c*h,this._z=u*c*h+d*f*l,this._w=u*c*l-d*f*h):"YXZ"===o?(this._x=d*c*l+u*f*h,this._y=u*f*l-d*c*h,this._z=u*c*h-d*f*l,this._w=u*c*l+d*f*h):"ZXY"===o?(this._x=d*c*l-u*f*h,this._y=u*f*l+d*c*h,this._z=u*c*h+d*f*l,this._w=u*c*l-d*f*h):"ZYX"===o?(this._x=d*c*l-u*f*h,this._y=u*f*l+d*c*h,this._z=u*c*h-d*f*l,this._w=u*c*l+d*f*h):"YZX"===o?(this._x=d*c*l+u*f*h,this._y=u*f*l+d*c*h,this._z=u*c*h-d*f*l,this._w=u*c*l-d*f*h):"XZY"===o&&(this._x=d*c*l-u*f*h,this._y=u*f*l-d*c*h,this._z=u*c*h+d*f*l,this._w=u*c*l+d*f*h),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],u=n[9],c=n[2],l=n[6],d=n[10],f=r+s+d;return f>0?(e=.5/Math.sqrt(f+1),this._w=.25/e,this._x=(l-u)*e,this._y=(o-c)*e,this._z=(a-i)*e):r>s&&r>d?(e=2*Math.sqrt(1+r-s-d),this._w=(l-u)/e,this._x=.25*e,this._y=(i+a)/e,this._z=(o+c)/e):s>d?(e=2*Math.sqrt(1+s-r-d),this._w=(o-c)/e,this._x=(i+a)/e,this._y=.25*e,this._z=(u+l)/e):(e=2*Math.sqrt(1+d-r-s),this._w=(a-i)/e,this._x=(o+c)/e,this._y=(u+l)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(Jn.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,u=e._z,c=e._w;return this._x=n*c+o*a+r*u-i*s,this._y=r*c+o*s+i*a-n*u,this._z=i*c+o*u+n*s-r*a,this._w=o*c-n*a-r*s-i*u,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var u=1-e;return this._w=u*o+e*this._w,this._x=u*n+e*this._x,this._y=u*r+e*this._y,this._z=u*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(s),l=Math.atan2(c,a),d=Math.sin((1-e)*l)/c,f=Math.sin(e*l)/c;return this._w=o*d+this._w*f,this._x=n*d+this._x*f,this._y=r*d+this._y*f,this._z=i*d+this._z*f,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var ar=new ur,sr=new or;function ur(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}Object.assign(ur.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(sr.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(sr.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,u=s*e+o*r-a*n,c=s*n+a*e-i*r,l=s*r+i*n-o*e,d=-i*e-o*n-a*r;return this.x=u*s+d*-i+c*-a-l*-o,this.y=c*s+d*-o+l*-i-u*-a,this.z=l*s+d*-a+u*-o-c*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)},projectOnPlane:function(t){return ar.copy(this).projectOnVector(t),this.sub(ar)},reflect:function(t){return this.sub(ar.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var n=this.dot(t)/e;return Math.acos(Jn.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}});var cr=new ur,lr=new vr,dr=new ur(0,0,0),fr=new ur(1,1,1),hr=new ur,pr=new ur,mr=new ur;function vr(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(vr.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,o,a,s,u,c,l,d,f,h,p,m){var v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=r,v[1]=i,v[5]=o,v[9]=a,v[13]=s,v[2]=u,v[6]=c,v[10]=l,v[14]=d,v[3]=f,v[7]=h,v[11]=p,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new vr).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,r=1/cr.setFromMatrixColumn(t,0).length(),i=1/cr.setFromMatrixColumn(t,1).length(),o=1/cr.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),u=Math.sin(r),c=Math.cos(i),l=Math.sin(i);if("XYZ"===t.order){var d=o*c,f=o*l,h=a*c,p=a*l;e[0]=s*c,e[4]=-s*l,e[8]=u,e[1]=f+h*u,e[5]=d-p*u,e[9]=-a*s,e[2]=p-d*u,e[6]=h+f*u,e[10]=o*s}else if("YXZ"===t.order){var m=s*c,v=s*l,g=u*c,y=u*l;e[0]=m+y*a,e[4]=g*a-v,e[8]=o*u,e[1]=o*l,e[5]=o*c,e[9]=-a,e[2]=v*a-g,e[6]=y+m*a,e[10]=o*s}else if("ZXY"===t.order){m=s*c,v=s*l,g=u*c,y=u*l;e[0]=m-y*a,e[4]=-o*l,e[8]=g+v*a,e[1]=v+g*a,e[5]=o*c,e[9]=y-m*a,e[2]=-o*u,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){d=o*c,f=o*l,h=a*c,p=a*l;e[0]=s*c,e[4]=h*u-f,e[8]=d*u+p,e[1]=s*l,e[5]=p*u+d,e[9]=f*u-h,e[2]=-u,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var b=o*s,x=o*u,_=a*s,w=a*u;e[0]=s*c,e[4]=w-b*l,e[8]=_*l+x,e[1]=l,e[5]=o*c,e[9]=-a*c,e[2]=-u*c,e[6]=x*l+_,e[10]=b-w*l}else if("XZY"===t.order){b=o*s,x=o*u,_=a*s,w=a*u;e[0]=s*c,e[4]=-l,e[8]=u*c,e[1]=b*l+w,e[5]=o*c,e[9]=x*l-_,e[2]=_*l-x,e[6]=a*c,e[10]=w*l+b}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(dr,t,fr)},lookAt:function(t,e,n){var r=this.elements;return mr.subVectors(t,e),0===mr.lengthSq()&&(mr.z=1),mr.normalize(),hr.crossVectors(n,mr),0===hr.lengthSq()&&(1===Math.abs(n.z)?mr.x+=1e-4:mr.z+=1e-4,mr.normalize(),hr.crossVectors(n,mr)),hr.normalize(),pr.crossVectors(mr,hr),r[0]=hr.x,r[4]=pr.x,r[8]=mr.x,r[1]=hr.y,r[5]=pr.y,r[9]=mr.y,r[2]=hr.z,r[6]=pr.z,r[10]=mr.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],c=n[1],l=n[5],d=n[9],f=n[13],h=n[2],p=n[6],m=n[10],v=n[14],g=n[3],y=n[7],b=n[11],x=n[15],_=r[0],w=r[4],T=r[8],S=r[12],M=r[1],E=r[5],R=r[9],I=r[13],B=r[2],A=r[6],C=r[10],F=r[14],P=r[3],N=r[7],O=r[11],U=r[15];return i[0]=o*_+a*M+s*B+u*P,i[4]=o*w+a*E+s*A+u*N,i[8]=o*T+a*R+s*C+u*O,i[12]=o*S+a*I+s*F+u*U,i[1]=c*_+l*M+d*B+f*P,i[5]=c*w+l*E+d*A+f*N,i[9]=c*T+l*R+d*C+f*O,i[13]=c*S+l*I+d*F+f*U,i[2]=h*_+p*M+m*B+v*P,i[6]=h*w+p*E+m*A+v*N,i[10]=h*T+p*R+m*C+v*O,i[14]=h*S+p*I+m*F+v*U,i[3]=g*_+y*M+b*B+x*P,i[7]=g*w+y*E+b*A+x*N,i[11]=g*T+y*R+b*C+x*O,i[15]=g*S+y*I+b*F+x*U,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],u=t[13],c=t[2],l=t[6],d=t[10],f=t[14];return t[3]*(+i*s*l-r*u*l-i*a*d+n*u*d+r*a*f-n*s*f)+t[7]*(+e*s*f-e*u*d+i*o*d-r*o*f+r*u*c-i*s*c)+t[11]*(+e*u*l-e*a*f-i*o*l+n*o*f+i*a*c-n*u*c)+t[15]*(-r*a*c-e*s*l+e*a*d+r*o*l-n*o*d+n*s*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var n=this.elements,r=t.elements,i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],c=r[5],l=r[6],d=r[7],f=r[8],h=r[9],p=r[10],m=r[11],v=r[12],g=r[13],y=r[14],b=r[15],x=h*y*d-g*p*d+g*l*m-c*y*m-h*l*b+c*p*b,_=v*p*d-f*y*d-v*l*m+u*y*m+f*l*b-u*p*b,w=f*g*d-v*h*d+v*c*m-u*g*m-f*c*b+u*h*b,T=v*h*l-f*g*l-v*c*p+u*g*p+f*c*y-u*h*y,S=i*x+o*_+a*w+s*T;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var M=1/S;return n[0]=x*M,n[1]=(g*p*s-h*y*s-g*a*m+o*y*m+h*a*b-o*p*b)*M,n[2]=(c*y*s-g*l*s+g*a*d-o*y*d-c*a*b+o*l*b)*M,n[3]=(h*l*s-c*p*s-h*a*d+o*p*d+c*a*m-o*l*m)*M,n[4]=_*M,n[5]=(f*y*s-v*p*s+v*a*m-i*y*m-f*a*b+i*p*b)*M,n[6]=(v*l*s-u*y*s-v*a*d+i*y*d+u*a*b-i*l*b)*M,n[7]=(u*p*s-f*l*s+f*a*d-i*p*d-u*a*m+i*l*m)*M,n[8]=w*M,n[9]=(v*h*s-f*g*s-v*o*m+i*g*m+f*o*b-i*h*b)*M,n[10]=(u*g*s-v*c*s+v*o*d-i*g*d-u*o*b+i*c*b)*M,n[11]=(f*c*s-u*h*s-f*o*d+i*h*d+u*o*m-i*c*m)*M,n[12]=T*M,n[13]=(f*g*a-v*h*a+v*o*p-i*g*p-f*o*y+i*h*y)*M,n[14]=(v*c*a-u*g*a-v*o*l+i*g*l+u*o*y-i*c*y)*M,n[15]=(u*h*a-f*c*a+f*o*l-i*h*l-u*o*p+i*c*p)*M,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,u=i*o,c=i*a;return this.set(u*o+n,u*a-r*s,u*s+r*a,0,u*a+r*s,c*a+n,c*s-r*o,0,u*s-r*a,c*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var r=this.elements,i=e._x,o=e._y,a=e._z,s=e._w,u=i+i,c=o+o,l=a+a,d=i*u,f=i*c,h=i*l,p=o*c,m=o*l,v=a*l,g=s*u,y=s*c,b=s*l,x=n.x,_=n.y,w=n.z;return r[0]=(1-(p+v))*x,r[1]=(f+b)*x,r[2]=(h-y)*x,r[3]=0,r[4]=(f-b)*_,r[5]=(1-(d+v))*_,r[6]=(m+g)*_,r[7]=0,r[8]=(h+y)*w,r[9]=(m-g)*w,r[10]=(1-(d+p))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:function(t,e,n){var r=this.elements,i=cr.set(r[0],r[1],r[2]).length(),o=cr.set(r[4],r[5],r[6]).length(),a=cr.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],lr.copy(this);var s=1/i,u=1/o,c=1/a;return lr.elements[0]*=s,lr.elements[1]*=s,lr.elements[2]*=s,lr.elements[4]*=u,lr.elements[5]*=u,lr.elements[6]*=u,lr.elements[8]*=c,lr.elements[9]*=c,lr.elements[10]*=c,e.setFromRotationMatrix(lr),n.x=i,n.y=o,n.z=a,this},makePerspective:function(t,e,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(e-t),u=2*i/(n-r),c=(e+t)/(e-t),l=(n+r)/(n-r),d=-(o+i)/(o-i),f=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=u,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,r,i,o){var a=this.elements,s=1/(e-t),u=1/(n-r),c=1/(o-i),l=(e+t)*s,d=(n+r)*u,f=(o+i)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}});var gr=new vr,yr=new or;function br(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||br.DefaultOrder}function xr(){this.mask=1}br.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],br.DefaultOrder="XYZ",Object.defineProperties(br.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(br.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=Jn.clamp,i=t.elements,o=i[0],a=i[4],s=i[8],u=i[1],c=i[5],l=i[9],d=i[2],f=i[6],h=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,h),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(s,h),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-d,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,h),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(u,o))):"ZYX"===e?(this._y=Math.asin(-r(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,h),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===e?(this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(s,h))):"XZY"===e?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-l,h),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,n){return gr.makeRotationFromQuaternion(t),this.setFromRotationMatrix(gr,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return yr.setFromEuler(this),this.setFromQuaternion(yr,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new ur(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(xr.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!==(this.mask&t.mask)}});var _r=0,wr=new ur,Tr=new or,Sr=new vr,Mr=new ur,Er=new ur,Rr=new ur,Ir=new or,Br=new ur(1,0,0),Ar=new ur(0,1,0),Cr=new ur(0,0,1),Fr={type:"added"},Pr={type:"removed"};function Nr(){Object.defineProperty(this,"id",{value:_r++}),this.uuid=Jn.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Nr.DefaultUp.clone();var t=new ur,e=new br,n=new or,r=new ur(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new vr},normalMatrix:{value:new Kn}}),this.matrix=new vr,this.matrixWorld=new vr,this.matrixAutoUpdate=Nr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new xr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Or(){Nr.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Nr.DefaultUp=new ur(0,1,0),Nr.DefaultMatrixAutoUpdate=!0,Nr.prototype=Object.assign(Object.create(jn.prototype),{constructor:Nr,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return Tr.setFromAxisAngle(t,e),this.quaternion.multiply(Tr),this},rotateOnWorldAxis:function(t,e){return Tr.setFromAxisAngle(t,e),this.quaternion.premultiply(Tr),this},rotateX:function(t){return this.rotateOnAxis(Br,t)},rotateY:function(t){return this.rotateOnAxis(Ar,t)},rotateZ:function(t){return this.rotateOnAxis(Cr,t)},translateOnAxis:function(t,e){return wr.copy(t).applyQuaternion(this.quaternion),this.position.add(wr.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(Br,t)},translateY:function(t){return this.translateOnAxis(Ar,t)},translateZ:function(t){return this.translateOnAxis(Cr,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(Sr.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?Mr.copy(t):Mr.set(t,e,n);var r=this.parent;this.updateWorldMatrix(!0,!1),Er.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Sr.lookAt(Er,Mr,this.up):Sr.lookAt(Mr,Er,this.up),this.quaternion.setFromRotationMatrix(Sr),r&&(Sr.extractRotation(r.matrixWorld),Tr.setFromRotationMatrix(Sr),this.quaternion.premultiply(Tr.inverse()))},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Fr)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Pr)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),Sr.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Sr.multiply(t.parent.matrixWorld)),t.applyMatrix4(Sr),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new ur),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new or),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Er,t,Rr),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new ur),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Er,Ir,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new ur),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var r=this.children,i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"===typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,u=a.length;s<u;s++){var c=a[s];i(t.shapes,c)}else i(t.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var l=[];for(s=0,u=this.material.length;s<u;s++)l.push(i(t.materials,this.material[s]));r.material=l}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(t).object)}if(e){var d=m(t.geometries),f=m(t.materials),h=m(t.textures),p=m(t.images);a=m(t.shapes);d.length>0&&(n.geometries=d),f.length>0&&(n.materials=f),h.length>0&&(n.textures=h),p.length>0&&(n.images=p),a.length>0&&(n.shapes=a)}return n.object=r,n;function m(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}}),Or.prototype=Object.assign(Object.create(Nr.prototype),{constructor:Or,isScene:!0,copy:function(t,e){return Nr.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=Nr.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Ur=[new ur,new ur,new ur,new ur,new ur,new ur,new ur,new ur],Lr=new ur,Gr=new Yr,Dr=new ur,Vr=new ur,Hr=new ur,kr=new ur,zr=new ur,Xr=new ur,Wr=new ur,jr=new ur,Zr=new ur,Qr=new ur;function Yr(t,e){this.min=void 0!==t?t:new ur(1/0,1/0,1/0),this.max=void 0!==e?e:new ur(-1/0,-1/0,-1/0)}function Jr(t,e,n,r,i){var o,a;for(o=0,a=t.length-3;o<=a;o+=3){Qr.fromArray(t,o);var s=i.x*Math.abs(Qr.x)+i.y*Math.abs(Qr.y)+i.z*Math.abs(Qr.z),u=e.dot(Qr),c=n.dot(Qr),l=r.dot(Qr);if(Math.max(-Math.max(u,c,l),Math.min(u,c,l))>s)return!1}return!0}Object.assign(Yr.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=t.length;s<u;s+=3){var c=t[s],l=t[s+1],d=t[s+2];c<e&&(e=c),l<n&&(n=l),d<r&&(r=d),c>i&&(i=c),l>o&&(o=l),d>a&&(a=d)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=t.count;s<u;s++){var c=t.getX(s),l=t.getY(s),d=t.getZ(s);c<e&&(e=c),l<n&&(n=l),d<r&&(r=d),c>i&&(i=c),l>o&&(o=l),d>a&&(a=d)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=Lr.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new ur),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new ur),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),Gr.copy(e.boundingBox),Gr.applyMatrix4(t.matrixWorld),this.union(Gr));for(var n=t.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new ur),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,Lr),Lr.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(Wr),jr.subVectors(this.max,Wr),Dr.subVectors(t.a,Wr),Vr.subVectors(t.b,Wr),Hr.subVectors(t.c,Wr),kr.subVectors(Vr,Dr),zr.subVectors(Hr,Vr),Xr.subVectors(Dr,Hr);var e=[0,-kr.z,kr.y,0,-zr.z,zr.y,0,-Xr.z,Xr.y,kr.z,0,-kr.x,zr.z,0,-zr.x,Xr.z,0,-Xr.x,-kr.y,kr.x,0,-zr.y,zr.x,0,-Xr.y,Xr.x,0];return!!Jr(e,Dr,Vr,Hr,jr)&&(!!Jr(e=[1,0,0,0,1,0,0,0,1],Dr,Vr,Hr,jr)&&(Zr.crossVectors(kr,zr),Jr(e=[Zr.x,Zr.y,Zr.z],Dr,Vr,Hr,jr)))},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new ur),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return Lr.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(Lr).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(Ur[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ur[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ur[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ur[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ur[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ur[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ur[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ur[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ur)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var qr=new Yr;function Kr(t,e){this.center=void 0!==t?t:new ur,this.radius=void 0!==e?e:0}Object.assign(Kr.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){var n=this.center;void 0!==e?n.copy(e):qr.setFromPoints(t).getCenter(n);for(var r=0,i=0,o=t.length;i<o;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new ur),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Yr),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var $r=new ur,ti=new ur,ei=new ur,ni=new ur,ri=new ur,ii=new ur,oi=new ur;function ai(t,e){this.origin=void 0!==t?t:new ur,this.direction=void 0!==e?e:new ur(0,0,-1)}Object.assign(ai.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new ur),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,$r)),this},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new ur),e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=$r.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):($r.copy(this.direction).multiplyScalar(e).add(this.origin),$r.distanceToSquared(t))},distanceSqToSegment:function(t,e,n,r){ti.copy(t).add(e).multiplyScalar(.5),ei.copy(e).sub(t).normalize(),ni.copy(this.origin).sub(ti);var i,o,a,s,u=.5*t.distanceTo(e),c=-this.direction.dot(ei),l=ni.dot(this.direction),d=-ni.dot(ei),f=ni.lengthSq(),h=Math.abs(1-c*c);if(h>0)if(o=c*l-d,s=u*h,(i=c*d-l)>=0)if(o>=-s)if(o<=s){var p=1/h;a=(i*=p)*(i+c*(o*=p)+2*l)+o*(c*i+o+2*d)+f}else o=u,a=-(i=Math.max(0,-(c*o+l)))*i+o*(o+2*d)+f;else o=-u,a=-(i=Math.max(0,-(c*o+l)))*i+o*(o+2*d)+f;else o<=-s?a=-(i=Math.max(0,-(-c*u+l)))*i+(o=i>0?-u:Math.min(Math.max(-u,-d),u))*(o+2*d)+f:o<=s?(i=0,a=(o=Math.min(Math.max(-u,-d),u))*(o+2*d)+f):a=-(i=Math.max(0,-(c*u+l)))*i+(o=i>0?u:Math.min(Math.max(-u,-d),u))*(o+2*d)+f;else o=c>0?-u:u,a=-(i=Math.max(0,-(c*o+l)))*i+o*(o+2*d)+f;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(ei).multiplyScalar(o).add(ti),a},intersectSphere:function(t,e){$r.subVectors(t.center,this.origin);var n=$r.dot(this.direction),r=$r.dot($r)-n*n,i=t.radius*t.radius;if(r>i)return null;var o=Math.sqrt(i-r),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,e):this.at(a,e)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,r,i,o,a,s,u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,d=this.origin;return u>=0?(n=(t.min.x-d.x)*u,r=(t.max.x-d.x)*u):(n=(t.max.x-d.x)*u,r=(t.min.x-d.x)*u),c>=0?(i=(t.min.y-d.y)*c,o=(t.max.y-d.y)*c):(i=(t.max.y-d.y)*c,o=(t.min.y-d.y)*c),n>o||i>r?null:((i>n||n!==n)&&(n=i),(o<r||r!==r)&&(r=o),l>=0?(a=(t.min.z-d.z)*l,s=(t.max.z-d.z)*l):(a=(t.max.z-d.z)*l,s=(t.min.z-d.z)*l),n>s||a>r?null:((a>n||n!==n)&&(n=a),(s<r||r!==r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))},intersectsBox:function(t){return null!==this.intersectBox(t,$r)},intersectTriangle:function(t,e,n,r,i){ri.subVectors(e,t),ii.subVectors(n,t),oi.crossVectors(ri,ii);var o,a=this.direction.dot(oi);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}ni.subVectors(this.origin,t);var s=o*this.direction.dot(ii.crossVectors(ni,ii));if(s<0)return null;var u=o*this.direction.dot(ri.cross(ni));if(u<0)return null;if(s+u>a)return null;var c=-o*ni.dot(oi);return c<0?null:this.at(c/a,i)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var si=new ur,ui=new ur,ci=new Kn;function li(t,e){this.normal=void 0!==t?t:new ur(1,0,0),this.constant=void 0!==e?e:0}Object.assign(li.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,n){var r=si.subVectors(n,e).cross(ui.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new ur),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new ur);var n=t.delta(si),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;var i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:e.copy(n).multiplyScalar(i).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new ur),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){var n=e||ci.getNormalMatrix(t),r=this.coplanarPoint(si).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var di=new ur,fi=new ur,hi=new ur,pi=new ur,mi=new ur,vi=new ur,gi=new ur,yi=new ur,bi=new ur,xi=new ur;function _i(t,e,n){this.a=void 0!==t?t:new ur,this.b=void 0!==e?e:new ur,this.c=void 0!==n?n:new ur}Object.assign(_i,{getNormal:function(t,e,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new ur),r.subVectors(n,e),di.subVectors(t,e),r.cross(di);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},getBarycoord:function(t,e,n,r,i){di.subVectors(r,e),fi.subVectors(n,e),hi.subVectors(t,e);var o=di.dot(di),a=di.dot(fi),s=di.dot(hi),u=fi.dot(fi),c=fi.dot(hi),l=o*u-a*a;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new ur),0===l)return i.set(-2,-1,-1);var d=1/l,f=(u*s-a*c)*d,h=(o*c-a*s)*d;return i.set(1-f-h,h,f)},containsPoint:function(t,e,n,r){return _i.getBarycoord(t,e,n,r,pi),pi.x>=0&&pi.y>=0&&pi.x+pi.y<=1},getUV:function(t,e,n,r,i,o,a,s){return this.getBarycoord(t,e,n,r,pi),s.set(0,0),s.addScaledVector(i,pi.x),s.addScaledVector(o,pi.y),s.addScaledVector(a,pi.z),s},isFrontFacing:function(t,e,n,r){return di.subVectors(n,e),fi.subVectors(t,e),di.cross(fi).dot(r)<0}}),Object.assign(_i.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return di.subVectors(this.c,this.b),fi.subVectors(this.a,this.b),.5*di.cross(fi).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new ur),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return _i.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new li),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return _i.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,n,r,i){return _i.getUV(t,this.a,this.b,this.c,e,n,r,i)},containsPoint:function(t){return _i.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return _i.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new ur);var n,r,i=this.a,o=this.b,a=this.c;mi.subVectors(o,i),vi.subVectors(a,i),yi.subVectors(t,i);var s=mi.dot(yi),u=vi.dot(yi);if(s<=0&&u<=0)return e.copy(i);bi.subVectors(t,o);var c=mi.dot(bi),l=vi.dot(bi);if(c>=0&&l<=c)return e.copy(o);var d=s*l-c*u;if(d<=0&&s>=0&&c<=0)return n=s/(s-c),e.copy(i).addScaledVector(mi,n);xi.subVectors(t,a);var f=mi.dot(xi),h=vi.dot(xi);if(h>=0&&f<=h)return e.copy(a);var p=f*u-s*h;if(p<=0&&u>=0&&h<=0)return r=u/(u-h),e.copy(i).addScaledVector(vi,r);var m=c*h-f*l;if(m<=0&&l-c>=0&&f-h>=0)return gi.subVectors(a,o),r=(l-c)/(l-c+(f-h)),e.copy(o).addScaledVector(gi,r);var v=1/(m+p+d);return n=p*v,r=d*v,e.copy(i).addScaledVector(mi,n).addScaledVector(vi,r)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var wi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ti={h:0,s:0,l:0},Si={h:0,s:0,l:0};function Mi(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function Ei(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function Ri(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Ii(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function Bi(t,e,n,r,i,o){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new ur,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new Mi,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}Object.assign(Mi.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){if(t=Jn.euclideanModulo(t,1),e=Jn.clamp(e,0,1),n=Jn.clamp(n,0,1),0===e)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=Ei(i,r,t+1/3),this.g=Ei(i,r,t),this.b=Ei(i,r,t-1/3)}return this},setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,u=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(a,s,u)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var c=n[1],l=c.length;if(3===l)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){var e=wi[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Ri(t.r),this.g=Ri(t.g),this.b=Ri(t.b),this},copyLinearToSRGB:function(t){return this.r=Ii(t.r),this.g=Ii(t.g),this.b=Ii(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),u=(s+a)/2;if(s===a)e=0,n=0;else{var c=a-s;switch(n=u<=.5?c/(a+s):c/(2-a-s),a){case r:e=(i-o)/c+(i<o?6:0);break;case i:e=(o-r)/c+2;break;case o:e=(r-i)/c+4}e/=6}return t.h=e,t.s=n,t.l=u,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){return this.getHSL(Ti),Ti.h+=t,Ti.s+=e,Ti.l+=n,this.setHSL(Ti.h,Ti.s,Ti.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(Ti),t.getHSL(Si);var n=Jn.lerp(Ti.h,Si.h,e),r=Jn.lerp(Ti.s,Si.s,e),i=Jn.lerp(Ti.l,Si.l,e);return this.setHSL(n,r,i),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),Mi.NAMES=wi,Object.assign(Bi.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var Ai=0;function Ci(){Object.defineProperty(this,"id",{value:Ai++}),this.uuid=Jn.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=P,this.side=R,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Z,this.blendDst=Q,this.blendEquation=G,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=rt,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Un,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=wn,this.stencilZFail=wn,this.stencilZPass=wn,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Fi(t){Ci.call(this),this.type="MeshBasicMaterial",this.color=new Mi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ut,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}Ci.prototype=Object.assign(Object.create(jn.prototype),{constructor:Ci,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===A;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"===typeof t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==P&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==R&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){var i=r(t.textures),o=r(t.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,n=null;if(null!==e){var r=e.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Ci.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Fi.prototype=Object.create(Ci.prototype),Fi.prototype.constructor=Fi,Fi.prototype.isMeshBasicMaterial=!0,Fi.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var Pi=new ur;function Ni(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=Ln,this.updateRange={offset:0,count:-1},this.version=0}function Oi(t,e,n){Ni.call(this,new Int8Array(t),e,n)}function Ui(t,e,n){Ni.call(this,new Uint8Array(t),e,n)}function Li(t,e,n){Ni.call(this,new Uint8ClampedArray(t),e,n)}function Gi(t,e,n){Ni.call(this,new Int16Array(t),e,n)}function Di(t,e,n){Ni.call(this,new Uint16Array(t),e,n)}function Vi(t,e,n){Ni.call(this,new Int32Array(t),e,n)}function Hi(t,e,n){Ni.call(this,new Uint32Array(t),e,n)}function ki(t,e,n){Ni.call(this,new Float32Array(t),e,n)}function zi(t,e,n){Ni.call(this,new Float64Array(t),e,n)}function Xi(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Wi(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}Object.defineProperty(Ni.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Ni.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new Mi),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new qn),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new ur),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new nr),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},applyMatrix3:function(t){for(var e=0,n=this.count;e<n;e++)Pi.x=this.getX(e),Pi.y=this.getY(e),Pi.z=this.getZ(e),Pi.applyMatrix3(t),this.setXYZ(e,Pi.x,Pi.y,Pi.z);return this},applyMatrix4:function(t){for(var e=0,n=this.count;e<n;e++)Pi.x=this.getX(e),Pi.y=this.getY(e),Pi.z=this.getZ(e),Pi.applyMatrix4(t),this.setXYZ(e,Pi.x,Pi.y,Pi.z);return this},applyNormalMatrix:function(t){for(var e=0,n=this.count;e<n;e++)Pi.x=this.getX(e),Pi.y=this.getY(e),Pi.z=this.getZ(e),Pi.applyNormalMatrix(t),this.setXYZ(e,Pi.x,Pi.y,Pi.z);return this},transformDirection:function(t){for(var e=0,n=this.count;e<n;e++)Pi.x=this.getX(e),Pi.y=this.getY(e),Pi.z=this.getZ(e),Pi.transformDirection(t),this.setXYZ(e,Pi.x,Pi.y,Pi.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Oi.prototype=Object.create(Ni.prototype),Oi.prototype.constructor=Oi,Ui.prototype=Object.create(Ni.prototype),Ui.prototype.constructor=Ui,Li.prototype=Object.create(Ni.prototype),Li.prototype.constructor=Li,Gi.prototype=Object.create(Ni.prototype),Gi.prototype.constructor=Gi,Di.prototype=Object.create(Ni.prototype),Di.prototype.constructor=Di,Vi.prototype=Object.create(Ni.prototype),Vi.prototype.constructor=Vi,Hi.prototype=Object.create(Ni.prototype),Hi.prototype.constructor=Hi,ki.prototype=Object.create(Ni.prototype),ki.prototype.constructor=ki,zi.prototype=Object.create(Ni.prototype),zi.prototype.constructor=zi,Object.assign(Xi.prototype,{computeGroups:function(t){for(var e,n=[],r=void 0,i=t.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:r})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,i=t.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=t.morphTargets,u=s.length;if(u>0){e=[];for(var c=0;c<u;c++)e[c]={name:s[c].name,data:[]};this.morphTargets.position=e}var l,d=t.morphNormals,f=d.length;if(f>0){l=[];for(c=0;c<f;c++)l[c]={name:d[c].name,data:[]};this.morphTargets.normal=l}var h=t.skinIndices,p=t.skinWeights,m=h.length===r.length,v=p.length===r.length;r.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(c=0;c<n.length;c++){var g=n[c];this.vertices.push(r[g.a],r[g.b],r[g.c]);var y=g.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=g.normal;this.normals.push(b,b,b)}var x,_=g.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var w=g.color;this.colors.push(w,w,w)}if(!0===o)void 0!==(x=i[0][c])?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new qn,new qn,new qn));if(!0===a)void 0!==(x=i[1][c])?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new qn,new qn,new qn));for(var T=0;T<u;T++){var S=s[T].vertices;e[T].data.push(S[g.a],S[g.b],S[g.c])}for(T=0;T<f;T++){var M=d[T].vertexNormals[c];l[T].data.push(M.a,M.b,M.c)}m&&this.skinIndices.push(h[g.a],h[g.b],h[g.c]),v&&this.skinWeights.push(p[g.a],p[g.b],p[g.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var ji=1,Zi=new vr,Qi=new Nr,Yi=new ur,Ji=new Yr,qi=new Yr,Ki=new ur;function $i(){Object.defineProperty(this,"id",{value:ji+=2}),this.uuid=Jn.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}$i.prototype=Object.assign(Object.create(jn.prototype),{constructor:$i,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(Wi(t)>65535?Hi:Di)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new Kn).getNormalMatrix(t);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Zi.makeRotationX(t),this.applyMatrix4(Zi),this},rotateY:function(t){return Zi.makeRotationY(t),this.applyMatrix4(Zi),this},rotateZ:function(t){return Zi.makeRotationZ(t),this.applyMatrix4(Zi),this},translate:function(t,e,n){return Zi.makeTranslation(t,e,n),this.applyMatrix4(Zi),this},scale:function(t,e,n){return Zi.makeScale(t,e,n),this.applyMatrix4(Zi),this},lookAt:function(t){return Qi.lookAt(t),Qi.updateMatrix(),this.applyMatrix4(Qi.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Yi).negate(),this.translate(Yi.x,Yi.y,Yi.z),this},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new ki(3*e.vertices.length,3),r=new ki(3*e.colors.length,3);if(this.setAttribute("position",n.copyVector3sArray(e.vertices)),this.setAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new ki(e.lineDistances.length,1);this.setAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new ki(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Xi).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new Ni(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.setAttribute("normal",new Ni(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.setAttribute("color",new Ni(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new Ni(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new Ni(o,2).copyVector2sArray(t.uvs2))}for(var a in this.groups=t.groups,t.morphTargets){for(var s=[],u=t.morphTargets[a],c=0,l=u.length;c<l;c++){var d=u[c],f=new ki(3*d.data.length,3);f.name=d.name,s.push(f.copyVector3sArray(d.data))}this.morphAttributes[a]=s}if(t.skinIndices.length>0){var h=new ki(4*t.skinIndices.length,4);this.setAttribute("skinIndex",h.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var p=new ki(4*t.skinWeights.length,4);this.setAttribute("skinWeight",p.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Yr);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,r=e.length;n<r;n++){var i=e[n];Ji.setFromBufferAttribute(i),this.morphTargetsRelative?(Ki.addVectors(this.boundingBox.min,Ji.min),this.boundingBox.expandByPoint(Ki),Ki.addVectors(this.boundingBox.max,Ji.max),this.boundingBox.expandByPoint(Ki)):(this.boundingBox.expandByPoint(Ji.min),this.boundingBox.expandByPoint(Ji.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Kr);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var n=this.boundingSphere.center;if(Ji.setFromBufferAttribute(t),e)for(var r=0,i=e.length;r<i;r++){var o=e[r];qi.setFromBufferAttribute(o),this.morphTargetsRelative?(Ki.addVectors(Ji.min,qi.min),Ji.expandByPoint(Ki),Ki.addVectors(Ji.max,qi.max),Ji.expandByPoint(Ki)):(Ji.expandByPoint(qi.min),Ji.expandByPoint(qi.max))}Ji.getCenter(n);var a=0;for(r=0,i=t.count;r<i;r++)Ki.fromBufferAttribute(t,r),a=Math.max(a,n.distanceToSquared(Ki));if(e)for(r=0,i=e.length;r<i;r++){o=e[r];for(var s=this.morphTargetsRelative,u=0,c=o.count;u<c;u++)Ki.fromBufferAttribute(o,u),s&&(Yi.fromBufferAttribute(t,u),Ki.add(Yi)),a=Math.max(a,n.distanceToSquared(Ki))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var n=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new Ni(new Float32Array(n.length),3));else for(var r=e.normal.array,i=0,o=r.length;i<o;i++)r[i]=0;var a,s,u,c=e.normal.array,l=new ur,d=new ur,f=new ur,h=new ur,p=new ur;if(t){var m=t.array;for(i=0,o=t.count;i<o;i+=3)a=3*m[i+0],s=3*m[i+1],u=3*m[i+2],l.fromArray(n,a),d.fromArray(n,s),f.fromArray(n,u),h.subVectors(f,d),p.subVectors(l,d),h.cross(p),c[a]+=h.x,c[a+1]+=h.y,c[a+2]+=h.z,c[s]+=h.x,c[s+1]+=h.y,c[s+2]+=h.z,c[u]+=h.x,c[u+1]+=h.y,c[u+2]+=h.z}else for(i=0,o=n.length;i<o;i+=9)l.fromArray(n,i),d.fromArray(n,i+3),f.fromArray(n,i+6),h.subVectors(f,d),p.subVectors(l,d),h.cross(p),c[i]=h.x,c[i+1]=h.y,c[i+2]=h.z,c[i+3]=h.x,c[i+4]=h.y,c[i+5]=h.z,c[i+6]=h.x,c[i+7]=h.y,c[i+8]=h.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,o=t.attributes[r],a=o.array,s=o.itemSize*e,u=Math.min(a.length,i.length-s),c=0,l=s;c<u;c++,l++)i[l]=a[c];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,n=t.count;e<n;e++)Ki.x=t.getX(e),Ki.y=t.getY(e),Ki.z=t.getZ(e),Ki.normalize(),t.setXYZ(e,Ki.x,Ki.y,Ki.z)},toNonIndexed:function(){function t(t,e){for(var n=t.array,r=t.itemSize,i=new n.constructor(e.length*r),o=0,a=0,s=0,u=e.length;s<u;s++){o=e[s]*r;for(var c=0;c<r;c++)i[a++]=n[o++]}return new Ni(i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new $i,n=this.index.array,r=this.attributes;for(var i in r){var o=t(r[i],n);e.setAttribute(i,o)}var a=this.morphAttributes;for(i in a){for(var s=[],u=a[i],c=0,l=u.length;c<l;c++){o=t(u[c],n);s.push(o)}e.morphAttributes[i]=s}e.morphTargetsRelative=this.morphTargetsRelative;for(var d=this.groups,f=(c=0,d.length);c<f;c++){var h=d[c];e.addGroup(h.start,h.count,h.materialIndex)}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;null!==r&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var n in i){var o=(f=i[n]).toJSON();""!==f.name&&(o.name=f.name),t.data.attributes[n]=o}var a={},s=!1;for(var n in this.morphAttributes){for(var u=this.morphAttributes[n],c=[],l=0,d=u.length;l<d;l++){var f;o=(f=u[l]).toJSON();""!==f.name&&(o.name=f.name),c.push(o)}c.length>0&&(a[n]=c,s=!0)}s&&(t.data.morphAttributes=a,t.data.morphTargetsRelative=this.morphTargetsRelative);var h=this.groups;h.length>0&&(t.data.groups=JSON.parse(JSON.stringify(h)));var p=this.boundingSphere;return null!==p&&(t.data.boundingSphere={center:p.center.toArray(),radius:p.radius}),t},clone:function(){return(new $i).copy(this)},copy:function(t){var e,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var o=t.attributes;for(e in o){var a=o[e];this.setAttribute(e,a.clone())}var s=t.morphAttributes;for(e in s){var u=[],c=s[e];for(n=0,r=c.length;n<r;n++)u.push(c[n].clone());this.morphAttributes[e]=u}this.morphTargetsRelative=t.morphTargetsRelative;var l=t.groups;for(n=0,r=l.length;n<r;n++){var d=l[n];this.addGroup(d.start,d.count,d.materialIndex)}var f=t.boundingBox;null!==f&&(this.boundingBox=f.clone());var h=t.boundingSphere;return null!==h&&(this.boundingSphere=h.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var to=new vr,eo=new ai,no=new Kr,ro=new ur,io=new ur,oo=new ur,ao=new ur,so=new ur,uo=new ur,co=new ur,lo=new ur,fo=new ur,ho=new qn,po=new qn,mo=new qn,vo=new ur,go=new ur;function yo(t,e){Nr.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new $i,this.material=void 0!==e?e:new Fi,this.updateMorphTargets()}function bo(t,e,n,r,i,o,a,s){if(null===(e.side===I?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,e.side!==B,s)))return null;go.copy(s),go.applyMatrix4(t.matrixWorld);var u=n.ray.origin.distanceTo(go);return u<n.near||u>n.far?null:{distance:u,point:go.clone(),object:t}}function xo(t,e,n,r,i,o,a,s,u,c,l,d){ro.fromBufferAttribute(i,c),io.fromBufferAttribute(i,l),oo.fromBufferAttribute(i,d);var f=t.morphTargetInfluences;if(e.morphTargets&&o&&f){co.set(0,0,0),lo.set(0,0,0),fo.set(0,0,0);for(var h=0,p=o.length;h<p;h++){var m=f[h],v=o[h];0!==m&&(ao.fromBufferAttribute(v,c),so.fromBufferAttribute(v,l),uo.fromBufferAttribute(v,d),a?(co.addScaledVector(ao,m),lo.addScaledVector(so,m),fo.addScaledVector(uo,m)):(co.addScaledVector(ao.sub(ro),m),lo.addScaledVector(so.sub(io),m),fo.addScaledVector(uo.sub(oo),m)))}ro.add(co),io.add(lo),oo.add(fo)}var g=bo(t,e,n,r,ro,io,oo,vo);if(g){s&&(ho.fromBufferAttribute(s,c),po.fromBufferAttribute(s,l),mo.fromBufferAttribute(s,d),g.uv=_i.getUV(vo,ro,io,oo,ho,po,mo,new qn)),u&&(ho.fromBufferAttribute(u,c),po.fromBufferAttribute(u,l),mo.fromBufferAttribute(u,d),g.uv2=_i.getUV(vo,ro,io,oo,ho,po,mo,new qn));var y=new Bi(c,l,d);_i.getNormal(ro,io,oo,y.normal),g.face=y}return g}yo.prototype=Object.assign(Object.create(Nr.prototype),{constructor:yo,isMesh:!0,copy:function(t){return Nr.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){var n,r=this.geometry,i=this.material,o=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),no.copy(r.boundingSphere),no.applyMatrix4(o),!1!==t.ray.intersectsSphere(no)&&(to.getInverse(o),eo.copy(t.ray).applyMatrix4(to),null===r.boundingBox||!1!==eo.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var a,s,u,c,l,d,f,h,p,m=r.index,v=r.attributes.position,g=r.morphAttributes.position,y=r.morphTargetsRelative,b=r.attributes.uv,x=r.attributes.uv2,_=r.groups,w=r.drawRange;if(null!==m)if(Array.isArray(i))for(c=0,d=_.length;c<d;c++)for(p=i[(h=_[c]).materialIndex],l=Math.max(h.start,w.start),f=Math.min(h.start+h.count,w.start+w.count);l<f;l+=3)a=m.getX(l),s=m.getX(l+1),u=m.getX(l+2),(n=xo(this,p,t,eo,v,g,y,b,x,a,s,u))&&(n.faceIndex=Math.floor(l/3),n.face.materialIndex=h.materialIndex,e.push(n));else for(c=Math.max(0,w.start),d=Math.min(m.count,w.start+w.count);c<d;c+=3)a=m.getX(c),s=m.getX(c+1),u=m.getX(c+2),(n=xo(this,i,t,eo,v,g,y,b,x,a,s,u))&&(n.faceIndex=Math.floor(c/3),e.push(n));else if(void 0!==v)if(Array.isArray(i))for(c=0,d=_.length;c<d;c++)for(p=i[(h=_[c]).materialIndex],l=Math.max(h.start,w.start),f=Math.min(h.start+h.count,w.start+w.count);l<f;l+=3)(n=xo(this,p,t,eo,v,g,y,b,x,a=l,s=l+1,u=l+2))&&(n.faceIndex=Math.floor(l/3),n.face.materialIndex=h.materialIndex,e.push(n));else for(c=Math.max(0,w.start),d=Math.min(v.count,w.start+w.count);c<d;c+=3)(n=xo(this,i,t,eo,v,g,y,b,x,a=c,s=c+1,u=c+2))&&(n.faceIndex=Math.floor(c/3),e.push(n))}else if(r.isGeometry){var T,S,M,E,R=Array.isArray(i),I=r.vertices,B=r.faces,A=r.faceVertexUvs[0];A.length>0&&(E=A);for(var C=0,F=B.length;C<F;C++){var P=B[C],N=R?i[P.materialIndex]:i;if(void 0!==N&&(T=I[P.a],S=I[P.b],M=I[P.c],n=bo(this,N,t,eo,T,S,M,vo))){if(E&&E[C]){var O=E[C];ho.copy(O[0]),po.copy(O[1]),mo.copy(O[2]),n.uv=_i.getUV(vo,T,S,M,ho,po,mo,new qn)}n.face=P,n.faceIndex=C,e.push(n)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var _o=0,wo=new vr,To=new Nr,So=new ur;function Mo(){Object.defineProperty(this,"id",{value:_o+=2}),this.uuid=Jn.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Mo.prototype=Object.assign(Object.create(jn.prototype),{constructor:Mo,isGeometry:!0,applyMatrix4:function(t){for(var e=(new Kn).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(t)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(e).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return wo.makeRotationX(t),this.applyMatrix4(wo),this},rotateY:function(t){return wo.makeRotationY(t),this.applyMatrix4(wo),this},rotateZ:function(t){return wo.makeRotationZ(t),this.applyMatrix4(wo),this},translate:function(t,e,n){return wo.makeTranslation(t,e,n),this.applyMatrix4(wo),this},scale:function(t,e,n){return wo.makeScale(t,e,n),this.applyMatrix4(wo),this},lookAt:function(t){return To.lookAt(t),To.updateMatrix(),this.applyMatrix4(To.matrix),this},fromBufferGeometry:function(t){var e=this,n=null!==t.index?t.index.array:void 0,r=t.attributes;if(void 0===r.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var i=r.position.array,o=void 0!==r.normal?r.normal.array:void 0,a=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,u=void 0!==r.uv2?r.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var c=0;c<i.length;c+=3)e.vertices.push((new ur).fromArray(i,c)),void 0!==a&&e.colors.push((new Mi).fromArray(a,c));function l(t,n,r,i){var c=void 0===a?[]:[e.colors[t].clone(),e.colors[n].clone(),e.colors[r].clone()],l=new Bi(t,n,r,void 0===o?[]:[(new ur).fromArray(o,3*t),(new ur).fromArray(o,3*n),(new ur).fromArray(o,3*r)],c,i);e.faces.push(l),void 0!==s&&e.faceVertexUvs[0].push([(new qn).fromArray(s,2*t),(new qn).fromArray(s,2*n),(new qn).fromArray(s,2*r)]),void 0!==u&&e.faceVertexUvs[1].push([(new qn).fromArray(u,2*t),(new qn).fromArray(u,2*n),(new qn).fromArray(u,2*r)])}var d=t.groups;if(d.length>0)for(c=0;c<d.length;c++)for(var f=d[c],h=f.start,p=h,m=h+f.count;p<m;p+=3)void 0!==n?l(n[p],n[p+1],n[p+2],f.materialIndex):l(p,p+1,p+2,f.materialIndex);else if(void 0!==n)for(c=0;c<n.length;c+=3)l(n[c],n[c+1],n[c+2]);else for(c=0;c<i.length/3;c+=3)l(c,c+1,c+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(So).negate(),this.translate(So.x,So.y,So.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,r=new vr;return r.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){for(var t=new ur,e=new ur,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){var e,n,r,i,o,a;for(void 0===t&&(t=!0),a=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)a[e]=new ur;if(t){var s,u,c,l=new ur,d=new ur;for(r=0,i=this.faces.length;r<i;r++)o=this.faces[r],s=this.vertices[o.a],u=this.vertices[o.b],c=this.vertices[o.c],l.subVectors(c,u),d.subVectors(s,u),l.cross(d),a[o.a].add(l),a[o.b].add(l),a[o.c].add(l)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)a[(o=this.faces[r]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,n=this.vertices.length;e<n;e++)a[e].normalize();for(r=0,i=this.faces.length;r<i;r++){var f=(o=this.faces[r]).vertexNormals;3===f.length?(f[0].copy(a[o.a]),f[1].copy(a[o.b]),f[2].copy(a[o.c])):(f[0]=a[o.a].clone(),f[1]=a[o.b].clone(),f[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var r=(n=this.faces[t]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var o=new Mo;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)u=new ur,c={a:new ur,b:new ur,c:new ur},a.push(u),s.push(c)}var u,c,l=this.morphNormals[t];for(o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],u=l.faceNormals[n],c=l.vertexNormals[n],u.copy(i.normal),c.a.copy(i.vertexNormals[0]),c.b.copy(i.vertexNormals[1]),c.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Yr),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Kr),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,u=t.faces,c=this.colors,l=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new Kn).getNormalMatrix(e));for(var d=0,f=a.length;d<f;d++){var h=a[d].clone();void 0!==e&&h.applyMatrix4(e),o.push(h)}for(d=0,f=l.length;d<f;d++)c.push(l[d].clone());for(d=0,f=u.length;d<f;d++){var p,m,v,g=u[d],y=g.vertexNormals,b=g.vertexColors;(p=new Bi(g.a+i,g.b+i,g.c+i)).normal.copy(g.normal),void 0!==r&&p.normal.applyMatrix3(r).normalize();for(var x=0,_=y.length;x<_;x++)m=y[x].clone(),void 0!==r&&m.applyMatrix3(r).normalize(),p.vertexNormals.push(m);p.color.copy(g.color);for(x=0,_=b.length;x<_;x++)v=b[x],p.vertexColors.push(v.clone());p.materialIndex=g.materialIndex+n,s.push(p)}for(d=0,f=t.faceVertexUvs.length;d<f;d++){var w=t.faceVertexUvs[d];void 0===this.faceVertexUvs[d]&&(this.faceVertexUvs[d]=[]);for(x=0,_=w.length;x<_;x++){for(var T=w[x],S=[],M=0,E=T.length;M<E;M++)S.push(T[M].clone());this.faceVertexUvs[d].push(S)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,n,r,i,o,a,s,u={},c=[],l=[],d=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)t=this.vertices[n],void 0===u[e=Math.round(t.x*d)+"_"+Math.round(t.y*d)+"_"+Math.round(t.z*d)]?(u[e]=n,c.push(this.vertices[n]),l[n]=c.length-1):l[n]=l[u[e]];var f=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=l[i.a],i.b=l[i.b],i.c=l[i.c],o=[i.a,i.b,i.c];for(var h=0;h<3;h++)if(o[h]===o[(h+1)%3]){f.push(n);break}}for(n=f.length-1;n>=0;n--){var p=f[n];for(this.faces.splice(p,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(p,1)}var m=this.vertices.length-c.length;return this.vertices=c,m},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var r=t[e];this.vertices.push(new ur(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort((function(t,e){return t.materialIndex-e.materialIndex}));var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===e&&(r=[]),a&&a.length===e&&(i=[]);for(n=0;n<e;n++){var s=t[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}for(var r=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];r.push(o.x,o.y,o.z)}var a=[],s=[],u={},c=[],l={},d=[],f={};for(i=0;i<this.faces.length;i++){var h=this.faces[i],p=void 0!==this.faceVertexUvs[0][i],m=h.normal.length()>0,v=h.vertexNormals.length>0,g=1!==h.color.r||1!==h.color.g||1!==h.color.b,y=h.vertexColors.length>0,b=0;if(b=T(b,0,0),b=T(b,1,!0),b=T(b,2,!1),b=T(b,3,p),b=T(b,4,m),b=T(b,5,v),b=T(b,6,g),b=T(b,7,y),a.push(b),a.push(h.a,h.b,h.c),a.push(h.materialIndex),p){var x=this.faceVertexUvs[0][i];a.push(E(x[0]),E(x[1]),E(x[2]))}if(m&&a.push(S(h.normal)),v){var _=h.vertexNormals;a.push(S(_[0]),S(_[1]),S(_[2]))}if(g&&a.push(M(h.color)),y){var w=h.vertexColors;a.push(M(w[0]),M(w[1]),M(w[2]))}}function T(t,e,n){return n?t|1<<e:t&~(1<<e)}function S(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==u[e]||(u[e]=s.length/3,s.push(t.x,t.y,t.z)),u[e]}function M(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==l[e]||(l[e]=c.length,c.push(t.getHex())),l[e]}function E(t){var e=t.x.toString()+t.y.toString();return void 0!==f[e]||(f[e]=d.length/2,d.push(t.x,t.y)),f[e]}return t.data={},t.data.vertices=r,t.data.normals=s,c.length>0&&(t.data.colors=c),d.length>0&&(t.data.uvs=[d]),t.data.faces=a,t},clone:function(){return(new Mo).copy(this)},copy:function(t){var e,n,r,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var u=t.colors;for(e=0,n=u.length;e<n;e++)this.colors.push(u[e].clone());var c=t.faces;for(e=0,n=c.length;e<n;e++)this.faces.push(c[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var l=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,i=l.length;r<i;r++){var d=l[r],f=[];for(o=0,a=d.length;o<a;o++){var h=d[o];f.push(h.clone())}this.faceVertexUvs[e].push(f)}}var p=t.morphTargets;for(e=0,n=p.length;e<n;e++){var m={};if(m.name=p[e].name,void 0!==p[e].vertices)for(m.vertices=[],r=0,i=p[e].vertices.length;r<i;r++)m.vertices.push(p[e].vertices[r].clone());if(void 0!==p[e].normals)for(m.normals=[],r=0,i=p[e].normals.length;r<i;r++)m.normals.push(p[e].normals[r].clone());this.morphTargets.push(m)}var v=t.morphNormals;for(e=0,n=v.length;e<n;e++){var g={};if(void 0!==v[e].vertexNormals)for(g.vertexNormals=[],r=0,i=v[e].vertexNormals.length;r<i;r++){var y=v[e].vertexNormals[r],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),g.vertexNormals.push(b)}if(void 0!==v[e].faceNormals)for(g.faceNormals=[],r=0,i=v[e].faceNormals.length;r<i;r++)g.faceNormals.push(v[e].faceNormals[r].clone());this.morphNormals.push(g)}var x=t.skinWeights;for(e=0,n=x.length;e<n;e++)this.skinWeights.push(x[e].clone());var _=t.skinIndices;for(e=0,n=_.length;e<n;e++)this.skinIndices.push(_[e].clone());var w=t.lineDistances;for(e=0,n=w.length;e<n;e++)this.lineDistances.push(w[e]);var T=t.boundingBox;null!==T&&(this.boundingBox=T.clone());var S=t.boundingSphere;return null!==S&&(this.boundingSphere=S.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Eo=function(t){s(n,t);var e=h(n);function n(t,r,i,a,s,u){var c;return o(this,n),(c=e.call(this)).type="BoxGeometry",c.parameters={width:t,height:r,depth:i,widthSegments:a,heightSegments:s,depthSegments:u},c.fromBufferGeometry(new Ro(t,r,i,a,s,u)),c.mergeVertices(),c}return n}(Mo),Ro=function(t){s(n,t);var e=h(n);function n(t,r,a,s,u,c){var l;o(this,n),(l=e.call(this)).type="BoxBufferGeometry",l.parameters={width:t,height:r,depth:a,widthSegments:s,heightSegments:u,depthSegments:c};var d=i(l);t=t||1,r=r||1,a=a||1,s=Math.floor(s)||1,u=Math.floor(u)||1,c=Math.floor(c)||1;var f=[],h=[],p=[],m=[],v=0,g=0;function y(t,e,n,r,i,o,a,s,u,c,l){var y,b,x=o/u,_=a/c,w=o/2,T=a/2,S=s/2,M=u+1,E=c+1,R=0,I=0,B=new ur;for(b=0;b<E;b++){var A=b*_-T;for(y=0;y<M;y++){var C=y*x-w;B[t]=C*r,B[e]=A*i,B[n]=S,h.push(B.x,B.y,B.z),B[t]=0,B[e]=0,B[n]=s>0?1:-1,p.push(B.x,B.y,B.z),m.push(y/u),m.push(1-b/c),R+=1}}for(b=0;b<c;b++)for(y=0;y<u;y++){var F=v+y+M*b,P=v+y+M*(b+1),N=v+(y+1)+M*(b+1),O=v+(y+1)+M*b;f.push(F,P,O),f.push(P,N,O),I+=6}d.addGroup(g,I,l),g+=I,v+=R}return y("z","y","x",-1,-1,a,r,t,c,u,0),y("z","y","x",1,-1,a,r,-t,c,u,1),y("x","z","y",1,1,t,a,r,s,c,2),y("x","z","y",1,-1,t,a,-r,s,c,3),y("x","y","z",1,-1,t,r,a,s,u,4),y("x","y","z",-1,-1,t,r,-a,s,u,5),l.setIndex(f),l.setAttribute("position",new ki(h,3)),l.setAttribute("normal",new ki(p,3)),l.setAttribute("uv",new ki(m,2)),l}return n}($i);function Io(t){var e={};for(var n in t)for(var r in e[n]={},t[n]){var i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}return e}function Bo(t){for(var e={},n=0;n<t.length;n++){var r=Io(t[n]);for(var i in r)e[i]=r[i]}return e}var Ao={clone:Io,merge:Bo};function Co(t){Ci.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Fo(){Nr.call(this),this.type="Camera",this.matrixWorldInverse=new vr,this.projectionMatrix=new vr,this.projectionMatrixInverse=new vr}function Po(t,e,n,r){Fo.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Co.prototype=Object.create(Ci.prototype),Co.prototype.constructor=Co,Co.prototype.isShaderMaterial=!0,Co.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Io(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},Co.prototype.toJSON=function(t){var e=Ci.prototype.toJSON.call(this,t);for(var n in e.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?e.uniforms[n]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[n]={type:"m4",value:r.toArray()}:e.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;var i={};for(var o in this.extensions)!0===this.extensions[o]&&(i[o]=!0);return Object.keys(i).length>0&&(e.extensions=i),e},Fo.prototype=Object.assign(Object.create(Nr.prototype),{constructor:Fo,isCamera:!0,copy:function(t,e){return Nr.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new ur),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){Nr.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){Nr.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Po.prototype=Object.assign(Object.create(Fo.prototype),{constructor:Po,isPerspectiveCamera:!0,copy:function(t,e){return Fo.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*Jn.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*Jn.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Jn.RAD2DEG*Math.atan(Math.tan(.5*Jn.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*Jn.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,e-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var u=this.filmOffset;0!==u&&(i+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=Nr.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});function No(t,e,n,r){Nr.call(this),this.type="CubeCamera";var i=new Po(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new ur(1,0,0)),this.add(i);var o=new Po(90,1,t,e);o.up.set(0,-1,0),o.lookAt(new ur(-1,0,0)),this.add(o);var a=new Po(90,1,t,e);a.up.set(0,0,1),a.lookAt(new ur(0,1,0)),this.add(a);var s=new Po(90,1,t,e);s.up.set(0,0,-1),s.lookAt(new ur(0,-1,0)),this.add(s);var u=new Po(90,1,t,e);u.up.set(0,-1,0),u.lookAt(new ur(0,0,1)),this.add(u);var c=new Po(90,1,t,e);c.up.set(0,-1,0),c.lookAt(new ur(0,0,-1)),this.add(c),r=r||{format:qt,magFilter:Pt,minFilter:Pt},this.renderTarget=new Oo(n,r),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=t.getRenderTarget(),r=this.renderTarget,l=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,t.setRenderTarget(r,0),t.render(e,i),t.setRenderTarget(r,1),t.render(e,o),t.setRenderTarget(r,2),t.render(e,a),t.setRenderTarget(r,3),t.render(e,s),t.setRenderTarget(r,4),t.render(e,u),r.texture.generateMipmaps=l,t.setRenderTarget(r,5),t.render(e,c),t.setRenderTarget(n)},this.clear=function(t,e,n,r){for(var i=t.getRenderTarget(),o=this.renderTarget,a=0;a<6;a++)t.setRenderTarget(o,a),t.clear(e,n,r);t.setRenderTarget(i)}}function Oo(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),rr.call(this,t,t,e)}function Uo(t,e,n,r,i,o,a,s,u,c,l,d){er.call(this,null,o,a,s,u,c,r,i,l,d),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==u?u:It,this.minFilter=void 0!==c?c:It,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}No.prototype=Object.create(Nr.prototype),No.prototype.constructor=No,Oo.prototype=Object.create(rr.prototype),Oo.prototype.constructor=Oo,Oo.prototype.isWebGLCubeRenderTarget=!0,Oo.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;var n=new Or,r={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},i=new Co({type:"CubemapFromEquirect",uniforms:Io(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:I,blending:F});i.uniforms.tEquirect.value=e;var o=new yo(new Ro(5,5,5),i);n.add(o);var a=new No(1,10,1);return a.renderTarget=this,a.renderTarget.texture.name="CubeCameraTexture",a.update(t,n),o.geometry.dispose(),o.material.dispose(),this},Uo.prototype=Object.create(er.prototype),Uo.prototype.constructor=Uo,Uo.prototype.isDataTexture=!0;var Lo=new Kr,Go=new ur;function Do(t,e,n,r,i,o){this.planes=[void 0!==t?t:new li,void 0!==e?e:new li,void 0!==n?n:new li,void 0!==r?r:new li,void 0!==i?i:new li,void 0!==o?o:new li]}Object.assign(Do.prototype,{set:function(t,e,n,r,i,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromProjectionMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],d=n[8],f=n[9],h=n[10],p=n[11],m=n[12],v=n[13],g=n[14],y=n[15];return e[0].setComponents(a-r,l-s,p-d,y-m).normalize(),e[1].setComponents(a+r,l+s,p+d,y+m).normalize(),e[2].setComponents(a+i,l+u,p+f,y+v).normalize(),e[3].setComponents(a-i,l-u,p-f,y-v).normalize(),e[4].setComponents(a-o,l-c,p-h,y-g).normalize(),e[5].setComponents(a+o,l+c,p+h,y+g).normalize(),this},intersectsObject:function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Lo.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Lo)},intersectsSprite:function(t){return Lo.center.set(0,0,0),Lo.radius=.7071067811865476,Lo.applyMatrix4(t.matrixWorld),this.intersectsSphere(Lo)},intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:function(t){for(var e=this.planes,n=0;n<6;n++){var r=e[n];if(Go.x=r.normal.x>0?t.max.x:t.min.x,Go.y=r.normal.y>0?t.max.y:t.min.y,Go.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(Go)<0)return!1}return!0},containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}});var Vo={common:{diffuse:{value:new Mi(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Kn},uv2Transform:{value:new Kn},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new qn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Mi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Mi(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Kn}},sprite:{diffuse:{value:new Mi(15658734)},opacity:{value:1},center:{value:new qn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Kn}}};function Ho(){var t=null,e=!1,n=null;function r(i,o){!1!==e&&(n(i,o),t.requestAnimationFrame(r))}return{start:function(){!0!==e&&null!==n&&(t.requestAnimationFrame(r),e=!0)},stop:function(){e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function ko(t,e){var n=e.isWebGL2,r=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),r.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var n=r.get(e);n&&(t.deleteBuffer(n.buffer),r.delete(e))},update:function(e,i){e.isInterleavedBufferAttribute&&(e=e.data);var o=r.get(e);void 0===o?r.set(e,function(e,n){var r=e.array,i=e.usage,o=t.createBuffer();t.bindBuffer(n,o),t.bufferData(n,r,i),e.onUploadCallback();var a=5126;return r instanceof Float32Array?a=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?a=5123:r instanceof Int16Array?a=5122:r instanceof Uint32Array?a=5125:r instanceof Int32Array?a=5124:r instanceof Int8Array?a=5120:r instanceof Uint8Array&&(a=5121),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,i)):o.version<e.version&&(!function(e,r,i){var o=r.array,a=r.updateRange;t.bindBuffer(i,e),-1===a.count?t.bufferSubData(i,0,o):(n?t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}(o.buffer,e,i),o.version=e.version)}}}function zo(t,e,n,r){Mo.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new Xo(t,e,n,r)),this.mergeVertices()}function Xo(t,e,n,r){$i.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i,o,a=(t=t||1)/2,s=(e=e||1)/2,u=Math.floor(n)||1,c=Math.floor(r)||1,l=u+1,d=c+1,f=t/u,h=e/c,p=[],m=[],v=[],g=[];for(o=0;o<d;o++){var y=o*h-s;for(i=0;i<l;i++){var b=i*f-a;m.push(b,-y,0),v.push(0,0,1),g.push(i/u),g.push(1-o/c)}}for(o=0;o<c;o++)for(i=0;i<u;i++){var x=i+l*o,_=i+l*(o+1),w=i+1+l*(o+1),T=i+1+l*o;p.push(x,_,T),p.push(_,w,T)}this.setIndex(p),this.setAttribute("position",new ki(m,3)),this.setAttribute("normal",new ki(v,3)),this.setAttribute("uv",new ki(g,2))}zo.prototype=Object.create(Mo.prototype),zo.prototype.constructor=zo,Xo.prototype=Object.create($i.prototype),Xo.prototype.constructor=Xo;var Wo={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},jo={basic:{uniforms:Bo([Vo.common,Vo.specularmap,Vo.envmap,Vo.aomap,Vo.lightmap,Vo.fog]),vertexShader:Wo.meshbasic_vert,fragmentShader:Wo.meshbasic_frag},lambert:{uniforms:Bo([Vo.common,Vo.specularmap,Vo.envmap,Vo.aomap,Vo.lightmap,Vo.emissivemap,Vo.fog,Vo.lights,{emissive:{value:new Mi(0)}}]),vertexShader:Wo.meshlambert_vert,fragmentShader:Wo.meshlambert_frag},phong:{uniforms:Bo([Vo.common,Vo.specularmap,Vo.envmap,Vo.aomap,Vo.lightmap,Vo.emissivemap,Vo.bumpmap,Vo.normalmap,Vo.displacementmap,Vo.fog,Vo.lights,{emissive:{value:new Mi(0)},specular:{value:new Mi(1118481)},shininess:{value:30}}]),vertexShader:Wo.meshphong_vert,fragmentShader:Wo.meshphong_frag},standard:{uniforms:Bo([Vo.common,Vo.envmap,Vo.aomap,Vo.lightmap,Vo.emissivemap,Vo.bumpmap,Vo.normalmap,Vo.displacementmap,Vo.roughnessmap,Vo.metalnessmap,Vo.fog,Vo.lights,{emissive:{value:new Mi(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Wo.meshphysical_vert,fragmentShader:Wo.meshphysical_frag},toon:{uniforms:Bo([Vo.common,Vo.specularmap,Vo.aomap,Vo.lightmap,Vo.emissivemap,Vo.bumpmap,Vo.normalmap,Vo.displacementmap,Vo.gradientmap,Vo.fog,Vo.lights,{emissive:{value:new Mi(0)},specular:{value:new Mi(1118481)},shininess:{value:30}}]),vertexShader:Wo.meshtoon_vert,fragmentShader:Wo.meshtoon_frag},matcap:{uniforms:Bo([Vo.common,Vo.bumpmap,Vo.normalmap,Vo.displacementmap,Vo.fog,{matcap:{value:null}}]),vertexShader:Wo.meshmatcap_vert,fragmentShader:Wo.meshmatcap_frag},points:{uniforms:Bo([Vo.points,Vo.fog]),vertexShader:Wo.points_vert,fragmentShader:Wo.points_frag},dashed:{uniforms:Bo([Vo.common,Vo.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Wo.linedashed_vert,fragmentShader:Wo.linedashed_frag},depth:{uniforms:Bo([Vo.common,Vo.displacementmap]),vertexShader:Wo.depth_vert,fragmentShader:Wo.depth_frag},normal:{uniforms:Bo([Vo.common,Vo.bumpmap,Vo.normalmap,Vo.displacementmap,{opacity:{value:1}}]),vertexShader:Wo.normal_vert,fragmentShader:Wo.normal_frag},sprite:{uniforms:Bo([Vo.sprite,Vo.fog]),vertexShader:Wo.sprite_vert,fragmentShader:Wo.sprite_frag},background:{uniforms:{uvTransform:{value:new Kn},t2D:{value:null}},vertexShader:Wo.background_vert,fragmentShader:Wo.background_frag},cube:{uniforms:Bo([Vo.envmap,{opacity:{value:1}}]),vertexShader:Wo.cube_vert,fragmentShader:Wo.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Wo.equirect_vert,fragmentShader:Wo.equirect_frag},distanceRGBA:{uniforms:Bo([Vo.common,Vo.displacementmap,{referencePosition:{value:new ur},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Wo.distanceRGBA_vert,fragmentShader:Wo.distanceRGBA_frag},shadow:{uniforms:Bo([Vo.lights,Vo.fog,{color:{value:new Mi(0)},opacity:{value:1}}]),vertexShader:Wo.shadow_vert,fragmentShader:Wo.shadow_frag}};function Zo(t,e,n,r){var i,o,a=new Mi(0),s=0,u=null,c=0,l=null;function d(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}return{getClearColor:function(){return a},setClearColor:function(t,e){a.set(t),d(a,s=void 0!==e?e:1)},getClearAlpha:function(){return s},setClearAlpha:function(t){d(a,s=t)},render:function(e,r,f,h){var p=r.background,m=t.xr,v=m.getSession&&m.getSession();if(v&&"additive"===v.environmentBlendMode&&(p=null),null===p?d(a,s):p&&p.isColor&&(d(p,1),h=!0),(t.autoClear||h)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLCubeRenderTarget||p.mapping===Tt)){void 0===o&&((o=new yo(new Ro(1,1,1),new Co({type:"BackgroundCubeMaterial",uniforms:Io(jo.cube.uniforms),vertexShader:jo.cube.vertexShader,fragmentShader:jo.cube.fragmentShader,side:I,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(o));var g=p.isWebGLCubeRenderTarget?p.texture:p;o.material.uniforms.envMap.value=g,o.material.uniforms.flipEnvMap.value=g.isCubeTexture?-1:1,u===p&&c===g.version&&l===t.toneMapping||(o.material.needsUpdate=!0,u=p,c=g.version,l=t.toneMapping),e.unshift(o,o.geometry,o.material,0,0,null)}else p&&p.isTexture&&(void 0===i&&((i=new yo(new Xo(2,2),new Co({type:"BackgroundMaterial",uniforms:Io(jo.background.uniforms),vertexShader:jo.background.vertexShader,fragmentShader:jo.background.fragmentShader,side:R,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(i)),i.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),i.material.uniforms.uvTransform.value.copy(p.matrix),u===p&&c===p.version&&l===t.toneMapping||(i.material.needsUpdate=!0,u=p,c=p.version,l=t.toneMapping),e.unshift(i,i.geometry,i.material,0,0,null))}}}function Qo(t,e,n,r){var i,o=r.isWebGL2;this.setMode=function(t){i=t},this.render=function(e,r){t.drawArrays(i,e,r),n.update(r,i)},this.renderInstances=function(r,a,s,u){if(0!==u){var c,l;if(o)c=t,l="drawArraysInstanced";else if(l="drawArraysInstancedANGLE",null===(c=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[l](i,a,s,u),n.update(s,i,u)}}}function Yo(t,e,n){var r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o="undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!==typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var u=!0===n.logarithmicDepthBuffer,c=t.getParameter(34930),l=t.getParameter(35660),d=t.getParameter(3379),f=t.getParameter(34076),h=t.getParameter(34921),p=t.getParameter(36347),m=t.getParameter(36348),v=t.getParameter(36349),g=l>0,y=o||!!e.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:l,maxTextureSize:d,maxCubemapSize:f,maxAttributes:h,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:g&&y,maxSamples:o?t.getParameter(36183):0}}function Jo(){var t=this,e=null,n=0,r=!1,i=!1,o=new li,a=new Kn,s={value:null,needsUpdate:!1};function u(){s.value!==e&&(s.value=e,s.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function c(e,n,r,i){var u=null!==e?e.length:0,c=null;if(0!==u){if(c=s.value,!0!==i||null===c){var l=r+4*u,d=n.matrixWorldInverse;a.getNormalMatrix(d),(null===c||c.length<l)&&(c=new Float32Array(l));for(var f=0,h=r;f!==u;++f,h+=4)o.copy(e[f]).applyMatrix4(d,a),o.normal.toArray(c,h),c[h+3]=o.constant}s.value=c,s.needsUpdate=!0}return t.numPlanes=u,t.numIntersection=0,c}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,o){var a=0!==t.length||i||0!==n||r;return r=i,e=c(t,o,0),n=t.length,a},this.beginShadows=function(){i=!0,c(null)},this.endShadows=function(){i=!1,u()},this.setState=function(t,o,a,l,d,f){if(!r||null===t||0===t.length||i&&!a)i?c(null):u();else{var h=i?0:n,p=4*h,m=d.clippingState||null;s.value=m,m=c(t,l,p,f);for(var v=0;v!==p;++v)m[v]=e[v];d.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=h}}}function qo(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=r,r}}}function Ko(t,e,n){var r=new WeakMap,i=new WeakMap;function o(t){var a=t.target,s=r.get(a);for(var u in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[u]);a.removeEventListener("dispose",o),r.delete(a);var c=i.get(s);c&&(e.remove(c),i.delete(s)),n.memory.geometries--}function a(t){var n=[],r=t.index,o=t.attributes.position,a=0;if(null!==r){var s=r.array;a=r.version;for(var u=0,c=s.length;u<c;u+=3){var l=s[u+0],d=s[u+1],f=s[u+2];n.push(l,d,d,f,f,l)}}else{s=o.array;a=o.version;for(u=0,c=s.length/3-1;u<c;u+=3){l=u+0,d=u+1,f=u+2;n.push(l,d,d,f,f,l)}}var h=new(Wi(n)>65535?Hi:Di)(n,1);h.version=a,e.update(h,34963);var p=i.get(t);p&&e.remove(p),i.set(t,h)}return{get:function(t,e){var i=r.get(e);return i||(e.addEventListener("dispose",o),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new $i).setFromObject(t)),i=e._bufferGeometry),r.set(e,i),n.memory.geometries++,i)},update:function(t){var n=t.index,r=t.attributes;for(var i in null!==n&&e.update(n,34963),r)e.update(r[i],34962);var o=t.morphAttributes;for(var i in o)for(var a=o[i],s=0,u=a.length;s<u;s++)e.update(a[s],34962)},getWireframeAttribute:function(t){var e=i.get(t);if(e){var n=t.index;null!==n&&e.version<n.version&&a(t)}else a(t);return i.get(t)}}}function $o(t,e,n,r){var i,o,a,s=r.isWebGL2;this.setMode=function(t){i=t},this.setIndex=function(t){o=t.type,a=t.bytesPerElement},this.render=function(e,r){t.drawElements(i,r,o,e*a),n.update(r,i)},this.renderInstances=function(r,u,c,l){if(0!==l){var d,f;if(s)d=t,f="drawElementsInstanced";else if(f="drawElementsInstancedANGLE",null===(d=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[f](i,c,o,u*a,l),n.update(c,i,l)}}}function ta(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,r){switch(r=r||1,e.calls++,n){case 4:e.triangles+=r*(t/3);break;case 1:e.lines+=r*(t/2);break;case 3:e.lines+=r*(t-1);break;case 2:e.lines+=r*t;break;case 0:e.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function ea(t,e){return Math.abs(e[1])-Math.abs(t[1])}function na(t){var e={},n=new Float32Array(8);return{update:function(r,i,o,a){var s=r.morphTargetInfluences,u=void 0===s?0:s.length,c=e[i.id];if(void 0===c){c=[];for(var l=0;l<u;l++)c[l]=[l,0];e[i.id]=c}var d=o.morphTargets&&i.morphAttributes.position,f=o.morphNormals&&i.morphAttributes.normal;for(l=0;l<u;l++){0!==(p=c[l])[1]&&(d&&i.deleteAttribute("morphTarget"+l),f&&i.deleteAttribute("morphNormal"+l))}for(l=0;l<u;l++){(p=c[l])[0]=l,p[1]=s[l]}c.sort(ea);var h=0;for(l=0;l<8;l++){var p;if(p=c[l]){var m=p[0],v=p[1];if(v){d&&i.setAttribute("morphTarget"+l,d[m]),f&&i.setAttribute("morphNormal"+l,f[m]),n[l]=v,h+=v;continue}}n[l]=0}var g=i.morphTargetsRelative?1:1-h;a.getUniforms().setValue(t,"morphTargetBaseInfluence",g),a.getUniforms().setValue(t,"morphTargetInfluences",n)}}}function ra(t,e,n,r){var i=new WeakMap;return{update:function(t){var o=r.render.frame,a=t.geometry,s=e.get(t,a);return i.get(s)!==o&&(a.isGeometry&&s.updateFromObject(t),e.update(s),i.set(s,o)),t.isInstancedMesh&&n.update(t.instanceMatrix,34962),s},dispose:function(){i=new WeakMap}}}function ia(t,e,n,r,i,o,a,s,u,c){t=void 0!==t?t:[],e=void 0!==e?e:yt,a=void 0!==a?a:qt,er.call(this,t,e,n,r,i,o,a,s,u,c),this.flipY=!1}function oa(t,e,n,r){er.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=It,this.minFilter=It,this.wrapR=Et,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function aa(t,e,n,r){er.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=It,this.minFilter=It,this.wrapR=Et,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}jo.physical={uniforms:Bo([jo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new qn(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Mi(0)},transparency:{value:0}}]),vertexShader:Wo.meshphysical_vert,fragmentShader:Wo.meshphysical_frag},ia.prototype=Object.create(er.prototype),ia.prototype.constructor=ia,ia.prototype.isCubeTexture=!0,Object.defineProperty(ia.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),oa.prototype=Object.create(er.prototype),oa.prototype.constructor=oa,oa.prototype.isDataTexture2DArray=!0,aa.prototype=Object.create(er.prototype),aa.prototype.constructor=aa,aa.prototype.isDataTexture3D=!0;var sa=new er,ua=new oa,ca=new aa,la=new ia,da=[],fa=[],ha=new Float32Array(16),pa=new Float32Array(9),ma=new Float32Array(4);function va(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,o=da[i];if(void 0===o&&(o=new Float32Array(i),da[i]=o),0!==e){r.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=n,t[a].toArray(o,s)}return o}function ga(t,e){if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function ya(t,e){for(var n=0,r=e.length;n<r;n++)t[n]=e[n]}function ba(t,e){var n=fa[e];void 0===n&&(n=new Int32Array(e),fa[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function xa(t,e){var n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function _a(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ga(n,e))return;t.uniform2fv(this.addr,e),ya(n,e)}}function wa(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(ga(n,e))return;t.uniform3fv(this.addr,e),ya(n,e)}}function Ta(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ga(n,e))return;t.uniform4fv(this.addr,e),ya(n,e)}}function Sa(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(ga(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),ya(n,e)}else{if(ga(n,r))return;ma.set(r),t.uniformMatrix2fv(this.addr,!1,ma),ya(n,r)}}function Ma(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(ga(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),ya(n,e)}else{if(ga(n,r))return;pa.set(r),t.uniformMatrix3fv(this.addr,!1,pa),ya(n,r)}}function Ea(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(ga(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),ya(n,e)}else{if(ga(n,r))return;ha.set(r),t.uniformMatrix4fv(this.addr,!1,ha),ya(n,r)}}function Ra(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(e||sa,i)}function Ia(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||ua,i)}function Ba(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||ca,i)}function Aa(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(e||la,i)}function Ca(t,e){var n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Fa(t,e){var n=this.cache;ga(n,e)||(t.uniform2iv(this.addr,e),ya(n,e))}function Pa(t,e){var n=this.cache;ga(n,e)||(t.uniform3iv(this.addr,e),ya(n,e))}function Na(t,e){var n=this.cache;ga(n,e)||(t.uniform4iv(this.addr,e),ya(n,e))}function Oa(t,e){var n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Ua(t,e){t.uniform1fv(this.addr,e)}function La(t,e){t.uniform1iv(this.addr,e)}function Ga(t,e){t.uniform2iv(this.addr,e)}function Da(t,e){t.uniform3iv(this.addr,e)}function Va(t,e){t.uniform4iv(this.addr,e)}function Ha(t,e){var n=va(e,this.size,2);t.uniform2fv(this.addr,n)}function ka(t,e){var n=va(e,this.size,3);t.uniform3fv(this.addr,n)}function za(t,e){var n=va(e,this.size,4);t.uniform4fv(this.addr,n)}function Xa(t,e){var n=va(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Wa(t,e){var n=va(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function ja(t,e){var n=va(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Za(t,e,n){var r=e.length,i=ba(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTexture2D(e[o]||sa,i[o])}function Qa(t,e,n){var r=e.length,i=ba(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTextureCube(e[o]||la,i[o])}function Ya(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return xa;case 35664:return _a;case 35665:return wa;case 35666:return Ta;case 35674:return Sa;case 35675:return Ma;case 35676:return Ea;case 5124:case 35670:return Ca;case 35667:case 35671:return Fa;case 35668:case 35672:return Pa;case 35669:case 35673:return Na;case 5125:return Oa;case 35678:case 36198:case 36298:case 36306:case 35682:return Ra;case 35679:case 36299:case 36307:return Ba;case 35680:case 36300:case 36308:case 36293:return Aa;case 36289:case 36303:case 36311:case 36292:return Ia}}(e.type)}function Ja(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Ua;case 35664:return Ha;case 35665:return ka;case 35666:return za;case 35674:return Xa;case 35675:return Wa;case 35676:return ja;case 5124:case 35670:return La;case 35667:case 35671:return Ga;case 35668:case 35672:return Da;case 35669:case 35673:return Va;case 35678:case 36198:case 36298:case 36306:case 35682:return Za;case 35680:case 36300:case 36308:case 36293:return Qa}}(e.type)}function qa(t){this.id=t,this.seq=[],this.map={}}Ja.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),ya(e,t)},qa.prototype.setValue=function(t,e,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(t,e[a.id],n)}};var Ka=/([\w\d_]+)(\])?(\[|\.)?/g;function $a(t,e){t.seq.push(e),t.map[e.id]=e}function ts(t,e,n){var r=t.name,i=r.length;for(Ka.lastIndex=0;;){var o=Ka.exec(r),a=Ka.lastIndex,s=o[1],u="]"===o[2],c=o[3];if(u&&(s|=0),void 0===c||"["===c&&a+2===i){$a(n,void 0===c?new Ya(s,t,e):new Ja(s,t,e));break}var l=n.map[s];void 0===l&&$a(n,l=new qa(s)),n=l}}function es(t,e){this.seq=[],this.map={};for(var n=t.getProgramParameter(e,35718),r=0;r<n;++r){var i=t.getActiveUniform(e,r);ts(i,t.getUniformLocation(e,i.name),this)}}function ns(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}es.prototype.setValue=function(t,e,n,r){var i=this.map[e];void 0!==i&&i.setValue(t,n,r)},es.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},es.upload=function(t,e,n,r){for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,r)}},es.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var o=t[r];o.id in e&&n.push(o)}return n};var rs=0;function is(t){switch(t){case cn:return["Linear","( value )"];case ln:return["sRGB","( value )"];case fn:return["RGBE","( value )"];case pn:return["RGBM","( value, 7.0 )"];case mn:return["RGBM","( value, 16.0 )"];case vn:return["RGBD","( value, 256.0 )"];case dn:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case hn:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+t)}}function os(t,e,n){var r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function as(t,e){var n=is(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function ss(t,e){var n=is(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function us(t,e){var n;switch(e){case ft:n="Linear";break;case ht:n="Reinhard";break;case pt:n="Uncharted2";break;case mt:n="OptimizedCineon";break;case vt:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function cs(t){return""!==t}function ls(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function ds(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var fs=/^[ \t]*#include +<([\w\d./]+)>/gm;function hs(t){return t.replace(fs,ps)}function ps(t,e){var n=Wo[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return hs(n)}var ms=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,vs=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function gs(t){return t.replace(vs,bs).replace(ms,ys)}function ys(t,e,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),bs(t,e,n,r)}function bs(t,e,n,r){for(var i="",o=parseInt(e);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function xs(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function _s(t,e,n){var r,i,o=t.getContext(),a=n.defines,s=n.vertexShader,u=n.fragmentShader,c=function(t){var e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===S?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===M?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===E&&(e="SHADOWMAP_TYPE_VSM"),e}(n),l=function(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case yt:case bt:e="ENVMAP_TYPE_CUBE";break;case Tt:case St:e="ENVMAP_TYPE_CUBE_UV";break;case xt:case _t:e="ENVMAP_TYPE_EQUIREC";break;case wt:e="ENVMAP_TYPE_SPHERE"}return e}(n),d=function(t){var e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case bt:case _t:e="ENVMAP_MODE_REFRACTION"}return e}(n),f=function(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case ut:e="ENVMAP_BLENDING_MULTIPLY";break;case ct:e="ENVMAP_BLENDING_MIX";break;case lt:e="ENVMAP_BLENDING_ADD"}return e}(n),h=t.gammaFactor>0?t.gammaFactor:1,p=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(cs).join("\n")}(n),m=function(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(a),v=o.createProgram();if(n.isRawShaderMaterial?((r=[m].filter(cs).join("\n")).length>0&&(r+="\n"),(i=[p,m].filter(cs).join("\n")).length>0&&(i+="\n")):(r=[xs(n),"#define SHADER_NAME "+n.shaderName,m,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+h,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(cs).join("\n"),i=[p,xs(n),"#define SHADER_NAME "+n.shaderName,m,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+h,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+l:"",n.envMap?"#define "+d:"",n.envMap?"#define "+f:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==dt?"#define TONE_MAPPING":"",n.toneMapping!==dt?Wo.tonemapping_pars_fragment:"",n.toneMapping!==dt?us("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.outputEncoding||n.mapEncoding||n.matcapEncoding||n.envMapEncoding||n.emissiveMapEncoding||n.lightMapEncoding?Wo.encodings_pars_fragment:"",n.mapEncoding?as("mapTexelToLinear",n.mapEncoding):"",n.matcapEncoding?as("matcapTexelToLinear",n.matcapEncoding):"",n.envMapEncoding?as("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?as("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMapEncoding?as("lightMapTexelToLinear",n.lightMapEncoding):"",n.outputEncoding?ss("linearToOutputTexel",n.outputEncoding):"",n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(cs).join("\n")),s=ds(s=ls(s=hs(s),n),n),u=ds(u=ls(u=hs(u),n),n),s=gs(s),u=gs(u),n.isWebGL2&&!n.isRawShaderMaterial){var g=!1,y=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==s.match(y)&&null!==u.match(y)&&(g=!0,s=s.replace(y,""),u=u.replace(y,"")),r=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+r,i=["#version 300 es\n","#define varying in",g?"":"out highp vec4 pc_fragColor;",g?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+i}var b,x,_=i+u,w=ns(o,35633,r+s),T=ns(o,35632,_);if(o.attachShader(v,w),o.attachShader(v,T),void 0!==n.index0AttributeName?o.bindAttribLocation(v,0,n.index0AttributeName):!0===n.morphTargets&&o.bindAttribLocation(v,0,"position"),o.linkProgram(v),t.debug.checkShaderErrors){var R=o.getProgramInfoLog(v).trim(),I=o.getShaderInfoLog(w).trim(),B=o.getShaderInfoLog(T).trim(),A=!0,C=!0;if(!1===o.getProgramParameter(v,35714)){A=!1;var F=os(o,w,"vertex"),P=os(o,T,"fragment");console.error("THREE.WebGLProgram: shader error: ",o.getError(),"35715",o.getProgramParameter(v,35715),"gl.getProgramInfoLog",R,F,P)}else""!==R?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",R):""!==I&&""!==B||(C=!1);C&&(this.diagnostics={runnable:A,programLog:R,vertexShader:{log:I,prefix:r},fragmentShader:{log:B,prefix:i}})}return o.detachShader(v,w),o.detachShader(v,T),o.deleteShader(w),o.deleteShader(T),this.getUniforms=function(){return void 0===b&&(b=new es(o,v)),b},this.getAttributes=function(){return void 0===x&&(x=function(t,e){for(var n={},r=t.getProgramParameter(e,35721),i=0;i<r;i++){var o=t.getActiveAttrib(e,i).name;n[o]=t.getAttribLocation(e,o)}return n}(o,v)),x},this.destroy=function(){o.deleteProgram(v),this.program=void 0},this.name=n.shaderName,this.id=rs++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=w,this.fragmentShader=T,this}function ws(t,e,n){var r=[],i=n.isWebGL2,o=n.logarithmicDepthBuffer,a=n.floatVertexTextures,s=n.precision,u=n.maxVertexUniforms,c=n.vertexTextures,l={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},d=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function f(t){var e;return t?t.isTexture?e=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=cn,e}this.getParameters=function(r,d,h,p,m,v,g){var y=p.fog,b=r.isMeshStandardMaterial?p.environment:null,x=r.envMap||b,_=l[r.type],w=g.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(a)return 1024;var n=u,r=Math.floor((n-20)/4),i=Math.min(r,e.length);return i<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+i+"."),0):i}(g):0;null!==r.precision&&(s=n.getMaxPrecision(r.precision))!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",s,"instead.");var T=function(t,e){var n;if(e){var r=jo[e];n={name:t.type,uniforms:Ao.clone(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}}else n={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};return n}(r,_);r.onBeforeCompile(T,t);var S=t.getRenderTarget();return{isWebGL2:i,shaderID:_,shaderName:T.name,uniforms:T.uniforms,vertexShader:T.vertexShader,fragmentShader:T.fragmentShader,defines:r.defines,isRawShaderMaterial:r.isRawShaderMaterial,isShaderMaterial:r.isShaderMaterial,precision:s,instancing:!0===g.isInstancedMesh,supportsVertexTextures:c,outputEncoding:null!==S?f(S.texture):t.outputEncoding,map:!!r.map,mapEncoding:f(r.map),matcap:!!r.matcap,matcapEncoding:f(r.matcap),envMap:!!x,envMapMode:x&&x.mapping,envMapEncoding:f(x),envMapCubeUV:!!x&&(x.mapping===Tt||x.mapping===St),lightMap:!!r.lightMap,lightMapEncoding:f(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:f(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:r.normalMapType===xn,tangentSpaceNormalMap:r.normalMapType===bn,clearcoatMap:!!r.clearcoatMap,clearcoatRoughnessMap:!!r.clearcoatRoughnessMap,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexUvs:!!r.map||!!r.bumpMap||!!r.normalMap||!!r.specularMap||!!r.alphaMap||!!r.emissiveMap||!!r.roughnessMap||!!r.metalnessMap||!!r.clearcoatMap||!!r.clearcoatRoughnessMap||!!r.clearcoatNormalMap||!!r.displacementMap,uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap)&&!!r.displacementMap,fog:!!y,useFog:r.fog,fogExp2:y&&y.isFogExp2,flatShading:r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:o,skinning:r.skinning&&w>0,maxBones:w,useVertexTexture:a,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:d.directional.length,numPointLights:d.point.length,numSpotLights:d.spot.length,numRectAreaLights:d.rectArea.length,numHemiLights:d.hemi.length,numDirLightShadows:d.directionalShadowMap.length,numPointLightShadows:d.pointShadowMap.length,numSpotLightShadows:d.spotShadowMap.length,numClippingPlanes:m,numClipIntersection:v,dithering:r.dithering,shadowMapEnabled:t.shadowMap.enabled&&h.length>0,shadowMapType:t.shadowMap.type,toneMapping:r.toneMapped?t.toneMapping:dt,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:r.side===B,flipSided:r.side===I,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.fragDepth,extensionDrawBuffers:r.extensions&&r.extensions.drawBuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:i||null!==e.get("EXT_frag_depth"),rendererExtensionDrawBuffers:i||null!==e.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:i||null!==e.get("EXT_shader_texture_lod"),onBeforeCompile:r.onBeforeCompile}},this.getProgramCacheKey=function(e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)n.push(r),n.push(e.defines[r]);if(void 0===e.isRawShaderMaterial){for(var i=0;i<d.length;i++)n.push(e[d[i]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.onBeforeCompile.toString()),n.join()},this.acquireProgram=function(e,n){for(var i,o=0,a=r.length;o<a;o++){var s=r[o];if(s.cacheKey===n){++(i=s).usedTimes;break}}return void 0===i&&(i=new _s(t,n,e),r.push(i)),i},this.releaseProgram=function(t){if(0===--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function Ts(){var t=new WeakMap;return{get:function(e){var n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function Ss(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Ms(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Es(){var t=[],e=0,n=[],r=[],i={id:-1};function o(n,r,o,a,s,u){var c=t[e];return void 0===c?(c={id:n.id,object:n,geometry:r,material:o,program:o.program||i,groupOrder:a,renderOrder:n.renderOrder,z:s,group:u},t[e]=c):(c.id=n.id,c.object=n,c.geometry=r,c.material=o,c.program=o.program||i,c.groupOrder=a,c.renderOrder=n.renderOrder,c.z=s,c.group=u),e++,c}return{opaque:n,transparent:r,init:function(){e=0,n.length=0,r.length=0},push:function(t,e,i,a,s,u){var c=o(t,e,i,a,s,u);(!0===i.transparent?r:n).push(c)},unshift:function(t,e,i,a,s,u){var c=o(t,e,i,a,s,u);(!0===i.transparent?r:n).unshift(c)},finish:function(){for(var n=e,r=t.length;n<r;n++){var i=t[n];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(t,e){n.length>1&&n.sort(t||Ss),r.length>1&&r.sort(e||Ms)}}}function Rs(){var t=new WeakMap;function e(n){var r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){var i,o=t.get(n);return void 0===o?(i=new Es,t.set(n,new WeakMap),t.get(n).set(r,i),n.addEventListener("dispose",e)):void 0===(i=o.get(r))&&(i=new Es,o.set(r,i)),i},dispose:function(){t=new WeakMap}}}function Is(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new ur,color:new Mi};break;case"SpotLight":n={position:new ur,direction:new ur,color:new Mi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new ur,color:new Mi,distance:0,decay:0};break;case"HemisphereLight":n={direction:new ur,skyColor:new Mi,groundColor:new Mi};break;case"RectAreaLight":n={color:new Mi,position:new ur,halfWidth:new ur,halfHeight:new ur}}return t[e.id]=n,n}}}var Bs=0;function As(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function Cs(){for(var t=new Is,e=function(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new qn};break;case"PointLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new qn,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=0;r<9;r++)n.probe.push(new ur);var i=new ur,o=new vr,a=new vr;return{setup:function(r,s,u){for(var c=0,l=0,d=0,f=0;f<9;f++)n.probe[f].set(0,0,0);var h=0,p=0,m=0,v=0,g=0,y=0,b=0,x=0,_=u.matrixWorldInverse;r.sort(As),f=0;for(var w=r.length;f<w;f++){var T=r[f],S=T.color,M=T.intensity,E=T.distance,R=T.shadow&&T.shadow.map?T.shadow.map.texture:null;if(T.isAmbientLight)c+=S.r*M,l+=S.g*M,d+=S.b*M;else if(T.isLightProbe)for(var I=0;I<9;I++)n.probe[I].addScaledVector(T.sh.coefficients[I],M);else if(T.isDirectionalLight){if((C=t.get(T)).color.copy(T.color).multiplyScalar(T.intensity),C.direction.setFromMatrixPosition(T.matrixWorld),i.setFromMatrixPosition(T.target.matrixWorld),C.direction.sub(i),C.direction.transformDirection(_),T.castShadow){var B=T.shadow;(A=e.get(T)).shadowBias=B.bias,A.shadowRadius=B.radius,A.shadowMapSize=B.mapSize,n.directionalShadow[h]=A,n.directionalShadowMap[h]=R,n.directionalShadowMatrix[h]=T.shadow.matrix,y++}n.directional[h]=C,h++}else if(T.isSpotLight){if((C=t.get(T)).position.setFromMatrixPosition(T.matrixWorld),C.position.applyMatrix4(_),C.color.copy(S).multiplyScalar(M),C.distance=E,C.direction.setFromMatrixPosition(T.matrixWorld),i.setFromMatrixPosition(T.target.matrixWorld),C.direction.sub(i),C.direction.transformDirection(_),C.coneCos=Math.cos(T.angle),C.penumbraCos=Math.cos(T.angle*(1-T.penumbra)),C.decay=T.decay,T.castShadow){B=T.shadow;(A=e.get(T)).shadowBias=B.bias,A.shadowRadius=B.radius,A.shadowMapSize=B.mapSize,n.spotShadow[m]=A,n.spotShadowMap[m]=R,n.spotShadowMatrix[m]=T.shadow.matrix,x++}n.spot[m]=C,m++}else if(T.isRectAreaLight){(C=t.get(T)).color.copy(S).multiplyScalar(M),C.position.setFromMatrixPosition(T.matrixWorld),C.position.applyMatrix4(_),a.identity(),o.copy(T.matrixWorld),o.premultiply(_),a.extractRotation(o),C.halfWidth.set(.5*T.width,0,0),C.halfHeight.set(0,.5*T.height,0),C.halfWidth.applyMatrix4(a),C.halfHeight.applyMatrix4(a),n.rectArea[v]=C,v++}else if(T.isPointLight){if((C=t.get(T)).position.setFromMatrixPosition(T.matrixWorld),C.position.applyMatrix4(_),C.color.copy(T.color).multiplyScalar(T.intensity),C.distance=T.distance,C.decay=T.decay,T.castShadow){var A;B=T.shadow;(A=e.get(T)).shadowBias=B.bias,A.shadowRadius=B.radius,A.shadowMapSize=B.mapSize,A.shadowCameraNear=B.camera.near,A.shadowCameraFar=B.camera.far,n.pointShadow[p]=A,n.pointShadowMap[p]=R,n.pointShadowMatrix[p]=T.shadow.matrix,b++}n.point[p]=C,p++}else if(T.isHemisphereLight){var C;(C=t.get(T)).direction.setFromMatrixPosition(T.matrixWorld),C.direction.transformDirection(_),C.direction.normalize(),C.skyColor.copy(T.color).multiplyScalar(M),C.groundColor.copy(T.groundColor).multiplyScalar(M),n.hemi[g]=C,g++}}n.ambient[0]=c,n.ambient[1]=l,n.ambient[2]=d;var F=n.hash;F.directionalLength===h&&F.pointLength===p&&F.spotLength===m&&F.rectAreaLength===v&&F.hemiLength===g&&F.numDirectionalShadows===y&&F.numPointShadows===b&&F.numSpotShadows===x||(n.directional.length=h,n.spot.length=m,n.rectArea.length=v,n.point.length=p,n.hemi.length=g,n.directionalShadow.length=y,n.directionalShadowMap.length=y,n.pointShadow.length=b,n.pointShadowMap.length=b,n.spotShadow.length=x,n.spotShadowMap.length=x,n.directionalShadowMatrix.length=y,n.pointShadowMatrix.length=b,n.spotShadowMatrix.length=x,F.directionalLength=h,F.pointLength=p,F.spotLength=m,F.rectAreaLength=v,F.hemiLength=g,F.numDirectionalShadows=y,F.numPointShadows=b,F.numSpotShadows=x,n.version=Bs++)},state:n}}function Fs(){var t=new Cs,e=[],n=[];return{init:function(){e.length=0,n.length=0},state:{lightsArray:e,shadowsArray:n,lights:t},setupLights:function(r){t.setup(e,n,r)},pushLight:function(t){e.push(t)},pushShadow:function(t){n.push(t)}}}function Ps(){var t=new WeakMap;function e(n){var r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){var i;return!1===t.has(n)?(i=new Fs,t.set(n,new WeakMap),t.get(n).set(r,i),n.addEventListener("dispose",e)):!1===t.get(n).has(r)?(i=new Fs,t.get(n).set(r,i)):i=t.get(n).get(r),i},dispose:function(){t=new WeakMap}}}function Ns(t){Ci.call(this),this.type="MeshDepthMaterial",this.depthPacking=gn,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Os(t){Ci.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new ur,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}Ns.prototype=Object.create(Ci.prototype),Ns.prototype.constructor=Ns,Ns.prototype.isMeshDepthMaterial=!0,Ns.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Os.prototype=Object.create(Ci.prototype),Os.prototype.constructor=Os,Os.prototype.isMeshDistanceMaterial=!0,Os.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};function Us(t,e,n){var r=new Do,i=new qn,o=new qn,a=new nr,s=[],u=[],c={},l={0:I,1:R,2:B},d=new Co({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new qn},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONAL_PASS=1;var h=new $i;h.setAttribute("position",new Ni(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var p=new yo(h,d),m=this;function v(n,r){var i=e.update(p);d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,i,d,p,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,i,f,p,null)}function g(t,e,n){var r=t<<0|e<<1|n<<2,i=s[r];return void 0===i&&(i=new Ns({depthPacking:yn,morphTargets:t,skinning:e}),s[r]=i),i}function y(t,e,n){var r=t<<0|e<<1|n<<2,i=u[r];return void 0===i&&(i=new Os({morphTargets:t,skinning:e}),u[r]=i),i}function b(e,n,r,i,o,a){var s=e.geometry,u=null,d=g,f=e.customDepthMaterial;if(!0===r.isPointLight&&(d=y,f=e.customDistanceMaterial),void 0===f){var h=!1;!0===n.morphTargets&&(!0===s.isBufferGeometry?h=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:!0===s.isGeometry&&(h=s.morphTargets&&s.morphTargets.length>0));var p=!1;!0===e.isSkinnedMesh&&(!0===n.skinning?p=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e)),u=d(h,p,!0===e.isInstancedMesh)}else u=f;if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var m=u.uuid,v=n.uuid,b=c[m];void 0===b&&(b={},c[m]=b);var x=b[v];void 0===x&&(x=u.clone(),b[v]=x),u=x}return u.visible=n.visible,u.wireframe=n.wireframe,u.side=a===E?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:l[n.side],u.clipShadows=n.clipShadows,u.clippingPlanes=n.clippingPlanes,u.clipIntersection=n.clipIntersection,u.wireframeLinewidth=n.wireframeLinewidth,u.linewidth=n.linewidth,!0===r.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(r.matrixWorld),u.nearDistance=i,u.farDistance=o),u}function x(n,i,o,a,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===E)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var u=e.update(n),c=n.material;if(Array.isArray(c))for(var l=u.groups,d=0,f=l.length;d<f;d++){var h=l[d],p=c[h.materialIndex];if(p&&p.visible){var m=b(n,p,a,o.near,o.far,s);t.renderBufferDirect(o,null,u,m,n,h)}}else if(c.visible){m=b(n,c,a,o.near,o.far,s);t.renderBufferDirect(o,null,u,m,n,null)}}for(var v=n.children,g=0,y=v.length;g<y;g++)x(v[g],i,o,a,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=S,this.render=function(e,s,u){if(!1!==m.enabled&&(!1!==m.autoUpdate||!1!==m.needsUpdate)&&0!==e.length){var c=t.getRenderTarget(),l=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),f=t.state;f.setBlending(F),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var h=0,p=e.length;h<p;h++){var g=e[h],y=g.shadow;if(void 0!==y){i.copy(y.mapSize);var b=y.getFrameExtents();if(i.multiply(b),o.copy(y.mapSize),(i.x>n||i.y>n)&&(console.warn("THREE.WebGLShadowMap:",g,"has shadow exceeding max texture size, reducing"),i.x>n&&(o.x=Math.floor(n/b.x),i.x=o.x*b.x,y.mapSize.x=o.x),i.y>n&&(o.y=Math.floor(n/b.y),i.y=o.y*b.y,y.mapSize.y=o.y)),null===y.map&&!y.isPointLightShadow&&this.type===E){var _={minFilter:Pt,magFilter:Pt,format:Kt};y.map=new rr(i.x,i.y,_),y.map.texture.name=g.name+".shadowMap",y.mapPass=new rr(i.x,i.y,_),y.camera.updateProjectionMatrix()}if(null===y.map){_={minFilter:It,magFilter:It,format:Kt};y.map=new rr(i.x,i.y,_),y.map.texture.name=g.name+".shadowMap",y.camera.updateProjectionMatrix()}t.setRenderTarget(y.map),t.clear();for(var w=y.getViewportCount(),T=0;T<w;T++){var S=y.getViewport(T);a.set(o.x*S.x,o.y*S.y,o.x*S.z,o.y*S.w),f.viewport(a),y.updateMatrices(g,T),r=y.getFrustum(),x(s,u,y.camera,g,this.type)}y.isPointLightShadow||this.type!==E||v(y,u)}else console.warn("THREE.WebGLShadowMap:",g,"has no shadow.")}m.needsUpdate=!1,t.setRenderTarget(c,l,d)}}}function Ls(t,e,n){var i,o,a=n.isWebGL2;var s=new function(){var e=!1,n=new nr,r=null,i=new nr(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,a,s){!0===s&&(e*=a,r*=a,o*=a),n.set(e,r,o,a),!1===i.equals(n)&&(t.clearColor(e,r,o,a),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},u=new function(){var e=!1,n=null,r=null,i=null;return{setTest:function(t){t?wt(2929):Tt(2929)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case tt:t.depthFunc(512);break;case et:t.depthFunc(519);break;case nt:t.depthFunc(513);break;case rt:t.depthFunc(515);break;case it:t.depthFunc(514);break;case ot:t.depthFunc(518);break;case at:t.depthFunc(516);break;case st:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},c=new function(){var e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,c=null;return{setTest:function(t){e||(t?wt(2960):Tt(2960))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,a){r===e&&i===n&&o===a||(t.stencilFunc(e,n,a),r=e,i=n,o=a)},setOp:function(e,n,r){a===e&&s===n&&u===r||(t.stencilOp(e,n,r),a=e,s=n,u=r)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,c=null}}},l=t.getParameter(34921),d=new Uint8Array(l),f=new Uint8Array(l),h=new Uint8Array(l),p={},m=null,v=null,x=null,_=null,w=null,T=null,S=null,M=null,E=null,R=!1,A=null,C=null,ut=null,ct=null,lt=null,dt=t.getParameter(35661),ft=!1,ht=0,pt=t.getParameter(7938);-1!==pt.indexOf("WebGL")?(ht=parseFloat(/^WebGL\ ([0-9])/.exec(pt)[1]),ft=ht>=1):-1!==pt.indexOf("OpenGL ES")&&(ht=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(pt)[1]),ft=ht>=2);var mt=null,vt={},gt=new nr,yt=new nr;function bt(e,n,r){var i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(var a=0;a<r;a++)t.texImage2D(n+a,0,6408,1,1,0,6408,5121,i);return o}var xt={};function _t(n,r){(d[n]=1,0===f[n]&&(t.enableVertexAttribArray(n),f[n]=1),h[n]!==r)&&((a?t:e.get("ANGLE_instanced_arrays"))[a?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),h[n]=r)}function wt(e){!0!==p[e]&&(t.enable(e),p[e]=!0)}function Tt(e){!1!==p[e]&&(t.disable(e),p[e]=!1)}xt[3553]=bt(3553,3553,1),xt[34067]=bt(34067,34069,6),s.setClear(0,0,0,1),u.setClear(1),c.setClear(0),wt(2929),u.setFunc(rt),It(!1),Bt(y),wt(2884),Rt(F);var St=(i={},Object(r.a)(i,G,32774),Object(r.a)(i,D,32778),Object(r.a)(i,V,32779),i);if(a)St[H]=32775,St[k]=32776;else{var Mt=e.get("EXT_blend_minmax");null!==Mt&&(St[H]=Mt.MIN_EXT,St[k]=Mt.MAX_EXT)}var Et=(o={},Object(r.a)(o,z,0),Object(r.a)(o,X,1),Object(r.a)(o,W,768),Object(r.a)(o,Z,770),Object(r.a)(o,$,776),Object(r.a)(o,q,774),Object(r.a)(o,Y,772),Object(r.a)(o,j,769),Object(r.a)(o,Q,771),Object(r.a)(o,K,775),Object(r.a)(o,J,773),o);function Rt(e,n,r,i,o,a,s,u){if(e!==F){if(v||(wt(3042),v=!0),e===L)o=o||n,a=a||r,s=s||i,n===_&&o===S||(t.blendEquationSeparate(St[n],St[o]),_=n,S=o),r===w&&i===T&&a===M&&s===E||(t.blendFuncSeparate(Et[r],Et[i],Et[a],Et[s]),w=r,T=i,M=a,E=s),x=e,R=null;else if(e!==x||u!==R){if(_===G&&S===G||(t.blendEquation(32774),_=G,S=G),u)switch(e){case P:t.blendFuncSeparate(1,771,1,771);break;case N:t.blendFunc(1,1);break;case O:t.blendFuncSeparate(0,0,769,771);break;case U:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case P:t.blendFuncSeparate(770,771,1,771);break;case N:t.blendFunc(770,1);break;case O:t.blendFunc(0,769);break;case U:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}w=null,T=null,M=null,E=null,x=e,R=u}}else v&&(Tt(3042),v=!1)}function It(e){A!==e&&(e?t.frontFace(2304):t.frontFace(2305),A=e)}function Bt(e){e!==g?(wt(2884),e!==C&&(e===y?t.cullFace(1029):e===b?t.cullFace(1028):t.cullFace(1032))):Tt(2884),C=e}function At(e,n,r){e?(wt(32823),ct===n&&lt===r||(t.polygonOffset(n,r),ct=n,lt=r)):Tt(32823)}function Ct(e){void 0===e&&(e=33984+dt-1),mt!==e&&(t.activeTexture(e),mt=e)}return{buffers:{color:s,depth:u,stencil:c},initAttributes:function(){for(var t=0,e=d.length;t<e;t++)d[t]=0},enableAttribute:function(t){_t(t,0)},enableAttributeAndDivisor:_t,disableUnusedAttributes:function(){for(var e=0,n=f.length;e!==n;++e)f[e]!==d[e]&&(t.disableVertexAttribArray(e),f[e]=0)},enable:wt,disable:Tt,useProgram:function(e){return m!==e&&(t.useProgram(e),m=e,!0)},setBlending:Rt,setMaterial:function(t,e){t.side===B?Tt(2884):wt(2884);var n=t.side===I;e&&(n=!n),It(n),t.blending===P&&!1===t.transparent?Rt(F):Rt(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),u.setFunc(t.depthFunc),u.setTest(t.depthTest),u.setMask(t.depthWrite),s.setMask(t.colorWrite);var r=t.stencilWrite;c.setTest(r),r&&(c.setMask(t.stencilWriteMask),c.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),c.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),At(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:It,setCullFace:Bt,setLineWidth:function(e){e!==ut&&(ft&&t.lineWidth(e),ut=e)},setPolygonOffset:At,setScissorTest:function(t){t?wt(3089):Tt(3089)},activeTexture:Ct,bindTexture:function(e,n){null===mt&&Ct();var r=vt[mt];void 0===r&&(r={type:void 0,texture:void 0},vt[mt]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||xt[e]),r.type=e,r.texture=n)},unbindTexture:function(){var e=vt[mt];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(e){!1===gt.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),gt.copy(e))},viewport:function(e){!1===yt.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),yt.copy(e))},reset:function(){for(var e=0;e<f.length;e++)1===f[e]&&(t.disableVertexAttribArray(e),f[e]=0);p={},mt=null,vt={},m=null,x=null,A=null,C=null,s.reset(),u.reset(),c.reset()}}}function Gs(t,e,n,i,o,a,s){var u,c,l,d=o.isWebGL2,f=o.maxTextures,h=o.maxCubemapSize,p=o.maxTextureSize,m=o.maxSamples,v=new WeakMap,g=!1;try{g="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(k){}function y(t,e){return g?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function b(t,e,n,r){var i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap){var o=e?Jn.floorPowerOfTwo:Math.floor,a=o(i*t.width),s=o(i*t.height);void 0===l&&(l=y(a,s));var u=n?y(a,s):l;return u.width=a,u.height=s,u.getContext("2d").drawImage(t,0,0,a,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+a+"x"+s+")."),u}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function x(t){return Jn.isPowerOfTwo(t.width)&&Jn.isPowerOfTwo(t.height)}function _(t,e){return t.generateMipmaps&&e&&t.minFilter!==It&&t.minFilter!==Pt}function w(e,n,r,o){t.generateMipmap(e),i.get(n).__maxMipLevel=Math.log(Math.max(r,o))*Math.LOG2E}function T(n,r,i){if(!1===d)return r;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var o=r;return 6403===r&&(5126===i&&(o=33326),5131===i&&(o=33325),5121===i&&(o=33321)),6407===r&&(5126===i&&(o=34837),5131===i&&(o=34843),5121===i&&(o=32849)),6408===r&&(5126===i&&(o=34836),5131===i&&(o=34842),5121===i&&(o=32856)),33325!==o&&33326!==o&&34842!==o&&34836!==o||e.get("EXT_color_buffer_float"),o}function S(t){return t===It||t===Bt||t===Ct?9728:9729}function M(e){var n=e.target;n.removeEventListener("dispose",M),function(e){var n=i.get(e);if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture),i.remove(e)}(n),n.isVideoTexture&&v.delete(n),s.memory.textures--}function E(e){var n=e.target;n.removeEventListener("dispose",E),function(e){var n=i.get(e),r=i.get(e.texture);if(!e)return;void 0!==r.__webglTexture&&t.deleteTexture(r.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(var o=0;o<6;o++)t.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[o]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&t.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&t.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&t.deleteRenderbuffer(n.__webglDepthRenderbuffer);i.remove(e.texture),i.remove(e)}(n),s.memory.textures--}var R=0;function I(t,e){var r=i.get(t);if(t.isVideoTexture&&function(t){var e=s.render.frame;v.get(t)!==e&&(v.set(t,e),t.update())}(t),t.version>0&&r.__version!==t.version){var o=t.image;if(void 0===o)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==o.complete)return void O(r,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,r.__webglTexture)}function B(e,r){if(6===e.image.length){var o=i.get(e);if(e.version>0&&o.__version!==e.version){N(o,e),n.activeTexture(33984+r),n.bindTexture(34067,o.__webglTexture),t.pixelStorei(37440,e.flipY);for(var s=e&&(e.isCompressedTexture||e.image[0].isCompressedTexture),u=e.image[0]&&e.image[0].isDataTexture,c=[],l=0;l<6;l++)c[l]=s||u?u?e.image[l].image:e.image[l]:b(e.image[l],!1,!0,h);var f,p=c[0],m=x(p)||d,v=a.convert(e.format),g=a.convert(e.type),y=T(e.internalFormat,v,g);if(P(34067,e,m),s){for(l=0;l<6;l++){f=c[l].mipmaps;for(var S=0;S<f.length;S++){var M=f[S];e.format!==Kt&&e.format!==qt?null!==v?n.compressedTexImage2D(34069+l,S,y,M.width,M.height,0,M.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+l,S,y,M.width,M.height,0,v,g,M.data)}}o.__maxMipLevel=f.length-1}else{f=e.mipmaps;for(l=0;l<6;l++)if(u){n.texImage2D(34069+l,0,y,c[l].width,c[l].height,0,v,g,c[l].data);for(S=0;S<f.length;S++){var E=(M=f[S]).image[l].image;n.texImage2D(34069+l,S+1,y,E.width,E.height,0,v,g,E.data)}}else{n.texImage2D(34069+l,0,y,v,g,c[l]);for(S=0;S<f.length;S++){M=f[S];n.texImage2D(34069+l,S+1,y,v,g,M.image[l])}}o.__maxMipLevel=f.length}_(e,m)&&w(34067,e,p.width,p.height),o.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(33984+r),n.bindTexture(34067,o.__webglTexture)}}function A(t,e){n.activeTexture(33984+e),n.bindTexture(34067,i.get(t).__webglTexture)}var C=(u={},Object(r.a)(u,Mt,10497),Object(r.a)(u,Et,33071),Object(r.a)(u,Rt,33648),u),F=(c={},Object(r.a)(c,It,9728),Object(r.a)(c,Bt,9984),Object(r.a)(c,Ct,9986),Object(r.a)(c,Pt,9729),Object(r.a)(c,Nt,9985),Object(r.a)(c,Ut,9987),c);function P(n,r,a){a?(t.texParameteri(n,10242,C[r.wrapS]),t.texParameteri(n,10243,C[r.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,C[r.wrapR]),t.texParameteri(n,10240,F[r.magFilter]),t.texParameteri(n,10241,F[r.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),r.wrapS===Et&&r.wrapT===Et||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,S(r.magFilter)),t.texParameteri(n,10241,S(r.minFilter)),r.minFilter!==It&&r.minFilter!==Pt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var s=e.get("EXT_texture_filter_anisotropic");if(s){if(r.type===Xt&&null===e.get("OES_texture_float_linear"))return;if(r.type===Wt&&null===(d||e.get("OES_texture_half_float_linear")))return;(r.anisotropy>1||i.get(r).__currentAnisotropy)&&(t.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(r.anisotropy,o.getMaxAnisotropy())),i.get(r).__currentAnisotropy=r.anisotropy)}}function N(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",M),e.__webglTexture=t.createTexture(),s.memory.textures++)}function O(e,r,i){var o=3553;r.isDataTexture2DArray&&(o=35866),r.isDataTexture3D&&(o=32879),N(e,r),n.activeTexture(33984+i),n.bindTexture(o,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment);var s=function(t){return!d&&(t.wrapS!==Et||t.wrapT!==Et||t.minFilter!==It&&t.minFilter!==Pt)}(r)&&!1===x(r.image),u=b(r.image,s,!1,p),c=x(u)||d,l=a.convert(r.format),f=a.convert(r.type),h=T(r.internalFormat,l,f);P(o,r,c);var m,v=r.mipmaps;if(r.isDepthTexture)h=6402,d?h=r.type===Xt?36012:r.type===zt?33190:r.type===Yt?35056:33189:r.type===Xt&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===ne&&6402===h&&r.type!==Ht&&r.type!==zt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Ht,f=a.convert(r.type)),r.format===re&&6402===h&&(h=34041,r.type!==Yt&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Yt,f=a.convert(r.type))),n.texImage2D(3553,0,h,u.width,u.height,0,l,f,null);else if(r.isDataTexture)if(v.length>0&&c){for(var g=0,y=v.length;g<y;g++)m=v[g],n.texImage2D(3553,g,h,m.width,m.height,0,l,f,m.data);r.generateMipmaps=!1,e.__maxMipLevel=v.length-1}else n.texImage2D(3553,0,h,u.width,u.height,0,l,f,u.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(g=0,y=v.length;g<y;g++)m=v[g],r.format!==Kt&&r.format!==qt?null!==l?n.compressedTexImage2D(3553,g,h,m.width,m.height,0,m.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,g,h,m.width,m.height,0,l,f,m.data);e.__maxMipLevel=v.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,h,u.width,u.height,u.depth,0,l,f,u.data),e.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,h,u.width,u.height,u.depth,0,l,f,u.data),e.__maxMipLevel=0;else if(v.length>0&&c){for(g=0,y=v.length;g<y;g++)m=v[g],n.texImage2D(3553,g,h,l,f,m);r.generateMipmaps=!1,e.__maxMipLevel=v.length-1}else n.texImage2D(3553,0,h,l,f,u),e.__maxMipLevel=0;_(r,c)&&w(o,r,u.width,u.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function U(e,r,o,s){var u=a.convert(r.texture.format),c=a.convert(r.texture.type),l=T(r.texture.internalFormat,u,c);n.texImage2D(s,0,l,r.width,r.height,0,u,c,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,o,s,i.get(r.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function L(e,n,r){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){var i=33189;if(r){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===Xt?i=36012:o.type===zt&&(i=33190));var s=D(n);t.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(r){s=D(n);t.renderbufferStorageMultisample(36161,s,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{var u=a.convert(n.texture.format),c=a.convert(n.texture.type);i=T(n.texture.internalFormat,u,c);if(r){s=D(n);t.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height)}t.bindRenderbuffer(36161,null)}function G(e){var n=i.get(e),r=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),I(n.depthTexture,0);var r=i.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===ne)t.framebufferTexture2D(36160,36096,3553,r,0);else{if(n.depthTexture.format!==re)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,r,0)}}(n.__webglFramebuffer,e)}else if(r){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(36160,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=t.createRenderbuffer(),L(n.__webglDepthbuffer[o],e,!1)}else t.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),L(n.__webglDepthbuffer,e,!1);t.bindFramebuffer(36160,null)}function D(t){return d&&t.isWebGLMultisampleRenderTarget?Math.min(m,t.samples):0}var V=!1,H=!1;this.allocateTextureUnit=function(){var t=R;return t>=f&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+f),R+=1,t},this.resetTextureUnits=function(){R=0},this.setTexture2D=I,this.setTexture2DArray=function(t,e){var r=i.get(t);t.version>0&&r.__version!==t.version?O(r,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(t,e){var r=i.get(t);t.version>0&&r.__version!==t.version?O(r,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,r.__webglTexture))},this.setTextureCube=B,this.setTextureCubeDynamic=A,this.setupRenderTarget=function(e){var r=i.get(e),o=i.get(e.texture);e.addEventListener("dispose",E),o.__webglTexture=t.createTexture(),s.memory.textures++;var u=!0===e.isWebGLCubeRenderTarget,c=!0===e.isWebGLMultisampleRenderTarget,l=x(e)||d;if(!d||e.texture.format!==qt||e.texture.type!==Xt&&e.texture.type!==Wt||(e.texture.format=Kt,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),u){r.__webglFramebuffer=[];for(var f=0;f<6;f++)r.__webglFramebuffer[f]=t.createFramebuffer()}else if(r.__webglFramebuffer=t.createFramebuffer(),c)if(d){r.__webglMultisampledFramebuffer=t.createFramebuffer(),r.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,r.__webglColorRenderbuffer);var h=a.convert(e.texture.format),p=a.convert(e.texture.type),m=T(e.texture.internalFormat,h,p),v=D(e);t.renderbufferStorageMultisample(36161,v,m,e.width,e.height),t.bindFramebuffer(36160,r.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,r.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(r.__webglDepthRenderbuffer=t.createRenderbuffer(),L(r.__webglDepthRenderbuffer,e,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(u){n.bindTexture(34067,o.__webglTexture),P(34067,e.texture,l);for(f=0;f<6;f++)U(r.__webglFramebuffer[f],e,36064,34069+f);_(e.texture,l)&&w(34067,e.texture,e.width,e.height),n.bindTexture(34067,null)}else n.bindTexture(3553,o.__webglTexture),P(3553,e.texture,l),U(r.__webglFramebuffer,e,36064,3553),_(e.texture,l)&&w(3553,e.texture,e.width,e.height),n.bindTexture(3553,null);e.depthBuffer&&G(e)},this.updateRenderTargetMipmap=function(t){var e=t.texture;if(_(e,x(t)||d)){var r=t.isWebGLCubeRenderTarget?34067:3553,o=i.get(e).__webglTexture;n.bindTexture(r,o),w(r,e,t.width,t.height),n.bindTexture(r,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(d){var n=i.get(e);t.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,n.__webglFramebuffer);var r=e.width,o=e.height,a=16384;e.depthBuffer&&(a|=256),e.stencilBuffer&&(a|=1024),t.blitFramebuffer(0,0,r,o,0,0,r,o,a,9728),t.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===V&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),V=!0),t=t.texture),I(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===H&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),H=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?B(t,e):A(t,e)}}function Ds(t,e,n){var r=n.isWebGL2;return{convert:function(t){var n;if(t===Gt)return 5121;if(t===jt)return 32819;if(t===Zt)return 32820;if(t===Qt)return 33635;if(t===Dt)return 5120;if(t===Vt)return 5122;if(t===Ht)return 5123;if(t===kt)return 5124;if(t===zt)return 5125;if(t===Xt)return 5126;if(t===Wt)return r?5131:null!==(n=e.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(t===Jt)return 6406;if(t===qt)return 6407;if(t===Kt)return 6408;if(t===$t)return 6409;if(t===te)return 6410;if(t===ne)return 6402;if(t===re)return 34041;if(t===ie)return 6403;if(t===oe)return 36244;if(t===ae)return 33319;if(t===se)return 33320;if(t===ue)return 36248;if(t===ce)return 36249;if(t===le||t===de||t===fe||t===he){if(null===(n=e.get("WEBGL_compressed_texture_s3tc")))return null;if(t===le)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===de)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===fe)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===he)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t===pe||t===me||t===ve||t===ge){if(null===(n=e.get("WEBGL_compressed_texture_pvrtc")))return null;if(t===pe)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===me)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===ve)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===ge)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===ye)return null!==(n=e.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((t===be||t===xe)&&null!==(n=e.get("WEBGL_compressed_texture_etc"))){if(t===be)return n.COMPRESSED_RGB8_ETC2;if(t===xe)return n.COMPRESSED_RGBA8_ETC2_EAC}return t===_e||t===we||t===Te||t===Se||t===Me||t===Ee||t===Re||t===Ie||t===Be||t===Ae||t===Ce||t===Fe||t===Pe||t===Ne||t===Ue||t===Le||t===Ge||t===De||t===Ve||t===He||t===ke||t===ze||t===Xe||t===We||t===je||t===Ze||t===Qe||t===Ye?null!==(n=e.get("WEBGL_compressed_texture_astc"))?t:null:t===Oe?null!==(n=e.get("EXT_texture_compression_bptc"))?t:null:t===Yt?r?34042:null!==(n=e.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function Vs(t){Po.call(this),this.cameras=t||[]}function Hs(){Nr.call(this),this.type="Group"}function ks(t,e){var n=this,r=null,i=1,o=null,a="local-floor",s=null,u=[],c=new Map,l=new Po;l.layers.enable(1),l.viewport=new nr;var d=new Po;d.layers.enable(2),d.viewport=new nr;var f=new Vs([l,d]);f.layers.enable(1),f.layers.enable(2);var h=null,p=null;function m(t){var e=c.get(t.inputSource);e&&(e.targetRay&&e.targetRay.dispatchEvent({type:t.type}),e.grip&&e.grip.dispatchEvent({type:t.type}))}function v(){c.forEach((function(t,e){t.targetRay&&(t.targetRay.dispatchEvent({type:"disconnected",data:e}),t.targetRay.visible=!1),t.grip&&(t.grip.dispatchEvent({type:"disconnected",data:e}),t.grip.visible=!1)})),c.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),T.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function g(t){o=t,T.setContext(r),T.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function y(t){for(var e=r.inputSources,n=0;n<u.length;n++)c.set(e[n],u[n]);for(n=0;n<t.removed.length;n++){var i=t.removed[n];(o=c.get(i))&&(o.targetRay&&o.targetRay.dispatchEvent({type:"disconnected",data:i}),o.grip&&o.grip.dispatchEvent({type:"disconnected",data:i}),c.delete(i))}for(n=0;n<t.added.length;n++){var o;i=t.added[n];(o=c.get(i))&&(o.targetRay&&o.targetRay.dispatchEvent({type:"connected",data:i}),o.grip&&o.grip.dispatchEvent({type:"connected",data:i}))}}this.enabled=!1,this.isPresenting=!1,this.getController=function(t){var e=u[t];return void 0===e&&(e={},u[t]=e),void 0===e.targetRay&&(e.targetRay=new Hs,e.targetRay.matrixAutoUpdate=!1,e.targetRay.visible=!1),e.targetRay},this.getControllerGrip=function(t){var e=u[t];return void 0===e&&(e={},u[t]=e),void 0===e.grip&&(e.grip=new Hs,e.grip.matrixAutoUpdate=!1,e.grip.visible=!1),e.grip},this.setFramebufferScaleFactor=function(t){i=t,1==n.isPresenting&&console.warn("WebXRManager: Cannot change framebuffer scale while presenting VR content")},this.setReferenceSpaceType=function(t){a=t},this.getReferenceSpace=function(){return o},this.getSession=function(){return r},this.setSession=function(t){if(null!==(r=t)){r.addEventListener("select",m),r.addEventListener("selectstart",m),r.addEventListener("selectend",m),r.addEventListener("squeeze",m),r.addEventListener("squeezestart",m),r.addEventListener("squeezeend",m),r.addEventListener("end",v);var n=e.getContextAttributes(),o={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:i},s=new XRWebGLLayer(r,e,o);r.updateRenderState({baseLayer:s}),r.requestReferenceSpace(a).then(g),r.addEventListener("inputsourceschange",y)}};var b=new ur,x=new ur;function _(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}this.getCamera=function(t){f.near=d.near=l.near=t.near,f.far=d.far=l.far=t.far,h===f.near&&p===f.far||(r.updateRenderState({depthNear:f.near,depthFar:f.far}),h=f.near,p=f.far);var e=t.parent,n=f.cameras;_(f,e);for(var i=0;i<n.length;i++)_(n[i],e);t.matrixWorld.copy(f.matrixWorld);for(var o=t.children,a=(i=0,o.length);i<a;i++)o[i].updateMatrixWorld(!0);return function(t,e,n){b.setFromMatrixPosition(e.matrixWorld),x.setFromMatrixPosition(n.matrixWorld);var r=b.distanceTo(x),i=e.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],c=(i[9]-1)/i[5],l=(i[8]-1)/i[0],d=(o[8]+1)/o[0],f=a*l,h=a*d,p=r/(-l+d),m=p*-l;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld);var v=a+p,g=s+p,y=f-m,_=h+(r-m),w=u*s/g*v,T=c*s/g*v;t.projectionMatrix.makePerspective(y,_,w,T,v,g)}(f,l,d),f};var w=null;var T=new Ho;T.setAnimationLoop((function(e,n){if(null!==(s=n.getViewerPose(o))){var i=s.views,a=r.renderState.baseLayer;t.setFramebuffer(a.framebuffer);for(var c=0;c<i.length;c++){var l=i[c],d=a.getViewport(l),h=f.cameras[c];h.matrix.fromArray(l.transform.matrix),h.projectionMatrix.fromArray(l.projectionMatrix),h.viewport.set(d.x,d.y,d.width,d.height),0===c&&f.matrix.copy(h.matrix)}}var p=r.inputSources;for(c=0;c<u.length;c++){var m=u[c],v=p[c],g=null,y=null;v&&(m.targetRay&&null!==(g=n.getPose(v.targetRaySpace,o))&&(m.targetRay.matrix.fromArray(g.transform.matrix),m.targetRay.matrix.decompose(m.targetRay.position,m.targetRay.rotation,m.targetRay.scale)),m.grip&&v.gripSpace&&null!==(y=n.getPose(v.gripSpace,o))&&(m.grip.matrix.fromArray(y.transform.matrix),m.grip.matrix.decompose(m.grip.position,m.grip.rotation,m.grip.scale))),m.targetRay&&(m.targetRay.visible=null!==g),m.grip&&(m.grip.visible=null!==y)}w&&w(e,n)})),this.setAnimationLoop=function(t){w=t},this.dispose=function(){}}function zs(t){var e=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,i=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,a=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,u=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=void 0!==t.powerPreference?t.powerPreference:"default",l=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,d=null,f=null;this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=cn,this.physicallyCorrectLights=!1,this.toneMapping=ft,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var h,p,m,v,g,y,b,x,_,w,T,S,M,E,R,B,A,C,F=this,P=!1,N=null,O=0,U=0,L=null,G=null,D=-1,V={geometry:null,program:null,wireframe:!1},H=null,k=null,z=new nr,X=new nr,W=null,j=e.width,Z=e.height,Q=1,Y=null,J=null,q=new nr(0,0,j,Z),K=new nr(0,0,j,Z),$=!1,tt=new Do,et=new Jo,nt=!1,rt=!1,it=new vr,ot=new ur;function at(){return null===L?Q:1}try{var st={alpha:r,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:l,xrCompatible:!0};if(e.addEventListener("webglcontextlost",dt,!1),e.addEventListener("webglcontextrestored",ht,!1),null===(h=n||e.getContext("webgl",st)||e.getContext("experimental-webgl",st)))throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===h.getShaderPrecisionFormat&&(h.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Et){throw console.error("THREE.WebGLRenderer: "+Et.message),Et}function ut(){p=new qo(h),!1===(m=new Yo(h,p,t)).isWebGL2&&(p.get("WEBGL_depth_texture"),p.get("OES_texture_float"),p.get("OES_texture_half_float"),p.get("OES_texture_half_float_linear"),p.get("OES_standard_derivatives"),p.get("OES_element_index_uint"),p.get("ANGLE_instanced_arrays")),p.get("OES_texture_float_linear"),C=new Ds(h,p,m),(v=new Ls(h,p,m)).scissor(X.copy(K).multiplyScalar(Q).floor()),v.viewport(z.copy(q).multiplyScalar(Q).floor()),g=new ta(h),y=new Ts,b=new Gs(h,p,v,y,m,C,g),x=new ko(h,m),_=new Ko(h,x,g),w=new ra(h,_,x,g),R=new na(h),T=new ws(F,p,m),S=new Rs,M=new Ps,E=new Zo(F,v,w,s),B=new Qo(h,p,g,m),A=new $o(h,p,g,m),g.programs=T.programs,F.capabilities=m,F.extensions=p,F.properties=y,F.renderLists=S,F.state=v,F.info=g}ut();var ct=new ks(F,h);this.xr=ct;var lt=new Us(F,w,m.maxTextureSize);function dt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),P=!0}function ht(){console.log("THREE.WebGLRenderer: Context Restored."),P=!1,ut()}function pt(t){var e=t.target;e.removeEventListener("dispose",pt),function(t){mt(t),y.remove(t)}(e)}function mt(t){var e=y.get(t).program;t.program=void 0,void 0!==e&&T.releaseProgram(e)}this.shadowMap=lt,this.getContext=function(){return h},this.getContextAttributes=function(){return h.getContextAttributes()},this.forceContextLoss=function(){var t=p.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=p.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return Q},this.setPixelRatio=function(t){void 0!==t&&(Q=t,this.setSize(j,Z,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new qn),t.set(j,Z)},this.setSize=function(t,n,r){ct.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(j=t,Z=n,e.width=Math.floor(t*Q),e.height=Math.floor(n*Q),!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new qn),t.set(j*Q,Z*Q).floor()},this.setDrawingBufferSize=function(t,n,r){j=t,Z=n,Q=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new nr),t.copy(z)},this.getViewport=function(t){return t.copy(q)},this.setViewport=function(t,e,n,r){t.isVector4?q.set(t.x,t.y,t.z,t.w):q.set(t,e,n,r),v.viewport(z.copy(q).multiplyScalar(Q).floor())},this.getScissor=function(t){return t.copy(K)},this.setScissor=function(t,e,n,r){t.isVector4?K.set(t.x,t.y,t.z,t.w):K.set(t,e,n,r),v.scissor(X.copy(K).multiplyScalar(Q).floor())},this.getScissorTest=function(){return $},this.setScissorTest=function(t){v.setScissorTest($=t)},this.setOpaqueSort=function(t){Y=t},this.setTransparentSort=function(t){J=t},this.getClearColor=function(){return E.getClearColor()},this.setClearColor=function(){E.setClearColor.apply(E,arguments)},this.getClearAlpha=function(){return E.getClearAlpha()},this.setClearAlpha=function(){E.setClearAlpha.apply(E,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=16384),(void 0===e||e)&&(r|=256),(void 0===n||n)&&(r|=1024),h.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",dt,!1),e.removeEventListener("webglcontextrestored",ht,!1),S.dispose(),M.dispose(),y.dispose(),w.dispose(),ct.dispose(),yt.stop(),this.forceContextLoss()},this.renderBufferImmediate=function(t,e){v.initAttributes();var n=y.get(t);t.hasPositions&&!n.position&&(n.position=h.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=h.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=h.createBuffer()),t.hasColors&&!n.color&&(n.color=h.createBuffer());var r=e.getAttributes();t.hasPositions&&(h.bindBuffer(34962,n.position),h.bufferData(34962,t.positionArray,35048),v.enableAttribute(r.position),h.vertexAttribPointer(r.position,3,5126,!1,0,0)),t.hasNormals&&(h.bindBuffer(34962,n.normal),h.bufferData(34962,t.normalArray,35048),v.enableAttribute(r.normal),h.vertexAttribPointer(r.normal,3,5126,!1,0,0)),t.hasUvs&&(h.bindBuffer(34962,n.uv),h.bufferData(34962,t.uvArray,35048),v.enableAttribute(r.uv),h.vertexAttribPointer(r.uv,2,5126,!1,0,0)),t.hasColors&&(h.bindBuffer(34962,n.color),h.bufferData(34962,t.colorArray,35048),v.enableAttribute(r.color),h.vertexAttribPointer(r.color,3,5126,!1,0,0)),v.disableUnusedAttributes(),h.drawArrays(4,0,t.count),t.count=0};var vt=new Or;this.renderBufferDirect=function(t,e,n,r,i,o){null===e&&(e=vt);var a=i.isMesh&&i.matrixWorld.determinant()<0,s=Tt(t,e,r,i);v.setMaterial(r,a);var u=!1;V.geometry===n.id&&V.program===s.id&&V.wireframe===(!0===r.wireframe)||(V.geometry=n.id,V.program=s.id,V.wireframe=!0===r.wireframe,u=!0),(r.morphTargets||r.morphNormals)&&(R.update(i,n,r,s),u=!0);var c=n.index,l=n.attributes.position;if(null===c){if(void 0===l||0===l.count)return}else if(0===c.count)return;var d,f=1;!0===r.wireframe&&(c=_.getWireframeAttribute(n),f=2);var g=B;null!==c&&(d=x.get(c),(g=A).setIndex(d)),u&&(!function(t,e,n,r){if(!1===m.isWebGL2&&(t.isInstancedMesh||e.isInstancedBufferGeometry)&&null===p.get("ANGLE_instanced_arrays"))return;v.initAttributes();var i=e.attributes,o=r.getAttributes(),a=n.defaultAttributeValues;for(var s in o){var u=o[s];if(u>=0){var c=i[s];if(void 0!==c){var l=c.normalized,d=c.itemSize;if(void 0===(T=x.get(c)))continue;var f=T.buffer,g=T.type,y=T.bytesPerElement;if(c.isInterleavedBufferAttribute){var b=c.data,_=b.stride,w=c.offset;b&&b.isInstancedInterleavedBuffer?(v.enableAttributeAndDivisor(u,b.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=b.meshPerAttribute*b.count)):v.enableAttribute(u),h.bindBuffer(34962,f),h.vertexAttribPointer(u,d,g,l,_*y,w*y)}else c.isInstancedBufferAttribute?(v.enableAttributeAndDivisor(u,c.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=c.meshPerAttribute*c.count)):v.enableAttribute(u),h.bindBuffer(34962,f),h.vertexAttribPointer(u,d,g,l,0,0)}else if("instanceMatrix"===s){var T;if(void 0===(T=x.get(t.instanceMatrix)))continue;f=T.buffer,g=T.type;v.enableAttributeAndDivisor(u+0,1),v.enableAttributeAndDivisor(u+1,1),v.enableAttributeAndDivisor(u+2,1),v.enableAttributeAndDivisor(u+3,1),h.bindBuffer(34962,f),h.vertexAttribPointer(u+0,4,g,!1,64,0),h.vertexAttribPointer(u+1,4,g,!1,64,16),h.vertexAttribPointer(u+2,4,g,!1,64,32),h.vertexAttribPointer(u+3,4,g,!1,64,48)}else if(void 0!==a){var S=a[s];if(void 0!==S)switch(S.length){case 2:h.vertexAttrib2fv(u,S);break;case 3:h.vertexAttrib3fv(u,S);break;case 4:h.vertexAttrib4fv(u,S);break;default:h.vertexAttrib1fv(u,S)}}}}v.disableUnusedAttributes()}(i,n,r,s),null!==c&&h.bindBuffer(34963,d.buffer));var y=null!==c?c.count:l.count,b=n.drawRange.start*f,w=n.drawRange.count*f,T=null!==o?o.start*f:0,S=null!==o?o.count*f:1/0,M=Math.max(b,T),E=Math.min(y,b+w,T+S)-1,I=Math.max(0,E-M+1);if(0!==I){if(i.isMesh)!0===r.wireframe?(v.setLineWidth(r.wireframeLinewidth*at()),g.setMode(1)):g.setMode(4);else if(i.isLine){var C=r.linewidth;void 0===C&&(C=1),v.setLineWidth(C*at()),i.isLineSegments?g.setMode(1):i.isLineLoop?g.setMode(2):g.setMode(3)}else i.isPoints?g.setMode(0):i.isSprite&&g.setMode(4);i.isInstancedMesh?g.renderInstances(n,M,I,i.count):n.isInstancedBufferGeometry?g.renderInstances(n,M,I,n.maxInstancedCount):g.render(M,I)}},this.compile=function(t,e){(f=M.get(t,e)).init(),t.traverse((function(t){t.isLight&&(f.pushLight(t),t.castShadow&&f.pushShadow(t))})),f.setupLights(e);var n={};t.traverse((function(e){if(e.material)if(Array.isArray(e.material))for(var r=0;r<e.material.length;r++)e.material[r].uuid in n===!1&&(wt(e.material[r],t,e),n[e.material[r].uuid]=!0);else e.material.uuid in n===!1&&(wt(e.material,t,e),n[e.material.uuid]=!0)}))};var gt=null;var yt=new Ho;function bt(t,e,n,r){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)f.pushLight(t),t.castShadow&&f.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||tt.intersectsSprite(t)){r&&ot.setFromMatrixPosition(t.matrixWorld).applyMatrix4(it);var i=w.update(t);(o=t.material).visible&&d.push(t,i,o,n,ot.z,null)}}else if(t.isImmediateRenderObject)r&&ot.setFromMatrixPosition(t.matrixWorld).applyMatrix4(it),d.push(t,null,t.material,n,ot.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==g.render.frame&&(t.skeleton.update(),t.skeleton.frame=g.render.frame),!t.frustumCulled||tt.intersectsObject(t))){r&&ot.setFromMatrixPosition(t.matrixWorld).applyMatrix4(it);i=w.update(t);var o=t.material;if(Array.isArray(o))for(var a=i.groups,s=0,u=a.length;s<u;s++){var c=a[s],l=o[c.materialIndex];l&&l.visible&&d.push(t,i,l,n,ot.z,c)}else o.visible&&d.push(t,i,o,n,ot.z,null)}var h=t.children;for(s=0,u=h.length;s<u;s++)bt(h[s],e,n,r)}}function xt(t,e,n,r){for(var i=0,o=t.length;i<o;i++){var a=t[i],s=a.object,u=a.geometry,c=void 0===r?a.material:r,l=a.group;if(n.isArrayCamera){k=n;for(var d=n.cameras,h=0,p=d.length;h<p;h++){var m=d[h];s.layers.test(m.layers)&&(v.viewport(z.copy(m.viewport)),f.setupLights(m),_t(s,e,m,u,c,l))}}else k=null,_t(s,e,n,u,c,l)}}function _t(t,e,n,r,i,o){if(t.onBeforeRender(F,e,n,r,i,o),f=M.get(e,k||n),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var a=Tt(n,e,i,t);v.setMaterial(i),V.geometry=null,V.program=null,V.wireframe=!1,function(t,e){t.render((function(t){F.renderBufferImmediate(t,e)}))}(t,a)}else F.renderBufferDirect(n,e,r,i,t,o);t.onAfterRender(F,e,n,r,i,o),f=M.get(e,k||n)}function wt(t,e,n){var r=y.get(t),i=f.state.lights,o=f.state.shadowsArray,a=i.state.version,s=T.getParameters(t,i.state,o,e,et.numPlanes,et.numIntersection,n),u=T.getProgramCacheKey(s),c=r.program,l=!0;if(void 0===c)t.addEventListener("dispose",pt);else if(c.cacheKey!==u)mt(t);else if(r.lightsStateVersion!==a)r.lightsStateVersion=a,l=!1;else{if(void 0!==s.shaderID)return;l=!1}l&&(c=T.acquireProgram(s,u),r.program=c,r.uniforms=s.uniforms,r.environment=t.isMeshStandardMaterial?e.environment:null,r.outputEncoding=F.outputEncoding,t.program=c);var d=c.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var h=0;h<F.maxMorphTargets;h++)d["morphTarget"+h]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(h=0;h<F.maxMorphNormals;h++)d["morphNormal"+h]>=0&&t.numSupportedMorphNormals++}var p=r.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=et.numPlanes,r.numIntersection=et.numIntersection,p.clippingPlanes=et.uniform),r.fog=e.fog,r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=a,r.needsLights&&(p.ambientLightColor.value=i.state.ambient,p.lightProbe.value=i.state.probe,p.directionalLights.value=i.state.directional,p.directionalLightShadows.value=i.state.directionalShadow,p.spotLights.value=i.state.spot,p.spotLightShadows.value=i.state.spotShadow,p.rectAreaLights.value=i.state.rectArea,p.pointLights.value=i.state.point,p.pointLightShadows.value=i.state.pointShadow,p.hemisphereLights.value=i.state.hemi,p.directionalShadowMap.value=i.state.directionalShadowMap,p.directionalShadowMatrix.value=i.state.directionalShadowMatrix,p.spotShadowMap.value=i.state.spotShadowMap,p.spotShadowMatrix.value=i.state.spotShadowMatrix,p.pointShadowMap.value=i.state.pointShadowMap,p.pointShadowMatrix.value=i.state.pointShadowMatrix);var m=r.program.getUniforms(),v=es.seqWithValue(m.seq,p);r.uniformsList=v}function Tt(t,e,n,r){b.resetTextureUnits();var i=e.fog,o=n.isMeshStandardMaterial?e.environment:null,a=y.get(n),s=f.state.lights;if(nt&&(rt||t!==H)){var u=t===H&&n.id===D;et.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,a,u)}n.version===a.__version?void 0===a.program||n.fog&&a.fog!==i||a.environment!==o||a.needsLights&&a.lightsStateVersion!==s.state.version?wt(n,e,r):void 0===a.numClippingPlanes||a.numClippingPlanes===et.numPlanes&&a.numIntersection===et.numIntersection?a.outputEncoding!==F.outputEncoding&&wt(n,e,r):wt(n,e,r):(wt(n,e,r),a.__version=n.version);var c,l,d=!1,p=!1,g=!1,x=a.program,_=x.getUniforms(),w=a.uniforms;if(v.useProgram(x.program)&&(d=!0,p=!0,g=!0),n.id!==D&&(D=n.id,p=!0),d||H!==t){if(_.setValue(h,"projectionMatrix",t.projectionMatrix),m.logarithmicDepthBuffer&&_.setValue(h,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),H!==t&&(H=t,p=!0,g=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var T=_.map.cameraPosition;void 0!==T&&T.setValue(h,ot.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&_.setValue(h,"isOrthographic",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&_.setValue(h,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){_.setOptional(h,r,"bindMatrix"),_.setOptional(h,r,"bindMatrixInverse");var S=r.skeleton;if(S){var M=S.bones;if(m.floatVertexTextures){if(void 0===S.boneTexture){var E=Math.sqrt(4*M.length);E=Jn.ceilPowerOfTwo(E),E=Math.max(E,4);var R=new Float32Array(E*E*4);R.set(S.boneMatrices);var B=new Uo(R,E,E,Kt,Xt);S.boneMatrices=R,S.boneTexture=B,S.boneTextureSize=E}_.setValue(h,"boneTexture",S.boneTexture,b),_.setValue(h,"boneTextureSize",S.boneTextureSize)}else _.setOptional(h,S,"boneMatrices")}}return(p||a.receiveShadow!==r.receiveShadow)&&(a.receiveShadow=r.receiveShadow,_.setValue(h,"receiveShadow",r.receiveShadow)),p&&(_.setValue(h,"toneMappingExposure",F.toneMappingExposure),_.setValue(h,"toneMappingWhitePoint",F.toneMappingWhitePoint),a.needsLights&&(l=g,(c=w).ambientLightColor.needsUpdate=l,c.lightProbe.needsUpdate=l,c.directionalLights.needsUpdate=l,c.directionalLightShadows.needsUpdate=l,c.pointLights.needsUpdate=l,c.pointLightShadows.needsUpdate=l,c.spotLights.needsUpdate=l,c.spotLightShadows.needsUpdate=l,c.rectAreaLights.needsUpdate=l,c.hemisphereLights.needsUpdate=l),i&&n.fog&&function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(w,i),n.isMeshBasicMaterial?St(w,n):n.isMeshLambertMaterial?(St(w,n),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(w,n)):n.isMeshToonMaterial?(St(w,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.gradientMap&&(t.gradientMap.value=e.gradientMap);e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===I&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===I&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(w,n)):n.isMeshPhongMaterial?(St(w,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===I&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===I&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(w,n)):n.isMeshStandardMaterial?(St(w,n,o),n.isMeshPhysicalMaterial?function(t,e,n){Mt(t,e,n),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen);e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap);e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap);e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===I&&t.clearcoatNormalScale.value.negate());t.transparency.value=e.transparency}(w,n,o):Mt(w,n,o)):n.isMeshMatcapMaterial?(St(w,n),function(t,e){e.matcap&&(t.matcap.value=e.matcap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===I&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===I&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(w,n)):n.isMeshDepthMaterial?(St(w,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(w,n)):n.isMeshDistanceMaterial?(St(w,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(w,n)):n.isMeshNormalMaterial?(St(w,n),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===I&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===I&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(w,n)):n.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(w,n),n.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(w,n)):n.isPointsMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*Q,t.scale.value=.5*Z,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(w,n):n.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(w,n):n.isShadowMaterial&&(w.color.value.copy(n.color),w.opacity.value=n.opacity),void 0!==w.ltc_1&&(w.ltc_1.value=Vo.LTC_1),void 0!==w.ltc_2&&(w.ltc_2.value=Vo.LTC_2),es.upload(h,a.uniformsList,w,b),n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(es.upload(h,a.uniformsList,w,b),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&_.setValue(h,"center",r.center),_.setValue(h,"modelViewMatrix",r.modelViewMatrix),_.setValue(h,"normalMatrix",r.normalMatrix),_.setValue(h,"modelMatrix",r.matrixWorld),x}function St(t,e,n){t.opacity.value=e.opacity,e.color&&t.diffuse.value.copy(e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap);var r,i,o=e.envMap||n;o&&(t.envMap.value=o,t.flipEnvMap.value=o.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=y.get(o).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?r=e.map:e.specularMap?r=e.specularMap:e.displacementMap?r=e.displacementMap:e.normalMap?r=e.normalMap:e.bumpMap?r=e.bumpMap:e.roughnessMap?r=e.roughnessMap:e.metalnessMap?r=e.metalnessMap:e.alphaMap?r=e.alphaMap:e.emissiveMap&&(r=e.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),e.aoMap?i=e.aoMap:e.lightMap&&(i=e.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function Mt(t,e,n){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===I&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===I&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),(e.envMap||n)&&(t.envMapIntensity.value=e.envMapIntensity)}yt.setAnimationLoop((function(t){ct.isPresenting||gt&&gt(t)})),"undefined"!==typeof window&&yt.setContext(window),this.setAnimationLoop=function(t){gt=t,ct.setAnimationLoop(t),yt.start()},this.render=function(t,e){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),e&&e.isCamera){if(!P){V.geometry=null,V.program=null,V.wireframe=!1,D=-1,H=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),ct.enabled&&ct.isPresenting&&(e=ct.getCamera(e)),(f=M.get(t,e)).init(),t.onBeforeRender(F,t,e,n||L),it.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),tt.setFromProjectionMatrix(it),rt=this.localClippingEnabled,nt=et.init(this.clippingPlanes,rt,e),(d=S.get(t,e)).init(),bt(t,e,0,F.sortObjects),d.finish(),!0===F.sortObjects&&d.sort(Y,J),nt&&et.beginShadows();var i=f.state.shadowsArray;lt.render(i,t,e),f.setupLights(e),nt&&et.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),E.render(d,t,e,r);var o=d.opaque,a=d.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;o.length&&xt(o,t,e,s),a.length&&xt(a,t,e,s)}else o.length&&xt(o,t,e),a.length&&xt(a,t,e);t.onAfterRender(F,t,e),null!==L&&(b.updateRenderTargetMipmap(L),b.updateMultisampleRenderTarget(L)),v.buffers.depth.setTest(!0),v.buffers.depth.setMask(!0),v.buffers.color.setMask(!0),v.setPolygonOffset(!1),d=null,f=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(t){N!==t&&null===L&&h.bindFramebuffer(36160,t),N=t},this.getActiveCubeFace=function(){return O},this.getActiveMipmapLevel=function(){return U},this.getRenderTarget=function(){return L},this.setRenderTarget=function(t,e,n){L=t,O=e,U=n,t&&void 0===y.get(t).__webglFramebuffer&&b.setupRenderTarget(t);var r=N,i=!1;if(t){var o=y.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=o[e||0],i=!0):r=t.isWebGLMultisampleRenderTarget?y.get(t).__webglMultisampledFramebuffer:o,z.copy(t.viewport),X.copy(t.scissor),W=t.scissorTest}else z.copy(q).multiplyScalar(Q).floor(),X.copy(K).multiplyScalar(Q).floor(),W=$;if(G!==r&&(h.bindFramebuffer(36160,r),G=r),v.viewport(z),v.scissor(X),v.setScissorTest(W),i){var a=y.get(t.texture);h.framebufferTexture2D(36160,36064,34069+(e||0),a.__webglTexture,n||0)}},this.readRenderTargetPixels=function(t,e,n,r,i,o,a){if(t&&t.isWebGLRenderTarget){var s=y.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){var u=!1;s!==G&&(h.bindFramebuffer(36160,s),u=!0);try{var c=t.texture,l=c.format,d=c.type;if(l!==Kt&&C.convert(l)!==h.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(d!==Gt&&C.convert(d)!==h.getParameter(35738)&&(d!==Xt||!(m.isWebGL2||p.get("OES_texture_float")||p.get("WEBGL_color_buffer_float")))&&(d!==Wt||!(m.isWebGL2?p.get("EXT_color_buffer_float"):p.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===h.checkFramebufferStatus(36160)?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&h.readPixels(e,n,r,i,C.convert(l),C.convert(d),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{u&&h.bindFramebuffer(36160,G)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,n){void 0===n&&(n=0);var r=Math.pow(2,-n),i=Math.floor(e.image.width*r),o=Math.floor(e.image.height*r),a=C.convert(e.format);b.setTexture2D(e,0),h.copyTexImage2D(3553,n,a,t.x,t.y,i,o,0),v.unbindTexture()},this.copyTextureToTexture=function(t,e,n,r){var i=e.image.width,o=e.image.height,a=C.convert(n.format),s=C.convert(n.type);b.setTexture2D(n,0),e.isDataTexture?h.texSubImage2D(3553,r||0,t.x,t.y,i,o,a,s,e.image.data):h.texSubImage2D(3553,r||0,t.x,t.y,a,s,e.image),v.unbindTexture()},this.initTexture=function(t){b.setTexture2D(t,0),v.unbindTexture()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Xs(t,e){this.name="",this.color=new Mi(t),this.density=void 0!==e?e:25e-5}function Ws(t,e,n){this.name="",this.color=new Mi(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function js(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=Ln,this.updateRange={offset:0,count:-1},this.version=0}Vs.prototype=Object.assign(Object.create(Po.prototype),{constructor:Vs,isArrayCamera:!0}),Hs.prototype=Object.assign(Object.create(Nr.prototype),{constructor:Hs,isGroup:!0}),Object.assign(ks.prototype,jn.prototype),Object.assign(Xs.prototype,{isFogExp2:!0,clone:function(){return new Xs(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Ws.prototype,{isFog:!0,clone:function(){return new Ws(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(js.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(js.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var Zs,Qs=new ur;function Ys(t,e,n,r){this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function Js(t){Ci.call(this),this.type="SpriteMaterial",this.color=new Mi(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}Object.defineProperties(Ys.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Ys.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var e=0,n=this.data.count;e<n;e++)Qs.x=this.getX(e),Qs.y=this.getY(e),Qs.z=this.getZ(e),Qs.applyMatrix4(t),this.setXYZ(e,Qs.x,Qs.y,Qs.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}}),Js.prototype=Object.create(Ci.prototype),Js.prototype.constructor=Js,Js.prototype.isSpriteMaterial=!0,Js.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var qs=new ur,Ks=new ur,$s=new ur,tu=new qn,eu=new qn,nu=new vr,ru=new ur,iu=new ur,ou=new ur,au=new qn,su=new qn,uu=new qn;function cu(t){if(Nr.call(this),this.type="Sprite",void 0===Zs){Zs=new $i;var e=new js(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Zs.setIndex([0,1,2,0,2,3]),Zs.setAttribute("position",new Ys(e,3,0,!1)),Zs.setAttribute("uv",new Ys(e,2,3,!1))}this.geometry=Zs,this.material=void 0!==t?t:new Js,this.center=new qn(.5,.5)}function lu(t,e,n,r,i,o){tu.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(eu.x=o*tu.x-i*tu.y,eu.y=i*tu.x+o*tu.y):eu.copy(tu),t.copy(e),t.x+=eu.x,t.y+=eu.y,t.applyMatrix4(nu)}cu.prototype=Object.assign(Object.create(Nr.prototype),{constructor:cu,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ks.setFromMatrixScale(this.matrixWorld),nu.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),$s.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ks.multiplyScalar(-$s.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var o=this.center;lu(ru.set(-.5,-.5,0),$s,o,Ks,n,r),lu(iu.set(.5,-.5,0),$s,o,Ks,n,r),lu(ou.set(.5,.5,0),$s,o,Ks,n,r),au.set(0,0),su.set(1,0),uu.set(1,1);var a=t.ray.intersectTriangle(ru,iu,ou,!1,qs);if(null!==a||(lu(iu.set(-.5,.5,0),$s,o,Ks,n,r),su.set(0,1),null!==(a=t.ray.intersectTriangle(ru,ou,iu,!1,qs)))){var s=t.ray.origin.distanceTo(qs);s<t.near||s>t.far||e.push({distance:s,point:qs.clone(),uv:_i.getUV(qs,ru,iu,ou,au,su,uu,new qn),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return Nr.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}});var du=new ur,fu=new ur;function hu(){Nr.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function pu(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),yo.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new vr,this.bindMatrixInverse=new vr}hu.prototype=Object.assign(Object.create(Nr.prototype),{constructor:hu,isLOD:!0,copy:function(t){Nr.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,r=e.length;n<r;n++){var i=e[n];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);return n.splice(r,0,{distance:e,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var e=this.levels;if(e.length>0){for(var n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object}return null},raycast:function(t,e){if(this.levels.length>0){du.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(du);this.getObjectForDistance(n).raycast(t,e)}},update:function(t){var e=this.levels;if(e.length>1){du.setFromMatrixPosition(t.matrixWorld),fu.setFromMatrixPosition(this.matrixWorld);var n=du.distanceTo(fu)/t.zoom;e[0].object.visible=!0;for(var r=1,i=e.length;r<i&&n>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(this._currentLevel=r-1;r<i;r++)e[r].object.visible=!1}},toJSON:function(t){var e=Nr.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),pu.prototype=Object.assign(Object.create(yo.prototype),{constructor:pu,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new nr,e=this.geometry.attributes.skinWeight,n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);var i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){yo.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var mu=new vr,vu=new vr;function gu(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new vr)}}function yu(){Nr.call(this),this.type="Bone"}Object.assign(gu.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new vr;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=t.length;i<o;i++){var a=t[i]?t[i].matrixWorld:vu;mu.multiplyMatrices(a,e[i]),mu.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)},clone:function(){return new gu(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var r=this.bones[e];if(r.name===t)return r}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),yu.prototype=Object.assign(Object.create(Nr.prototype),{constructor:yu,isBone:!0});var bu=new vr,xu=new vr,_u=[],wu=new yo;function Tu(t,e,n){yo.call(this,t,e),this.instanceMatrix=new Ni(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function Su(t){Ci.call(this),this.type="LineBasicMaterial",this.color=new Mi(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}Tu.prototype=Object.assign(Object.create(yo.prototype),{constructor:Tu,isInstancedMesh:!0,getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){var n=this.matrixWorld,r=this.count;if(wu.geometry=this.geometry,wu.material=this.material,void 0!==wu.material)for(var i=0;i<r;i++)this.getMatrixAt(i,bu),xu.multiplyMatrices(n,bu),wu.matrixWorld=xu,wu.raycast(t,_u),_u.length>0&&(_u[0].instanceId=i,_u[0].object=this,e.push(_u[0]),_u.length=0)},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),Su.prototype=Object.create(Ci.prototype),Su.prototype.constructor=Su,Su.prototype.isLineBasicMaterial=!0,Su.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this};var Mu=new ur,Eu=new ur,Ru=new vr,Iu=new ai,Bu=new Kr;function Au(t,e,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Nr.call(this),this.type="Line",this.geometry=void 0!==t?t:new $i,this.material=void 0!==e?e:new Su}Au.prototype=Object.assign(Object.create(Nr.prototype),{constructor:Au,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[0],r=1,i=e.count;r<i;r++)Mu.fromBufferAttribute(e,r-1),Eu.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=Mu.distanceTo(Eu);t.setAttribute("lineDistance",new ki(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var o=t.vertices;(n=t.lineDistances)[0]=0;for(r=1,i=o.length;r<i;r++)n[r]=n[r-1],n[r]+=o[r-1].distanceTo(o[r])}return this},raycast:function(t,e){var n=this.geometry,r=this.matrixWorld,i=t.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Bu.copy(n.boundingSphere),Bu.applyMatrix4(r),Bu.radius+=i,!1!==t.ray.intersectsSphere(Bu)){Ru.getInverse(r),Iu.copy(t.ray).applyMatrix4(Ru);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,s=new ur,u=new ur,c=new ur,l=new ur,d=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var f=n.index,h=n.attributes.position.array;if(null!==f)for(var p=f.array,m=0,v=p.length-1;m<v;m+=d){var g=p[m],y=p[m+1];if(s.fromArray(h,3*g),u.fromArray(h,3*y),!(Iu.distanceSqToSegment(s,u,l,c)>a))l.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(l))<t.near||_>t.far||e.push({distance:_,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}else for(m=0,v=h.length/3-1;m<v;m+=d){if(s.fromArray(h,3*m),u.fromArray(h,3*m+3),!(Iu.distanceSqToSegment(s,u,l,c)>a))l.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(l))<t.near||_>t.far||e.push({distance:_,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){var b=n.vertices,x=b.length;for(m=0;m<x-1;m+=d){var _;if(!(Iu.distanceSqToSegment(b[m],b[m+1],l,c)>a))l.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(l))<t.near||_>t.far||e.push({distance:_,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Cu=new ur,Fu=new ur;function Pu(t,e){Au.call(this,t,e),this.type="LineSegments"}function Nu(t,e){Au.call(this,t,e),this.type="LineLoop"}function Ou(t){Ci.call(this),this.type="PointsMaterial",this.color=new Mi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}Pu.prototype=Object.assign(Object.create(Au.prototype),{constructor:Pu,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[],r=0,i=e.count;r<i;r+=2)Cu.fromBufferAttribute(e,r),Fu.fromBufferAttribute(e,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Cu.distanceTo(Fu);t.setAttribute("lineDistance",new ki(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var o=t.vertices;for(n=t.lineDistances,r=0,i=o.length;r<i;r+=2)Cu.copy(o[r]),Fu.copy(o[r+1]),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Cu.distanceTo(Fu)}return this}}),Nu.prototype=Object.assign(Object.create(Au.prototype),{constructor:Nu,isLineLoop:!0}),Ou.prototype=Object.create(Ci.prototype),Ou.prototype.constructor=Ou,Ou.prototype.isPointsMaterial=!0,Ou.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var Uu=new vr,Lu=new ai,Gu=new Kr,Du=new ur;function Vu(t,e){Nr.call(this),this.type="Points",this.geometry=void 0!==t?t:new $i,this.material=void 0!==e?e:new Ou,this.updateMorphTargets()}function Hu(t,e,n,r,i,o,a){var s=Lu.distanceSqToPoint(t);if(s<n){var u=new ur;Lu.closestPointToPoint(t,u),u.applyMatrix4(r);var c=i.ray.origin.distanceTo(u);if(c<i.near||c>i.far)return;o.push({distance:c,distanceToRay:Math.sqrt(s),point:u,index:e,face:null,object:a})}}function ku(t,e,n,r,i,o,a,s,u){er.call(this,t,e,n,r,i,o,a,s,u),this.format=void 0!==a?a:qt,this.minFilter=void 0!==o?o:Pt,this.magFilter=void 0!==i?i:Pt,this.generateMipmaps=!1}function zu(t,e,n,r,i,o,a,s,u,c,l,d){er.call(this,null,o,a,s,u,c,r,i,l,d),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Xu(t,e,n,r,i,o,a,s,u){er.call(this,t,e,n,r,i,o,a,s,u),this.needsUpdate=!0}function Wu(t,e,n,r,i,o,a,s,u,c){if((c=void 0!==c?c:ne)!==ne&&c!==re)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===ne&&(n=Ht),void 0===n&&c===re&&(n=Yt),er.call(this,null,r,i,o,a,s,c,n,u),this.image={width:t,height:e},this.magFilter=void 0!==a?a:It,this.minFilter=void 0!==s?s:It,this.flipY=!1,this.generateMipmaps=!1}function ju(t){$i.call(this),this.type="WireframeGeometry";var e,n,r,i,o,a,s,u,c,l,d=[],f=[0,0],h={},p=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,r=m.length;e<r;e++){var v=m[e];for(n=0;n<3;n++)s=v[p[n]],u=v[p[(n+1)%3]],f[0]=Math.min(s,u),f[1]=Math.max(s,u),void 0===h[c=f[0]+","+f[1]]&&(h[c]={index1:f[0],index2:f[1]})}for(c in h)a=h[c],l=t.vertices[a.index1],d.push(l.x,l.y,l.z),l=t.vertices[a.index2],d.push(l.x,l.y,l.z)}else if(t&&t.isBufferGeometry){var g,y,b,x,_,w,T;if(l=new ur,null!==t.index){for(g=t.attributes.position,y=t.index,0===(b=t.groups).length&&(b=[{start:0,count:y.count,materialIndex:0}]),i=0,o=b.length;i<o;++i)for(e=_=(x=b[i]).start,r=_+x.count;e<r;e+=3)for(n=0;n<3;n++)s=y.getX(e+n),u=y.getX(e+(n+1)%3),f[0]=Math.min(s,u),f[1]=Math.max(s,u),void 0===h[c=f[0]+","+f[1]]&&(h[c]={index1:f[0],index2:f[1]});for(c in h)a=h[c],l.fromBufferAttribute(g,a.index1),d.push(l.x,l.y,l.z),l.fromBufferAttribute(g,a.index2),d.push(l.x,l.y,l.z)}else for(e=0,r=(g=t.attributes.position).count/3;e<r;e++)for(n=0;n<3;n++)w=3*e+n,l.fromBufferAttribute(g,w),d.push(l.x,l.y,l.z),T=3*e+(n+1)%3,l.fromBufferAttribute(g,T),d.push(l.x,l.y,l.z)}this.setAttribute("position",new ki(d,3))}function Zu(t,e,n){Mo.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new Qu(t,e,n)),this.mergeVertices()}function Qu(t,e,n){$i.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r,i,o=[],a=[],s=[],u=[],c=1e-5,l=new ur,d=new ur,f=new ur,h=new ur,p=new ur;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var m=e+1;for(r=0;r<=n;r++){var v=r/n;for(i=0;i<=e;i++){var g=i/e;t(g,v,d),a.push(d.x,d.y,d.z),g-c>=0?(t(g-c,v,f),h.subVectors(d,f)):(t(g+c,v,f),h.subVectors(f,d)),v-c>=0?(t(g,v-c,f),p.subVectors(d,f)):(t(g,v+c,f),p.subVectors(f,d)),l.crossVectors(h,p).normalize(),s.push(l.x,l.y,l.z),u.push(g,v)}}for(r=0;r<n;r++)for(i=0;i<e;i++){var y=r*m+i,b=r*m+i+1,x=(r+1)*m+i+1,_=(r+1)*m+i;o.push(y,b,_),o.push(b,x,_)}this.setIndex(o),this.setAttribute("position",new ki(a,3)),this.setAttribute("normal",new ki(s,3)),this.setAttribute("uv",new ki(u,2))}function Yu(t,e,n,r){Mo.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new Ju(t,e,n,r)),this.mergeVertices()}function Ju(t,e,n,r){$i.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;var i=[],o=[];function a(t,e,n,r){var i,o,a=Math.pow(2,r),u=[];for(i=0;i<=a;i++){u[i]=[];var c=t.clone().lerp(n,i/a),l=e.clone().lerp(n,i/a),d=a-i;for(o=0;o<=d;o++)u[i][o]=0===o&&i===a?c:c.clone().lerp(l,o/d)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var f=Math.floor(o/2);o%2===0?(s(u[i][f+1]),s(u[i+1][f]),s(u[i][f])):(s(u[i][f+1]),s(u[i+1][f+1]),s(u[i+1][f]))}}function s(t){i.push(t.x,t.y,t.z)}function u(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function c(t,e,n,r){r<0&&1===t.x&&(o[e]=t.x-1),0===n.x&&0===n.z&&(o[e]=r/2/Math.PI+.5)}function l(t){return Math.atan2(t.z,-t.x)}!function(t){for(var n=new ur,r=new ur,i=new ur,o=0;o<e.length;o+=3)u(e[o+0],n),u(e[o+1],r),u(e[o+2],i),a(n,r,i,t)}(r=r||0),function(t){for(var e=new ur,n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){for(var t=new ur,e=0;e<i.length;e+=3){t.x=i[e+0],t.y=i[e+1],t.z=i[e+2];var n=l(t)/2/Math.PI+.5,r=(a=t,Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5);o.push(n,1-r)}var a;(function(){for(var t=new ur,e=new ur,n=new ur,r=new ur,a=new qn,s=new qn,u=new qn,d=0,f=0;d<i.length;d+=9,f+=6){t.set(i[d+0],i[d+1],i[d+2]),e.set(i[d+3],i[d+4],i[d+5]),n.set(i[d+6],i[d+7],i[d+8]),a.set(o[f+0],o[f+1]),s.set(o[f+2],o[f+3]),u.set(o[f+4],o[f+5]),r.copy(t).add(e).add(n).divideScalar(3);var h=l(r);c(a,f+0,t,h),c(s,f+2,e,h),c(u,f+4,n,h)}})(),function(){for(var t=0;t<o.length;t+=6){var e=o[t+0],n=o[t+2],r=o[t+4],i=Math.max(e,n,r),a=Math.min(e,n,r);i>.9&&a<.1&&(e<.2&&(o[t+0]+=1),n<.2&&(o[t+2]+=1),r<.2&&(o[t+4]+=1))}}()}(),this.setAttribute("position",new ki(i,3)),this.setAttribute("normal",new ki(i.slice(),3)),this.setAttribute("uv",new ki(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function qu(t,e){Mo.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ku(t,e)),this.mergeVertices()}function Ku(t,e){Ju.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function $u(t,e){Mo.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new tc(t,e)),this.mergeVertices()}function tc(t,e){Ju.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ec(t,e){Mo.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new nc(t,e)),this.mergeVertices()}function nc(t,e){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];Ju.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function rc(t,e){Mo.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ic(t,e)),this.mergeVertices()}function ic(t,e){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];Ju.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function oc(t,e,n,r,i,o){Mo.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new ac(t,e,n,r,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function ac(t,e,n,r,i){$i.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},e=e||64,n=n||1,r=r||8,i=i||!1;var o=t.computeFrenetFrames(e,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,u=new ur,c=new ur,l=new qn,d=new ur,f=[],h=[],p=[],m=[];function v(i){d=t.getPointAt(i/e,d);var a=o.normals[i],l=o.binormals[i];for(s=0;s<=r;s++){var p=s/r*Math.PI*2,m=Math.sin(p),v=-Math.cos(p);c.x=v*a.x+m*l.x,c.y=v*a.y+m*l.y,c.z=v*a.z+m*l.z,c.normalize(),h.push(c.x,c.y,c.z),u.x=d.x+n*c.x,u.y=d.y+n*c.y,u.z=d.z+n*c.z,f.push(u.x,u.y,u.z)}}!function(){for(a=0;a<e;a++)v(a);v(!1===i?e:0),function(){for(a=0;a<=e;a++)for(s=0;s<=r;s++)l.x=a/e,l.y=s/r,p.push(l.x,l.y)}(),function(){for(s=1;s<=e;s++)for(a=1;a<=r;a++){var t=(r+1)*(s-1)+(a-1),n=(r+1)*s+(a-1),i=(r+1)*s+a,o=(r+1)*(s-1)+a;m.push(t,n,o),m.push(n,i,o)}}()}(),this.setIndex(m),this.setAttribute("position",new ki(f,3)),this.setAttribute("normal",new ki(h,3)),this.setAttribute("uv",new ki(p,2))}function sc(t,e,n,r,i,o,a){Mo.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new uc(t,e,n,r,i,o)),this.mergeVertices()}function uc(t,e,n,r,i,o){$i.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;var a,s,u=[],c=[],l=[],d=[],f=new ur,h=new ur,p=new ur,m=new ur,v=new ur,g=new ur,y=new ur;for(a=0;a<=n;++a){var b=a/n*i*Math.PI*2;for(R(b,i,o,t,p),R(b+.01,i,o,t,m),g.subVectors(m,p),y.addVectors(m,p),v.crossVectors(g,y),y.crossVectors(v,g),v.normalize(),y.normalize(),s=0;s<=r;++s){var x=s/r*Math.PI*2,_=-e*Math.cos(x),w=e*Math.sin(x);f.x=p.x+(_*y.x+w*v.x),f.y=p.y+(_*y.y+w*v.y),f.z=p.z+(_*y.z+w*v.z),c.push(f.x,f.y,f.z),h.subVectors(f,p).normalize(),l.push(h.x,h.y,h.z),d.push(a/n),d.push(s/r)}}for(s=1;s<=n;s++)for(a=1;a<=r;a++){var T=(r+1)*(s-1)+(a-1),S=(r+1)*s+(a-1),M=(r+1)*s+a,E=(r+1)*(s-1)+a;u.push(T,S,E),u.push(S,M,E)}function R(t,e,n,r,i){var o=Math.cos(t),a=Math.sin(t),s=n/e*t,u=Math.cos(s);i.x=r*(2+u)*.5*o,i.y=r*(2+u)*a*.5,i.z=r*Math.sin(s)*.5}this.setIndex(u),this.setAttribute("position",new ki(c,3)),this.setAttribute("normal",new ki(l,3)),this.setAttribute("uv",new ki(d,2))}function cc(t,e,n,r,i){Mo.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new lc(t,e,n,r,i)),this.mergeVertices()}function lc(t,e,n,r,i){$i.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o,a,s=[],u=[],c=[],l=[],d=new ur,f=new ur,h=new ur;for(o=0;o<=n;o++)for(a=0;a<=r;a++){var p=a/r*i,m=o/n*Math.PI*2;f.x=(t+e*Math.cos(m))*Math.cos(p),f.y=(t+e*Math.cos(m))*Math.sin(p),f.z=e*Math.sin(m),u.push(f.x,f.y,f.z),d.x=t*Math.cos(p),d.y=t*Math.sin(p),h.subVectors(f,d).normalize(),c.push(h.x,h.y,h.z),l.push(a/r),l.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=r;a++){var v=(r+1)*o+a-1,g=(r+1)*(o-1)+a-1,y=(r+1)*(o-1)+a,b=(r+1)*o+a;s.push(v,g,b),s.push(g,y,b)}this.setIndex(s),this.setAttribute("position",new ki(u,3)),this.setAttribute("normal",new ki(c,3)),this.setAttribute("uv",new ki(l,2))}Vu.prototype=Object.assign(Object.create(Nr.prototype),{constructor:Vu,isPoints:!0,raycast:function(t,e){var n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Gu.copy(n.boundingSphere),Gu.applyMatrix4(r),Gu.radius+=i,!1!==t.ray.intersectsSphere(Gu)){Uu.getInverse(r),Lu.copy(t.ray).applyMatrix4(Uu);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(n.isBufferGeometry){var s=n.index,u=n.attributes.position.array;if(null!==s)for(var c=s.array,l=0,d=c.length;l<d;l++){var f=c[l];Du.fromArray(u,3*f),Hu(Du,f,a,r,t,e,this)}else{l=0;for(var h=u.length/3;l<h;l++)Du.fromArray(u,3*l),Hu(Du,l,a,r,t,e,this)}}else{var p=n.vertices;for(l=0,h=p.length;l<h;l++)Hu(p[l],l,a,r,t,e,this)}}},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ku.prototype=Object.assign(Object.create(er.prototype),{constructor:ku,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),zu.prototype=Object.create(er.prototype),zu.prototype.constructor=zu,zu.prototype.isCompressedTexture=!0,Xu.prototype=Object.create(er.prototype),Xu.prototype.constructor=Xu,Xu.prototype.isCanvasTexture=!0,Wu.prototype=Object.create(er.prototype),Wu.prototype.constructor=Wu,Wu.prototype.isDepthTexture=!0,ju.prototype=Object.create($i.prototype),ju.prototype.constructor=ju,Zu.prototype=Object.create(Mo.prototype),Zu.prototype.constructor=Zu,Qu.prototype=Object.create($i.prototype),Qu.prototype.constructor=Qu,Yu.prototype=Object.create(Mo.prototype),Yu.prototype.constructor=Yu,Ju.prototype=Object.create($i.prototype),Ju.prototype.constructor=Ju,qu.prototype=Object.create(Mo.prototype),qu.prototype.constructor=qu,Ku.prototype=Object.create(Ju.prototype),Ku.prototype.constructor=Ku,$u.prototype=Object.create(Mo.prototype),$u.prototype.constructor=$u,tc.prototype=Object.create(Ju.prototype),tc.prototype.constructor=tc,ec.prototype=Object.create(Mo.prototype),ec.prototype.constructor=ec,nc.prototype=Object.create(Ju.prototype),nc.prototype.constructor=nc,rc.prototype=Object.create(Mo.prototype),rc.prototype.constructor=rc,ic.prototype=Object.create(Ju.prototype),ic.prototype.constructor=ic,oc.prototype=Object.create(Mo.prototype),oc.prototype.constructor=oc,ac.prototype=Object.create($i.prototype),ac.prototype.constructor=ac,ac.prototype.toJSON=function(){var t=$i.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},sc.prototype=Object.create(Mo.prototype),sc.prototype.constructor=sc,uc.prototype=Object.create($i.prototype),uc.prototype.constructor=uc,cc.prototype=Object.create(Mo.prototype),cc.prototype.constructor=cc,lc.prototype=Object.create($i.prototype),lc.prototype.constructor=lc;var dc=function(t,e,n){n=n||2;var r,i,o,a,s,u,c,l=e&&e.length,d=l?e[0]*n:t.length,f=fc(t,0,d,n,!0),h=[];if(!f||f.next===f.prev)return h;if(l&&(f=function(t,e,n,r){var i,o,a,s,u,c=[];for(i=0,o=e.length;i<o;i++)a=e[i]*r,s=i<o-1?e[i+1]*r:t.length,(u=fc(t,a,s,r,!1))===u.next&&(u.steiner=!0),c.push(wc(u));for(c.sort(bc),i=0;i<c.length;i++)xc(c[i],n),n=hc(n,n.next);return n}(t,e,f,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var p=n;p<d;p+=n)(s=t[p])<r&&(r=s),(u=t[p+1])<i&&(i=u),s>o&&(o=s),u>a&&(a=u);c=0!==(c=Math.max(o-r,a-i))?1/c:0}return pc(f,h,n,r,i,c),h};function fc(t,e,n,r,i){var o,a;if(i===function(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)a=Ac(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=Ac(o,t[o],t[o+1],a);return a&&Ec(a,a.next)&&(Cc(a),a=a.next),a}function hc(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!Ec(r,r.next)&&0!==Mc(r.prev,r,r.next))r=r.next;else{if(Cc(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function pc(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=_c(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,o);for(var s,u,c=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?vc(t,r,i,o):mc(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),Cc(t),t=u.next,c=u.next;else if((t=u)===c){a?1===a?pc(t=gc(t,e,n),e,n,r,i,o,2):2===a&&yc(t,e,n,r,i,o):pc(hc(t),e,n,r,i,o,1);break}}}function mc(t){var e=t.prev,n=t,r=t.next;if(Mc(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(Tc(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Mc(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function vc(t,e,n,r){var i=t.prev,o=t,a=t.next;if(Mc(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,d=_c(s,u,e,n,r),f=_c(c,l,e,n,r),h=t.prevZ,p=t.nextZ;h&&h.z>=d&&p&&p.z<=f;){if(h!==t.prev&&h!==t.next&&Tc(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&Mc(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,p!==t.prev&&p!==t.next&&Tc(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Mc(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;h&&h.z>=d;){if(h!==t.prev&&h!==t.next&&Tc(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&Mc(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;p&&p.z<=f;){if(p!==t.prev&&p!==t.next&&Tc(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Mc(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function gc(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!Ec(i,o)&&Rc(i,r,r.next,o)&&Ic(i,o)&&Ic(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),Cc(r),Cc(r.next),r=t=o),r=r.next}while(r!==t);return r}function yc(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Sc(a,s)){var u=Bc(a,s);return a=hc(a,a.next),u=hc(u,u.next),pc(a,e,n,r,i,o),void pc(u,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function bc(t,e){return t.x-e.x}function xc(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var u,c=n,l=n.x,d=n.y,f=1/0;r=n.next;for(;r!==c;)i>=r.x&&r.x>=l&&i!==r.x&&Tc(o<d?i:a,o,l,d,o<d?a:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<f||u===f&&r.x>n.x)&&Ic(r,t)&&(n=r,f=u),r=r.next;return n}(t,e)){var n=Bc(e,t);hc(n,n.next)}}function _c(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function wc(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Tc(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Sc(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Rc(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&Ic(t,e)&&Ic(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function Mc(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ec(t,e){return t.x===e.x&&t.y===e.y}function Rc(t,e,n,r){return!!(Ec(t,n)&&Ec(e,r)||Ec(t,r)&&Ec(n,e))||Mc(t,e,n)>0!==Mc(t,e,r)>0&&Mc(n,r,t)>0!==Mc(n,r,e)>0}function Ic(t,e){return Mc(t.prev,t,t.next)<0?Mc(t,e,t.next)>=0&&Mc(t,t.prev,e)>=0:Mc(t,e,t.prev)<0||Mc(t,t.next,e)<0}function Bc(t,e){var n=new Fc(t.i,t.x,t.y),r=new Fc(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Ac(t,e,n,r){var i=new Fc(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Cc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Fc(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Pc={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return Pc.area(t)<0},triangulateShape:function(t,e){var n=[],r=[],i=[];Nc(t),Oc(n,t);var o=t.length;e.forEach(Nc);for(var a=0;a<e.length;a++)r.push(o),o+=e[a].length,Oc(n,e[a]);var s=dc(n,r);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};function Nc(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Oc(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function Uc(t,e){Mo.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Lc(t,e)),this.mergeVertices()}function Lc(t,e){$i.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];for(var n=this,r=[],i=[],o=0,a=t.length;o<a;o++){s(t[o])}function s(t){var o=[],a=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1,u=void 0!==e.depth?e.depth:100,c=void 0===e.bevelEnabled||e.bevelEnabled,l=void 0!==e.bevelThickness?e.bevelThickness:6,d=void 0!==e.bevelSize?e.bevelSize:l-2,f=void 0!==e.bevelOffset?e.bevelOffset:0,h=void 0!==e.bevelSegments?e.bevelSegments:3,p=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:Gc;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=e.amount);var v,g,y,b,x,_,w,T,S=!1;p&&(v=p.getSpacedPoints(s),S=!0,c=!1,g=p.computeFrenetFrames(s,!1),y=new ur,b=new ur,x=new ur),c||(h=0,l=0,d=0,f=0);var M=t.extractPoints(a),E=M.shape,R=M.holes;if(!Pc.isClockWise(E))for(E=E.reverse(),w=0,T=R.length;w<T;w++)_=R[w],Pc.isClockWise(_)&&(R[w]=_.reverse());var I=Pc.triangulateShape(E,R),B=E;for(w=0,T=R.length;w<T;w++)_=R[w],E=E.concat(_);function A(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}var C,F,P,N,O,U,L=E.length,G=I.length;function D(t,e,n){var r,i,o,a=t.x-e.x,s=t.y-e.y,u=n.x-t.x,c=n.y-t.y,l=a*a+s*s,d=a*c-s*u;if(Math.abs(d)>Number.EPSILON){var f=Math.sqrt(l),h=Math.sqrt(u*u+c*c),p=e.x-s/f,m=e.y+a/f,v=((n.x-c/h-p)*c-(n.y+u/h-m)*u)/(a*c-s*u),g=(r=p+a*v-t.x)*r+(i=m+s*v-t.y)*i;if(g<=2)return new qn(r,i);o=Math.sqrt(g/2)}else{var y=!1;a>Number.EPSILON?u>Number.EPSILON&&(y=!0):a<-Number.EPSILON?u<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(c)&&(y=!0),y?(r=-s,i=a,o=Math.sqrt(l)):(r=a,i=s,o=Math.sqrt(l/2))}return new qn(r/o,i/o)}for(var V=[],H=0,k=B.length,z=k-1,X=H+1;H<k;H++,z++,X++)z===k&&(z=0),X===k&&(X=0),V[H]=D(B[H],B[z],B[X]);var W,j,Z=[],Q=V.concat();for(w=0,T=R.length;w<T;w++){for(_=R[w],W=[],H=0,z=(k=_.length)-1,X=H+1;H<k;H++,z++,X++)z===k&&(z=0),X===k&&(X=0),W[H]=D(_[H],_[z],_[X]);Z.push(W),Q=Q.concat(W)}for(C=0;C<h;C++){for(P=C/h,N=l*Math.cos(P*Math.PI/2),F=d*Math.sin(P*Math.PI/2)+f,H=0,k=B.length;H<k;H++)J((O=A(B[H],V[H],F)).x,O.y,-N);for(w=0,T=R.length;w<T;w++)for(_=R[w],W=Z[w],H=0,k=_.length;H<k;H++)J((O=A(_[H],W[H],F)).x,O.y,-N)}for(F=d+f,H=0;H<L;H++)O=c?A(E[H],Q[H],F):E[H],S?(b.copy(g.normals[0]).multiplyScalar(O.x),y.copy(g.binormals[0]).multiplyScalar(O.y),x.copy(v[0]).add(b).add(y),J(x.x,x.y,x.z)):J(O.x,O.y,0);for(j=1;j<=s;j++)for(H=0;H<L;H++)O=c?A(E[H],Q[H],F):E[H],S?(b.copy(g.normals[j]).multiplyScalar(O.x),y.copy(g.binormals[j]).multiplyScalar(O.y),x.copy(v[j]).add(b).add(y),J(x.x,x.y,x.z)):J(O.x,O.y,u/s*j);for(C=h-1;C>=0;C--){for(P=C/h,N=l*Math.cos(P*Math.PI/2),F=d*Math.sin(P*Math.PI/2)+f,H=0,k=B.length;H<k;H++)J((O=A(B[H],V[H],F)).x,O.y,u+N);for(w=0,T=R.length;w<T;w++)for(_=R[w],W=Z[w],H=0,k=_.length;H<k;H++)O=A(_[H],W[H],F),S?J(O.x,O.y+v[s-1].y,v[s-1].x+N):J(O.x,O.y,u+N)}function Y(t,e){var n,r;for(H=t.length;--H>=0;){n=H,(r=H-1)<0&&(r=t.length-1);var i=0,o=s+2*h;for(i=0;i<o;i++){var a=L*i,u=L*(i+1);K(e+n+a,e+r+a,e+r+u,e+n+u)}}}function J(t,e,n){o.push(t),o.push(e),o.push(n)}function q(t,e,i){$(t),$(e),$(i);var o=r.length/3,a=m.generateTopUV(n,r,o-3,o-2,o-1);tt(a[0]),tt(a[1]),tt(a[2])}function K(t,e,i,o){$(t),$(e),$(o),$(e),$(i),$(o);var a=r.length/3,s=m.generateSideWallUV(n,r,a-6,a-3,a-2,a-1);tt(s[0]),tt(s[1]),tt(s[3]),tt(s[1]),tt(s[2]),tt(s[3])}function $(t){r.push(o[3*t+0]),r.push(o[3*t+1]),r.push(o[3*t+2])}function tt(t){i.push(t.x),i.push(t.y)}!function(){var t=r.length/3;if(c){var e=0,i=L*e;for(H=0;H<G;H++)q((U=I[H])[2]+i,U[1]+i,U[0]+i);for(i=L*(e=s+2*h),H=0;H<G;H++)q((U=I[H])[0]+i,U[1]+i,U[2]+i)}else{for(H=0;H<G;H++)q((U=I[H])[2],U[1],U[0]);for(H=0;H<G;H++)q((U=I[H])[0]+L*s,U[1]+L*s,U[2]+L*s)}n.addGroup(t,r.length/3-t,0)}(),function(){var t=r.length/3,e=0;for(Y(B,e),e+=B.length,w=0,T=R.length;w<T;w++)Y(_=R[w],e),e+=_.length;n.addGroup(t,r.length/3-t,1)}()}this.setAttribute("position",new ki(r,3)),this.setAttribute("uv",new ki(i,2)),this.computeVertexNormals()}Uc.prototype=Object.create(Mo.prototype),Uc.prototype.constructor=Uc,Uc.prototype.toJSON=function(){var t=Mo.prototype.toJSON.call(this);return Dc(this.parameters.shapes,this.parameters.options,t)},Lc.prototype=Object.create($i.prototype),Lc.prototype.constructor=Lc,Lc.prototype.toJSON=function(){var t=$i.prototype.toJSON.call(this);return Dc(this.parameters.shapes,this.parameters.options,t)};var Gc={generateTopUV:function(t,e,n,r,i){var o=e[3*n],a=e[3*n+1],s=e[3*r],u=e[3*r+1],c=e[3*i],l=e[3*i+1];return[new qn(o,a),new qn(s,u),new qn(c,l)]},generateSideWallUV:function(t,e,n,r,i,o){var a=e[3*n],s=e[3*n+1],u=e[3*n+2],c=e[3*r],l=e[3*r+1],d=e[3*r+2],f=e[3*i],h=e[3*i+1],p=e[3*i+2],m=e[3*o],v=e[3*o+1],g=e[3*o+2];return Math.abs(s-l)<.01?[new qn(a,1-u),new qn(c,1-d),new qn(f,1-p),new qn(m,1-g)]:[new qn(s,1-u),new qn(l,1-d),new qn(h,1-p),new qn(v,1-g)]}};function Dc(t,e,n){if(n.shapes=[],Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var o=t[r];n.shapes.push(o.uuid)}else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}function Vc(t,e){Mo.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Hc(t,e)),this.mergeVertices()}function Hc(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Mo;var r=n.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Lc.call(this,r,e),this.type="TextBufferGeometry"}function kc(t,e,n,r,i,o,a){Mo.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new zc(t,e,n,r,i,o,a)),this.mergeVertices()}function zc(t,e,n,r,i,o,a){$i.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;var s,u,c=Math.min(o+a,Math.PI),l=0,d=[],f=new ur,h=new ur,p=[],m=[],v=[],g=[];for(u=0;u<=n;u++){var y=[],b=u/n,x=0;for(0==u&&0==o?x=.5/e:u==n&&c==Math.PI&&(x=-.5/e),s=0;s<=e;s++){var _=s/e;f.x=-t*Math.cos(r+_*i)*Math.sin(o+b*a),f.y=t*Math.cos(o+b*a),f.z=t*Math.sin(r+_*i)*Math.sin(o+b*a),m.push(f.x,f.y,f.z),h.copy(f).normalize(),v.push(h.x,h.y,h.z),g.push(_+x,1-b),y.push(l++)}d.push(y)}for(u=0;u<n;u++)for(s=0;s<e;s++){var w=d[u][s+1],T=d[u][s],S=d[u+1][s],M=d[u+1][s+1];(0!==u||o>0)&&p.push(w,T,M),(u!==n-1||c<Math.PI)&&p.push(T,S,M)}this.setIndex(p),this.setAttribute("position",new ki(m,3)),this.setAttribute("normal",new ki(v,3)),this.setAttribute("uv",new ki(g,2))}function Xc(t,e,n,r,i,o){Mo.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new Wc(t,e,n,r,i,o)),this.mergeVertices()}function Wc(t,e,n,r,i,o){$i.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},t=t||.5,e=e||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var a,s,u,c=[],l=[],d=[],f=[],h=t,p=(e-t)/(r=void 0!==r?Math.max(1,r):1),m=new ur,v=new qn;for(s=0;s<=r;s++){for(u=0;u<=n;u++)a=i+u/n*o,m.x=h*Math.cos(a),m.y=h*Math.sin(a),l.push(m.x,m.y,m.z),d.push(0,0,1),v.x=(m.x/e+1)/2,v.y=(m.y/e+1)/2,f.push(v.x,v.y);h+=p}for(s=0;s<r;s++){var g=s*(n+1);for(u=0;u<n;u++){var y=a=u+g,b=a+n+1,x=a+n+2,_=a+1;c.push(y,b,_),c.push(b,x,_)}}this.setIndex(c),this.setAttribute("position",new ki(l,3)),this.setAttribute("normal",new ki(d,3)),this.setAttribute("uv",new ki(f,2))}function jc(t,e,n,r){Mo.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new Zc(t,e,n,r)),this.mergeVertices()}function Zc(t,e,n,r){$i.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=Jn.clamp(r,0,2*Math.PI);var i,o,a,s=[],u=[],c=[],l=1/e,d=new ur,f=new qn;for(o=0;o<=e;o++){var h=n+o*l*r,p=Math.sin(h),m=Math.cos(h);for(a=0;a<=t.length-1;a++)d.x=t[a].x*p,d.y=t[a].y,d.z=t[a].x*m,u.push(d.x,d.y,d.z),f.x=o/e,f.y=a/(t.length-1),c.push(f.x,f.y)}for(o=0;o<e;o++)for(a=0;a<t.length-1;a++){var v=i=a+o*t.length,g=i+t.length,y=i+t.length+1,b=i+1;s.push(v,g,b),s.push(g,y,b)}if(this.setIndex(s),this.setAttribute("position",new ki(u,3)),this.setAttribute("uv",new ki(c,2)),this.computeVertexNormals(),r===2*Math.PI){var x=this.attributes.normal.array,_=new ur,w=new ur,T=new ur;for(i=e*t.length*3,o=0,a=0;o<t.length;o++,a+=3)_.x=x[a+0],_.y=x[a+1],_.z=x[a+2],w.x=x[i+a+0],w.y=x[i+a+1],w.z=x[i+a+2],T.addVectors(_,w).normalize(),x[a+0]=x[i+a+0]=T.x,x[a+1]=x[i+a+1]=T.y,x[a+2]=x[i+a+2]=T.z}}function Qc(t,e){Mo.call(this),this.type="ShapeGeometry","object"===typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Yc(t,e)),this.mergeVertices()}function Yc(t,e){$i.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],r=[],i=[],o=[],a=0,s=0;if(!1===Array.isArray(t))c(t);else for(var u=0;u<t.length;u++)c(t[u]),this.addGroup(a,s,u),a+=s,s=0;function c(t){var a,u,c,l=r.length/3,d=t.extractPoints(e),f=d.shape,h=d.holes;for(!1===Pc.isClockWise(f)&&(f=f.reverse()),a=0,u=h.length;a<u;a++)c=h[a],!0===Pc.isClockWise(c)&&(h[a]=c.reverse());var p=Pc.triangulateShape(f,h);for(a=0,u=h.length;a<u;a++)c=h[a],f=f.concat(c);for(a=0,u=f.length;a<u;a++){var m=f[a];r.push(m.x,m.y,0),i.push(0,0,1),o.push(m.x,m.y)}for(a=0,u=p.length;a<u;a++){var v=p[a],g=v[0]+l,y=v[1]+l,b=v[2]+l;n.push(g,y,b),s+=3}}this.setIndex(n),this.setAttribute("position",new ki(r,3)),this.setAttribute("normal",new ki(i,3)),this.setAttribute("uv",new ki(o,2))}function Jc(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}function qc(t,e){$i.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n,r,i,o,a=[],s=Math.cos(Jn.DEG2RAD*e),u=[0,0],c={},l=["a","b","c"];t.isBufferGeometry?(o=new Mo).fromBufferGeometry(t):o=t.clone(),o.mergeVertices(),o.computeFaceNormals();for(var d=o.vertices,f=o.faces,h=0,p=f.length;h<p;h++)for(var m=f[h],v=0;v<3;v++)n=m[l[v]],r=m[l[(v+1)%3]],u[0]=Math.min(n,r),u[1]=Math.max(n,r),void 0===c[i=u[0]+","+u[1]]?c[i]={index1:u[0],index2:u[1],face1:h,face2:void 0}:c[i].face2=h;for(i in c){var g=c[i];if(void 0===g.face2||f[g.face1].normal.dot(f[g.face2].normal)<=s){var y=d[g.index1];a.push(y.x,y.y,y.z),y=d[g.index2],a.push(y.x,y.y,y.z)}}this.setAttribute("position",new ki(a,3))}function Kc(t,e,n,r,i,o,a,s){Mo.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new $c(t,e,n,r,i,o,a,s)),this.mergeVertices()}function $c(t,e,n,r,i,o,a,s){$i.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var u=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var c=[],l=[],d=[],f=[],h=0,p=[],m=n/2,v=0;function g(n){var i,o,p,g=new qn,y=new ur,b=0,x=!0===n?t:e,_=!0===n?1:-1;for(o=h,i=1;i<=r;i++)l.push(0,m*_,0),d.push(0,_,0),f.push(.5,.5),h++;for(p=h,i=0;i<=r;i++){var w=i/r*s+a,T=Math.cos(w),S=Math.sin(w);y.x=x*S,y.y=m*_,y.z=x*T,l.push(y.x,y.y,y.z),d.push(0,_,0),g.x=.5*T+.5,g.y=.5*S*_+.5,f.push(g.x,g.y),h++}for(i=0;i<r;i++){var M=o+i,E=p+i;!0===n?c.push(E,E+1,M):c.push(E+1,E,M),b+=3}u.addGroup(v,b,!0===n?1:2),v+=b}!function(){var o,g,y=new ur,b=new ur,x=0,_=(e-t)/n;for(g=0;g<=i;g++){var w=[],T=g/i,S=T*(e-t)+t;for(o=0;o<=r;o++){var M=o/r,E=M*s+a,R=Math.sin(E),I=Math.cos(E);b.x=S*R,b.y=-T*n+m,b.z=S*I,l.push(b.x,b.y,b.z),y.set(R,_,I).normalize(),d.push(y.x,y.y,y.z),f.push(M,1-T),w.push(h++)}p.push(w)}for(o=0;o<r;o++)for(g=0;g<i;g++){var B=p[g][o],A=p[g+1][o],C=p[g+1][o+1],F=p[g][o+1];c.push(B,A,F),c.push(A,C,F),x+=6}u.addGroup(v,x,0),v+=x}(),!1===o&&(t>0&&g(!0),e>0&&g(!1)),this.setIndex(c),this.setAttribute("position",new ki(l,3)),this.setAttribute("normal",new ki(d,3)),this.setAttribute("uv",new ki(f,2))}function tl(t,e,n,r,i,o,a){Kc.call(this,0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function el(t,e,n,r,i,o,a){$c.call(this,0,t,e,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function nl(t,e,n,r){Mo.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new rl(t,e,n,r)),this.mergeVertices()}function rl(t,e,n,r){$i.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,o,a=[],s=[],u=[],c=[],l=new ur,d=new qn;for(s.push(0,0,0),u.push(0,0,1),c.push(.5,.5),o=0,i=3;o<=e;o++,i+=3){var f=n+o/e*r;l.x=t*Math.cos(f),l.y=t*Math.sin(f),s.push(l.x,l.y,l.z),u.push(0,0,1),d.x=(s[i]/t+1)/2,d.y=(s[i+1]/t+1)/2,c.push(d.x,d.y)}for(i=1;i<=e;i++)a.push(i,i+1,0);this.setIndex(a),this.setAttribute("position",new ki(s,3)),this.setAttribute("normal",new ki(u,3)),this.setAttribute("uv",new ki(c,2))}Vc.prototype=Object.create(Mo.prototype),Vc.prototype.constructor=Vc,Hc.prototype=Object.create(Lc.prototype),Hc.prototype.constructor=Hc,kc.prototype=Object.create(Mo.prototype),kc.prototype.constructor=kc,zc.prototype=Object.create($i.prototype),zc.prototype.constructor=zc,Xc.prototype=Object.create(Mo.prototype),Xc.prototype.constructor=Xc,Wc.prototype=Object.create($i.prototype),Wc.prototype.constructor=Wc,jc.prototype=Object.create(Mo.prototype),jc.prototype.constructor=jc,Zc.prototype=Object.create($i.prototype),Zc.prototype.constructor=Zc,Qc.prototype=Object.create(Mo.prototype),Qc.prototype.constructor=Qc,Qc.prototype.toJSON=function(){var t=Mo.prototype.toJSON.call(this);return Jc(this.parameters.shapes,t)},Yc.prototype=Object.create($i.prototype),Yc.prototype.constructor=Yc,Yc.prototype.toJSON=function(){var t=$i.prototype.toJSON.call(this);return Jc(this.parameters.shapes,t)},qc.prototype=Object.create($i.prototype),qc.prototype.constructor=qc,Kc.prototype=Object.create(Mo.prototype),Kc.prototype.constructor=Kc,$c.prototype=Object.create($i.prototype),$c.prototype.constructor=$c,tl.prototype=Object.create(Kc.prototype),tl.prototype.constructor=tl,el.prototype=Object.create($c.prototype),el.prototype.constructor=el,nl.prototype=Object.create(Mo.prototype),nl.prototype.constructor=nl,rl.prototype=Object.create($i.prototype),rl.prototype.constructor=rl;var il=Object.freeze({__proto__:null,WireframeGeometry:ju,ParametricGeometry:Zu,ParametricBufferGeometry:Qu,TetrahedronGeometry:qu,TetrahedronBufferGeometry:Ku,OctahedronGeometry:$u,OctahedronBufferGeometry:tc,IcosahedronGeometry:ec,IcosahedronBufferGeometry:nc,DodecahedronGeometry:rc,DodecahedronBufferGeometry:ic,PolyhedronGeometry:Yu,PolyhedronBufferGeometry:Ju,TubeGeometry:oc,TubeBufferGeometry:ac,TorusKnotGeometry:sc,TorusKnotBufferGeometry:uc,TorusGeometry:cc,TorusBufferGeometry:lc,TextGeometry:Vc,TextBufferGeometry:Hc,SphereGeometry:kc,SphereBufferGeometry:zc,RingGeometry:Xc,RingBufferGeometry:Wc,PlaneGeometry:zo,PlaneBufferGeometry:Xo,LatheGeometry:jc,LatheBufferGeometry:Zc,ShapeGeometry:Qc,ShapeBufferGeometry:Yc,ExtrudeGeometry:Uc,ExtrudeBufferGeometry:Lc,EdgesGeometry:qc,ConeGeometry:tl,ConeBufferGeometry:el,CylinderGeometry:Kc,CylinderBufferGeometry:$c,CircleGeometry:nl,CircleBufferGeometry:rl,BoxGeometry:Eo,BoxBufferGeometry:Ro});function ol(t){Ci.call(this),this.type="ShadowMaterial",this.color=new Mi(0),this.transparent=!0,this.setValues(t)}function al(t){Co.call(this,t),this.type="RawShaderMaterial"}function sl(t){Ci.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Mi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bn,this.normalScale=new qn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function ul(t){sl.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new qn(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function cl(t){Ci.call(this),this.type="MeshPhongMaterial",this.color=new Mi(16777215),this.specular=new Mi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bn,this.normalScale=new qn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ut,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function ll(t){Ci.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Mi(16777215),this.specular=new Mi(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bn,this.normalScale=new qn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function dl(t){Ci.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bn,this.normalScale=new qn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function fl(t){Ci.call(this),this.type="MeshLambertMaterial",this.color=new Mi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ut,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function hl(t){Ci.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Mi(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bn,this.normalScale=new qn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function pl(t){Su.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}ol.prototype=Object.create(Ci.prototype),ol.prototype.constructor=ol,ol.prototype.isShadowMaterial=!0,ol.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.color.copy(t.color),this},al.prototype=Object.create(Co.prototype),al.prototype.constructor=al,al.prototype.isRawShaderMaterial=!0,sl.prototype=Object.create(Ci.prototype),sl.prototype.constructor=sl,sl.prototype.isMeshStandardMaterial=!0,sl.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},ul.prototype=Object.create(sl.prototype),ul.prototype.constructor=ul,ul.prototype.isMeshPhysicalMaterial=!0,ul.prototype.copy=function(t){return sl.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new Mi).copy(t.sheen):this.sheen=null,this.transparency=t.transparency,this},cl.prototype=Object.create(Ci.prototype),cl.prototype.constructor=cl,cl.prototype.isMeshPhongMaterial=!0,cl.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},ll.prototype=Object.create(Ci.prototype),ll.prototype.constructor=ll,ll.prototype.isMeshToonMaterial=!0,ll.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},dl.prototype=Object.create(Ci.prototype),dl.prototype.constructor=dl,dl.prototype.isMeshNormalMaterial=!0,dl.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},fl.prototype=Object.create(Ci.prototype),fl.prototype.constructor=fl,fl.prototype.isMeshLambertMaterial=!0,fl.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},hl.prototype=Object.create(Ci.prototype),hl.prototype.constructor=hl,hl.prototype.isMeshMatcapMaterial=!0,hl.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},pl.prototype=Object.create(Su.prototype),pl.prototype.constructor=pl,pl.prototype.isLineDashedMaterial=!0,pl.prototype.copy=function(t){return Su.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var ml=Object.freeze({__proto__:null,ShadowMaterial:ol,SpriteMaterial:Js,RawShaderMaterial:al,ShaderMaterial:Co,PointsMaterial:Ou,MeshPhysicalMaterial:ul,MeshStandardMaterial:sl,MeshPhongMaterial:cl,MeshToonMaterial:ll,MeshNormalMaterial:dl,MeshLambertMaterial:fl,MeshDepthMaterial:Ns,MeshDistanceMaterial:Os,MeshBasicMaterial:Fi,MeshMatcapMaterial:hl,LineDashedMaterial:pl,LineBasicMaterial:Su,Material:Ci}),vl={arraySlice:function(t,e,n){return vl.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"===typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*e,u=0;u!==e;++u)i[a++]=t[s+u];return i},flattenJSON:function(t,e,n,r){for(var i=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)}},subclip:function(t,e,n,r,i){i=i||30;var o=t.clone();o.name=e;for(var a=[],s=0;s<o.tracks.length;++s){for(var u=o.tracks[s],c=u.getValueSize(),l=[],d=[],f=0;f<u.times.length;++f){var h=u.times[f]*i;if(!(h<n||h>=r)){l.push(u.times[f]);for(var p=0;p<c;++p)d.push(u.values[f*c+p])}}0!==l.length&&(u.times=vl.convertArray(l,u.times.constructor),u.values=vl.convertArray(d,u.values.constructor),a.push(u))}o.tracks=a;var m=1/0;for(s=0;s<o.tracks.length;++s)m>o.tracks[s].times[0]&&(m=o.tracks[s].times[0]);for(s=0;s<o.tracks.length;++s)o.tracks[s].shift(-1*m);return o.resetDuration(),o}};function gl(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function yl(t,e,n,r){gl.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function bl(t,e,n,r){gl.call(this,t,e,n,r)}function xl(t,e,n,r){gl.call(this,t,e,n,r)}function _l(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=vl.convertArray(e,this.TimeBufferType),this.values=vl.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function wl(t,e,n){_l.call(this,t,e,n)}function Tl(t,e,n,r){_l.call(this,t,e,n,r)}function Sl(t,e,n,r){_l.call(this,t,e,n,r)}function Ml(t,e,n,r){gl.call(this,t,e,n,r)}function El(t,e,n,r){_l.call(this,t,e,n,r)}function Rl(t,e,n,r){_l.call(this,t,e,n,r)}function Il(t,e,n,r){_l.call(this,t,e,n,r)}function Bl(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=Jn.generateUUID(),this.duration<0&&this.resetDuration()}function Al(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Sl;case"vector":case"vector2":case"vector3":case"vector4":return Il;case"color":return Tl;case"quaternion":return El;case"bool":case"boolean":return wl;case"string":return Rl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var n=[],r=[];vl.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(gl.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var o;n:{r:if(!(t<r)){for(var a=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===a)break;if(i=r,t<(r=e[++n]))break e}o=e.length;break n}if(t>=i)break t;var s=e[1];t<s&&(n=2,i=s);for(a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===a)break;if(r=i,t>=(i=e[--n-1]))break e}o=n,n=0}for(;n<o;){var u=n+o>>>1;t<e[u]?o=u:n=u+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,o=0;o!==r;++o)e[o]=n[i+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(gl.prototype,{beforeStart_:gl.prototype.copySampleValue_,afterEnd_:gl.prototype.copySampleValue_}),yl.prototype=Object.assign(Object.create(gl.prototype),{constructor:yl,DefaultSettings_:{endingStart:nn,endingEnd:nn},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case rn:i=t,a=2*e-n;break;case on:a=e+r[i=r.length-2]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case rn:o=t,s=2*n-e;break;case on:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}var u=.5*(n-e),c=this.valueSize;this._weightPrev=u/(e-a),this._weightNext=u/(s-n),this._offsetPrev=i*c,this._offsetNext=o*c},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,c=this._offsetPrev,l=this._offsetNext,d=this._weightPrev,f=this._weightNext,h=(n-e)/(r-e),p=h*h,m=p*h,v=-d*m+2*d*p-d*h,g=(1+d)*m+(-1.5-2*d)*p+(-.5+d)*h+1,y=(-1-f)*m+(1.5+f)*p+.5*h,b=f*m-f*p,x=0;x!==a;++x)i[x]=v*o[c+x]+g*o[u+x]+y*o[s+x]+b*o[l+x];return i}}),bl.prototype=Object.assign(Object.create(gl.prototype),{constructor:bl,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,c=(n-e)/(r-e),l=1-c,d=0;d!==a;++d)i[d]=o[u+d]*l+o[s+d]*c;return i}}),xl.prototype=Object.assign(Object.create(gl.prototype),{constructor:xl,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(_l,{toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:vl.convertArray(t.times,Array),values:vl.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e}}),Object.assign(_l.prototype,{constructor:_l,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:tn,InterpolantFactoryMethodDiscrete:function(t){return new xl(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new bl(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new yl(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case $e:e=this.InterpolantFactoryMethodDiscrete;break;case tn:e=this.InterpolantFactoryMethodLinear;break;case en:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return $e;case this.InterpolantFactoryMethodLinear:return tn;case this.InterpolantFactoryMethodSmooth:return en}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=vl.arraySlice(n,i,o),this.values=vl.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"===typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),t=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),t=!1;break}o=s}if(void 0!==r&&vl.isTypedArray(r)){a=0;for(var u=r.length;a!==u;++a){var c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),t=!1;break}}}return t},optimize:function(){for(var t=vl.arraySlice(this.times),e=vl.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===en,i=1,o=t.length-1,a=1;a<o;++a){var s=!1,u=t[a];if(u!==t[a+1]&&(1!==a||u!==u[0]))if(r)s=!0;else for(var c=a*n,l=c-n,d=c+n,f=0;f!==n;++f){var h=e[c+f];if(h!==e[l+f]||h!==e[d+f]){s=!0;break}}if(s){if(a!==i){t[i]=t[a];var p=a*n,m=i*n;for(f=0;f!==n;++f)e[m+f]=e[p+f]}++i}}if(o>0){t[i]=t[o];for(p=o*n,m=i*n,f=0;f!==n;++f)e[m+f]=e[p+f];++i}return i!==t.length?(this.times=vl.arraySlice(t,0,i),this.values=vl.arraySlice(e,0,i*n)):(this.times=t,this.values=e),this},clone:function(){var t=vl.arraySlice(this.times,0),e=vl.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}),wl.prototype=Object.assign(Object.create(_l.prototype),{constructor:wl,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:$e,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Tl.prototype=Object.assign(Object.create(_l.prototype),{constructor:Tl,ValueTypeName:"color"}),Sl.prototype=Object.assign(Object.create(_l.prototype),{constructor:Sl,ValueTypeName:"number"}),Ml.prototype=Object.assign(Object.create(gl.prototype),{constructor:Ml,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=(n-e)/(r-e),c=s+a;s!==c;s+=4)or.slerpFlat(i,0,o,s-a,o,s,u);return i}}),El.prototype=Object.assign(Object.create(_l.prototype),{constructor:El,ValueTypeName:"quaternion",DefaultInterpolation:tn,InterpolantFactoryMethodLinear:function(t){return new Ml(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Rl.prototype=Object.assign(Object.create(_l.prototype),{constructor:Rl,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:$e,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Il.prototype=Object.assign(Object.create(_l.prototype),{constructor:Il,ValueTypeName:"vector"}),Object.assign(Bl,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,o=n.length;i!==o;++i)e.push(Al(n[i]).scale(r));return new Bl(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid},i=0,o=n.length;i!==o;++i)e.push(_l.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,o=[],a=0;a<i;a++){var s=[],u=[];s.push((a+i-1)%i,a,(a+1)%i),u.push(0,1,0);var c=vl.getKeyframeOrder(s);s=vl.sortedArray(s,1,c),u=vl.sortedArray(u,1,c),r||0!==s[0]||(s.push(i),u.push(u[0])),o.push(new Sl(".morphTargetInfluences["+e[a].name+"]",s,u).scale(1/n))}return new Bl(t,-1,o)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],u=s.name.match(i);if(u&&u.length>1){var c=r[d=u[1]];c||(r[d]=c=[]),c.push(s)}}var l=[];for(var d in r)l.push(Bl.CreateFromMorphTargetSequence(d,r[d],e,n));return l},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var o=[],a=[];vl.flattenJSON(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],u=0;u<s.length;u++){var c=s[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var l={},d=0;d<c.length;d++)if(c[d].morphTargets)for(var f=0;f<c[d].morphTargets.length;f++)l[c[d].morphTargets[f]]=-1;for(var h in l){var p=[],m=[];for(f=0;f!==c[d].morphTargets.length;++f){var v=c[d];p.push(v.time),m.push(v.morphTarget===h?1:0)}r.push(new Sl(".morphTargetInfluence["+h+"]",p,m))}o=l.length*(a||1)}else{var g=".bones["+e[u].name+"]";n(Il,g+".position",c,"pos",r),n(El,g+".quaternion",c,"rot",r),n(Il,g+".scale",c,"scl",r)}}return 0===r.length?null:new Bl(i,o,r)}}),Object.assign(Bl.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new Bl(this.name,this.duration,t)}});var Cl={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Fl(t,e,n){var r=this,i=!1,o=0,a=0,s=void 0,u=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return u.push(t,e),this},this.removeHandler=function(t){var e=u.indexOf(t);return-1!==e&&u.splice(e,2),this},this.getHandler=function(t){for(var e=0,n=u.length;e<n;e+=2){var r=u[e],i=u[e+1];if(r.global&&(r.lastIndex=0),r.test(t))return i}return null}}var Pl=new Fl;function Nl(t){this.manager=void 0!==t?t:Pl,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(Nl.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this}});var Ol={};function Ul(t){Nl.call(this,t)}function Ll(t){Nl.call(this,t)}function Gl(t){Nl.call(this,t)}function Dl(t){Nl.call(this,t)}function Vl(t){Nl.call(this,t)}function Hl(t){Nl.call(this,t)}function kl(t){Nl.call(this,t)}function zl(){this.type="Curve",this.arcLengthDivisions=200}function Xl(t,e,n,r,i,o,a,s){zl.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Wl(t,e,n,r,i,o){Xl.call(this,t,e,n,n,r,i,o),this.type="ArcCurve"}function jl(){var t=0,e=0,n=0,r=0;function i(i,o,a,s){t=i,e=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(t,e,n,r,o){i(e,n,o*(n-t),o*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,o,a,s){var u=(e-t)/o-(n-t)/(o+a)+(n-e)/a,c=(n-e)/a-(r-e)/(a+s)+(r-n)/s;i(e,n,u*=a,c*=a)},calc:function(i){var o=i*i;return t+e*i+n*o+r*(o*i)}}}Ul.prototype=Object.assign(Object.create(Nl.prototype),{constructor:Ul,load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=Cl.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;if(void 0===Ol[t]){var a=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],u=!!a[2],c=a[3];c=decodeURIComponent(c),u&&(c=atob(c));try{var l,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var f=new Uint8Array(c.length),h=0;h<c.length;h++)f[h]=c.charCodeAt(h);l="blob"===d?new Blob([f.buffer],{type:s}):f.buffer;break;case"document":var p=new DOMParser;l=p.parseFromString(c,s);break;case"json":l=JSON.parse(c);break;default:l=c}setTimeout((function(){e&&e(l),i.manager.itemEnd(t)}),0)}catch(g){setTimeout((function(){r&&r(g),i.manager.itemError(t),i.manager.itemEnd(t)}),0)}}else{Ol[t]=[],Ol[t].push({onLoad:e,onProgress:n,onError:r});var m=new XMLHttpRequest;for(var v in m.open("GET",t,!0),m.addEventListener("load",(function(e){var n=this.response,r=Ol[t];if(delete Ol[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Cl.add(t,n);for(var o=0,a=r.length;o<a;o++){(s=r[o]).onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else{for(o=0,a=r.length;o<a;o++){var s;(s=r[o]).onError&&s.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}}),!1),m.addEventListener("progress",(function(e){for(var n=Ol[t],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(e)}}),!1),m.addEventListener("error",(function(e){var n=Ol[t];delete Ol[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),m.addEventListener("abort",(function(e){var n=Ol[t];delete Ol[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(v,this.requestHeader[v]);m.send(null)}return i.manager.itemStart(t),m}Ol[t].push({onLoad:e,onProgress:n,onError:r})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Ll.prototype=Object.assign(Object.create(Nl.prototype),{constructor:Ll,load:function(t,e,n,r){var i=this,o=new Ul(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){for(var e=[],n=0;n<t.length;n++){var r=Bl.parse(t[n]);e.push(r)}return e}}),Gl.prototype=Object.assign(Object.create(Nl.prototype),{constructor:Gl,load:function(t,e,n,r){var i=this,o=[],a=new zu;a.image=o;var s=new Ul(this.manager);function u(u){s.load(t[u],(function(t){var n=i.parse(t,!0);o[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(c+=1)&&(1===n.mipmapCount&&(a.minFilter=Pt),a.format=n.format,a.needsUpdate=!0,e&&e(a))}),n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var c=0,l=0,d=t.length;l<d;++l)u(l);else s.load(t,(function(t){var n=i.parse(t,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+u]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=Pt),a.format=n.format,a.needsUpdate=!0,e&&e(a)}),n,r);return a}}),Dl.prototype=Object.assign(Object.create(Nl.prototype),{constructor:Dl,load:function(t,e,n,r){var i=this,o=new Uo,a=new Ul(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(t,(function(t){var n=i.parse(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:Et,o.wrapT=void 0!==n.wrapT?n.wrapT:Et,o.magFilter=void 0!==n.magFilter?n.magFilter:Pt,o.minFilter=void 0!==n.minFilter?n.minFilter:Pt,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=Ut),1===n.mipmapCount&&(o.minFilter=Pt),o.needsUpdate=!0,e&&e(o,n))}),n,r),o}}),Vl.prototype=Object.assign(Object.create(Nl.prototype),{constructor:Vl,load:function(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=Cl.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),Cl.add(t,this),e&&e(this),i.manager.itemEnd(t)}function u(e){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}return a.addEventListener("load",s,!1),a.addEventListener("error",u,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a}}),Hl.prototype=Object.assign(Object.create(Nl.prototype),{constructor:Hl,load:function(t,e,n,r){var i=new ia,o=new Vl(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(t[n],(function(t){i.images[n]=t,6===++a&&(i.needsUpdate=!0,e&&e(i))}),void 0,r)}for(var u=0;u<t.length;++u)s(u);return i}}),kl.prototype=Object.assign(Object.create(Nl.prototype),{constructor:kl,load:function(t,e,n,r){var i=new er,o=new Vl(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(n){i.image=n;var r=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?qt:Kt,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i}}),Object.assign(zl.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=t;n++)o+=(e=this.getPoint(n/t)).distanceTo(i),r.push(o),i=e;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r=this.getLengths(),i=0,o=r.length;n=e||t*r[o-1];for(var a,s=0,u=o-1;s<=u;)if((a=r[i=Math.floor(s+(u-s)/2)]-n)<0)s=i+1;else{if(!(a>0)){u=i;break}u=i-1}if(r[i=u]===n)return i/(o-1);var c=r[i];return(i+(n-c)/(r[i+1]-c))/(o-1)},getTangent:function(t){var e=t-1e-4,n=t+1e-4;e<0&&(e=0),n>1&&(n=1);var r=this.getPoint(e);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var n,r,i,o=new ur,a=[],s=[],u=[],c=new ur,l=new vr;for(n=0;n<=t;n++)r=n/t,a[n]=this.getTangentAt(r),a[n].normalize();s[0]=new ur,u[0]=new ur;var d=Number.MAX_VALUE,f=Math.abs(a[0].x),h=Math.abs(a[0].y),p=Math.abs(a[0].z);for(f<=d&&(d=f,o.set(1,0,0)),h<=d&&(d=h,o.set(0,1,0)),p<=d&&o.set(0,0,1),c.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],c),u[0].crossVectors(a[0],s[0]),n=1;n<=t;n++)s[n]=s[n-1].clone(),u[n]=u[n-1].clone(),c.crossVectors(a[n-1],a[n]),c.length()>Number.EPSILON&&(c.normalize(),i=Math.acos(Jn.clamp(a[n-1].dot(a[n]),-1,1)),s[n].applyMatrix4(l.makeRotationAxis(c,i))),u[n].crossVectors(a[n],s[n]);if(!0===e)for(i=Math.acos(Jn.clamp(s[0].dot(s[t]),-1,1)),i/=t,a[0].dot(c.crossVectors(s[0],s[t]))>0&&(i=-i),n=1;n<=t;n++)s[n].applyMatrix4(l.makeRotationAxis(a[n],i*n)),u[n].crossVectors(a[n],s[n]);return{tangents:a,normals:s,binormals:u}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Xl.prototype=Object.create(zl.prototype),Xl.prototype.constructor=Xl,Xl.prototype.isEllipseCurve=!0,Xl.prototype.getPoint=function(t,e){for(var n=e||new qn,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var c=Math.cos(this.aRotation),l=Math.sin(this.aRotation),d=s-this.aX,f=u-this.aY;s=d*c-f*l+this.aX,u=d*l+f*c+this.aY}return n.set(s,u)},Xl.prototype.copy=function(t){return zl.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Xl.prototype.toJSON=function(){var t=zl.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Xl.prototype.fromJSON=function(t){return zl.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Wl.prototype=Object.create(Xl.prototype),Wl.prototype.constructor=Wl,Wl.prototype.isArcCurve=!0;var Zl=new ur,Ql=new jl,Yl=new jl,Jl=new jl;function ql(t,e,n,r){zl.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function Kl(t,e,n,r,i){var o=.5*(r-e),a=.5*(i-n),s=t*t;return(2*n-2*r+o+a)*(t*s)+(-3*n+3*r-2*o-a)*s+o*t+n}function $l(t,e,n,r){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function td(t,e,n,r,i){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}function ed(t,e,n,r){zl.call(this),this.type="CubicBezierCurve",this.v0=t||new qn,this.v1=e||new qn,this.v2=n||new qn,this.v3=r||new qn}function nd(t,e,n,r){zl.call(this),this.type="CubicBezierCurve3",this.v0=t||new ur,this.v1=e||new ur,this.v2=n||new ur,this.v3=r||new ur}function rd(t,e){zl.call(this),this.type="LineCurve",this.v1=t||new qn,this.v2=e||new qn}function id(t,e){zl.call(this),this.type="LineCurve3",this.v1=t||new ur,this.v2=e||new ur}function od(t,e,n){zl.call(this),this.type="QuadraticBezierCurve",this.v0=t||new qn,this.v1=e||new qn,this.v2=n||new qn}function ad(t,e,n){zl.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new ur,this.v1=e||new ur,this.v2=n||new ur}function sd(t){zl.call(this),this.type="SplineCurve",this.points=t||[]}ql.prototype=Object.create(zl.prototype),ql.prototype.constructor=ql,ql.prototype.isCatmullRomCurve3=!0,ql.prototype.getPoint=function(t,e){var n,r,i,o,a=e||new ur,s=this.points,u=s.length,c=(u-(this.closed?0:1))*t,l=Math.floor(c),d=c-l;if(this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/u)+1)*u:0===d&&l===u-1&&(l=u-2,d=1),this.closed||l>0?n=s[(l-1)%u]:(Zl.subVectors(s[0],s[1]).add(s[0]),n=Zl),r=s[l%u],i=s[(l+1)%u],this.closed||l+2<u?o=s[(l+2)%u]:(Zl.subVectors(s[u-1],s[u-2]).add(s[u-1]),o=Zl),"centripetal"===this.curveType||"chordal"===this.curveType){var f="chordal"===this.curveType?.5:.25,h=Math.pow(n.distanceToSquared(r),f),p=Math.pow(r.distanceToSquared(i),f),m=Math.pow(i.distanceToSquared(o),f);p<1e-4&&(p=1),h<1e-4&&(h=p),m<1e-4&&(m=p),Ql.initNonuniformCatmullRom(n.x,r.x,i.x,o.x,h,p,m),Yl.initNonuniformCatmullRom(n.y,r.y,i.y,o.y,h,p,m),Jl.initNonuniformCatmullRom(n.z,r.z,i.z,o.z,h,p,m)}else"catmullrom"===this.curveType&&(Ql.initCatmullRom(n.x,r.x,i.x,o.x,this.tension),Yl.initCatmullRom(n.y,r.y,i.y,o.y,this.tension),Jl.initCatmullRom(n.z,r.z,i.z,o.z,this.tension));return a.set(Ql.calc(d),Yl.calc(d),Jl.calc(d)),a},ql.prototype.copy=function(t){zl.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},ql.prototype.toJSON=function(){var t=zl.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},ql.prototype.fromJSON=function(t){zl.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new ur).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},ed.prototype=Object.create(zl.prototype),ed.prototype.constructor=ed,ed.prototype.isCubicBezierCurve=!0,ed.prototype.getPoint=function(t,e){var n=e||new qn,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(td(t,r.x,i.x,o.x,a.x),td(t,r.y,i.y,o.y,a.y)),n},ed.prototype.copy=function(t){return zl.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ed.prototype.toJSON=function(){var t=zl.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ed.prototype.fromJSON=function(t){return zl.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},nd.prototype=Object.create(zl.prototype),nd.prototype.constructor=nd,nd.prototype.isCubicBezierCurve3=!0,nd.prototype.getPoint=function(t,e){var n=e||new ur,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(td(t,r.x,i.x,o.x,a.x),td(t,r.y,i.y,o.y,a.y),td(t,r.z,i.z,o.z,a.z)),n},nd.prototype.copy=function(t){return zl.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},nd.prototype.toJSON=function(){var t=zl.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},nd.prototype.fromJSON=function(t){return zl.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},rd.prototype=Object.create(zl.prototype),rd.prototype.constructor=rd,rd.prototype.isLineCurve=!0,rd.prototype.getPoint=function(t,e){var n=e||new qn;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},rd.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},rd.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},rd.prototype.copy=function(t){return zl.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},rd.prototype.toJSON=function(){var t=zl.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},rd.prototype.fromJSON=function(t){return zl.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},id.prototype=Object.create(zl.prototype),id.prototype.constructor=id,id.prototype.isLineCurve3=!0,id.prototype.getPoint=function(t,e){var n=e||new ur;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},id.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},id.prototype.copy=function(t){return zl.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},id.prototype.toJSON=function(){var t=zl.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},id.prototype.fromJSON=function(t){return zl.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},od.prototype=Object.create(zl.prototype),od.prototype.constructor=od,od.prototype.isQuadraticBezierCurve=!0,od.prototype.getPoint=function(t,e){var n=e||new qn,r=this.v0,i=this.v1,o=this.v2;return n.set($l(t,r.x,i.x,o.x),$l(t,r.y,i.y,o.y)),n},od.prototype.copy=function(t){return zl.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},od.prototype.toJSON=function(){var t=zl.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},od.prototype.fromJSON=function(t){return zl.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ad.prototype=Object.create(zl.prototype),ad.prototype.constructor=ad,ad.prototype.isQuadraticBezierCurve3=!0,ad.prototype.getPoint=function(t,e){var n=e||new ur,r=this.v0,i=this.v1,o=this.v2;return n.set($l(t,r.x,i.x,o.x),$l(t,r.y,i.y,o.y),$l(t,r.z,i.z,o.z)),n},ad.prototype.copy=function(t){return zl.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ad.prototype.toJSON=function(){var t=zl.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ad.prototype.fromJSON=function(t){return zl.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},sd.prototype=Object.create(zl.prototype),sd.prototype.constructor=sd,sd.prototype.isSplineCurve=!0,sd.prototype.getPoint=function(t,e){var n=e||new qn,r=this.points,i=(r.length-1)*t,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],u=r[o],c=r[o>r.length-2?r.length-1:o+1],l=r[o>r.length-3?r.length-1:o+2];return n.set(Kl(a,s.x,u.x,c.x,l.x),Kl(a,s.y,u.y,c.y,l.y)),n},sd.prototype.copy=function(t){zl.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this},sd.prototype.toJSON=function(){var t=zl.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t},sd.prototype.fromJSON=function(t){zl.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new qn).fromArray(r))}return this};var ud=Object.freeze({__proto__:null,ArcCurve:Wl,CatmullRomCurve3:ql,CubicBezierCurve:ed,CubicBezierCurve3:nd,EllipseCurve:Xl,LineCurve:rd,LineCurve3:id,QuadraticBezierCurve:od,QuadraticBezierCurve3:ad,SplineCurve:sd});function cd(){zl.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function ld(t){cd.call(this),this.type="Path",this.currentPoint=new qn,t&&this.setFromPoints(t)}function dd(t){ld.call(this,t),this.uuid=Jn.generateUUID(),this.type="Shape",this.holes=[]}function fd(t,e){Nr.call(this),this.type="Light",this.color=new Mi(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function hd(t,e,n){fd.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Nr.DefaultUp),this.updateMatrix(),this.groundColor=new Mi(e)}function pd(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new qn(512,512),this.map=null,this.mapPass=null,this.matrix=new vr,this._frustum=new Do,this._frameExtents=new qn(1,1),this._viewportCount=1,this._viewports=[new nr(0,0,1,1)]}function md(){pd.call(this,new Po(50,1,.5,500))}function vd(t,e,n,r,i,o){fd.call(this,t,e),this.type="SpotLight",this.position.copy(Nr.DefaultUp),this.updateMatrix(),this.target=new Nr,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new md}function gd(){pd.call(this,new Po(90,1,.5,500)),this._frameExtents=new qn(4,2),this._viewportCount=6,this._viewports=[new nr(2,1,1,1),new nr(0,1,1,1),new nr(3,1,1,1),new nr(1,1,1,1),new nr(3,0,1,1),new nr(1,0,1,1)],this._cubeDirections=[new ur(1,0,0),new ur(-1,0,0),new ur(0,0,1),new ur(0,0,-1),new ur(0,1,0),new ur(0,-1,0)],this._cubeUps=[new ur(0,1,0),new ur(0,1,0),new ur(0,1,0),new ur(0,1,0),new ur(0,0,1),new ur(0,0,-1)]}function yd(t,e,n,r){fd.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new gd}function bd(t,e,n,r,i,o){Fo.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function xd(){pd.call(this,new bd(-5,5,5,-5,.5,500))}function _d(t,e){fd.call(this,t,e),this.type="DirectionalLight",this.position.copy(Nr.DefaultUp),this.updateMatrix(),this.target=new Nr,this.shadow=new xd}function wd(t,e){fd.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function Td(t,e,n,r){fd.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function Sd(t){Nl.call(this,t),this.textures={}}cd.prototype=Object.assign(Object.create(zl.prototype),{constructor:cd,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new rd(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=e){var i=n[r]-e,o=this.curves[r],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}r++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a),u=0;u<s.length;u++){var c=s[u];e&&e.equals(c)||(n.push(c),e=c)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){zl.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=zl.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++){var r=this.curves[e];t.curves.push(r.toJSON())}return t},fromJSON:function(t){zl.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push((new ud[r.type]).fromJSON(r))}return this}}),ld.prototype=Object.assign(Object.create(cd.prototype),{constructor:ld,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){var n=new rd(this.currentPoint.clone(),new qn(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,n,r){var i=new od(this.currentPoint.clone(),new qn(t,e),new qn(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},bezierCurveTo:function(t,e,n,r,i,o){var a=new ed(this.currentPoint.clone(),new qn(t,e),new qn(n,r),new qn(i,o));return this.curves.push(a),this.currentPoint.set(i,o),this},splineThru:function(t){var e=new sd([this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+a,e+s,n,r,i,o),this},absarc:function(t,e,n,r,i,o){return this.absellipse(t,e,n,n,r,i,o),this},ellipse:function(t,e,n,r,i,o,a,s){var u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+u,e+c,n,r,i,o,a,s),this},absellipse:function(t,e,n,r,i,o,a,s){var u=new Xl(t,e,n,r,i,o,a,s);if(this.curves.length>0){var c=u.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(u);var l=u.getPoint(1);return this.currentPoint.copy(l),this},copy:function(t){return cd.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=cd.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return cd.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),dd.prototype=Object.assign(Object.create(ld.prototype),{constructor:dd,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){ld.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push(r.clone())}return this},toJSON:function(){var t=ld.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++){var r=this.holes[e];t.holes.push(r.toJSON())}return t},fromJSON:function(t){ld.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push((new ld).fromJSON(r))}return this}}),fd.prototype=Object.assign(Object.create(Nr.prototype),{constructor:fd,isLight:!0,copy:function(t){return Nr.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=Nr.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),hd.prototype=Object.assign(Object.create(fd.prototype),{constructor:hd,isHemisphereLight:!0,copy:function(t){return fd.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(pd.prototype,{_projScreenMatrix:new vr,_lightPositionWorld:new ur,_lookTarget:new ur,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var e=this.camera,n=this.matrix,r=this._projScreenMatrix,i=this._lookTarget,o=this._lightPositionWorld;o.setFromMatrixPosition(t.matrixWorld),e.position.copy(o),i.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(i),e.updateMatrixWorld(),r.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),md.prototype=Object.assign(Object.create(pd.prototype),{constructor:md,isSpotLightShadow:!0,updateMatrices:function(t){var e=this.camera,n=2*Jn.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),pd.prototype.updateMatrices.call(this,t)}}),vd.prototype=Object.assign(Object.create(fd.prototype),{constructor:vd,isSpotLight:!0,copy:function(t){return fd.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),gd.prototype=Object.assign(Object.create(pd.prototype),{constructor:gd,isPointLightShadow:!0,updateMatrices:function(t,e){void 0===e&&(e=0);var n=this.camera,r=this.matrix,i=this._lightPositionWorld,o=this._lookTarget,a=this._projScreenMatrix;i.setFromMatrixPosition(t.matrixWorld),n.position.copy(i),o.copy(n.position),o.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(o),n.updateMatrixWorld(),r.makeTranslation(-i.x,-i.y,-i.z),a.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a)}}),yd.prototype=Object.assign(Object.create(fd.prototype),{constructor:yd,isPointLight:!0,copy:function(t){return fd.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),bd.prototype=Object.assign(Object.create(Fo.prototype),{constructor:bd,isOrthographicCamera:!0,copy:function(t,e){return Fo.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,o=n+t,a=r+e,s=r-e;if(null!==this.view&&this.view.enabled){var u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o=(i+=u*this.view.offsetX)+u*this.view.width,s=(a-=c*this.view.offsetY)-c*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=Nr.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),xd.prototype=Object.assign(Object.create(pd.prototype),{constructor:xd,isDirectionalLightShadow:!0,updateMatrices:function(t){pd.prototype.updateMatrices.call(this,t)}}),_d.prototype=Object.assign(Object.create(fd.prototype),{constructor:_d,isDirectionalLight:!0,copy:function(t){return fd.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),wd.prototype=Object.assign(Object.create(fd.prototype),{constructor:wd,isAmbientLight:!0}),Td.prototype=Object.assign(Object.create(fd.prototype),{constructor:Td,isRectAreaLight:!0,copy:function(t){return fd.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=fd.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),Sd.prototype=Object.assign(Object.create(Nl.prototype),{constructor:Sd,load:function(t,e,n,r){var i=this,o=new Ul(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var r=new ml[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=(new Mi).setHex(t.sheen)),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(r.morphNormals=t.morphNormals),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.vertexTangents&&(r.vertexTangents=t.vertexTangents),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.vertexColors&&("number"===typeof t.vertexColors?r.vertexColors=t.vertexColors>0:r.vertexColors=t.vertexColors),void 0!==t.uniforms)for(var i in t.uniforms){var o=t.uniforms[i];switch(r.uniforms[i]={},o.type){case"t":r.uniforms[i].value=n(o.value);break;case"c":r.uniforms[i].value=(new Mi).setHex(o.value);break;case"v2":r.uniforms[i].value=(new qn).fromArray(o.value);break;case"v3":r.uniforms[i].value=(new ur).fromArray(o.value);break;case"v4":r.uniforms[i].value=(new nr).fromArray(o.value);break;case"m3":r.uniforms[i].value=(new Kn).fromArray(o.value);case"m4":r.uniforms[i].value=(new vr).fromArray(o.value);break;default:r.uniforms[i].value=o.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var a in t.extensions)r.extensions[a]=t.extensions[a];if(void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){var s=t.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new qn).fromArray(s)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(r.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new qn).fromArray(t.clearcoatNormalScale)),r},setTextures:function(t){return this.textures=t,this}});var Md={decodeText:function(t){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(i){return e}},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};function Ed(){$i.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Rd(t,e,n,r){"number"===typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Ni.call(this,t,e,n),this.meshPerAttribute=r||1}function Id(t){Nl.call(this,t)}Ed.prototype=Object.assign(Object.create($i.prototype),{constructor:Ed,isInstancedBufferGeometry:!0,copy:function(t){return $i.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=$i.prototype.toJSON.call(this);return t.maxInstancedCount=this.maxInstancedCount,t.isInstancedBufferGeometry=!0,t}}),Rd.prototype=Object.assign(Object.create(Ni.prototype),{constructor:Rd,isInstancedBufferAttribute:!0,copy:function(t){return Ni.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=Ni.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Id.prototype=Object.assign(Object.create(Nl.prototype),{constructor:Id,load:function(t,e,n,r){var i=this,o=new Ul(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=t.isInstancedBufferGeometry?new Ed:new $i,n=t.data.index;if(void 0!==n){var r=new Bd[n.type](n.array);e.setIndex(new Ni(r,1))}var i=t.data.attributes;for(var o in i){var a=i[o],s=(r=new Bd[a.type](a.array),new(a.isInstancedBufferAttribute?Rd:Ni)(r,a.itemSize,a.normalized));void 0!==a.name&&(s.name=a.name),e.setAttribute(o,s)}var u=t.data.morphAttributes;if(u)for(var o in u){for(var c=u[o],l=[],d=0,f=c.length;d<f;d++){a=c[d],s=new Ni(r=new Bd[a.type](a.array),a.itemSize,a.normalized);void 0!==a.name&&(s.name=a.name),l.push(s)}e.morphAttributes[o]=l}t.data.morphTargetsRelative&&(e.morphTargetsRelative=!0);var h=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==h){d=0;for(var p=h.length;d!==p;++d){var m=h[d];e.addGroup(m.start,m.count,m.materialIndex)}}var v=t.data.boundingSphere;if(void 0!==v){var g=new ur;void 0!==v.center&&g.fromArray(v.center),e.boundingSphere=new Kr(g,v.radius)}return t.name&&(e.name=t.name),t.userData&&(e.userData=t.userData),e}});var Bd={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!==typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Ad(t){Nl.call(this,t)}Ad.prototype=Object.assign(Object.create(Nl.prototype),{constructor:Ad,load:function(t,e,n,r){var i=this,o=""===this.path?Md.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||o;var a=new Ul(i.manager);a.setPath(this.path),a.load(t,(function(n){var o=null;try{o=JSON.parse(n)}catch(s){return void 0!==r&&r(s),void console.error("THREE:ObjectLoader: Can't parse "+t+".",s.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,e):console.error("THREE.ObjectLoader: Can't load "+t)}),n,r)},parse:function(t,e){var n=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,n),i=this.parseImages(t.images,(function(){void 0!==e&&e(s)})),o=this.parseTextures(t.textures,i),a=this.parseMaterials(t.materials,o),s=this.parseObject(t.object,r,a);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,r=t.length;n<r;n++){var i=(new dd).fromJSON(t[n]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var r=new Id,i=0,o=t.length;i<o;i++){var a,s=t[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new il[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new il[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new il[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new il[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new il[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new il[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new il[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new il[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new il[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new il[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":a=new il[s.type]((new ud[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":a=new il[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new il[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var u=[],c=0,l=s.shapes.length;c<l;c++){var d=e[s.shapes[c]];u.push(d)}a=new il[s.type](u,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(u=[],c=0,l=s.shapes.length;c<l;c++){d=e[s.shapes[c]];u.push(d)}var f=s.options.extrudePath;void 0!==f&&(s.options.extrudePath=(new ud[f.type]).fromJSON(f)),a=new il[s.type](u,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(s);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}return n},parseMaterials:function(t,e){var n={},r={};if(void 0!==t){var i=new Sd;i.setTextures(e);for(var o=0,a=t.length;o<a;o++){var s=t[o];if("MultiMaterial"===s.type){for(var u=[],c=0;c<s.materials.length;c++){var l=s.materials[c];void 0===n[l.uuid]&&(n[l.uuid]=i.parse(l)),u.push(n[l.uuid])}r[s.uuid]=u}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n],i=Bl.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),e.push(i)}return e},parseImages:function(t,e){var n=this,r={};function i(t){return n.manager.itemStart(t),o.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}if(void 0!==t&&t.length>0){var o=new Vl(new Fl(e));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=t.length;a<s;a++){var u=t[a],c=u.url;if(Array.isArray(c)){r[u.uuid]=[];for(var l=0,d=c.length;l<d;l++){var f=c[l],h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(f)?f:n.resourcePath+f;r[u.uuid].push(i(h))}}else{h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:n.resourcePath+u.url;r[u.uuid]=i(h)}}}return r},parseTextures:function(t,e){function n(t,e){return"number"===typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var i=0,o=t.length;i<o;i++){var a,s=t[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(a=Array.isArray(e[s.image])?new ia(e[s.image]):new er(e[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=n(s.mapping,Fd)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=n(s.wrap[0],Pd),a.wrapT=n(s.wrap[1],Pd)),void 0!==s.format&&(a.format=s.format),void 0!==s.type&&(a.type=s.type),void 0!==s.encoding&&(a.encoding=s.encoding),void 0!==s.minFilter&&(a.minFilter=n(s.minFilter,Nd)),void 0!==s.magFilter&&(a.magFilter=n(s.magFilter,Nd)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(a.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(a.unpackAlignment=s.unpackAlignment),r[s.uuid]=a}return r},parseObject:function(t,e,n){var r;function i(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function o(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,i=t.length;r<i;r++){var o=t[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),e.push(n[o])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}switch(t.type){case"Scene":r=new Or,void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new Mi(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new Ws(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new Xs(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new Po(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new bd(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"AmbientLight":r=new wd(t.color,t.intensity);break;case"DirectionalLight":r=new _d(t.color,t.intensity);break;case"PointLight":r=new yd(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new Td(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new vd(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new hd(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":r=new yo(a=i(t.geometry),s=o(t.material));break;case"InstancedMesh":var a=i(t.geometry),s=o(t.material),u=t.count,c=t.instanceMatrix;(r=new Tu(a,s,u)).instanceMatrix=new Ni(new Float32Array(c.array),16);break;case"LOD":r=new hu;break;case"Line":r=new Au(i(t.geometry),o(t.material),t.mode);break;case"LineLoop":r=new Nu(i(t.geometry),o(t.material));break;case"LineSegments":r=new Pu(i(t.geometry),o(t.material));break;case"PointCloud":case"Points":r=new Vu(i(t.geometry),o(t.material));break;case"Sprite":r=new cu(o(t.material));break;case"Group":r=new Hs;break;default:r=new Nr}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(r.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(r.matrixAutoUpdate=t.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.frustumCulled&&(r.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(r.renderOrder=t.renderOrder),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.layers&&(r.layers.mask=t.layers),void 0!==t.children)for(var l=t.children,d=0;d<l.length;d++)r.add(this.parseObject(l[d],e,n));if("LOD"===t.type){void 0!==t.autoUpdate&&(r.autoUpdate=t.autoUpdate);for(var f=t.levels,h=0;h<f.length;h++){var p=f[h],m=r.getObjectByProperty("uuid",p.object);void 0!==m&&r.addLevel(m,p.distance)}}return r}});var Cd,Fd={UVMapping:gt,CubeReflectionMapping:yt,CubeRefractionMapping:bt,EquirectangularReflectionMapping:xt,EquirectangularRefractionMapping:_t,SphericalReflectionMapping:wt,CubeUVReflectionMapping:Tt,CubeUVRefractionMapping:St},Pd={RepeatWrapping:Mt,ClampToEdgeWrapping:Et,MirroredRepeatWrapping:Rt},Nd={NearestFilter:It,NearestMipmapNearestFilter:Bt,NearestMipmapLinearFilter:Ct,LinearFilter:Pt,LinearMipmapNearestFilter:Nt,LinearMipmapLinearFilter:Ut};function Od(t){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Nl.call(this,t),this.options=void 0}function Ud(){this.type="ShapePath",this.color=new Mi,this.subPaths=[],this.currentPath=null}function Ld(t){this.type="Font",this.data=t}function Gd(t,e,n,r,i){var o=i.glyphs[t]||i.glyphs["?"];if(o){var a,s,u,c,l,d,f,h,p=new Ud;if(o.o)for(var m=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),v=0,g=m.length;v<g;){switch(m[v++]){case"m":a=m[v++]*e+n,s=m[v++]*e+r,p.moveTo(a,s);break;case"l":a=m[v++]*e+n,s=m[v++]*e+r,p.lineTo(a,s);break;case"q":u=m[v++]*e+n,c=m[v++]*e+r,l=m[v++]*e+n,d=m[v++]*e+r,p.quadraticCurveTo(l,d,u,c);break;case"b":u=m[v++]*e+n,c=m[v++]*e+r,l=m[v++]*e+n,d=m[v++]*e+r,f=m[v++]*e+n,h=m[v++]*e+r,p.bezierCurveTo(l,d,f,h,u,c)}}return{offsetX:o.ha*e,path:p}}console.error('THREE.Font: character "'+t+'" does not exists in font family '+i.familyName+".")}function Dd(t){Nl.call(this,t)}Od.prototype=Object.assign(Object.create(Nl.prototype),{constructor:Od,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=Cl.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;fetch(t).then((function(t){return t.blob()})).then((function(t){return void 0===i.options?createImageBitmap(t):createImageBitmap(t,i.options)})).then((function(n){Cl.add(t,n),e&&e(n),i.manager.itemEnd(t)})).catch((function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)})),i.manager.itemStart(t)}}),Object.assign(Ud.prototype,{moveTo:function(t,e){return this.currentPath=new ld,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this},bezierCurveTo:function(t,e,n,r,i,o){return this.currentPath.bezierCurveTo(t,e,n,r,i,o),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],o=new dd;o.curves=i.curves,e.push(o)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=e[i],s=e[o],u=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(a=e[o],u=-u,s=e[i],c=-c),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var l=c*(t.x-a.x)-u*(t.y-a.y);if(0===l)return!0;if(l<0)continue;r=!r}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return r}var i=Pc.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);var a,s,u,c=[];if(1===o.length)return s=o[0],(u=new dd).curves=s.curves,c.push(u),c;var l=!i(o[0].getPoints());l=t?!l:l;var d,f,h=[],p=[],m=[],v=0;p[v]=void 0,m[v]=[];for(var g=0,y=o.length;g<y;g++)a=i(d=(s=o[g]).getPoints()),(a=t?!a:a)?(!l&&p[v]&&v++,p[v]={s:new dd,p:d},p[v].s.curves=s.curves,l&&v++,m[v]=[]):m[v].push({h:s,p:d[0]});if(!p[0])return n(o);if(p.length>1){for(var b=!1,x=[],_=0,w=p.length;_<w;_++)h[_]=[];for(_=0,w=p.length;_<w;_++)for(var T=m[_],S=0;S<T.length;S++){for(var M=T[S],E=!0,R=0;R<p.length;R++)r(M.p,p[R].p)&&(_!==R&&x.push({froms:_,tos:R,hole:S}),E?(E=!1,h[R].push(M)):b=!0);E&&h[_].push(M)}x.length>0&&(b||(m=h))}g=0;for(var I=p.length;g<I;g++){u=p[g].s,c.push(u);for(var B=0,A=(f=m[g]).length;B<A;B++)u.holes.push(f[B].h)}return c}}),Object.assign(Ld.prototype,{isFont:!0,generateShapes:function(t,e){void 0===e&&(e=100);for(var n=[],r=function(t,e,n){for(var r=Array.from?Array.from(t):String(t).split(""),i=e/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[],s=0,u=0,c=0;c<r.length;c++){var l=r[c];if("\n"===l)s=0,u-=o;else{var d=Gd(l,i,s,u,n);s+=d.offsetX,a.push(d.path)}}return a}(t,e,this.data),i=0,o=r.length;i<o;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),Dd.prototype=Object.assign(Object.create(Nl.prototype),{constructor:Dd,load:function(t,e,n,r){var i=this,o=new Ul(this.manager);o.setPath(this.path),o.load(t,(function(t){var n;try{n=JSON.parse(t)}catch(o){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var r=i.parse(n);e&&e(r)}),n,r)},parse:function(t){return new Ld(t)}});var Vd={getContext:function(){return void 0===Cd&&(Cd=new(window.AudioContext||window.webkitAudioContext)),Cd},setContext:function(t){Cd=t}};function Hd(t){Nl.call(this,t)}function kd(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new ur)}function zd(t,e){fd.call(this,void 0,e),this.sh=void 0!==t?t:new kd}function Xd(t,e,n){zd.call(this,void 0,n);var r=(new Mi).set(t),i=(new Mi).set(e),o=new ur(r.r,r.g,r.b),a=new ur(i.r,i.g,i.b),s=Math.sqrt(Math.PI),u=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(u)}function Wd(t,e){zd.call(this,void 0,e);var n=(new Mi).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}Hd.prototype=Object.assign(Object.create(Nl.prototype),{constructor:Hd,load:function(t,e,n,r){var i=new Ul(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(t,(function(t){var n=t.slice(0);Vd.getContext().decodeAudioData(n,(function(t){e(t)}))}),n,r)}}),Object.assign(kd.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},zero:function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,e){var n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*r),e.addScaledVector(o[2],.488603*i),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],n*r*1.092548),e.addScaledVector(o[5],r*i*1.092548),e.addScaledVector(o[6],.315392*(3*i*i-1)),e.addScaledVector(o[7],n*i*1.092548),e.addScaledVector(o[8],.546274*(n*n-r*r)),e},getIrradianceAt:function(t,e){var n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],1.023328*r),e.addScaledVector(o[2],1.023328*i),e.addScaledVector(o[3],1.023328*n),e.addScaledVector(o[4],.858086*n*r),e.addScaledVector(o[5],.858086*r*i),e.addScaledVector(o[6],.743125*i*i-.247708),e.addScaledVector(o[7],.858086*n*i),e.addScaledVector(o[8],.429043*(n*n-r*r)),e},add:function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},addScaledSH:function(t,e){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this},scale:function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},lerp:function(t,e){for(var n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this},equals:function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,e){void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}}),Object.assign(kd,{getBasisAt:function(t,e){var n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}),zd.prototype=Object.assign(Object.create(fd.prototype),{constructor:zd,isLightProbe:!0,copy:function(t){return fd.prototype.copy.call(this,t),this.sh.copy(t.sh),this.intensity=t.intensity,this},toJSON:function(t){return fd.prototype.toJSON.call(this,t)}}),Xd.prototype=Object.assign(Object.create(zd.prototype),{constructor:Xd,isHemisphereLightProbe:!0,copy:function(t){return zd.prototype.copy.call(this,t),this},toJSON:function(t){return zd.prototype.toJSON.call(this,t)}}),Wd.prototype=Object.assign(Object.create(zd.prototype),{constructor:Wd,isAmbientLightProbe:!0,copy:function(t){return zd.prototype.copy.call(this,t),this},toJSON:function(t){return zd.prototype.toJSON.call(this,t)}});var jd=new vr,Zd=new vr;function Qd(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Po,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Po,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function Yd(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(Qd.prototype,{update:function(t){var e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;var n,r,i=t.projectionMatrix.clone(),o=e.eyeSep/2,a=o*e.near/e.focus,s=e.near*Math.tan(Jn.DEG2RAD*e.fov*.5)/e.zoom;Zd.elements[12]=-o,jd.elements[12]=o,n=-s*e.aspect+a,r=s*e.aspect+a,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*e.aspect-a,r=s*e.aspect-a,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Zd),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(jd)}}),Object.assign(Yd.prototype,{start:function(){this.startTime=("undefined"===typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"===typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}});var Jd=new ur,qd=new or,Kd=new ur,$d=new ur;function tf(){Nr.call(this),this.type="AudioListener",this.context=Vd.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Yd}function ef(t){Nr.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}tf.prototype=Object.assign(Object.create(Nr.prototype),{constructor:tf,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){Nr.prototype.updateMatrixWorld.call(this,t);var e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Jd,qd,Kd),$d.set(0,0,-1).applyQuaternion(qd),e.positionX){var r=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(Jd.x,r),e.positionY.linearRampToValueAtTime(Jd.y,r),e.positionZ.linearRampToValueAtTime(Jd.z,r),e.forwardX.linearRampToValueAtTime($d.x,r),e.forwardY.linearRampToValueAtTime($d.y,r),e.forwardZ.linearRampToValueAtTime($d.z,r),e.upX.linearRampToValueAtTime(n.x,r),e.upY.linearRampToValueAtTime(n.y,r),e.upZ.linearRampToValueAtTime(n.z,r)}else e.setPosition(Jd.x,Jd.y,Jd.z),e.setOrientation($d.x,$d.y,$d.z,n.x,n.y,n.z)}}),ef.prototype=Object.assign(Object.create(Nr.prototype),{constructor:ef,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+t;var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._pausedAt+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var nf=new ur,rf=new or,of=new ur,af=new ur;function sf(t){ef.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function uf(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function cf(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}sf.prototype=Object.assign(Object.create(ef.prototype),{constructor:sf,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(t){if(Nr.prototype.updateMatrixWorld.call(this,t),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(nf,rf,of),af.set(0,0,1).applyQuaternion(rf);var e=this.panner;if(e.positionX){var n=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(nf.x,n),e.positionY.linearRampToValueAtTime(nf.y,n),e.positionZ.linearRampToValueAtTime(nf.z,n),e.orientationX.linearRampToValueAtTime(af.x,n),e.orientationY.linearRampToValueAtTime(af.y,n),e.orientationZ.linearRampToValueAtTime(af.z,n)}else e.setPosition(nf.x,nf.y,nf.z),e.setOrientation(af.x,af.y,af.z)}}}),Object.assign(uf.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(cf.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=e}else{var s=e/(o+=e);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*e;this._mixBufferRegion(n,r,a,1-i,e)}for(var s=e,u=e+e;s!==u;++s)if(n[s]!==n[s+e]){o.setValue(n,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=3*n;t.getValue(e,r);for(var i=n,o=r;i!==o;++i)e[i]=e[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)t[e+o]=t[n+o]},_slerp:function(t,e,n,r){or.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*r}}});var lf=new RegExp("[\\[\\]\\.:\\/]","g"),df="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",ff=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),hf=/(WCOD+)?/.source.replace("WCOD",df),pf=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),mf=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),vf=new RegExp("^"+ff+hf+pf+mf+"$"),gf=["material","materials","bones"];function yf(t,e,n){var r=n||bf.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function bf(t,e,n){this.path=e,this.parsedPath=n||bf.parseTrackName(e),this.node=bf.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function xf(){this.uuid=Jn.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function _f(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,o=new Array(i),a={endingStart:nn,endingEnd:nn},s=0;s!==i;++s){var u=r[s].createInterpolant(null);o[s]=u,u.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qe,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function wf(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Tf(t){"string"===typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function Sf(t,e,n){js.call(this,t,e),this.meshPerAttribute=n||1}function Mf(t,e,n,r){this.ray=new ai(t,e),this.near=n||0,this.far=r||1/0,this.camera=null,this.layers=new xr,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Ef(t,e){return t.distance-e.distance}function Rf(t,e,n,r){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===r)for(var i=t.children,o=0,a=i.length;o<a;o++)Rf(i[o],e,n,!0)}function If(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function Bf(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}Object.assign(yf.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(bf,{Composite:yf,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new bf.Composite(t,e,n):new bf(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(lf,"")},parseTrackName:function(t){var e=vf.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==gf.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function t(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===e||i.uuid===e)return i;var o=t(i.children);if(o)return o}return null}(t.children);if(r)return r}return null}}),Object.assign(bf.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=bf.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var s=t[r];if(void 0!==s){var u=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(t.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===i){i=a;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][u]}else{var l=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+r+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(bf.prototype,{_getValue_unbound:bf.prototype.getValue,_setValue_unbound:bf.prototype.setValue}),Object.assign(xf.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,u=void 0,c=0,l=arguments.length;c!==l;++c){var d=arguments[c],f=d.uuid,h=r[f];if(void 0===h){h=e++,r[f]=h,t.push(d);for(var p=0,m=s;p!==m;++p)a[p].push(new bf(d,i[p],o[p]))}else if(h<n){u=t[h];var v=--n,g=t[v];r[g.uuid]=h,t[h]=g,r[f]=v,t[v]=d;for(p=0,m=s;p!==m;++p){var y=a[p],b=y[v],x=y[h];y[h]=b,void 0===x&&(x=new bf(d,i[p],o[p])),y[v]=x}}else t[h]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],u=s.uuid,c=n[u];if(void 0!==c&&c>=e){var l=e++,d=t[l];n[d.uuid]=c,t[c]=d,n[u]=l,t[l]=s;for(var f=0,h=i;f!==h;++f){var p=r[f],m=p[l],v=p[c];p[c]=m,p[l]=v}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var u=arguments[a],c=u.uuid,l=r[c];if(void 0!==l)if(delete r[c],l<n){var d=--n,f=t[d],h=t[y=--e];r[f.uuid]=l,t[l]=f,r[h.uuid]=d,t[d]=h,t.pop();for(var p=0,m=o;p!==m;++p){var v=(b=i[p])[d],g=b[y];b[l]=v,b[d]=g,b.pop()}}else{var y;r[(h=t[y=--e]).uuid]=l,t[l]=h,t.pop();for(p=0,m=o;p!==m;++p){var b;(b=i[p])[l]=b[y],b.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,u=s.length,c=this.nCachedObjects_,l=new Array(u);r=i.length,n[t]=r,o.push(t),a.push(e),i.push(l);for(var d=c,f=s.length;d!==f;++d){var h=s[d];l[d]=new bf(h,t,e)}return l},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}),Object.assign(_f.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,o=i/r,a=r/i;t.warp(1,o,e),this.warp(a,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,u=o.sampleValues;return s[0]=i,s[1]=i+n,u[0]=t/a,u[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(t-i)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var u=this._interpolants,c=this._propertyBindings,l=0,d=u.length;l!==d;++l)u[l].evaluate(a),c[l].accumulate(r,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t,n=this._clip.duration,r=this.loop,i=this._loopCount,o=r===Ke;if(0===t)return-1===i?e:o&&1===(1&i)?n-e:e;if(r===Je){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0)){this.time=e;break t}e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=n||e<0){var a=Math.floor(e/n);e-=n*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var u=t<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=e;if(o&&1===(1&i))return n-e}return e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=rn,r.endingEnd=rn):(r.endingStart=t?this.zeroSlopeAtStart?rn:nn:on,r.endingEnd=e?this.zeroSlopeAtEnd?rn:nn:on)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=n,this}}),wf.prototype=Object.assign(Object.create(jn.prototype),{constructor:wf,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,u=this._bindingsByRootAndName,c=u[s];void 0===c&&(c={},u[s]=c);for(var l=0;l!==i;++l){var d=r[l],f=d.name,h=c[f];if(void 0!==h)o[l]=h;else{if(void 0!==(h=o[l])){null===h._cacheIndex&&(++h.referenceCount,this._addInactiveBinding(h,s,f));continue}var p=e&&e._propertyBindings[l].binding.parsedPath;++(h=new cf(bf.create(n,f,p),d.ValueTypeName,d.getValueSize())).referenceCount,this._addInactiveBinding(h,s,f),o[l]=h}a[l].resultBuffer=h.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0===s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0===--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,u=s[s.length-1],c=t._byClipCacheIndex;u._byClipCacheIndex=c,s[c]=u,s.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0===--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],o=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=e[e.length-1],u=t._cacheIndex;s._cacheIndex=u,e[u]=s,e.pop(),delete a[i],0===Object.keys(a).length&&delete o[r]},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new bl(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"===typeof t?Bl.findByName(n,t):t,o=null!==i?i.uuid:t,a=this._actionsByClip[o],s=null;if(void 0!==a){var u=a.actionByRoot[r];if(void 0!==u)return u;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var c=new _f(this,i,e);return this._bindAction(c,s),this._addInactiveAction(c,o,r),c},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"===typeof t?Bl.findByName(n,t):t,o=i?i.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a){e[a]._update(r,t,i,o)}var s=this._bindings,u=this._nActiveBindings;for(a=0;a!==u;++a)s[a].apply(o);return this},setTime:function(t){this.time=0;for(var e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var u=o[a];this._deactivateAction(u);var c=u._cacheIndex,l=e[e.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,l._cacheIndex=c,e[c]=l,e.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[e];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Tf.prototype.clone=function(){return new Tf(void 0===this.value.clone?this.value:this.value.clone())},Sf.prototype=Object.assign(Object.create(js.prototype),{constructor:Sf,isInstancedInterleavedBuffer:!0,copy:function(t){return js.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(Mf.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,n){var r=n||[];return Rf(t,this,r,e),r.sort(Ef),r},intersectObjects:function(t,e,n){var r=n||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,o=t.length;i<o;i++)Rf(t[i],this,r,e);return r.sort(Ef),r}}),Object.assign(If.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(Jn.clamp(e/this.radius,-1,1))),this}}),Object.assign(Bf.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}});var Af=new qn;function Cf(t,e){this.min=void 0!==t?t:new qn(1/0,1/0),this.max=void 0!==e?e:new qn(-1/0,-1/0)}Object.assign(Cf.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=Af.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new qn),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new qn),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new qn),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new qn),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return Af.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var Ff=new ur,Pf=new ur;function Nf(t,e){this.start=void 0!==t?t:new ur,this.end=void 0!==e?e:new ur}function Of(t){Nr.call(this),this.material=t,this.render=function(){}}Object.assign(Nf.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new ur),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new ur),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new ur),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,e){Ff.subVectors(t,this.start),Pf.subVectors(this.end,this.start);var n=Pf.dot(Pf),r=Pf.dot(Ff)/n;return e&&(r=Jn.clamp(r,0,1)),r},closestPointToPoint:function(t,e,n){var r=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new ur),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Of.prototype=Object.create(Nr.prototype),Of.prototype.constructor=Of,Of.prototype.isImmediateRenderObject=!0;var Uf=new ur;function Lf(t,e){Nr.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new $i,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;r.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}n.setAttribute("position",new ki(r,3));var u=new Su({fog:!1,toneMapped:!1});this.cone=new Pu(n,u),this.add(this.cone),this.update()}Lf.prototype=Object.create(Nr.prototype),Lf.prototype.constructor=Lf,Lf.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Lf.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),Uf.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Uf),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var Gf=new ur,Df=new vr,Vf=new vr;function Hf(t){for(var e=function t(e){var n=[];e&&e.isBone&&n.push(e);for(var r=0;r<e.children.length;r++)n.push.apply(n,t(e.children[r]));return n}(t),n=new $i,r=[],i=[],o=new Mi(0,0,1),a=new Mi(0,1,0),s=0;s<e.length;s++){var u=e[s];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.setAttribute("position",new ki(r,3)),n.setAttribute("color",new ki(i,3));var c=new Su({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});Pu.call(this,n,c),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function kf(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var r=new zc(e,4,2),i=new Fi({wireframe:!0,fog:!1,toneMapped:!1});yo.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}Hf.prototype=Object.create(Pu.prototype),Hf.prototype.constructor=Hf,Hf.prototype.isSkeletonHelper=!0,Hf.prototype.updateMatrixWorld=function(t){var e=this.bones,n=this.geometry,r=n.getAttribute("position");Vf.getInverse(this.root.matrixWorld);for(var i=0,o=0;i<e.length;i++){var a=e[i];a.parent&&a.parent.isBone&&(Df.multiplyMatrices(Vf,a.matrixWorld),Gf.setFromMatrixPosition(Df),r.setXYZ(o,Gf.x,Gf.y,Gf.z),Df.multiplyMatrices(Vf,a.parent.matrixWorld),Gf.setFromMatrixPosition(Df),r.setXYZ(o+1,Gf.x,Gf.y,Gf.z),o+=2)}n.getAttribute("position").needsUpdate=!0,Nr.prototype.updateMatrixWorld.call(this,t)},kf.prototype=Object.create(yo.prototype),kf.prototype.constructor=kf,kf.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},kf.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var zf=new ur,Xf=new Mi,Wf=new Mi;function jf(t,e,n){Nr.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new tc(e);r.rotateY(.5*Math.PI),this.material=new Fi({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);var i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.setAttribute("color",new Ni(o,3)),this.add(new yo(r,this.material)),this.update()}function Zf(t,e,n,r){t=t||10,e=e||10,n=new Mi(void 0!==n?n:4473924),r=new Mi(void 0!==r?r:8947848);for(var i=e/2,o=t/e,a=t/2,s=[],u=[],c=0,l=0,d=-a;c<=e;c++,d+=o){s.push(-a,0,d,a,0,d),s.push(d,0,-a,d,0,a);var f=c===i?n:r;f.toArray(u,l),l+=3,f.toArray(u,l),l+=3,f.toArray(u,l),l+=3,f.toArray(u,l),l+=3}var h=new $i;h.setAttribute("position",new ki(s,3)),h.setAttribute("color",new ki(u,3));var p=new Su({vertexColors:!0,toneMapped:!1});Pu.call(this,h,p)}function Qf(t,e,n,r,i,o){t=t||10,e=e||16,n=n||8,r=r||64,i=new Mi(void 0!==i?i:4473924),o=new Mi(void 0!==o?o:8947848);var a,s,u,c,l,d,f,h=[],p=[];for(c=0;c<=e;c++)u=c/e*(2*Math.PI),a=Math.sin(u)*t,s=Math.cos(u)*t,h.push(0,0,0),h.push(a,0,s),f=1&c?i:o,p.push(f.r,f.g,f.b),p.push(f.r,f.g,f.b);for(c=0;c<=n;c++)for(f=1&c?i:o,d=t-t/n*c,l=0;l<r;l++)u=l/r*(2*Math.PI),a=Math.sin(u)*d,s=Math.cos(u)*d,h.push(a,0,s),p.push(f.r,f.g,f.b),u=(l+1)/r*(2*Math.PI),a=Math.sin(u)*d,s=Math.cos(u)*d,h.push(a,0,s),p.push(f.r,f.g,f.b);var m=new $i;m.setAttribute("position",new ki(h,3)),m.setAttribute("color",new ki(p,3));var v=new Su({vertexColors:!0,toneMapped:!1});Pu.call(this,m,v)}jf.prototype=Object.create(Nr.prototype),jf.prototype.constructor=jf,jf.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},jf.prototype.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");Xf.copy(this.light.color),Wf.copy(this.light.groundColor);for(var n=0,r=e.count;n<r;n++){var i=n<r/2?Xf:Wf;e.setXYZ(n,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(zf.setFromMatrixPosition(this.light.matrixWorld).negate())},Zf.prototype=Object.assign(Object.create(Pu.prototype),{constructor:Zf,copy:function(t){return Pu.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),Qf.prototype=Object.create(Pu.prototype),Qf.prototype.constructor=Qf;var Yf=new ur,Jf=new ur,qf=new ur;function Kf(t,e,n){Nr.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var r=new $i;r.setAttribute("position",new ki([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new Su({fog:!1,toneMapped:!1});this.lightPlane=new Au(r,i),this.add(this.lightPlane),(r=new $i).setAttribute("position",new ki([0,0,0,0,0,1],3)),this.targetLine=new Au(r,i),this.add(this.targetLine),this.update()}Kf.prototype=Object.create(Nr.prototype),Kf.prototype.constructor=Kf,Kf.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Kf.prototype.update=function(){Yf.setFromMatrixPosition(this.light.matrixWorld),Jf.setFromMatrixPosition(this.light.target.matrixWorld),qf.subVectors(Jf,Yf),this.lightPlane.lookAt(Jf),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Jf),this.targetLine.scale.z=qf.length()};var $f=new ur,th=new Fo;function eh(t){var e=new $i,n=new Su({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],o={},a=new Mi(16755200),s=new Mi(16711680),u=new Mi(43775),c=new Mi(16777215),l=new Mi(3355443);function d(t,e,n){f(t,n),f(e,n)}function f(t,e){r.push(0,0,0),i.push(e.r,e.g,e.b),void 0===o[t]&&(o[t]=[]),o[t].push(r.length/3-1)}d("n1","n2",a),d("n2","n4",a),d("n4","n3",a),d("n3","n1",a),d("f1","f2",a),d("f2","f4",a),d("f4","f3",a),d("f3","f1",a),d("n1","f1",a),d("n2","f2",a),d("n3","f3",a),d("n4","f4",a),d("p","n1",s),d("p","n2",s),d("p","n3",s),d("p","n4",s),d("u1","u2",u),d("u2","u3",u),d("u3","u1",u),d("c","t",c),d("p","c",l),d("cn1","cn2",l),d("cn3","cn4",l),d("cf1","cf2",l),d("cf3","cf4",l),e.setAttribute("position",new ki(r,3)),e.setAttribute("color",new ki(i,3)),Pu.call(this,e,n),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function nh(t,e,n,r,i,o,a){$f.set(i,o,a).unproject(r);var s=e[t];if(void 0!==s)for(var u=n.getAttribute("position"),c=0,l=s.length;c<l;c++)u.setXYZ(s[c],$f.x,$f.y,$f.z)}eh.prototype=Object.create(Pu.prototype),eh.prototype.constructor=eh,eh.prototype.update=function(){var t=this.geometry,e=this.pointMap;th.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),nh("c",e,t,th,0,0,-1),nh("t",e,t,th,0,0,1),nh("n1",e,t,th,-1,-1,-1),nh("n2",e,t,th,1,-1,-1),nh("n3",e,t,th,-1,1,-1),nh("n4",e,t,th,1,1,-1),nh("f1",e,t,th,-1,-1,1),nh("f2",e,t,th,1,-1,1),nh("f3",e,t,th,-1,1,1),nh("f4",e,t,th,1,1,1),nh("u1",e,t,th,.7,1.1,-1),nh("u2",e,t,th,-.7,1.1,-1),nh("u3",e,t,th,0,2,-1),nh("cf1",e,t,th,-1,0,1),nh("cf2",e,t,th,1,0,1),nh("cf3",e,t,th,0,-1,1),nh("cf4",e,t,th,0,1,1),nh("cn1",e,t,th,-1,0,-1),nh("cn2",e,t,th,1,0,-1),nh("cn3",e,t,th,0,-1,-1),nh("cn4",e,t,th,0,1,-1),t.getAttribute("position").needsUpdate=!0};var rh=new Yr;function ih(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new $i;i.setIndex(new Ni(n,1)),i.setAttribute("position",new Ni(r,3)),Pu.call(this,i,new Su({color:e,toneMapped:!1})),this.matrixAutoUpdate=!1,this.update()}function oh(t,e){this.type="Box3Helper",this.box=t,e=e||16776960;var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new $i;r.setIndex(new Ni(n,1)),r.setAttribute("position",new ki([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Pu.call(this,r,new Su({color:e,toneMapped:!1})),this.geometry.computeBoundingSphere()}function ah(t,e,n){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var r=void 0!==n?n:16776960,i=new $i;i.setAttribute("position",new ki([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Au.call(this,i,new Su({color:r,toneMapped:!1}));var o=new $i;o.setAttribute("position",new ki([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new yo(o,new Fi({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}ih.prototype=Object.create(Pu.prototype),ih.prototype.constructor=ih,ih.prototype.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&rh.setFromObject(this.object),!rh.isEmpty()){var e=rh.min,n=rh.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}},ih.prototype.setFromObject=function(t){return this.object=t,this.update(),this},ih.prototype.copy=function(t){return Pu.prototype.copy.call(this,t),this.object=t.object,this},ih.prototype.clone=function(){return(new this.constructor).copy(this)},oh.prototype=Object.create(Pu.prototype),oh.prototype.constructor=oh,oh.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),Nr.prototype.updateMatrixWorld.call(this,t))},ah.prototype=Object.create(Au.prototype),ah.prototype.constructor=ah,ah.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?I:R,this.lookAt(this.plane.normal),Nr.prototype.updateMatrixWorld.call(this,t)};var sh,uh,ch=new ur;function lh(t,e,n,r,i,o){Nr.call(this),void 0===t&&(t=new ur(0,0,1)),void 0===e&&(e=new ur(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===sh&&((sh=new $i).setAttribute("position",new ki([0,0,0,0,1,0],3)),(uh=new $c(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new Au(sh,new Su({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new yo(uh,new Fi({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}function dh(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new $i;n.setAttribute("position",new ki(e,3)),n.setAttribute("color",new ki([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new Su({vertexColors:!0,toneMapped:!1});Pu.call(this,n,r)}lh.prototype=Object.create(Nr.prototype),lh.prototype.constructor=lh,lh.prototype.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{ch.set(t.z,0,-t.x).normalize();var e=Math.acos(t.y);this.quaternion.setFromAxisAngle(ch,e)}},lh.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},lh.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},lh.prototype.copy=function(t){return Nr.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},lh.prototype.clone=function(){return(new this.constructor).copy(this)},dh.prototype=Object.create(Pu.prototype),dh.prototype.constructor=dh;var fh=Math.pow(2,8),hh=[.125,.215,.35,.446,.526,.582],ph=5+hh.length,mh=(c={},Object(r.a)(c,cn,0),Object(r.a)(c,ln,1),Object(r.a)(c,fn,2),Object(r.a)(c,pn,3),Object(r.a)(c,mn,4),Object(r.a)(c,vn,5),Object(r.a)(c,dn,6),c),vh=new bd,gh=function(t){var e=new Float32Array(t),n=new ur(0,1,0),r=new al({defines:{n:t},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:mh[cn]},outputEncoding:{value:mh[cn]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n".concat("\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t","\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvec3 getSample(float theta, vec3 axis) {\n\tfloat cosTheta = cos(theta);\n\t// Rodrigues' axis-angle rotation\n\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\n}\n\nvoid main() {\n\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\tif (all(equal(axis, vec3(0.0))))\n\t\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\n\taxis = normalize(axis);\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfloat theta = dTheta * float(i);\n\t\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\n\t\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t"),blending:F,depthTest:!1,depthWrite:!1});return r.type="SphericalGaussianBlur",r}(20),yh=null,bh=null,xh=function(){for(var t=[],e=[],n=[],r=8,i=0;i<ph;i++){var o=Math.pow(2,r);e.push(o);var a=1/o;i>4?a=hh[i-8+4-1]:0==i&&(a=0),n.push(a);for(var s=1/(o-1),u=-s/2,c=1+s/2,l=[u,u,c,u,c,c,u,u,c,c,u,c],d=new Float32Array(108),f=new Float32Array(72),h=new Float32Array(36),p=0;p<6;p++){var m=p%3*2/3-1,v=p>2?0:-1,g=[m,v,0,m+2/3,v,0,m+2/3,v+1,0,m,v,0,m+2/3,v+1,0,m,v+1,0];d.set(g,18*p),f.set(l,12*p);var y=[p,p,p,p,p,p];h.set(y,6*p)}var b=new $i;b.setAttribute("position",new Ni(d,3)),b.setAttribute("uv",new Ni(f,2)),b.setAttribute("faceIndex",new Ni(h,1)),t.push(b),r>4&&r--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}(),_h=xh._lodPlanes,wh=xh._sizeLods,Th=xh._sigmas,Sh=null,Mh=null,Eh=null,Rh=(1+Math.sqrt(5))/2,Ih=1/Rh,Bh=[new ur(1,1,1),new ur(-1,1,1),new ur(1,1,-1),new ur(-1,1,-1),new ur(0,Rh,Ih),new ur(0,Rh,-Ih),new ur(Ih,0,Rh),new ur(-Ih,0,Rh),new ur(Rh,Ih,0),new ur(-Rh,Ih,0)];function Ah(t){Mh=t,Nh(gh)}function Ch(t){var e={magFilter:It,minFilter:It,generateMipmaps:!1,type:t?t.type:Gt,format:t?t.format:ee,encoding:t?t.encoding:fn,depthBuffer:!1,stencilBuffer:!1},n=Oh(e);return n.depthBuffer=!t,Sh=Oh(e),n}function Fh(t){Sh.dispose(),Mh.setRenderTarget(Eh),t.scissorTest=!1,t.setSize(t.width,t.height)}function Ph(t,e,n,r){var i=new Po(90,1,e,n),o=[1,1,1,1,-1,1],a=[1,1,-1,-1,-1,1],s=Mh.outputEncoding,u=Mh.toneMapping,c=Mh.toneMappingExposure,l=Mh.getClearColor(),d=Mh.getClearAlpha();Mh.toneMapping=ft,Mh.toneMappingExposure=1,Mh.outputEncoding=cn,t.scale.z*=-1;var f=t.background;if(f&&f.isColor){f.convertSRGBToLinear();var h=Math.max(f.r,f.g,f.b),p=Math.min(Math.max(Math.ceil(Math.log2(h)),-128),127);f=f.multiplyScalar(Math.pow(2,-p));var m=(p+128)/255;Mh.setClearColor(f,m),t.background=null}for(var v=0;v<6;v++){var g=v%3;0==g?(i.up.set(0,o[v],0),i.lookAt(a[v],0,0)):1==g?(i.up.set(0,0,o[v]),i.lookAt(0,a[v],0)):(i.up.set(0,o[v],0),i.lookAt(0,0,a[v])),Uh(r,g*fh,v>2?fh:0,fh,fh),Mh.setRenderTarget(r),Mh.render(t,i)}Mh.toneMapping=u,Mh.toneMappingExposure=c,Mh.outputEncoding=s,Mh.setClearColor(l,d),t.scale.z*=-1}function Nh(t){var e=new Or;e.add(new yo(_h[0],t)),Mh.compile(e,vh)}function Oh(t){var e=new rr(3*fh,3*fh,t);return e.texture.mapping=Tt,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Uh(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function Lh(t){var e=Mh.autoClear;Mh.autoClear=!1;for(var n=1;n<ph;n++){Gh(t,n-1,n,Math.sqrt(Th[n]*Th[n]-Th[n-1]*Th[n-1]),Bh[(n-1)%Bh.length])}Mh.autoClear=e}function Gh(t,e,n,r,i){Dh(t,Sh,e,n,r,"latitudinal",i),Dh(Sh,t,n,n,r,"longitudinal",i)}function Dh(t,e,n,r,i,o,a){"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");var s=new Or;s.add(new yo(_h[r],gh));var u=gh.uniforms,c=wh[n]-1,l=isFinite(i)?Math.PI/(2*c):2*Math.PI/39,d=i/l,f=isFinite(i)?1+Math.floor(3*d):20;f>20&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(f," samples when the maximum is set to ").concat(20));for(var h=[],p=0,m=0;m<20;++m){var v=m/d,g=Math.exp(-v*v/2);h.push(g),0==m?p+=g:m<f&&(p+=2*g)}for(m=0;m<h.length;m++)h[m]=h[m]/p;u.envMap.value=t.texture,u.samples.value=f,u.weights.value=h,u.latitudinal.value="latitudinal"===o,a&&(u.poleAxis.value=a),u.dTheta.value=l,u.mipInt.value=8-n,u.inputEncoding.value=mh[t.texture.encoding],u.outputEncoding.value=mh[t.texture.encoding];var y=wh[r];Uh(e,v=3*Math.max(0,fh-2*y),(0===r?0:2*fh)+2*y*(r>4?r-8+4:0),3*y,2*y),Mh.setRenderTarget(e),Mh.render(s,vh)}function Vh(){var t=new al({uniforms:{envMap:{value:null},texelSize:{value:new qn(1,1)},inputEncoding:{value:mh[cn]},outputEncoding:{value:mh[cn]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n".concat("\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t","\n\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv;\n\tuv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;\n\tuv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t"),blending:F,depthTest:!1,depthWrite:!1});return t.type="EquirectangularToCubeUV",t}function Hh(){var t=new al({uniforms:{envMap:{value:null},inputEncoding:{value:mh[cn]},outputEncoding:{value:mh[cn]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n".concat("\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t","\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t"),blending:F,depthTest:!1,depthWrite:!1});return t.type="CubemapToCubeUV",t}function kh(t,e,n,r,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Bi(t,e,n,i,o,a)}Ah.prototype={constructor:Ah,fromScene:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;Eh=Mh.getRenderTarget();var i=Ch();return Ph(t,n,r,i),e>0&&Gh(i,0,0,e),Lh(i),Fh(i),i},fromEquirectangular:function(t){return t.magFilter=It,t.minFilter=It,t.generateMipmaps=!1,this.fromCubemap(t)},fromCubemap:function(t){Eh=Mh.getRenderTarget();var e=Ch(t);return function(t,e){var n=new Or;t.isCubeTexture?null==bh&&(bh=Hh()):null==yh&&(yh=Vh());var r=t.isCubeTexture?bh:yh;n.add(new yo(_h[0],r));var i=r.uniforms;i.envMap.value=t,t.isCubeTexture||i.texelSize.value.set(1/t.image.width,1/t.image.height);i.inputEncoding.value=mh[t.encoding],i.outputEncoding.value=mh[t.encoding],Uh(e,0,0,3*fh,2*fh),Mh.setRenderTarget(e),Mh.render(n,vh)}(t,e),Lh(e),Fh(e),e},compileCubemapShader:function(){null==bh&&Nh(bh=Hh())},compileEquirectangularShader:function(){null==yh&&Nh(yh=Vh())},dispose:function(){gh.dispose(),null!=bh&&bh.dispose(),null!=yh&&yh.dispose();for(var t=0;t<_h.length;t++)_h[t].dispose()}};var zh=0,Xh=1,Wh=0,jh=1,Zh=2;function Qh(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function Yh(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function Jh(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Vu(t,e)}function qh(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new cu(t)}function Kh(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Vu(t,e)}function $h(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ou(t)}function tp(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ou(t)}function ep(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ou(t)}function np(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new ur(t,e,n)}function rp(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Ni(t,e).setUsage(Gn)}function ip(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Oi(t,e)}function op(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Ui(t,e)}function ap(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Li(t,e)}function sp(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Gi(t,e)}function up(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Di(t,e)}function cp(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Vi(t,e)}function lp(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Hi(t,e)}function dp(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new ki(t,e)}function fp(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new zi(t,e)}function hp(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ql.call(this,t),this.type="catmullrom",this.closed=!0}function pp(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ql.call(this,t),this.type="catmullrom"}function mp(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ql.call(this,t),this.type="catmullrom"}function vp(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new dh(t)}function gp(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new ih(t,e)}function yp(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Pu(new qc(t.geometry),new Su({color:void 0!==e?e:16777215}))}function bp(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Pu(new ju(t.geometry),new Su({color:void 0!==e?e:16777215}))}function xp(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Ul(t)}function _p(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Dl(t)}function wp(t,e,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Oo(t,n)}zl.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(zl.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(cd.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new Mo,n=0,r=t.length;n<r;n++){var i=t[n];e.vertices.push(new ur(i.x,i.y,i.z||0))}return e}}),Object.assign(ld.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),hp.prototype=Object.create(ql.prototype),pp.prototype=Object.create(ql.prototype),mp.prototype=Object.create(ql.prototype),Object.assign(mp.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Zf.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Hf.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Nl.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Md.extractUrlBase(t)}}),Nl.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(Ad.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(Cf.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Yr.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Do.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Nf.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(Jn,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Jn.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Jn.ceilPowerOfTwo(t)}}),Object.assign(Kn.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(vr.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new ur).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,o)}}),li.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},or.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(ai.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(_i.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(_i,{barycoordFromPoint:function(t,e,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),_i.getBarycoord(t,e,n,r,i)},normal:function(t,e,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),_i.getNormal(t,e,n,r)}}),Object.assign(dd.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Uc(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Qc(this,t)}}),Object.assign(qn.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ur.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(nr.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Mo.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.assign(Nr.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Nr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(yo.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(yo.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),an},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(hu.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(gu.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),pu.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(zl.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Po.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(fd.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Ni.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Gn},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Gn)}}}),Object.assign(Ni.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Gn:Ln),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign($i.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Ni(arguments[1],arguments[2])))},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties($i.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Mf.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(js.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Gn},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(js.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Gn:Ln),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Lc.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Tf.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Ci.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Mi}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===A}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(cl.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Co.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(zs.prototype,{clearTarget:function(t,e,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,r)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(zs.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?ln:cn}}}),Object.defineProperties(Us.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(rr.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(ef.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new Hd).load(t,(function(t){e.setBuffer(t)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),uf.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},No.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};var Tp={merge:function(t,e,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}};function Sp(){console.error("THREE.CanvasRenderer has been removed")}function Mp(){console.error("THREE.JSONLoader has been removed.")}$n.crossOrigin=void 0,$n.loadTexture=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new kl;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},$n.loadTextureCube=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Hl;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},$n.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},$n.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Ep={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function Rp(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:p}}))},function(t,e,n){"use strict";t.exports=n(101)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0),i=function(t){function e(e,n,r){var i=t.call(this)||this;return i.parent=e,i.outerValue=n,i.outerIndex=r,i.index=0,i}return r.a(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(n(1).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;r=t},get useDeprecatedSynchronousErrorHandling(){return r}}},function(t,e,n){"use strict";function r(t){return t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=n(1);function o(t,e){return function(n){return n.lift(new a(t,e))}}var a=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.predicate,this.thisArg))},t}(),s=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return r.a(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)},e}(i.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return s}));var r,i=n(12),o=n(38),a=n(45);r||(r={});var s=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"===typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){switch(this.kind){case"N":return Object(o.a)(this.value);case"E":return Object(a.a)(this.error);case"C":return Object(i.b)()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return"undefined"!==typeof e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}()},function(t,e,n){"use strict";function r(){return"function"===typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}n.d(e,"a",(function(){return i}));var i=r()},function(t,e,n){"use strict";function r(){}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){return"function"===typeof Symbol&&Symbol.observable||"@@observable"}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0),i=n(3),o=n(4),a=n(16),s=n(10),u=n(13);function c(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"===typeof e?function(r){return r.pipe(c((function(n,r){return Object(u.a)(t(n,r)).pipe(Object(s.a)((function(t,i){return e(n,t,r,i)})))}),n))}:("number"===typeof e&&(n=e),function(e){return e.lift(new l(t,n))})}var l=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new d(t,this.project,this.concurrent))},t}(),d=function(t){function e(e,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=t.call(this,e)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return r.a(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e,t,n)},e.prototype._innerSub=function(t,e,n){var r=new a.a(this,e,n),o=this.destination;o.add(r);var s=Object(i.a)(this,t,void 0,void 0,r);s!==r&&o.add(s)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(o.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}()},function(t,e,n){"use strict";function r(t){return"function"===typeof t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=n(58),o=function(t){function e(n,r){void 0===r&&(r=i.a.now);var o=t.call(this,n,(function(){return e.delegate&&e.delegate!==o?e.delegate.now():r()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return r.a(e,t),e.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),e.delegate&&e.delegate!==this?e.delegate.schedule(n,r,i):t.prototype.schedule.call(this,n,r,i)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(74),o=n(53);function a(t,e){return e?Object(o.a)(t,e):new r.a(Object(i.a)(t))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0),i=n(7),o=n(5),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=null,e.hasNext=!1,e.hasCompleted=!1,e}return r.a(e,t),e.prototype._subscribe=function(e){return this.hasError?(e.error(this.thrownError),o.a.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),o.a.EMPTY):t.prototype._subscribe.call(this,e)},e.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},e.prototype.error=function(e){this.hasCompleted||t.prototype.error.call(this,e)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&t.prototype.next.call(this,this.value),t.prototype.complete.call(this)},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0),i=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r.pending=!1,r}return r.a(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(i){n=!0,r=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),r},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,n){return t.call(this)||this}return r.a(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(n(5).a))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(8);function i(t){return!Object(r.a)(t)&&t-parseFloat(t)+1>=0}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(38),i=n(62);function o(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Object(i.a)()(r.a.apply(void 0,t))}},function(t,e,n){"use strict";function r(t){setTimeout((function(){throw t}),0)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(50);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(t,e)||Object(r.a)(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return s})),function(t){t.HOLD_START="holdStart",t.HOLD_END="holdEnd",t.HOLDING="holding"}(r||(r={}));var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(t){function e(e){void 0===e&&(e=100);var n=t.call(this)||this;return n.holdIntervalDelay=100,n._enabled=!0,n._holding=!1,n._intervalId=-1,n._deltaTime=0,n._elapsedTime=0,n._lastTime=0,n._holdStart=function(t){n._enabled&&(n._holding||(n._deltaTime=0,n._elapsedTime=0,n._lastTime=performance.now(),n.dispatchEvent({type:r.HOLD_START,deltaTime:n._deltaTime,elapsedTime:n._elapsedTime,originalEvent:t}),n._holding=!0,n._intervalId=window.setInterval((function(){var t=performance.now();n._deltaTime=t-n._lastTime,n._elapsedTime+=n._deltaTime,n._lastTime=performance.now(),n.dispatchEvent({type:r.HOLDING,deltaTime:n._deltaTime,elapsedTime:n._elapsedTime})}),n.holdIntervalDelay)))},n._holdEnd=function(t){if(n._enabled&&n._holding){var e=performance.now();n._deltaTime=e-n._lastTime,n._elapsedTime+=n._deltaTime,n._lastTime=performance.now(),n.dispatchEvent({type:r.HOLD_END,deltaTime:n._deltaTime,elapsedTime:n._elapsedTime,originalEvent:t}),window.clearInterval(n._intervalId),n._holding=!1}},n.holdIntervalDelay=e,n}return o(e,t),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled!==t&&(this._enabled=t,this._enabled||this._holdEnd())},enumerable:!0,configurable:!0}),e}(function(){function t(){this._listeners={}}return t.prototype.addEventListener=function(t,e){var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},t.prototype.removeEventListener=function(t,e){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}},t.prototype.dispatchEvent=function(t){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}},t}()),s=(function(t){function e(e,n){void 0===n&&(n=100);var r=t.call(this,n)||this;r._holdStart=r._holdStart.bind(r),r._holdEnd=r._holdEnd.bind(r);var i=r._holdStart,o=r._holdEnd;return e.addEventListener("mousedown",i),document.addEventListener("mouseup",o),window.addEventListener("blur",r._holdEnd),r}o(e,t)}(a),function(t){function e(e,n){void 0===n&&(n=100);var r=t.call(this,n)||this;r._holdStart=r._holdStart.bind(r),r._holdEnd=r._holdEnd.bind(r);return document.addEventListener("keydown",(function(t){(function(t){var e=t.target;return"INPUT"===e.tagName||"SELECT"===e.tagName||"TEXTAREA"===e.tagName||e.isContentEditable})(t)||t.keyCode===e&&r._holdStart(t)})),document.addEventListener("keyup",(function(t){t.keyCode===e&&r._holdEnd(t)})),window.addEventListener("blur",r._holdEnd),r}return o(e,t),e}(a))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(11),i=n(30),o=n(53);function a(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return Object(r.a)(n)?(t.pop(),Object(o.a)(t,n)):Object(i.a)(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(18);function i(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o(t)}function o(t){return 0===t.length?r.a:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){return"function"===typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(74),i=n(35),o=n(21),a=n(23),s=n(73),u=n(75),c=n(51),l=function(t){if(t&&"function"===typeof t[a.a])return l=t,function(t){var e=l[a.a]();if("function"!==typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(Object(s.a)(t))return Object(r.a)(t);if(Object(u.a)(t))return n=t,function(t){return n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,i.a),t};if(t&&"function"===typeof t[o.a])return e=t,function(t){for(var n=e[o.a]();;){var r=n.next();if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"===typeof n.return&&t.add((function(){n.return&&n.return()})),t};var e,n,l,d=Object(c.a)(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+d+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")}},function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return d}));var r=n(0),i=n(11),o=n(8),a=n(4),s=n(3),u=n(30),c={};function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=null,r=null;return Object(i.a)(t[t.length-1])&&(r=t.pop()),"function"===typeof t[t.length-1]&&(n=t.pop()),1===t.length&&Object(o.a)(t[0])&&(t=t[0]),Object(u.a)(t,r).lift(new d(n))}var d=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new f(t,this.resultSelector))},t}(),f=function(t){function e(e,n){var r=t.call(this,e)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return r.a(e,t),e.prototype._next=function(t){this.values.push(c),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var n=0;n<e;n++){var r=t[n];this.add(Object(s.a)(this,r,r,n))}}},e.prototype.notifyComplete=function(t){0===(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,n,r,i){var o=this.values,a=o[n],s=this.toRespond?a===c?--this.toRespond:this.toRespond:0;o[n]=e,0===s&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))},e.prototype._tryResultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)},e}(a.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(25),i=n(18);function o(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),Object(r.a)(i.a,t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2);function i(t,e){return e?new r.a((function(n){return e.schedule(o,0,{error:t,subscriber:n})})):new r.a((function(e){return e.error(t)}))}function o(t){var e=t.error;t.subscriber.error(e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=n(1);function o(){return function(t){return t.lift(new a(t))}}var a=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var n=this.connectable;n._refCount++;var r=new s(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i},t}(),s=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return r.a(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var n=this.connection,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(0),i=n(7),o=n(70),a=n(5),s=n(65),u=n(24),c=n(76),l=function(t){function e(e,n,r){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=t.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=e<1?1:e,i._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return r.a(e,t),e.prototype.nextInfiniteTimeWindow=function(e){var n=this._events;n.push(e),n.length>this._bufferSize&&n.shift(),t.prototype.next.call(this,e)},e.prototype.nextTimeWindow=function(e){this._events.push(new d(this._getNow(),e)),this._trimBufferThenGetEvents(),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;if(this.closed)throw new u.a;if(this.isStopped||this.hasError?e=a.a.EMPTY:(this.observers.push(t),e=new c.a(this,t)),i&&t.add(t=new s.a(t,i)),n)for(var l=0;l<o&&!t.closed;l++)t.next(r[l]);else for(l=0;l<o&&!t.closed;l++)t.next(r[l].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||o.a).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(t-r[o].time<n);)o++;return i>e&&(o=Math.max(o,i-e)),o>0&&r.splice(0,o),r},e}(i.a),d=function(){return function(t,e){this.time=t,this.value=e}}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(13),o=n(12);function a(t){return new r.a((function(e){var n;try{n=t()}catch(r){return void e.error(r)}return(n?Object(i.a)(n):Object(o.b)()).subscribe(e)}))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return d}));var r=n(0),i=n(30),o=n(8),a=n(1),s=n(4),u=n(3),c=n(21);function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return"function"===typeof n&&t.pop(),Object(i.a)(t,void 0).lift(new d(n))}var d=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new f(t,this.resultSelector))},t}(),f=function(t){function e(e,n,r){void 0===r&&(r=Object.create(null));var i=t.call(this,e)||this;return i.iterators=[],i.active=0,i.resultSelector="function"===typeof n?n:null,i.values=r,i}return r.a(e,t),e.prototype._next=function(t){var e=this.iterators;Object(o.a)(t)?e.push(new p(t)):"function"===typeof t[c.a]?e.push(new h(t[c.a]())):e.push(new m(this.destination,this,t))},e.prototype._complete=function(){var t=this.iterators,e=t.length;if(this.unsubscribe(),0!==e){this.active=e;for(var n=0;n<e;n++){var r=t[n];if(r.stillUnsubscribed)this.destination.add(r.subscribe(r,n));else this.active--}}else this.destination.complete()},e.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},e.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,n=this.destination,r=0;r<e;r++){if("function"===typeof(a=t[r]).hasValue&&!a.hasValue())return}var i=!1,o=[];for(r=0;r<e;r++){var a,s=(a=t[r]).next();if(a.hasCompleted()&&(i=!0),s.done)return void n.complete();o.push(s.value)}this.resultSelector?this._tryresultSelector(o):n.next(o),i&&n.complete()},e.prototype._tryresultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)},e}(a.a),h=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return t&&t.done},t}(),p=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[c.a]=function(){return this},t.prototype.next=function(t){var e=this.index++,n=this.array;return e<this.length?{value:n[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),m=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.parent=n,i.observable=r,i.stillUnsubscribed=!0,i.buffer=[],i.isComplete=!1,i}return r.a(e,t),e.prototype[c.a]=function(){return this},e.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},e.prototype.hasValue=function(){return this.buffer.length>0},e.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},e.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},e.prototype.notifyNext=function(t,e,n,r,i){this.buffer.push(e),this.parent.checkIterators()},e.prototype.subscribe=function(t,e){return Object(u.a)(this,this.observable,this,e)},e}(s.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(59);function i(t,e){if(t){if("string"===typeof t)return Object(r.a)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(t,e):void 0}}},function(t,e,n){"use strict";function r(t){return null!==t&&"object"===typeof t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1);function i(t){for(;t;){var e=t,n=e.closed,i=e.destination,o=e.isStopped;if(n||o)return!1;t=i&&i instanceof r.a?i:null}return!0}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2),i=n(5);function o(t,e){return new r.a((function(n){var r=new i.a,o=0;return r.add(e.schedule((function(){o!==t.length?(n.next(t[o++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(0),i=1,o=function(){return Promise.resolve()}(),a={};function s(t){return t in a&&(delete a[t],!0)}var u=function(t){var e=i++;return a[e]=!0,o.then((function(){return s(e)&&t()})),e},c=function(t){s(t)},l=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return r.a(e,t),e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0?t.prototype.requestAsyncId.call(this,e,n,r):(e.actions.push(this),e.scheduled||(e.scheduled=u(e.flush.bind(e,null))))},e.prototype.recycleAsyncId=function(e,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,r);0===e.actions.length&&(c(n),e.scheduled=void 0)},e}(n(32).a),d=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.a(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,r=-1,i=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++r<i&&(t=n.shift()));if(this.active=!1,e){for(;++r<i&&(t=n.shift());)t.unsubscribe();throw e}},e}(n(29).a))(l)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(17),i=n(35),o={closed:!0,next:function(t){},error:function(t){if(r.a.useDeprecatedSynchronousErrorHandling)throw t;Object(i.a)(t)},complete:function(){}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(59);var i=n(50);function o(t){return function(t){if(Array.isArray(t))return Object(r.a)(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(i.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(t,e,n){t.exports=n(105)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=function(){return Date.now()},t}()},function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return f}));var r=n(0),i=n(1),o=n(5),a=n(2),s=n(7);function u(t,e,n,r){return function(i){return i.lift(new c(t,e,n,r))}}var c=function(){function t(t,e,n,r){this.keySelector=t,this.elementSelector=e,this.durationSelector=n,this.subjectSelector=r}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},t}(),l=function(t){function e(e,n,r,i,o){var a=t.call(this,e)||this;return a.keySelector=n,a.elementSelector=r,a.durationSelector=i,a.subjectSelector=o,a.groups=null,a.attemptedToUnsubscribe=!1,a.count=0,a}return r.a(e,t),e.prototype._next=function(t){var e;try{e=this.keySelector(t)}catch(n){return void this.error(n)}this._group(t,e)},e.prototype._group=function(t,e){var n=this.groups;n||(n=this.groups=new Map);var r,i=n.get(e);if(this.elementSelector)try{r=this.elementSelector(t)}catch(u){this.error(u)}else r=t;if(!i){i=this.subjectSelector?this.subjectSelector():new s.a,n.set(e,i);var o=new f(e,i,this);if(this.destination.next(o),this.durationSelector){var a=void 0;try{a=this.durationSelector(new f(e,i))}catch(u){return void this.error(u)}this.add(a.subscribe(new d(e,i,this)))}}i.closed||i.next(r)},e.prototype._error=function(t){var e=this.groups;e&&(e.forEach((function(e,n){e.error(t)})),e.clear()),this.destination.error(t)},e.prototype._complete=function(){var t=this.groups;t&&(t.forEach((function(t,e){t.complete()})),t.clear()),this.destination.complete()},e.prototype.removeGroup=function(t){this.groups.delete(t)},e.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&t.prototype.unsubscribe.call(this))},e}(i.a),d=function(t){function e(e,n,r){var i=t.call(this,n)||this;return i.key=e,i.group=n,i.parent=r,i}return r.a(e,t),e.prototype._next=function(t){this.complete()},e.prototype._unsubscribe=function(){var t=this.parent,e=this.key;this.key=this.parent=null,t&&t.removeGroup(e)},e}(i.a),f=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.groupSubject=n,i.refCountSubscription=r,i}return r.a(e,t),e.prototype._subscribe=function(t){var e=new o.a,n=this.refCountSubscription,r=this.groupSubject;return n&&!n.closed&&e.add(new h(n)),e.add(r.subscribe(t)),e},e}(a.a),h=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,e.count++,n}return r.a(e,t),e.prototype.unsubscribe=function(){var e=this.parent;e.closed||this.closed||(t.prototype.unsubscribe.call(this),e.count-=1,0===e.count&&e.attemptedToUnsubscribe&&e.unsubscribe())},e}(o.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(2),i=n(9),o=n(33),a=n(11);function s(t,e,n){void 0===t&&(t=0);var s=-1;return Object(o.a)(e)?s=Number(e)<1?1:Number(e):Object(a.a)(e)&&(n=e),Object(a.a)(n)||(n=i.a),new r.a((function(e){var r=Object(o.a)(t)?t:+t-n.now();return n.schedule(u,r,{index:0,period:s,subscriber:e})}))}function u(t){var e=t.index,n=t.period,r=t.subscriber;if(r.next(e),!r.closed){if(-1===n)return r.complete();t.index=e+1,this.schedule(t,n)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(44);function i(){return Object(r.a)(1)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(2),i=n(11),o=n(44),a=n(30);function s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Number.POSITIVE_INFINITY,s=null,u=t[t.length-1];return Object(i.a)(u)?(s=t.pop(),t.length>1&&"number"===typeof t[t.length-1]&&(n=t.pop())):"number"===typeof u&&(n=t.pop()),null===s&&1===t.length&&t[0]instanceof r.a?t[0]:Object(o.a)(n)(Object(a.a)(t,s))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return l}));var r=n(0),i=n(7),o=n(2),a=n(1),s=n(5),u=n(46),c=function(t){function e(e,n){var r=t.call(this)||this;return r.source=e,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return r.a(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new s.a).add(this.source.subscribe(new d(this.getSubject(),this))),t.closed&&(this._connection=null,t=s.a.EMPTY)),t},e.prototype.refCount=function(){return Object(u.a)()(this)},e}(o.a),l=function(){var t=c.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}}(),d=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return r.a(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(i.b);a.a},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return u}));var r=n(0),i=n(1),o=n(20);function a(t,e){return void 0===e&&(e=0),function(n){return n.lift(new s(t,e))}}var s=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.scheduler,this.delay))},t}(),u=function(t){function e(e,n,r){void 0===r&&(r=0);var i=t.call(this,e)||this;return i.scheduler=n,i.delay=r,i}return r.a(e,t),e.dispatch=function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new c(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(o.a.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(o.a.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(o.a.createComplete()),this.unsubscribe()},e}(i.a),c=function(){return function(t,e){this.notification=t,this.destination=e}}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0),i=n(7),o=n(24),a=function(t){function e(e){var n=t.call(this)||this;return n._value=e,n}return r.a(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new o.a;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(0),i=n(8),o=n(30),a=n(4),s=n(3);function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length){if(!Object(i.a)(t[0]))return t[0];t=t[0]}return Object(o.a)(t,void 0).lift(new c)}var c=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new l(t))},t}(),l=function(t){function e(e){var n=t.call(this,e)||this;return n.hasFirst=!1,n.observables=[],n.subscriptions=[],n}return r.a(e,t),e.prototype._next=function(t){this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{for(var n=0;n<e&&!this.hasFirst;n++){var r=t[n],i=Object(s.a)(this,r,r,n);this.subscriptions&&this.subscriptions.push(i),this.add(i)}this.observables=null}},e.prototype.notifyNext=function(t,e,n,r,i){if(!this.hasFirst){this.hasFirst=!0;for(var o=0;o<this.subscriptions.length;o++)if(o!==n){var a=this.subscriptions[o];a.unsubscribe(),this.remove(a)}this.subscriptions=null}this.destination.next(e)},e}(a.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return t.prototype=Object.create(Error.prototype),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(2),i=n(5),o=n(23);var a=n(53),s=n(21);var u=n(75),c=n(73);function l(t,e){if(null!=t){if(function(t){return t&&"function"===typeof t[o.a]}(t))return function(t,e){return new r.a((function(n){var r=new i.a;return r.add(e.schedule((function(){var i=t[o.a]();r.add(i.subscribe({next:function(t){r.add(e.schedule((function(){return n.next(t)})))},error:function(t){r.add(e.schedule((function(){return n.error(t)})))},complete:function(){r.add(e.schedule((function(){return n.complete()})))}}))}))),r}))}(t,e);if(Object(u.a)(t))return function(t,e){return new r.a((function(n){var r=new i.a;return r.add(e.schedule((function(){return t.then((function(t){r.add(e.schedule((function(){n.next(t),r.add(e.schedule((function(){return n.complete()})))})))}),(function(t){r.add(e.schedule((function(){return n.error(t)})))}))}))),r}))}(t,e);if(Object(c.a)(t))return Object(a.a)(t,e);if(function(t){return t&&"function"===typeof t[s.a]}(t)||"string"===typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new r.a((function(n){var r,o=new i.a;return o.add((function(){r&&"function"===typeof r.return&&r.return()})),o.add(e.schedule((function(){r=t[s.a](),o.add(e.schedule((function(){if(!n.closed){var t,e;try{var i=r.next();t=i.value,e=i.done}catch(o){return void n.error(o)}e?n.complete():(n.next(t),this.schedule())}})))}))),o}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return r.a(e,t),e.prototype.schedule=function(e,n){return void 0===n&&(n=0),n>0?t.prototype.schedule.call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,n){return n>0||this.closed?t.prototype.execute.call(this,e,n):this._execute(e,n)},e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?t.prototype.requestAsyncId.call(this,e,n,r):e.flush(this)},e}(n(32).a),o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.a(e,t),e}(n(29).a))(i)},function(t,e,n){"use strict";function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(t){return t&&"number"===typeof t.length&&"function"!==typeof t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(t){return function(e){for(var n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()}}},function(t,e,n){"use strict";function r(t){return!!t&&"function"!==typeof t.subscribe&&"function"===typeof t.then}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0),i=function(t){function e(e,n){var r=t.call(this)||this;return r.subject=e,r.subscriber=n,r.closed=!1,r}return r.a(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(n(5).a)},function(t,e,n){"use strict";function r(t,e){function n(){return!n.pred.apply(n.thisArg,arguments)}return n.pred=t,n.thisArg=e,n}n.d(e,"a",(function(){return r}))},function(t,e,n){var r=n(87),i=n(89),o=n(81),a=n(90),s=n(92),u=n(129),c=n(57),l=n(94),d=n(95),f=n(96),h=n(97);"undefined"!=typeof self&&self,t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=75)}([function(t,e){t.exports=n(14)},function(t,e){t.exports=n(136)},function(t,e){t.exports=n(138)},function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var r=n(5),i=n.n(r),o={defines:{COGNITE_COLOR_BY_TREE_INDEX:!1}},a={simpleMesh:{fragment:i()(n(39).default),vertex:i()(n(40).default)},detailedMesh:{fragment:i()(n(41).default),vertex:i()(n(42).default)},instancedMesh:{fragment:i()(n(43).default),vertex:i()(n(44).default)},boxPrimitive:{fragment:i()(n(21).default),vertex:i()(n(22).default)},circlePrimitive:{fragment:i()(n(45).default),vertex:i()(n(46).default)},conePrimitive:{fragment:i()(n(47).default),vertex:i()(n(48).default)},eccentricConePrimitive:{fragment:i()(n(49).default),vertex:i()(n(50).default)},ellipsoidSegmentPrimitive:{fragment:i()(n(51).default),vertex:i()(n(52).default)},generalCylinderPrimitive:{fragment:i()(n(53).default),vertex:i()(n(54).default)},generalRingPrimitive:{fragment:i()(n(55).default),vertex:i()(n(56).default)},nutPrimitive:{fragment:i()(n(21).default),vertex:i()(n(22).default)},quadPrimitive:{fragment:i()(n(21).default),vertex:i()(n(22).default)},torusSegmentPrimitive:{fragment:i()(n(57).default),vertex:i()(n(58).default)},trapeziumPrimitive:{fragment:i()(n(59).default),vertex:i()(n(60).default)}},s={fragment:i()(n(61).default),vertex:i()(n(62).default)}},function(t,e){t.exports=n(137)},function(t,e){t.exports=n(131)},function(t,e){t.exports=n(132)},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Discarded=0]="Discarded",t[t.Simple=1]="Simple",t[t.Detailed=2]="Detailed"}(r||(r={}))},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.EptPointCloud="ept-pointcloud",t.RevealCadModel="reveal-directory"}(r||(r={}))},function(t,e,n){"use strict";function r(t,e){if(e(t)&&t.children){var n,i=h(t.children);try{for(i.s();!(n=i.n()).done;)r(n.value,e)}catch(o){i.e(o)}finally{i.f()}}}function i(t,e){e(t)&&t.parent&&i(t.parent,e)}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},function(t,e,n){"use strict";n.r(e),n.d(e,"HtmlOverlayHelper",(function(){return i})),n.d(e,"worldToViewport",(function(){return r.b})),n.d(e,"toThreeVector3",(function(){return o.g})),n.d(e,"fitCameraToBoundingBox",(function(){return o.a})),n.d(e,"toThreeMatrix4",(function(){return o.f})),n.d(e,"toThreeJsBox3",(function(){return o.e})),n.d(e,"fromThreeJsBox3",(function(){return o.b})),n.d(e,"fromThreeVector3",(function(){return o.d})),n.d(e,"fromThreeMatrix",(function(){return o.c})),n.d(e,"SsaoEffect",(function(){return x})),n.d(e,"SsaoPassType",(function(){return y})),n.d(e,"BoundingBoxClipper",(function(){return _.a}));var r=n(26),i=function(){function t(){d(this,t),this.htmlOverlays=new Map}return f(t,[{key:"addOverlayElement",value:function(t,e){if("absolute"!==t.style.position)throw new Error("htmlElement style must have a position of absolute");this.htmlOverlays.set(t,e)}},{key:"removeOverlayElement",value:function(t){this.htmlOverlays.delete(t)}},{key:"updatePositions",value:function(t,e){this.htmlOverlays.forEach((function(n,i){var o=t.domElement,a=Object(r.b)(o,e,n),s=a.x,u=a.y;i.style.top="".concat(u+o.offsetTop,"px"),i.style.left="".concat(s+o.offsetLeft,"px")}))}}]),t}(),o=n(12),a=n(5),s=n.n(a),u=n(0),c=n(14),l=s()(n(69).default),h=s()(n(70).default),p=s()(n(71).default),m=s()(n(72).default),v=s()(n(73).default);function g(t){var e=new u.Scene,n=new u.ShaderMaterial({uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,depthWrite:!1}),r=new u.Mesh(new u.PlaneBufferGeometry(2,2),n);return r.frustumCulled=!1,e.add(r),e}var y,b=new u.OrthographicCamera(-1,1,1,-1,0,1);!function(t){t.Regular="Regular",t.Ssao="Ssao",t.SsaoFinal="SsaoFinal",t.Antialias="Antialias"}(y||(y={}));var x=function(){function t(){d(this,t),this._ssaoPass=function(){var t=new u.WebGLRenderTarget(0,0);t.depthBuffer=!0,t.depthTexture=new u.DepthTexture(0,0),t.depthTexture.type=u.UnsignedIntType;var e=new u.WebGLRenderTarget(0,0);e.depthBuffer=!1,e.stencilBuffer=!1;var n=new u.WebGLRenderTarget(0,0);n.depthBuffer=!1,n.stencilBuffer=!1;var r=new u.WebGLRenderTarget(0,0,{minFilter:u.LinearFilter,magFilter:u.LinearFilter,format:u.RGBFormat,stencilBuffer:!1}),i=function(){for(var t,e=[],n=0;n<32;n++){for(var r=new u.Vector3;r.length()<.5;)r.x=2*Math.random()-1,r.y=2*Math.random()-1,r.z=Math.random();r.normalize();var i=n/32;i=.1+.9*(t=(t=(t=i*i)<0?0:t)>1?1:t),r.multiplyScalar(i),e.push(r)}return e}(),o=function(){for(var t=new Float32Array(65536),e=0;e<16384;e++){var n=4*e,r=2*Math.random()-1,i=2*Math.random()-1,o=2*Math.random()-1;t[n]=r,t[n+1]=i,t[n+2]=o,t[n+3]=1}var a=new u.DataTexture(t,128,128,u.RGBAFormat,u.FloatType);return a.wrapS=u.RepeatWrapping,a.wrapT=u.RepeatWrapping,a}(),a={tDiffuse:{value:t.texture},tDepth:{value:t.depthTexture},tNoise:{value:o},resolution:{value:new u.Vector2},kernel:{value:i},kernelRadius:{value:1},minDistance:{value:1e-4},maxDistance:{value:.1},cameraNear:{value:0},cameraFar:{value:0},cameraProjectionMatrix:{value:new u.Matrix4},cameraInverseProjectionMatrix:{value:new u.Matrix4}},s=g({uniforms:a,vertexShader:p,fragmentShader:m}),d=function(t,e){var n={tDiffuse:{value:t},ssaoTexture:{value:e},size:{value:new u.Vector2}};return{scene:g({uniforms:n,vertexShader:p,fragmentShader:v}),uniforms:n}}(t.texture,e.texture),f=d.scene,x=d.uniforms,_=function(t){var e={tDiffuse:{value:t},resolution:{value:new u.Vector2}};return{scene:g({uniforms:e,vertexShader:l,fragmentShader:h}),uniforms:e}}(n.texture),w=_.scene,T=_.uniforms,S=new u.Vector2;return{render:function(i,o,l,d){var h,p;i.getSize(S),t.width===S.x&&t.height===S.y||(h=S.x,p=S.y,t.setSize(h,p),r.setSize(h,p),T.resolution.value.set(h,p),e.setSize(h,p),a.resolution.value.set(h,p),n.setSize(h,p),x.size.value.set(h,p)),d=d||y.Antialias,i.setClearColor(new u.Color(7829503),0),i.setRenderTarget(t),i.clear(!0,!0,!1),d===y.Regular&&i.setRenderTarget(null),o.traverseVisible((function(t){"CadNode"===t.type&&(t.renderMode=c.a.PackColorAndNormal)})),i.render(o,l),o.traverseVisible((function(t){"CadNode"===t.type&&(t.renderMode=c.a.Color)})),d!==y.Regular&&(a.cameraNear.value=l.near,a.cameraFar.value=l.far,a.cameraProjectionMatrix.value=l.projectionMatrix,a.cameraInverseProjectionMatrix.value=l.projectionMatrixInverse,i.setRenderTarget(e),d===y.Ssao&&i.setRenderTarget(null),i.render(s,b),d!==y.Ssao&&(i.setRenderTarget(n),d===y.SsaoFinal&&i.setRenderTarget(null),i.render(f,b),d!==y.SsaoFinal&&(i.setRenderTarget(null),i.render(w,b))))},uniforms:a}}()}return f(t,[{key:"render",value:function(t,e,n,r){this._ssaoPass.render(t,e,n,r)}},{key:"kernelRadius",get:function(){return this._ssaoPass.uniforms.kernelRadius.value},set:function(t){this._ssaoPass.uniforms.kernelRadius.value=t}},{key:"minDistance",get:function(){return this._ssaoPass.uniforms.minDistance.value},set:function(t){this._ssaoPass.uniforms.minDistance.value=t}},{key:"maxDistance",get:function(){return this._ssaoPass.uniforms.maxDistance.value},set:function(t){this._ssaoPass.uniforms.maxDistance.value=t}}]),t}(),_=n(63)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2),i=function(){function t(e){d(this,t),this.min=r.vec3.fromValues(1/0,1/0,1/0),this.max=r.vec3.fromValues(-1/0,-1/0,-1/0);var n,i=h(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;this.min[0]=Math.min(o[0],this.min[0]),this.min[1]=Math.min(o[1],this.min[1]),this.min[2]=Math.min(o[2],this.min[2]),this.max[0]=Math.max(o[0],this.max[0]),this.max[1]=Math.max(o[1],this.max[1]),this.max[2]=Math.max(o[2],this.max[2])}}catch(a){i.e(a)}finally{i.f()}}return f(t,[{key:"createTransformed",value:function(e){return new t([r.vec3.transformMat4(r.vec3.create(),this.min,e),r.vec3.transformMat4(r.vec3.create(),this.max,e)])}},{key:"containsPoint",value:function(t){return t[0]>=this.min[0]&&t[1]>=this.min[1]&&t[2]>=this.min[2]&&t[0]<=this.max[0]&&t[1]<=this.max[1]&&t[2]<=this.max[2]}},{key:"intersectsBox",value:function(t){var e=this;return e.min[0]<=t.max[0]&&e.max[0]>=t.min[0]&&e.min[1]<=t.max[1]&&e.max[1]>=t.min[1]&&e.min[2]<=t.max[2]&&e.max[2]>=t.min[2]}},{key:"center",get:function(){var t=r.vec3.create(),e=r.vec3.add(t,this.min,this.max);return r.vec3.scale(t,e,.5)}},{key:"size",get:function(){return r.vec3.subtract(r.vec3.create(),this.max,this.min)}}],[{key:"fromBounds",value:function(e,n,i,o,a,s){return new t([r.vec3.fromValues(e,n,i),r.vec3.fromValues(o,a,s)])}},{key:"fromCenterAndSize",value:function(e,n){return new t([r.vec3.scaleAndAdd(r.vec3.create(),e,n,-.5),r.vec3.scaleAndAdd(r.vec3.create(),e,n,.5)])}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"g",(function(){return u})),n.d(e,"f",(function(){return l})),n.d(e,"d",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"e",(function(){return p})),n.d(e,"b",(function(){return v}));var r=n(0),i=n(11),o=n(2);function a(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=new r.Vector3(e.min[0],e.min[1],e.min[2]),o=new r.Vector3(e.max[0],e.max[1],e.max[2]),a=new r.Box3(i,o),s=new r.Sphere;a.getBoundingSphere(s);var u=s.center,c=s.radius*n,l=new r.Vector3(0,0,-1);l.applyQuaternion(t.quaternion);var d=new r.Vector3;d.copy(l).multiplyScalar(-c).add(u),t.position.set(d.x,d.y,d.z)}var s={result:o.vec3.create()};function u(t,e,n){if(!n)return t.set(e[0],e[1],e[2]),t;var r=s.result;return o.vec3.transformMat4(r,e,n.modelMatrix),t.set(r[0],r[1],r[2]),t}var c={result:o.mat4.create()};function l(t,e){if(!e)return(new r.Matrix4).fromArray(t);var n=c.result;return o.mat4.multiply(n,e.modelMatrix,t),(new r.Matrix4).fromArray(n)}function d(t,e,n){var r=o.vec3.set(t,e.x,e.y,e.z);return n?o.vec3.transformMat4(t,r,n.inverseModelMatrix):r}function f(t,e,n){return t[0]=e.elements[0],t[1]=e.elements[1],t[2]=e.elements[2],t[3]=e.elements[3],t[4]=e.elements[4],t[5]=e.elements[5],t[6]=e.elements[6],t[7]=e.elements[7],t[8]=e.elements[8],t[9]=e.elements[9],t[10]=e.elements[10],t[11]=e.elements[11],t[12]=e.elements[12],t[13]=e.elements[13],t[14]=e.elements[14],t[15]=e.elements[15],n?o.mat4.multiply(t,n.inverseModelMatrix,t):t}var h={outMin:new r.Vector3,outMax:new r.Vector3};function p(t,e,n){var r=h.outMin,i=h.outMax;return t.set(u(r,e.min,n),u(i,e.max,n)),t}var m={min:o.vec3.create(),max:o.vec3.create()};function v(t){var e=m.min,n=m.max;return d(e,t.min),d(n,t.max),new i.a([e,n])}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=function(){function t(e,n){d(this,t),this.model=e,this.outputs=n}return f(t,[{key:"findMostRecentOutput",value:function(t,e){var n=this.outputs.filter((function(n){return n.format===t&&(!e||-1!==e.indexOf(n.version))}));return n.length>0?n.reduce((function(t,e){return e.version>t.version?e:t})):void 0}}]),t}(),i=function(){function t(e){d(this,t),this.client=e}return f(t,[{key:"retrieveJsonBlob",value:function(){var t=l(c.mark((function t(e,n){var r;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.buildBlobRequestPath(e)+(n?"/".concat(n):""),t.next=3,this.client.get(r);case 3:return t.abrupt("return",t.sent.data);case 4:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"retrieveBinaryBlob",value:function(){var t=l(c.mark((function t(e,n){var r,i;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="".concat(this.client.getBaseUrl()).concat(this.buildBlobRequestPath(e)).concat(n?"/".concat(n):""),i=u(u({},this.client.getDefaultRequestHeaders()),{},{Accept:"*/*"}),t.next=3,fetch(r,{headers:i,method:"GET"});case 3:return t.abrupt("return",t.sent.arrayBuffer());case 4:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"buildBlobRequestPath",value:function(t){return"/api/playground/projects/".concat(this.client.project,"/3d/v2/blobs/").concat(t)}},{key:"getOutputs",value:function(){var t=l(c.mark((function t(e,n){var i,o,a,s;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i="/api/playground/projects/".concat(this.client.project,"/3d/v2/outputs"),o={models:[e],formats:n},t.next=4,this.client.post(i,{data:o});case 4:if(200!==(a=t.sent).status){t.next=8;break}return s=a.data.items[0],t.abrupt("return",new r(s.model,s.outputs));case 8:throw new Error("Unexpected response ".concat(a.status," (payload: '").concat(a.data,")"));case 9:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()}]),t}()},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Color=1]="Color",t[t.Normal=2]="Normal",t[t.TreeIndex=3]="TreeIndex",t[t.PackColorAndNormal=4]="PackColorAndNormal",t[t.Depth=5]="Depth"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(2),i=r.mat4.fromValues(1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1),o=r.mat4.invert(r.mat4.create(),i)},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o}));var r,i,o,a=n(6);!function(t){t[t.Circle=a.PointShape.CIRCLE]="Circle",t[t.Square=a.PointShape.SQUARE]="Square"}(r||(r={})),function(t){t[t.Rgb=a.PointColorType.RGB]="Rgb",t[t.Depth=a.PointColorType.DEPTH]="Depth",t[t.Height=a.PointColorType.HEIGHT]="Height",t[t.PointIndex=a.PointColorType.POINT_INDEX]="PointIndex",t[t.LevelOfDetail=a.PointColorType.LOD]="LevelOfDetail",t[t.Classification=a.PointColorType.CLASSIFICATION]="Classification"}(i||(i={})),function(t){t[t.Adaptive=a.PointSizeType.ADAPTIVE]="Adaptive",t[t.Fixed=a.PointSizeType.FIXED]="Fixed"}(o||(o={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(16),i=n(12),o=n(11),a=n(2),s=function(){function t(e){d(this,t),this.octtree=e,this.pointSize=2,this.pointSizeType=r.c.Adaptive,this.pointColorType=r.a.Rgb,this.pointShape=r.b.Circle,this.pointBudget=2e6}return f(t,[{key:"pointSize",get:function(){return this.octtree.material.size},set:function(t){this.octtree.material.size=t}},{key:"pointSizeType",get:function(){return this.octtree.material.pointSizeType},set:function(t){this.octtree.material.pointSizeType=t}},{key:"pointBudget",get:function(){return this.octtree.pointBudget},set:function(t){this.octtree.pointBudget=t}},{key:"visiblePointCount",get:function(){return this.octtree.numVisiblePoints||0}},{key:"boundingBox",get:function(){var t=this.octtree.root.tightBoundingBox,e=Object(i.b)(t),n=a.vec3.fromValues(e.min[0],e.min[2],-e.min[1]),r=a.vec3.fromValues(e.max[0],e.max[2],-e.max[1]);return new o.a([n,r])}},{key:"pointColorType",get:function(){return this.octtree.material.pointColorType},set:function(t){this.octtree.material.pointColorType=t}},{key:"pointShape",get:function(){return this.octtree.material.shape},set:function(t){this.octtree.material.shape=t}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(6),i=function(){function t(){d(this,t)}return f(t,null,[{key:"load",value:function(){var t=l(c.mark((function t(e){var n,i,o,a,s,u,l,d;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.XHRFactory.fetch(e);case 2:return n=t.sent,t.next=5,n.json();case 5:return i=t.sent,o=e.substr(0,e.lastIndexOf("ept.json")),a=new r.PointCloudEptGeometry(o,i),s=a.offset.x,u=a.offset.y,l=a.offset.z,d=new r.PointCloudEptGeometryNode(a,a.boundingBox,0,s,u,l),t.abrupt("return",(a.root=d,a.root.load(),a));case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n(0),u=n(24),c=n(12),l=n(7),p=function(t){a(n,t);var e=s(n);function n(t,r){var i;return d(this,n),(i=e.call(this)).name="Sector ".concat(r," [id=").concat(t,"]"),i.sectorId=t,i.lod=l.a.Discarded,i}return n}(r.Group),m=function(t){a(n,t);var e=s(n);function n(t){var r;d(this,n),r=e.call(this,0,"/");var i=t.scene,a=t.modelTransformation;return r.applyMatrix4(Object(c.f)(a.modelMatrix)),r.sectorNodeMap=new Map,function(t,e,n){!function t(e,n,r){var i=new p(e.id,e.path);i.name="Sector ".concat(e.id),n.add(i),r.set(e.id,i);var o,a=h(e.children);try{for(a.s();!(o=a.n()).done;)t(o.value,i,r)}catch(s){a.e(s)}finally{a.f()}}(t,e,n)}(i.root,o(r),r.sectorNodeMap),r}return n}(p),v=function(t){a(n,t);var e=s(n);function n(t,i){var o;d(this,n),(o=e.call(this))._previousCameraMatrix=new r.Matrix4,o.type="CadNode",o.name="Sector model",o._materialManager=i;var a=new m(t);o._cadModel=t;var s=t.scene,u=t.modelTransformation;return o._sectorScene=s,o.modelTransformation=u,o._previousCameraMatrix.elements[0]=1/0,o._rootSector=a,o.add(a),o._boundingBoxNode=o.createBoundingBoxNode(s.getAllSectors()),o.add(o._boundingBoxNode),o._renderHints={},o._loadingHints={},o.renderHints={},o.loadingHints={},o}return f(n,[{key:"requestNodeUpdate",value:function(t){this._materialManager.updateModelNodes(this._cadModel.identifier,t),this.dispatchEvent({type:"update"})}},{key:"suggestCameraConfig",value:function(){var t=Object(u.a)(this._sectorScene.root),e=t.position,n=t.target,i=t.near,o=t.far;return{position:Object(c.g)(new r.Vector3,e,this.modelTransformation),target:Object(c.g)(new r.Vector3,n,this.modelTransformation),near:i,far:o}}},{key:"createBoundingBoxNode",value:function(t){function e(t){return t.path.length/2}var n=t.reduce((function(t,n){return Math.max(t,e(n))}),0),o=new r.Color(16711680),a=new r.Color(65280),s=i(Array(n).keys()).map((function(t){var e=(new r.Color).copy(o);return e.lerpHSL(a,t/(n-1)),e})),u=new r.Group;return u.applyMatrix4(Object(c.f)(this.modelTransformation.modelMatrix)),u.name="Bounding boxes (for debugging)",t.forEach((function(t){var n=Object(c.e)(new r.Box3,t.bounds),i=s[e(t)],o=new r.Box3Helper(n,i);o.name="".concat(t.id),o.userData.sectorId=t.id,o.visible=!1,u.add(o)})),u}},{key:"clippingPlanes",get:function(){return this._materialManager.clippingPlanes},set:function(t){this._materialManager.clippingPlanes=t}},{key:"clipIntersection",get:function(){return this._materialManager.clipIntersection},set:function(t){this._materialManager.clipIntersection=t}},{key:"cadModel",get:function(){return this._cadModel}},{key:"sectorScene",get:function(){return this._sectorScene}},{key:"rootSector",get:function(){return this._rootSector}},{key:"materialManager",get:function(){return this._materialManager}},{key:"renderMode",set:function(t){this._materialManager.setRenderMode(t)},get:function(){return this._materialManager.getRenderMode()}},{key:"renderHints",set:function(t){this._renderHints=t,this._boundingBoxNode.visible=this.shouldRenderSectorBoundingBoxes},get:function(){return this._renderHints}},{key:"loadingHints",set:function(t){this._loadingHints=t},get:function(){return this._loadingHints}},{key:"shouldRenderSectorBoundingBoxes",get:function(){return this._renderHints.showSectorBoundingBoxes||!1}}]),n}(r.Object3D)},function(t,e,n){"use strict";n.d(e,"a",(function(){return x}));var r=n(0),o=n(2),a=n(9),s=n(12),p=function(){function t(e,n,r,i){d(this,t),this.version=e,this.maxTreeIndex=n,this.root=r,this.sectors=i}return f(t,[{key:"getSectorById",value:function(t){return this.sectors.get(t)}},{key:"getAllSectors",value:function(){return i(this.sectors.values())}},{key:"getSectorsContainingPoint",value:function(t){var e=[];return Object(a.a)(this.root,(function(n){return!!n.bounds.containsPoint(t)&&(e.push(n),!0)})),e}},{key:"getSectorsIntersectingBox",value:function(t){var e=[];return Object(a.a)(this.root,(function(n){return!!n.bounds.intersectsBox(t)&&(e.push(n),!0)})),e}},{key:"getSectorsIntersectingFrustum",value:function(t,e){var n=o.mat4.multiply(o.mat4.create(),t,e),i=(new r.Frustum).setFromProjectionMatrix(Object(s.f)(n)),u=new r.Box3,c=[];return Object(a.a)(this.root,(function(t){return!!i.intersectsBox(Object(s.e)(u,t.bounds))&&(c.push(t),!0)})),c}},{key:"sectorCount",get:function(){return this.sectors.size}}],[{key:"createFromRootSector",value:function(e,n,r){var i=new Map;return Object(a.a)(r,(function(t){return i.set(t.id,t),!0})),new t(e,n,r,i)}}]),t}(),m=n(11),v={quadSize:-1,coverageFactors:{xy:.5,yz:.5,xz:.5},recursiveCoverageFactors:{xy:.5,yz:.5,xz:.5},fileName:null,downloadSize:0};function g(t){return-1===t.facesFile.coverageFactors.xy}function y(t){var e;Object(a.b)(t,(function(t){return void 0===(e=g(t)?void 0:t.facesFile)})),e||(e=u({},v)),t.facesFile.coverageFactors.xy=e.recursiveCoverageFactors.xy,t.facesFile.coverageFactors.yz=e.recursiveCoverageFactors.yz,t.facesFile.coverageFactors.xz=e.recursiveCoverageFactors.xz,t.facesFile.recursiveCoverageFactors.xy=e.recursiveCoverageFactors.xy,t.facesFile.recursiveCoverageFactors.yz=e.recursiveCoverageFactors.yz,t.facesFile.recursiveCoverageFactors.xz=e.recursiveCoverageFactors.xz}var b=function(){function t(){d(this,t)}return f(t,[{key:"parse",value:function(t){var e=t.version;switch(e){case 8:return function(t){var e=new Map,n=[];t.sectors.forEach((function(t){var r=function(t){var e=function(t){return t.facesFile?u(u({},t.facesFile),{},{recursiveCoverageFactors:t.facesFile.recursiveCoverageFactors||t.facesFile.coverageFactors}):{quadSize:-1,coverageFactors:{xy:-1,yz:-1,xz:-1},recursiveCoverageFactors:{xy:-1,yz:-1,xz:-1},fileName:null,downloadSize:t.indexFile.downloadSize}}(t);return{id:t.id,path:t.path,depth:t.depth,bounds:new m.a([o.vec3.fromValues(t.boundingBox.min.x,t.boundingBox.min.y,t.boundingBox.min.z),o.vec3.fromValues(t.boundingBox.max.x,t.boundingBox.max.y,t.boundingBox.max.z)]),indexFile:u({},t.indexFile),facesFile:e,children:[],parent:void 0}}(t);e.set(t.id,r),n[t.id]=t.parentId}));var r,i=h(e.values());try{for(i.s();!(r=i.n()).done;){var a=r.value,s=n[a.id];if(-1!==s){var c=e.get(s);c.children.push(a),a.parent=c}}}catch(b){i.e(b)}finally{i.f()}var l,d=h(e.values());try{for(d.s();!(l=d.n()).done;){var f=l.value;g(f)&&y(f)}}catch(b){d.e(b)}finally{d.f()}var v=e.get(0);if(!v)throw new Error("Root sector not found, must have ID 0");return new p(t.version,t.maxTreeIndex,v,e)}(t);case void 0:throw new Error('Metadata must contain a "version"-field');default:throw new Error("Version ".concat(e," is not supported"))}}}]),t}(),x=function(){function t(e,n,r){d(this,t),this.identifier=e,this.dataRetriever=n,this._modelTransformation=r;var i=this.dataRetriever.fetchJson("scene.json");this.scenePromise=function(){var t=l(c.mark((function t(e){var n;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:return n=t.sent,t.abrupt("return",(new b).parse(n));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(i),this._scene=void 0}return f(t,[{key:"fetchSectorMetadata",value:function(){var t=l(c.mark((function t(){return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.scenePromise);case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"initialize",value:function(){var t=l(c.mark((function t(){return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.scenePromise;case 2:this._scene=t.sent;case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"modelTransformation",get:function(){return this._modelTransformation}},{key:"scene",get:function(){return this._scene}}],[{key:"create",value:function(){var e=l(c.mark((function e(n,r,i){var o;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new t(n,r,i),e.next=3,o.initialize();case 3:return e.abrupt("return",o);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),t}()},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nconst int RenderTypeColor = 1;\nconst int RenderTypeNormal = 2;\nconst int RenderTypeTreeIndex = 3;\nconst int RenderTypePackColorAndNormal = 4;\nconst int RenderTypeDepth = 5;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(int renderMode, vec3 color, float treeIndex, vec3 normal, float depth, sampler2D matCapTexture) {\n    if (renderMode == RenderTypeColor) {\n        vec3 hsv = rgb2hsv(color);\n        float h = hsv.x;\n        hsv.z = min(0.6 * hsv.z + 0.4, 1.0);\n        color = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        \n        vec4 albedo = vec4(color * (0.4 + 0.6 * amplitude), h);\n\n        vec2 cap = normal.xy * 0.5 + 0.5;\n\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1);\n        \n        gl_FragColor = albedo * mc * 1.7;\n\n    } else if (renderMode == RenderTypePackColorAndNormal) {\n        vec3 hsv = rgb2hsv(color);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex) {\n        color = packIntToColor(treeIndex);\n        gl_FragColor = vec4(color, 1.0);\n    } else if (renderMode == RenderTypeDepth) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n}\n\nbool determineVisibility(sampler2D visibilityTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 visible = texture2D(visibilityTexture, treeIndexUv);\n\n    return visible.r > 0.0;\n}\n\nvec3 determineColor(vec3 originalColor, sampler2D colorDataTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 overrideColor = texture2D(colorDataTexture, treeIndexUv);\n\n    return overrideColor.a * overrideColor.rgb + (1.0 - overrideColor.a) * originalColor;\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isSliced(vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nvarying float v_treeIndex;\nvarying vec3 v_normal;\nvarying vec3 v_color;\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 dataTextureSize;\n\nuniform int renderMode;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    if (!determineVisibility(overrideVisibilityPerTreeIndex, dataTextureSize, v_treeIndex)) {\n        discard;\n    }\n\n    if (isSliced(vViewPosition)) {\n        discard;\n    }\n\n    vec3 color = determineColor(v_color, colorDataTexture, dataTextureSize, v_treeIndex);\n    vec3 normal = normalize(v_normal);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n// TODO consider passing vec3 from a matrix3x4 to reduce memory usage and data transfer\n// TODO consider fixing Three.js so it is possible to pass a mat4:\n// see https://stackoverflow.com/questions/38853096/webgl-how-to-bind-values-to-a-mat4-attribute\n\nmat4 constructMatrix(vec4 column_0, vec4 column_1, vec4 column_2, vec4 column_3) {\n  return mat4(\n    column_0,\n    column_1,\n    column_2,\n    column_3\n  );\n}\n\nattribute vec4 a_instanceMatrix_column_0;\nattribute vec4 a_instanceMatrix_column_1;\nattribute vec4 a_instanceMatrix_column_2;\nattribute vec4 a_instanceMatrix_column_3;\n\nattribute float a_treeIndex;\nattribute vec3 a_color;\n\nvarying float v_treeIndex;\nvarying vec3 v_normal;\nvarying vec3 v_color;\n\nvarying vec3 vViewPosition;\n\nvoid main()\n{\n    mat4 instanceMatrix = constructMatrix(\n        a_instanceMatrix_column_0,\n        a_instanceMatrix_column_1,\n        a_instanceMatrix_column_2,\n        a_instanceMatrix_column_3\n    );\n\n    v_treeIndex = a_treeIndex;\n    v_color = a_color;\n    v_normal = normalMatrix * normalize(instanceMatrix * vec4(normalize(normal), 0.0)).xyz;\n\n    vec3 transformed = (instanceMatrix * vec4(position, 1.0)).xyz;\n    vec4 modelViewPosition = modelViewMatrix * vec4(transformed, 1.0);\n    vViewPosition = modelViewPosition.xyz;\n    gl_Position = projectionMatrix * modelViewPosition;\n}\n"},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0),o=n(12),a=n(3),s=new r.ShaderMaterial({vertexShader:a.a.vertex,fragmentShader:a.a.fragment}),u=new r.Quaternion,c=function(){function t(e){d(this,t),this.sectorIdOffset=0,this.scene=new r.Scene,this.containers=new Map,this.buffers={rtBuffer:new Uint8Array,sectorVisibilityBuffer:[]};var n=(e||{}).glContext,i=(e||{}).renderSize||new r.Vector2(640,480);this.renderer=new r.WebGLRenderer({context:n,antialias:!1,alpha:!1,precision:"lowp",stencil:!1}),this.renderer.setClearColor("#FFFFFF"),this.renderTarget=new r.WebGLRenderTarget(i.width,i.height,{generateMipmaps:!1,type:r.UnsignedByteType,format:r.RGBAFormat,stencilBuffer:!1}),this.renderer.setRenderTarget(this.renderTarget)}return f(t,[{key:"createDebugCanvas",value:function(t){if(this.debugRenderer)throw new Error("createDebugCanvas() can only be called once");var e=t?t.width:this.renderTarget.width,n=t?t.height:this.renderTarget.height;return this.debugRenderer=new r.WebGLRenderer({antialias:!1,alpha:!1,stencil:!1}),this.debugRenderer.setClearColor("white"),this.debugRenderer.setSize(e,n),this.debugRenderer.domElement}},{key:"setModels",value:function(t){var e,n=new Set,r=h(t);try{for(r.s();!(e=r.n()).done;){var o=e.value,a=o.identifier;n.add(a),this.containers.has(a)||this.addModel(o)}}catch(f){r.e(f)}finally{r.f()}var s,u=new Set(this.containers.keys()),c=new Set(i(u).filter((function(t){return!n.has(t)}))),l=h(c);try{for(l.s();!(s=l.n()).done;){var d=s.value;this.removeModel(d)}}catch(f){l.e(f)}finally{l.f()}}},{key:"orderSectorsByVisibility",value:function(t){var e=this;this.renderer.render(this.scene,t),this.debugRenderer&&this.debugRenderer.render(this.scene,t),this.prepareBuffers(),this.renderer.readRenderTargetPixels(this.renderTarget,0,0,this.renderTarget.width,this.renderTarget.height,this.buffers.rtBuffer);var n=this.unpackSectorVisibility(this.renderTarget.width,this.renderTarget.height,this.buffers.rtBuffer),r=n.reduce((function(t,e){return e.hitCount+t}),0);return n.filter((function(t){return t.hitCount>0})).sort((function(t,e){return t&&e?e.hitCount-t.hitCount:t?-1:e?1:0})).map((function(t){var n=e.findSectorContainer(t.sectorIdWithOffset),i=t.sectorIdWithOffset-n.sectorIdOffset;return{model:n.model,sectorId:i,priority:t.hitCount/r,depth:t.distance}}))}},{key:"removeModel",value:function(t){var e=this.containers.get(t);if(!e)throw new Error("Could not find model '".concat(t,"'"));this.scene.remove(e.renderable),this.containers.delete(t)}},{key:"addModel",value:function(t){var e=t.scene.getAllSectors(),n=this.createSectorTreeMesh(this.sectorIdOffset,e,t.modelTransformation);this.containers.set(t.identifier,{model:t,sectors:e,sectorIdOffset:this.sectorIdOffset,renderable:n}),this.sectorIdOffset+=e.length,this.scene.add(n)}},{key:"findSectorContainer",value:function(t){var e,n=h(this.containers.values());try{for(n.s();!(e=n.n()).done;){var r=e.value;if(t>=r.sectorIdOffset&&t<r.sectorIdOffset+r.sectors.length)return r}}catch(i){n.e(i)}finally{n.f()}throw new Error("Sector ID ".concat(t," is out of range"))}},{key:"unpackSectorVisibility",value:function(t,e,n){for(var r=this.buffers.sectorVisibilityBuffer,i=0;i<t*e;i++){var o=n[4*i+0],a=n[4*i+1],s=n[4*i+2],u=n[4*i+3];if(255!==o||255!==a||255!==s){var c=s+255*a+255*o*255,l=r[c]||{sectorIdWithOffset:c,hitCount:0,distance:u};l.hitCount++,l.distance=Math.min(l.distance,u),r[c]=l}}return r}},{key:"prepareBuffers",value:function(){this.buffers.rtBuffer.length<4*this.renderTarget.width*this.renderTarget.height&&(this.buffers.rtBuffer=new Uint8Array(4*this.renderTarget.width*this.renderTarget.height));for(var t=0;t<this.buffers.sectorVisibilityBuffer.length;t++){var e=this.buffers.sectorVisibilityBuffer[t];e&&(e.hitCount=0)}}},{key:"createSectorTreeMesh",value:function(t,e,n){var i=Object(o.f)(n.modelMatrix),a=new r.Group;a.applyMatrix4(i);var c=e.length,l=new Float32Array(4*c),d=new r.BoxBufferGeometry,f=new r.InstancedMesh(d,s,c),h=new r.Box3,p=new r.Vector3;e.forEach((function(e){var n=e.facesFile.coverageFactors,i=n.xy,a=n.xz,s=n.yz;p.set(s,a,i),function(e,n,i){Object(o.e)(h,e);var a=h.getCenter(new r.Vector3),s=h.getSize(new r.Vector3),c=(new r.Matrix4).compose(a,u,s);f.setMatrixAt(n,c),l[4*n+0]=t+n,l[4*n+1]=i.x,l[4*n+2]=i.y,l[4*n+3]=i.z}(e.bounds,e.id,p)}));var m=new r.InstancedInterleavedBuffer(l,4);return d.setAttribute("a_sectorId",new r.InterleavedBufferAttribute(m,1,0)),d.setAttribute("a_coverageFactor",new r.InterleavedBufferAttribute(m,3,1)),a.add(f),a}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(11),o=n(9);function a(t){var e=r.vec3.create(),n=r.vec3.create(),a=0;Object(o.a)(t,(function(t){return r.vec3.add(e,e,t.bounds.min),r.vec3.add(n,n,t.bounds.max),a+=1,!0})),r.vec3.scale(e,e,1/a),r.vec3.scale(n,n,1/a);var s=new i.a([e,n]),u=s.center,c=r.vec3.subtract(r.vec3.create(),s.max,s.min),l=r.vec3.add(r.vec3.create(),u,r.vec3.fromValues(-2*c[0],-2*c[1],2*c[2]));return{position:l,target:u,near:.1,far:12*r.vec3.distance(l,u)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(6),i=n(0),o=n(17),u=function(t){a(n,t);var e=s(n);function n(){var t;d(this,n),(t=e.call(this)).numNodesLoadingAfterLastRedraw=0,t.numChildrenAfterLastRedraw=0,t.potreeGroup=new r.Group,t.potreeGroup.name="PotreeGroup",t.name="Potree point cloud wrapper",t.add(t.potreeGroup);var o=new i.Mesh(new i.Geometry);return o.onAfterRender=function(){return t.resetNeedsRedraw()},t.add(o),t}return f(n,[{key:"addPointCloud",value:function(t){this.potreeGroup.add(t.octtree)}},{key:"pointClouds",value:c.mark((function t(){var e,n,r;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=h(this.potreeGroup.children),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,new o.a(r);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))},{key:"resetNeedsRedraw",value:function(){this.numNodesLoadingAfterLastRedraw=r.Global.numNodesLoading,this.numChildrenAfterLastRedraw=this.potreeGroup.children.length}},{key:"needsRedraw",get:function(){return r.Global.numNodesLoading!==this.numNodesLoadingAfterLastRedraw||this.numChildrenAfterLastRedraw!==this.potreeGroup.children.length}}]),n}(i.Object3D)},function(t,e,n){"use strict";function r(t,e){var n=e.clone().project(t);return n.y=-n.y,n.addScalar(1).multiplyScalar(.5),n}function i(t,e,n){var i=r(e,n);return{x:Math.round(i.x*(t.width/window.devicePixelRatio)),y:Math.round(i.y*(t.height/window.devicePixelRatio))}}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var r=n(2),o=n(23),a=n(7),s=n(9),u=function(){function t(e,n){var r=this;d(this,t),this.sectors=[],this._totalCost=0,this.determineSectorCost=n,Object(s.a)(e,(function(t){return r.sectors.length=Math.max(r.sectors.length,t.id),r.sectors[t.id]={sector:t,priority:-1,cost:0,lod:a.a.Discarded},!0})),this.setSectorLod(e.id,a.a.Simple)}return f(t,[{key:"determineWantedSectorCount",value:function(){return this.sectors.reduce((function(t,e){return e.lod!==a.a.Discarded?t+1:t}),0)}},{key:"toWantedSectors",value:function(t){return this.sectors.map((function(e){return{levelOfDetail:e.lod,metadata:e.sector,priority:e.priority,cadModelIdentifier:t.identifier,dataRetriever:t.dataRetriever,scene:t.scene,cadModelTransformation:t.modelTransformation}})).sort((function(t,e){return e.priority-t.priority}))}},{key:"markSectorDetailed",value:function(t,e){var n=this;this.setSectorPriority(t,e),this.sectors[t].lod!==a.a.Detailed&&(Object(s.b)(this.sectors[t].sector,(function(t){switch(n.sectors[t.id].lod){case a.a.Simple:n.replaceSimpleWithDetailed(t.id);break;case a.a.Discarded:n.setSectorLod(t.id,a.a.Detailed)}return!0})),this.markAllDiscardedChildrenAsSimple(t))}},{key:"replaceSimpleWithDetailed",value:function(t){c(this.sectors[t].lod===a.a.Simple,"Sector ".concat(t," must be a Simple-sector, but got ").concat(this.sectors[t].lod)),this.setSectorLod(t,a.a.Detailed),this.markAllDiscardedChildrenAsSimple(t)}},{key:"markAllDiscardedChildrenAsSimple",value:function(t){var e,n=h(this.sectors[t].sector.children);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.getSectorLod(r.id)===a.a.Discarded&&null!==r.facesFile.fileName&&this.setSectorLod(r.id,a.a.Simple)}}catch(i){n.e(i)}finally{n.f()}}},{key:"setSectorLod",value:function(t,e){c(e!==a.a.Simple||null!==this.sectors[t].sector.facesFile.fileName),this.sectors[t].lod=e,this._totalCost-=this.sectors[t].cost,this.sectors[t].cost=this.determineSectorCost(this.sectors[t].sector,e),this._totalCost+=this.sectors[t].cost}},{key:"setSectorPriority",value:function(t,e){this.sectors[t].priority=e}},{key:"getSectorLod",value:function(t){return this.sectors[t].lod}},{key:"totalCost",get:function(){return this._totalCost}}]),t}();function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"assertion hit";console.assert(t,e)}var l=n(12),p=function(){function t(e){d(this,t),this.maps=new Map,this.determineSectorCost=e}return f(t,[{key:"initializeScene",value:function(t){this.maps.set(t,new u(t.scene.root,this.determineSectorCost))}},{key:"getWantedSectorCount",value:function(){var t=0;return this.maps.forEach((function(e){t+=e.determineWantedSectorCount()})),t}},{key:"markSectorDetailed",value:function(t,e,n){var r=this.maps.get(t);!function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"assertion hit";console.assert(t,e)}(!!r),r.markSectorDetailed(e,n)}},{key:"collectWantedSectors",value:function(){var t,e=new Array,n=h(this.maps);try{for(n.s();!(t=n.n()).done;){var r=t.value,o=r[0],a=r[1];e.push.apply(e,i(a.toWantedSectors(o)))}}catch(s){n.e(s)}finally{n.f()}return e.sort((function(t,e){return e.priority-t.priority})),e}},{key:"clear",value:function(){this.maps.clear()}},{key:"totalCost",get:function(){var t=0;return this.maps.forEach((function(e){t+=e.totalCost})),t}}]),t}(),m=function(){function t(e){d(this,t),this.options={costLimit:e&&e.costLimit?e.costLimit:t.DefaultCostLimit,determineSectorCost:e&&e.determineSectorCost?e.determineSectorCost:v,highDetailProximityThreshold:e&&e.highDetailProximityThreshold?e.highDetailProximityThreshold:t.DefaultHighDetailProximityThreshold,logCallback:e&&e.logCallback?e.logCallback:function(){},coverageUtil:e&&e.coverageUtil?e.coverageUtil:new o.a},this.takenSectors=new p(this.options.determineSectorCost)}return f(t,[{key:"determineSectors",value:function(t){var e=this.update(t.camera,t.cadModels).collectWantedSectors(),n=t.cadModels.reduce((function(t,e){return t+e.scene.sectorCount}),0),r=e.filter((function(t){return t.levelOfDetail!==a.a.Discarded})).length,i=(100*(r-e.filter((function(t){return t.levelOfDetail===a.a.Detailed})).length)/n).toPrecision(3),o=(100*r/n).toPrecision(3);return this.log("Scene: ".concat(e.length," (").concat(e.filter((function(t){return!Number.isFinite(t.priority)})).length," required, ").concat(n," sectors, ").concat(o,"% of all sectors - ").concat(i,"% detailed)")),e}},{key:"update",value:function(t,e){var n=this.options.coverageUtil,r=this.takenSectors;r.clear(),e.forEach((function(t){return r.initializeScene(t)})),n.setModels(e);var i=n.orderSectorsByVisibility(t),o=this.options.costLimit,a=this.options.highDetailProximityThreshold;this.addHighDetailsForNearSectors(t,e,a,r);var s=0,u=i.length,c=0;for(c=0;c<u&&r.totalCost<o;c++){var l=i[c];r.markSectorDetailed(l.model,l.sectorId,l.priority),s+=l.priority}return this.log("Retrieving ".concat(c," of ").concat(u," (last: ").concat(i.length>0?i[c-1]:null,")")),this.log("Total scheduled: ".concat(r.getWantedSectorCount()," of ").concat(u," (cost: ").concat(r.totalCost/1024/1024,"/").concat(o/1024/1024,", priority: ").concat(s,")")),r}},{key:"addHighDetailsForNearSectors",value:function(t,e,n,i){var o=t.clone(!0);o.far=n,o.updateProjectionMatrix();var a=Object(l.c)(r.mat4.create(),o.matrixWorldInverse),s=Object(l.c)(r.mat4.create(),o.projectionMatrix),u=r.mat4.create();e.forEach((function(t){r.mat4.multiply(u,a,t.modelTransformation.modelMatrix);for(var e=t.scene.getSectorsIntersectingFrustum(s,u),n=0;n<e.length;n++)i.markSectorDetailed(t,e[n].id,1/0)}))}},{key:"log",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=this.options).logCallback.apply(e,[t].concat(r))}},{key:"lastWantedSectors",get:function(){return this.takenSectors.collectWantedSectors()}}]),t}();function v(t,e){switch(e){case a.a.Detailed:return t.indexFile.downloadSize;case a.a.Simple:return t.facesFile.downloadSize;default:throw new Error("Can't compute cost for lod ".concat(e))}}m.DefaultCostLimit=52428800,m.DefaultHighDetailProximityThreshold=10},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(0),i={renderTarget:new r.WebGLRenderTarget(1,1),pixelBuffer:new Uint8Array(4)};function o(t,e,n){var r=i.renderTarget,o=i.pixelBuffer,a=t.scene,s=t.camera,u=t.coords,c=t.renderer,l=s.clone();l.setViewOffset(c.domElement.clientWidth,c.domElement.clientHeight,(u.x+1)/2*c.domElement.clientWidth,(1-u.y)/2*c.domElement.clientHeight,1,1);var d=c.getClearColor().clone(),f=c.getClearAlpha();return c.setRenderTarget(r),c.setClearColor(e,n),c.clearColor(),c.render(a,l),c.setRenderTarget(null),c.setClearColor(d,f),c.readRenderTargetPixels(r,0,0,1,1,o),o}var a=n(14),s=new r.Color("black");function u(t,e){var n,r=[],i=h(t);try{for(i.s();!(n=i.n()).done;){var o=c(n.value,e);o&&r.push(o)}}catch(a){i.e(a)}finally{i.f()}return r.sort((function(t,e){return t.distance-e.distance}))}function c(t,e){var n,i,u,c=e.camera,h=e.coords,p=e.renderer,m=new r.Scene,v=t.parent;m.add(t);try{var g={coords:h,camera:c,renderer:p,scene:m,cadNode:t},y=function(t){var e,n=t.cadNode,r=n.renderMode;n.renderMode=a.a.TreeIndex;try{e=o(t,s,0)}finally{n.renderMode=r}if(0!==e[3])return 255*e[0]*255+255*e[1]+e[2]}(g);if(void 0===y)return;var b=function(t,e){var n=t.camera,i=t.coords,o=new r.Vector3;return f.getInverse(n.projectionMatrix),o.set(i.x,i.y,.5).applyMatrix4(f),o.multiplyScalar(e/o.z),o.applyMatrix4(n.matrixWorld),o}(g,(n=function(t){var e=t.cadNode,n=e.renderMode;e.renderMode=a.a.Depth;var r=o(t,s,0);return e.renderMode=n,function(t){return l.fromArray(t).multiplyScalar(1/255).dot(d)}(r)}(g),(i=c.near)*(u=c.far)/((u-i)*n-u)));return{distance:(new r.Vector3).subVectors(b,c.position).length(),point:b,treeIndex:y,object:t,cadNode:t}}finally{v&&v.add(t)}}var l=new r.Vector4,d=new r.Vector4(255/256/16777216,255/256/65536,255/256/256,255/256),f=new r.Matrix4},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(4),i=n(1),o=n(30),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.a.defaultPool;d(this,t),this.workerPool=e}return f(t,[{key:"parse",value:function(){var t=this;return Object(i.publish)((function(e){var n=e.pipe(Object(i.filter)((function(t){return"i3d"===t.format})),Object(i.flatMap)((function(e){return t.parseDetailed(e.data)}))),o=e.pipe(Object(i.filter)((function(t){return"f3d"===t.format})),Object(i.flatMap)((function(e){return t.parseSimple(e.data)})),Object(i.map)((function(e){return t.finalizeSimple(e)}))),a=e.pipe(Object(i.filter)((function(t){return"ctm"===t.format})),Object(i.flatMap)((function(e){return t.parseCtm(e.data)})));return Object(r.merge)(n,o,a)}))}},{key:"parseSimple",value:function(){var t=l(c.mark((function t(e){return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.workerPool.postWorkToAvailable(function(){var t=l(c.mark((function t(n){return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.parseQuads(e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"finalizeSimple",value:function(t){return{treeIndexToNodeIdMap:t.treeIndexToNodeIdMap,nodeIdToTreeIndexMap:t.nodeIdToTreeIndexMap,buffer:t.faces}}},{key:"parseDetailed",value:function(){var t=l(c.mark((function t(e){return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.workerPool.postWorkToAvailable(function(){var t=l(c.mark((function t(n){return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.parseSector(e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"parseCtm",value:function(){var t=l(c.mark((function t(e){return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.workerPool.postWorkToAvailable(function(){var t=l(c.mark((function t(n){return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.parseCtm(e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}()},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return i}));var r=n(31),i=function(){function e(){d(this,e),this.workerList=[];for(var n=this.determineNumberOfWorkers(),i=0;i<n;i++){var o={worker:r.wrap(new Worker(t,{name:"parser",type:void 0})),activeJobCount:0,messageIdCounter:0};this.workerList.push(o)}}return f(e,[{key:"postWorkToAvailable",value:function(){var t=l(c.mark((function t(e){var n,r,i,o,a;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this.workerList[0],r=h(this.workerList);try{for(r.s();!(i=r.n()).done;)(o=i.value).activeJobCount<n.activeJobCount&&(n=o)}catch(s){r.e(s)}finally{r.f()}return n.activeJobCount+=1,t.next=6,e(n.worker);case 6:return a=t.sent,t.abrupt("return",(n.activeJobCount-=1,a));case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"determineNumberOfWorkers",value:function(){return Math.max(2,Math.min(4,window.navigator.hardwareConcurrency||2))}}],[{key:"defaultPool",get:function(){return e._defaultPool=e._defaultPool||new e,e._defaultPool}}]),e}()}).call(this,n(38))},function(t,e){t.exports=n(139)},function(t,e){t.exports=n(83)},function(t,e,n){"use strict";var i=c.mark(w);n.d(e,"a",(function(){return I}));var o=n(4),a=n(1),s=n(0);function u(){this.array=null}var l=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0]),p=new s.Float32BufferAttribute(l.buffer,3),m=n(12),v=function(){var t=new s.BoxBufferGeometry(1,1,1,1,1,1),e={index:t.getIndex(),position:t.getAttribute("position"),normal:t.getAttribute("normal")};return t.dispose(),e}(),g=function(){var t=new s.PlaneBufferGeometry(1,1,1,1),e={index:t.getIndex(),position:t.getAttribute("position"),normal:t.getAttribute("normal")};return t.dispose(),e}(),y={index:new s.BufferAttribute(new Uint16Array([0,1,3,0,3,2]),1),position:new s.BufferAttribute(new Float32Array([0,0,0,1,1,1,2,2,2,3,3,3]),3)},b=function(){var t=[];t.push(-1,1,-1),t.push(-1,-1,-1),t.push(1,1,-1),t.push(1,-1,-1),t.push(1,1,1),t.push(1,-1,1);var e=new Uint16Array([1,2,0,1,3,2,3,4,2,3,5,4]);return{index:new s.BufferAttribute(e,1),position:new s.BufferAttribute(new Float32Array(t),3)}}(),x=function(){var t=function(t,e){return[t,2*e*Math.PI]};return[[6,4],[9,4],[11,6],[16,12],[24,16]].map((function(e){var n=r(e,2);return function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t,e){return[t,e,0]},i=[],o=[],a=1/t,u=1/e,c=0;c<=e;c++)for(var l=0;l<=t;l++){var d=n(l*a,c*u),f=r(d,3),h=f[0],p=f[1],m=f[2];i.push(h||0,p||0,m||0)}for(var v=1;v<=e;v++)for(var g=1;g<=t;g++){var y=(t+1)*v+g-1,b=(t+1)*(v-1)+g-1,x=(t+1)*(v-1)+g,_=(t+1)*v+g;o.push(y,b,_),o.push(b,x,_)}return{index:new s.Uint16BufferAttribute(o,1),position:new s.Float32BufferAttribute(i,3)}}(n[0],n[1],t)}))}(),_=function(){var t=new s.CylinderBufferGeometry(.5,.5,1,6);t.applyMatrix4((new s.Matrix4).makeRotationX(-Math.PI/2));var e={index:t.getIndex(),position:t.getAttribute("position"),normal:t.getAttribute("normal")};return t.dispose(),e}();function w(t,e){var n;return c.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n=t.primitives,i.t0=T(n.boxCollection),!i.t0){i.next=5;break}return i.next=5,function(t,e,n){var r=new s.InstancedBufferGeometry,i=new s.Mesh(r,n);return r.setIndex(v.index),r.setAttribute("position",v.position),r.setAttribute("normal",v.normal),S(r,t,e,i),i.frustumCulled=!1,i.name="Primitives (Boxes)",i}(n.boxCollection,n.boxAttributes,e.box);case 5:if(i.t1=T(n.circleCollection),!i.t1){i.next=9;break}return i.next=9,function(t,e,n){var r=new s.InstancedBufferGeometry,i=new s.Mesh(r,n);return r.setIndex(g.index),r.setAttribute("position",g.position),r.setAttribute("normal",g.position),S(r,t,e,i),i.frustumCulled=!1,i.name="Primitives (Circles)",i}(n.circleCollection,n.circleAttributes,e.circle);case 9:if(i.t2=T(n.coneCollection),!i.t2){i.next=13;break}return i.next=13,function(t,e,n){var r=new s.InstancedBufferGeometry,i=new s.Mesh(r,n);return r.setIndex(b.index),r.setAttribute("position",b.position),S(r,t,e,i),i.frustumCulled=!1,i.onBeforeRender=function(){return E(n,i.matrixWorld)},i.name="Primitives (Cones)",i}(n.coneCollection,n.coneAttributes,e.cone);case 13:if(i.t3=T(n.eccentricConeCollection),!i.t3){i.next=17;break}return i.next=17,function(t,e,n){var r=new s.InstancedBufferGeometry,i=new s.Mesh(r,n);return r.setIndex(b.index),r.setAttribute("position",b.position),S(r,t,e,i),i.frustumCulled=!1,i.onBeforeRender=function(){return E(n,i.matrixWorld)},i.name="Primitives (EccentricCones)",i}(n.eccentricConeCollection,n.eccentricConeAttributes,e.eccentricCone);case 17:if(i.t4=T(n.ellipsoidSegmentCollection),!i.t4){i.next=21;break}return i.next=21,function(t,e,n){var r=new s.InstancedBufferGeometry,i=new s.Mesh(r,n);return r.setIndex(b.index),r.setAttribute("position",b.position),S(r,t,e,i),i.frustumCulled=!1,i.onBeforeRender=function(){return E(n,i.matrixWorld)},i.name="Primitives (EllipsoidSegments)",i}(n.ellipsoidSegmentCollection,n.ellipsoidSegmentAttributes,e.ellipsoidSegment);case 21:if(i.t5=T(n.generalCylinderCollection),!i.t5){i.next=25;break}return i.next=25,function(t,e,n){var r=new s.InstancedBufferGeometry,i=new s.Mesh(r,n);return r.setIndex(b.index),r.setAttribute("position",b.position),S(r,t,e,i),i.frustumCulled=!1,i.onBeforeRender=function(){return E(n,i.matrixWorld)},i.name="Primitives (GeneralCylinders)",i}(n.generalCylinderCollection,n.generalCylinderAttributes,e.generalCylinder);case 25:if(i.t6=T(n.generalRingCollection),!i.t6){i.next=29;break}return i.next=29,function(t,e,n){var r=new s.InstancedBufferGeometry,i=new s.Mesh(r,n);return r.setIndex(g.index),r.setAttribute("position",g.position),S(r,t,e,i),i.frustumCulled=!1,i.onBeforeRender=function(){return E(n,i.matrixWorld)},i.name="Primitives (GeneralRings)",i}(n.generalRingCollection,n.generalRingAttributes,e.generalRing);case 29:if(i.t7=T(n.quadCollection),!i.t7){i.next=33;break}return i.next=33,function(t,e,n){var r=new s.InstancedBufferGeometry,i=new s.Mesh(r,n);return r.setIndex(g.index),r.setAttribute("position",g.position),r.setAttribute("normal",g.normal),S(r,t,e,i),i.frustumCulled=!1,i.name="Primitives (Quads)",i}(n.quadCollection,n.quadAttributes,e.quad);case 33:if(i.t8=T(n.sphericalSegmentCollection),!i.t8){i.next=37;break}return i.next=37,function(t,e,n){var r=new s.InstancedBufferGeometry,i=new s.Mesh(r,n);return r.setIndex(b.index),r.setAttribute("position",b.position),S(r,t,e,i),r.setAttribute("a_horizontalRadius",r.getAttribute("a_radius")),r.setAttribute("a_verticalRadius",r.getAttribute("a_radius")),i.frustumCulled=!1,i.onBeforeRender=function(){return E(n,i.matrixWorld)},i.name="Primitives (EllipsoidSegments)",i}(n.sphericalSegmentCollection,n.sphericalSegmentAttributes,e.sphericalSegment);case 37:if(i.t9=T(n.torusSegmentCollection),!i.t9){i.next=41;break}return i.next=41,function(t,e,n){var i=function(t,e){for(var n=Array.from(e.values()).reduce((function(t,e){return t+e.size}),0),r=t.length/n,i=new Float32Array(r),o=new DataView(t.buffer),a=e.get("size").offset,s=0;s<r;s++)i[s]=o.getFloat32(s*n+a,!0);return i}(t,e);if(!i)throw new Error("Torus segments are missing size attribute");var o=i.reduce((function(t,e){return Math.max(t,e)})),a=new s.LOD;a.name="Primitives (TorusSegments)";var u,c=h(x.entries());try{for(c.s();!(u=c.n()).done;){var l=r(u.value,2),d=l[0],f=l[1],p=new s.InstancedBufferGeometry,m=new s.Mesh(p,n);p.setIndex(f.index),p.setAttribute("position",f.position),S(p,t,e,m),m.frustumCulled=!1,m.name="Primitives (TorusSegments) - LOD ".concat(d),a.addLevel(m,M(o,d,x.length))}}catch(v){c.e(v)}finally{c.f()}return a}(n.torusSegmentCollection,n.torusSegmentAttributes,e.torusSegment);case 41:if(i.t10=T(n.trapeziumCollection),!i.t10){i.next=45;break}return i.next=45,function(t,e,n){var r=new s.InstancedBufferGeometry,i=new s.Mesh(r,n);return r.setIndex(y.index),r.setAttribute("position",y.position),S(r,t,e,i),i.frustumCulled=!1,i.onBeforeRender=function(){return E(n,i.matrixWorld)},i.name="Primitives (Trapeziums)",i}(n.trapeziumCollection,n.trapeziumAttributes,e.trapezium);case 45:if(i.t11=T(n.nutCollection),!i.t11){i.next=49;break}return i.next=49,function(t,e,n){var r=new s.InstancedBufferGeometry,i=new s.Mesh(r,n);return r.setIndex(_.index),r.setAttribute("position",_.position),r.setAttribute("normal",_.normal),S(r,t,e,i),i.frustumCulled=!1,i.name="Primitives (Nuts)",i}(n.nutCollection,n.nutAttributes,e.nut);case 49:case"end":return i.stop()}}),i)}function T(t){return t.length>0}function S(t,e,n,i){var o=Array.from(n.values()).reduce((function(t,e){return t+e.size}),0);!function(t){var e=t.get("instanceMatrix");if(e){for(var n=0;n<4;n++){var r=e.size/4,i={size:r,offset:e.offset+r*n};t.set("instanceMatrix_column_"+n,i)}t.delete("instanceMatrix")}}(n);var a,c=new s.InstancedInterleavedBuffer(e,o),l=new s.InstancedInterleavedBuffer(new Float32Array(e.buffer),o/4),d=h(n);try{for(d.s();!(a=d.n()).done;){var f=r(a.value,2),p=f[0],m=f[1],v="color"===p,g=v?c:l,y=v?m.size:m.size/4,b=v?m.offset:m.offset/4;t.setAttribute("a_".concat(p),new s.InterleavedBufferAttribute(g,y,b,v))}}catch(x){d.e(x)}finally{d.f()}i.onAfterRender=function(){u.bind(l)(),u.bind(c)(),i.onAfterRender=function(){}},t.maxInstancedCount=e.length/o}function M(t,e,n){return e>=n-1?0:t*Math.pow(15,n-1-e)}function E(t,e){t.uniforms.inverseModelMatrix.value.getInverse(e)}var R=n(7),I=function(){function t(e){d(this,t),this.materialManager=e}return f(t,[{key:"transform",value:function(){var t=this;return Object(a.publish)((function(e){var n=e.pipe(Object(a.filter)((function(t){return t.levelOfDetail===R.a.Detailed}))),r=e.pipe(Object(a.filter)((function(t){return t.levelOfDetail===R.a.Simple})));return Object(o.merge)(n.pipe(Object(a.map)((function(e){return function(t,e,n){var r,i=Object(m.e)(new s.Box3,e.bounds),o=new s.Group,a=h(w(t,n));try{for(a.s();!(r=a.n()).done;){var c=r.value;o.add(c)}}catch(x){a.e(x)}finally{a.f()}var l,d=function(t,e,n){var r,i=[],o=h(t);try{for(o.s();!(r=o.n()).done;){var a=r.value,c=new s.BufferGeometry,l=new s.Uint32BufferAttribute(a.indices.buffer,1).onUpload(u),d=new s.Float32BufferAttribute(a.vertices.buffer,3).onUpload(u),f=new s.Float32BufferAttribute(a.colors.buffer,3).onUpload(u),p=new s.Float32BufferAttribute(a.treeIndices.buffer,1).onUpload(u);c.setIndex(l),c.setAttribute("position",d),c.setAttribute("color",f),c.setAttribute("treeIndex",p),c.boundingBox=e.clone(),c.boundingSphere=new s.Sphere,e.getBoundingSphere(c.boundingSphere);var m=new s.Mesh(c,n);m.name="Triangle mesh ".concat(a.fileId),i.push(m)}}catch(x){o.e(x)}finally{o.f()}return i}(t.triangleMeshes,i,n.triangleMesh),f=h(d);try{for(f.s();!(l=f.n()).done;){var p=l.value;o.add(p)}}catch(x){f.e(x)}finally{f.f()}var v,g=function(t,e,n){var r,i=[],o=h(t);try{for(o.s();!(r=o.n()).done;){var a,c=r.value,l=new s.Uint32BufferAttribute(c.indices.buffer,1).onUpload(u),d=new s.Float32BufferAttribute(c.vertices.buffer,3).onUpload(u),f=h(c.instances);try{for(f.s();!(a=f.n()).done;){var p=a.value,m=p.triangleCount,v=p.triangleOffset,g=new s.InstancedBufferGeometry;g.setDrawRange(3*v,3*m),g.boundingBox=e.clone(),g.boundingSphere=new s.Sphere,e.getBoundingSphere(g.boundingSphere),g.setIndex(l),g.setAttribute("position",d),g.setAttribute("a_treeIndex",new s.InstancedBufferAttribute(p.treeIndices,1).onUpload(u)),g.setAttribute("a_color",new s.InstancedBufferAttribute(p.colors,4,!0).onUpload(u));for(var y=new s.InstancedInterleavedBuffer(p.instanceMatrices,16),b=0;b<4;b++){var _=new s.InterleavedBufferAttribute(y,4,4*b);g.setAttribute("a_instanceMatrix_column_".concat(b),_)}g.boundingBox=e.clone(),g.boundingSphere=new s.Sphere,e.getBoundingSphere(g.boundingSphere);var w=new s.Mesh(g,n);w.name="Instanced mesh ".concat(c.fileId),i.push(w)}}catch(x){f.e(x)}finally{f.f()}}}catch(x){o.e(x)}finally{o.f()}return i}(t.instanceMeshes,i,n.instancedMesh),y=h(g);try{for(y.s();!(v=y.n()).done;){var b=v.value;o.add(b)}}catch(x){y.e(x)}finally{y.f()}return o}(e.data,e.metadata,t.materialManager.getModelMaterials(e.cadModelIdentifier))}))),r.pipe(Object(a.map)((function(e){return function(t,e){var n=new s.Group;if(0===t.buffer.byteLength)return new s.Group;if(t.buffer.byteLength%23!=0)throw new Error("Expected buffer size to be multiple of 23, but got ".concat(t.buffer.byteLength));var r=new s.InstancedBufferGeometry,i=new s.InstancedInterleavedBuffer(t.buffer,23),o=new s.InterleavedBufferAttribute(i,3,0,!0),a=new s.InterleavedBufferAttribute(i,1,3,!1),c=new s.InterleavedBufferAttribute(i,3,4,!0),l=new s.InterleavedBufferAttribute(i,4,7,!1),d=new s.InterleavedBufferAttribute(i,4,11,!1),f=new s.InterleavedBufferAttribute(i,4,15,!1),h=new s.InterleavedBufferAttribute(i,4,19,!1);r.setAttribute("position",p),r.setAttribute("color",o),r.setAttribute("treeIndex",a),r.setAttribute("normal",c),r.setAttribute("matrix0",l),r.setAttribute("matrix1",d),r.setAttribute("matrix2",f),r.setAttribute("matrix3",h);var m=new s.Mesh(r,e.simple);return m.onAfterRender=function(){u.bind(i)(),m.onAfterRender=function(){}},m.frustumCulled=!1,n.add(m),n}(e.data,t.materialManager.getModelMaterials(e.cadModelIdentifier))}))))}))}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return M}));var i=n(4),o=n(1),a=n(76),s=n(78),p=n(68),m=n(77),v=n(0),g=new v.Geometry,y=n(19),b=n(8),x=n(27),_=n(6),w=n(12),T=n(25),S=n(17),M=function(){function t(e,n,r,o,a){d(this,t),this._modelSubject=new i.Subject,this._loadingHintsSubject=new i.BehaviorSubject({}),this._cadNodeMap=new Map,this._sectorCuller=a&&a.internal&&a.internal.sectorCuller||new x.a,this._sectorRepository=n,this._materialManager=r,this._modelObservable=this._modelSubject.pipe(this.addCadOrPointcloudModel(e)),this._cadModelObservable=this._modelObservable.pipe(this.getAddedModels()),this._cameraSubject=this.createLoadSectorsPipeline(o)}return f(t,[{key:"addModelFromCdf",value:function(t,e){var n,r,i=new Promise((function(t,e){n=t,r=e}));return this._modelSubject.next({format:b.a.RevealCadModel,source:{discriminator:"cdf",modelRevision:this.createModelIdentifier(t)},modelNodeAppearance:e,callbacks:{success:n,fail:r}}),i}},{key:"addModelFromUrl",value:function(t,e){var n,r,i=new Promise((function(t,e){n=t,r=e}));return this._modelSubject.next({format:b.a.RevealCadModel,source:{discriminator:"external",url:t},modelNodeAppearance:e,callbacks:{success:n,fail:r}}),i}},{key:"addPointCloudFromCdf",value:function(t){var e,n,r=new Promise((function(t,r){e=t,n=r}));return this._modelSubject.next({format:b.a.EptPointCloud,source:{discriminator:"cdf",modelRevision:this.createModelIdentifier(t)},callbacks:{success:e,fail:n}}),r}},{key:"addPointCloudFromUrl",value:function(t){var e,n,r=new Promise((function(t,r){e=t,n=r}));return this._modelSubject.next({format:b.a.EptPointCloud,source:{discriminator:"external",url:t},callbacks:{success:e,fail:n}}),r}},{key:"update",value:function(t){this._cameraSubject.next(t)}},{key:"createModelIdentifier",value:function(t){return"number"==typeof t?{id:t}:{externalId:t}}},{key:"addCadOrPointcloudModel",value:function(t){var e=this;return Object(o.publish)((function(n){var a=n.pipe(Object(o.filter)((function(t){return t.format===b.a.RevealCadModel})),e.loadCadModelFromCdfOrUrl(t)),s=n.pipe(Object(o.filter)((function(t){return t.format===b.a.EptPointCloud})),e.loadPointCloudModelFromCdfOrUrl(t));return Object(i.merge)(a.pipe(Object(o.map)((function(t){var n=t.data,r=new y.a(n,e._materialManager);return e._materialManager.addModelMaterials(n.identifier,n.scene.maxTreeIndex,t.modelNodeAppearance),e._cadNodeMap.set(n.identifier,r),t.callbacks.success(r),r}))),s.pipe(Object(o.flatMap)((function(t){return function(){var t=l(c.mark((function t(e,n){var i,o,a,s,u,l,d,f;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=r(e,1),o=i[0],t.next=4,o();case 4:return a=t.sent,s=r(a,2),u=s[0],l=s[1],n||(n=new T.a),(d=new _.PointCloudOctree(u)).name="PointCloudOctree",d.applyMatrix(Object(w.f)(l.modelMatrix)),f=new S.a(d),t.abrupt("return",(n.addPointCloud(f),[n,f]));case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(t.data)}),(function(t,e){return t.callbacks.success(e),e}))))}))}},{key:"loadCadModelFromCdfOrUrl",value:function(t){return Object(o.flatMap)((function(e){if("cdf"===e.source.discriminator)return Object(a.a)(t,e.source.modelRevision);if("external"===e.source.discriminator)return Object(s.a)(e.source.url);throw new Error("Unknown Source")}),(function(t,e){return u(u({},t),{},{data:e})}))}},{key:"loadPointCloudModelFromCdfOrUrl",value:function(t){return Object(o.flatMap)((function(e){if("cdf"===e.source.discriminator)return Object(p.a)(t,e.source.modelRevision);if("external"===e.source.discriminator)return Object(m.a)(e.source.url);throw new Error("Unknown Source")}),(function(t,e){return u(u({},t),{},{data:e})}))}},{key:"getAddedModels",value:function(){return Object(i.pipe)(Object(o.filter)((function(t){return t instanceof y.a})),Object(o.map)((function(t){return t.cadModel})),Object(o.scan)((function(t,e){return t.push(e),t}),[]))}},{key:"createLoadSectorsPipeline",value:function(t){var e=this,n=new i.Subject;return n.pipe(Object(o.auditTime)(100),Object(o.map)((function(t){return t.clone()})),Object(o.withLatestFrom)(this._cadModelObservable,this._loadingHintsSubject.pipe(Object(o.share)())),Object(o.filter)((function(t){var e=r(t,3),n=(e[0],e[1]),i=e[2];return n.length>0&&!0!==i.suspendLoading})),Object(o.map)((function(t){var n=r(t,3),i=n[0],o=n[1],a=n[2];return e._sectorCuller.determineSectors({camera:i,cadModels:o,loadingHints:a})})),Object(o.publish)((function(t){return t.pipe(Object(o.switchAll)(),Object(i.pipe)(Object(o.groupBy)((function(t){return t.metadata.id})),Object(o.mergeMap)((function(t){return t.pipe(Object(o.distinctUntilKeyChanged)("levelOfDetail"))}))),e._sectorRepository.loadSector(),(n=t,Object(i.pipe)(Object(o.withLatestFrom)(n),Object(o.flatMap)((function(t){var e,n=r(t,2),o=n[0],a=n[1],s=h(a);try{for(s.s();!(e=s.n()).done;){var u=e.value;if(o.metadata.id===u.metadata.id&&o.levelOfDetail===u.levelOfDetail)return Object(i.of)(o)}}catch(c){s.e(c)}finally{s.f()}return Object(i.empty)()})))));var n})),Object(o.observeOn)(i.animationFrameScheduler)).subscribe((function(n){var r=e._cadNodeMap.get(n.cadModelIdentifier).rootSector.sectorNodeMap.get(n.metadata.id);if(!r)throw new Error("Could not find 3D node for sector ".concat(n.metadata.id," - invalid id?"));r.group&&(r.group.userData.refCount-=1,0===r.group.userData.refCount&&function(t){var e,n=t.children.filter((function(t){return t instanceof v.Mesh})).map((function(t){return t})),r=h(n);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.geometry&&(i.geometry.dispose(),i.geometry=g)}}catch(o){r.e(o)}finally{r.f()}}(r.group),r.remove(r.group)),n.group&&r.add(n.group),r.group=n.group,t()})),n}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var o=n(7),a=n(4),s=n(1),p=function(){function t(e){d(this,t),this._value=e,this._lastAccessTime=Date.now()}return f(t,[{key:"touch",value:function(){this._lastAccessTime=Date.now()}},{key:"value",get:function(){return this.touch(),this._value}},{key:"lastAccessTime",get:function(){return this._lastAccessTime}}]),t}(),m=function(){function t(e){d(this,t),this._data=new Map,this._maxElementsInCache=e&&e.maxElementsInCache||50}return f(t,[{key:"has",value:function(t){return this._data.has(t)}},{key:"add",value:function(t,e){if(!(this._data.size<this._maxElementsInCache))throw new Error("Cache full, please clean Cache and retry adding data");this._data.set(t,new p(e))}},{key:"get",value:function(t){var e=this._data.get(t);if(void 0!==e)return e.value;throw new Error("Cache element ".concat(t," does not exist"))}},{key:"cleanCache",value:function(t){var e=Array.from(this._data.entries());e.sort((function(t,e){return e[1].lastAccessTime-t[1].lastAccessTime}));for(var n=0;n<t;n++){var r=e.pop();if(void 0===r)return;this._data.delete(r[0])}}},{key:"clear",value:function(){this._data.clear()}}]),t}();function v(t){var e=new Array(t.length);return t.forEach((function(n,r){e[r]=r>0?e[r-1]+t[r-1]:0})),e}var g=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;d(this,t),this.queue=[],this.slotsInUse=0,this.slotCount=e}return f(t,[{key:"acquire",value:function(){var t=l(c.mark((function t(){var e=this;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.slotsInUse<this.slotCount)){t.next=2;break}return t.abrupt("return",(this.slotsInUse+=1,!0));case 2:return t.abrupt("return",new Promise((function(t){e.queue.push(t)})));case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"release",value:function(){if(0===this.slotsInUse)throw new Error("Unbalanced call to release() - must call acquire() first");this.slotsInUse-=1;var t=this.queue.shift();t&&(this.slotsInUse+=1,t(!0))}},{key:"usedSlots",value:function(){return this.slotsInUse}},{key:"clearPendingRequests",value:function(){var t,e=h(this.queue);try{for(e.s();!(t=e.n()).done;)(0,t.value)(!1)}catch(n){e.e(n)}finally{e.f()}this.queue=[]}}]),t}(),y=function(){function t(e,n){d(this,t),this._modelDataCache=new m({maxElementsInCache:50}),this._ctmFileCache=new m({maxElementsInCache:300}),this._rateLimiter=new g(50),this._parsedDataSubject=new a.Subject,this._modelDataParser=e,this._modelDataTransformer=n}return f(t,[{key:"clearSemaphore",value:function(){this._rateLimiter.clearPendingRequests()}},{key:"loadSector",value:function(){var t=this;return Object(a.pipe)(Object(s.subscribeOn)(a.asapScheduler),Object(s.publish)((function(e){var n=e.pipe(Object(s.filter)((function(t){return t.levelOfDetail!==o.a.Discarded})),Object(s.share)()),i=Object(a.partition)(n,(function(e){return t._modelDataCache.has(t.cacheKey(e))})),d=r(i,2),f=d[0],h=d[1],p=e.pipe(Object(s.filter)((function(t){return t.levelOfDetail===o.a.Discarded})),Object(s.map)((function(t){return u(u({},t),{},{group:void 0})})));return Object(a.merge)(f.pipe(Object(s.flatMap)((function(e){return t._modelDataCache.get(t.cacheKey(e))}))),h.pipe(Object(s.flatMap)(function(){var e=l(c.mark((function e(n){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=n,e.next=3,t._rateLimiter.acquire();case 3:return e.t1=e.sent,e.abrupt("return",{wantedSector:e.t0,ready:e.t1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(s.filter)((function(t){return t.ready})),Object(s.map)((function(t){return t.wantedSector})),t.loadSectorFromNetwork(),Object(s.catchError)((function(e){return t._rateLimiter.release(),Object(a.of)(e)})),Object(s.tap)((function(e){return t._rateLimiter.release()}))),p)})),Object(s.retryWhen)((function(t){return t.pipe(Object(s.tap)((function(t){return console.error(t)})),Object(s.delay)(5e3))})))}},{key:"clearCache",value:function(){this._modelDataCache.clear()}},{key:"getParsedData",value:function(){return this._parsedDataSubject.pipe(Object(s.distinct)((function(t){return t.cadModelIdentifier+"."+t.sectorId})))}},{key:"loadSectorFromNetwork",value:function(){var t=this;return Object(s.publish)((function(e){var n=e.pipe(Object(s.filter)((function(t){return t.levelOfDetail===o.a.Simple})),Object(s.flatMap)((function(e){for(var n=Object(a.from)(e.dataRetriever.fetchData(e.metadata.facesFile.fileName)).pipe(Object(s.retry)(3),Object(s.map)((function(t){return{format:"f3d",data:new Uint8Array(t)}})),t._modelDataParser.parse(),Object(s.map)((function(n){return t._parsedDataSubject.next({cadModelIdentifier:e.cadModelIdentifier,sectorId:e.metadata.id,lod:"simple",data:n}),u(u({},e),{},{data:n})})),t._modelDataTransformer.transform(),Object(s.tap)((function(t){t.name="Quads ".concat(e.metadata.id)})),Object(s.map)((function(t){return u(u({},e),{},{group:t})})),Object(s.shareReplay)(1),Object(s.take)(1));;)try{t._modelDataCache.add(t.cacheKey(e),n);break}catch(e){t._modelDataCache.cleanCache(10)}return n}))),i=e.pipe(Object(s.filter)((function(t){return t.levelOfDetail===o.a.Detailed})),Object(s.flatMap)((function(e){for(var n=Object(a.of)(e.metadata.indexFile).pipe(Object(s.flatMap)((function(t){return e.dataRetriever.fetchData(t.fileName)})),Object(s.map)((function(t){return{format:"i3d",data:new Uint8Array(t)}})),Object(s.retry)(3),t._modelDataParser.parse()),i=Object(a.from)(e.metadata.indexFile.peripheralFiles).pipe(Object(s.map)((function(t){return{identifier:e.cadModelIdentifier,dataRetriever:e.dataRetriever,fileName:t}})),t.loadCtmFile(),Object(s.reduce)((function(t,e){return t.set(e.fileName,e.data),t}),new Map)),o=Object(a.zip)(n,i).pipe(Object(s.map)((function(e){var n=r(e,2),i=n[0],o=n[1];return t.finalizeDetailed(i,o)})),Object(s.map)((function(n){return t._parsedDataSubject.next({cadModelIdentifier:e.cadModelIdentifier,sectorId:e.metadata.id,lod:"detailed",data:n}),u(u({},e),{},{data:n})})),t._modelDataTransformer.transform(),Object(s.map)((function(t){return u(u({},e),{},{group:t})})),Object(s.shareReplay)(1),Object(s.take)(1));;)try{t._modelDataCache.add(t.cacheKey(e),o);break}catch(e){t._modelDataCache.cleanCache(10)}return o})));return Object(a.merge)(n,i)}))}},{key:"loadCtmFile",value:function(){var t=this;return Object(s.publish)((function(e){var n=Object(a.partition)(e,(function(e){return t._ctmFileCache.has(t.ctmKey(e))})),i=r(n,2),o=i[0],u=i[1];return Object(a.merge)(o.pipe(Object(s.flatMap)((function(e){return t._ctmFileCache.get(t.ctmKey(e))}),(function(t,e){return{fileName:t.fileName,data:e}}))),u.pipe(t.loadCtmFileFromNetwork()))}))}},{key:"loadCtmFileFromNetwork",value:function(){var t=this;return Object(a.pipe)(Object(s.flatMap)((function(e){for(var n=Object(a.from)(e.dataRetriever.fetchData(e.fileName)).pipe(Object(s.retry)(3),Object(s.map)((function(t){return{format:"ctm",data:new Uint8Array(t)}})),t._modelDataParser.parse(),Object(s.shareReplay)(1),Object(s.take)(1));;)try{t._ctmFileCache.add(t.ctmKey(e),n);break}catch(e){t._ctmFileCache.cleanCache(10)}return n}),(function(t,e){return{fileName:t.fileName,data:e}})))}},{key:"finalizeDetailed",value:function(t,e){var n=this,i=t.instanceMeshes,o=t.triangleMeshes,a=function(){var t,i=o.fileIds,a=o.colors,s=o.triangleCounts,u=o.treeIndices,c=n.groupMeshesByNumber(i),l=[],d=h(c.entries());try{for(d.s();!(t=d.n()).done;){for(var f=r(t.value,2),p=f[0],m=f[1],g=m.map((function(t){return s[t]})),y=v(g),b="mesh_".concat(p,".ctm"),x=e.get(b),_=x.indices,w=x.vertices,T=x.normals,S=new Float32Array(_.length),M=new Float32Array(_.length),E=0;E<m.length;E++)for(var R=m[E],I=u[R],B=y[E],A=g[E],C=n.readColorToFloat32s(a,R),F=r(C,3),P=F[0],N=F[1],O=F[2],U=B;U<B+A;U++)for(var L=0;L<3;L++){var G=_[3*U+L];M[G]=I,S[3*G]=P,S[3*G+1]=N,S[3*G+2]=O}var D={colors:S,fileId:p,treeIndices:M,indices:_,vertices:w,normals:T};l.push(D)}}catch(V){d.e(V)}finally{d.f()}return l}(),s=function(){var t,o=i.fileIds,a=i.colors,s=i.treeIndices,u=i.triangleCounts,c=i.triangleOffsets,l=i.instanceMatrices,d=n.groupMeshesByNumber(o),f=[],p=h(d.entries());try{for(p.s();!(t=p.n()).done;){var m,v=r(t.value,2),g=v[0],y=v[1],b="mesh_".concat(g,".ctm"),x=e.get(b),_=x.indices,w=x.vertices,T=x.normals,S=[],M=new Float64Array(y.map((function(t){return c[t]}))),E=new Float64Array(y.map((function(t){return u[t]}))),R=n.groupMeshesByNumber(M),I=h(R);try{for(I.s();!(m=I.n()).done;){for(var B=r(m.value,2),A=B[0],C=B[1],F=E[C[0]],P=new Float32Array(16*C.length),N=new Float32Array(C.length),O=new Uint8Array(4*C.length),U=0;U<C.length;U++){var L=y[C[U]],G=s[L],D=l.slice(16*L,16*L+16);P.set(D,16*U),N[U]=G;var V=a.slice(4*L,4*L+4);O.set(V,4*U)}S.push({triangleCount:F,triangleOffset:A,instanceMatrices:P,colors:O,treeIndices:N})}}catch(k){I.e(k)}finally{I.f()}var H={fileId:g,indices:_,vertices:w,normals:T,instances:S};f.push(H)}}catch(k){p.e(k)}finally{p.f()}return f}();return{treeIndexToNodeIdMap:t.treeIndexToNodeIdMap,nodeIdToTreeIndexMap:t.nodeIdToTreeIndexMap,primitives:t.primitives,instanceMeshes:s,triangleMeshes:a}}},{key:"groupMeshesByNumber",value:function(t){for(var e=new Map,n=0;n<t.length;++n){var r=t[n],o=e.get(r);o?e.set(r,[].concat(i(o),[n])):e.set(r,[n])}return e}},{key:"readColorToFloat32s",value:function(t,e){return[t[4*e]/255,t[4*e+1]/255,t[4*e+2]/255,t[4*e+3]/255]}},{key:"cacheKey",value:function(t){return t.cadModelIdentifier+"."+t.metadata.id+"."+t.levelOfDetail}},{key:"ctmKey",value:function(t){return t.identifier+"."+t.fileName}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n(0),i=n(3),o=Math.log(2);function a(t){return Math.pow(2,Math.ceil(Math.log(t)/o))}var s=new Image;s.src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAIAAgAMBIgACEQEDEQH/xACdAAADAQEBAQEBAAAAAAAAAAAFBgcEAwIIAQkQAAIBAwMCBQIDCAEDBQEAAAECAwQRIQUSMQBBBhMiUWFxkRQygRUjQqGxwdHwBxYzUiRDRGJj4QEAAwEBAQEAAAAAAAAAAAAAAgMEBQEABhEBAAIBAwMDAwMDAgcBAAAAAQIRIQMxQQASUSJhcQQygRORoUKxwSPRBUNSYnKC8KL/2gAMAwEAAhEDEQA/AP6h/ipaaXzIJGikQhgVYqwIyCrA3Hb5v79CdU1Wsq5pKiomeeRvzmQlmItYXJz/AC+MnrxqUpRbqfUBdWHsO3yP6fFx0oy6kzSbT6WseeD7r/i/WFqadHfC0fuOSq3223i/h6+n+nS5duYOJRf6XDz/AI/lMbKnXHpomPKd/dTnIza17n27C1wOlus8a06qVqWAWzAvuABWxO69+Qf0H3sn+L/EsGmxKu/e8r+VDBGC800z3tBFEMu7dgMAAsxVFZhMafw7q3iKpSXVmdaV2Dw6cjlqdSSHC1TCwq5eCY7/AIVDcBJ8SGHXisVgncVcat96ut9qlkeeetT6eEBFfQ7K4sp/t+bq8VVFPjSbUpGi0Gkav9RBqt3lUCHgj8UVPnMvdKSOdgbhtvTRomh6/qUm7UtWqoo2BBptOC0kVyLqhndZ6uUY/Mj0+6/5B0xeH/Bv4ahgaKAK3li9lFlUD0gC1lW2NoAAwBYDqseH/DrqiSPGUIcDK98C/wDc9hbnuItCDp6wtkcJm3c/kz+3VGvq6cSLp0sV01d2MgiPFA085N/CTofgvT6erjc0EE81/wDv1cIrZb3JJ31n4hge9wQPgdPdXo7+fEYz5ShF9MNoUA2kX2RBEuBYW244GCOncaOYikgX0qtwQByRY37D6fHXaLTzUqpJ/KSLe/P14+bXx1t0ShF9jN43E/jN9Zk9bUe26EhXpvAon7N+K6TDo0klI6M3moQDtlHmAEA3O19yj2yOO57rmo+D6FoA502lWWwtLBEaWW5tkSUTUz4+SRxcc9WVaNYYWXbklFFxyOLj34PWKpp9xRQoObkW7dh/L49+up2iueMG9uP9viup562pL9MvuIwk02lrg4M3j42x18+VOhanQuXoNRrAEtaCvIrabj8nmKIK2IdlYy1NseggnrXput11LPHS6hSrRPKwRKySrg/ZrMxABNVIYTAxvdVq4oCThSx6s37IjqkO+E3cswYew5Jvjt736xR+FaSaKp1Gspo5KWj/AHNPBPGHjraua+2F0b88MaXllXKsAAVs3TdKmdoJpHv97QUdxFcljxd4OilOJAi1ftxsGMX43PFlY7rrUIpKTR6FhIgYPO6EH8ZVva8gZRmFL7YuzKA4vcXa6rxBD4c0aTSdNkH7S1JB+1quMgNHDgrQRMLlVzebby1lOOYdU6ZqPhqmrtS0OLS4IpbpHpVejr5ys5Mkug1F7aXOhv6HMmnMDtEVKSZgC0vxUdQ3iQyLNHIYqinmGypgm5aGaM3ZGAIOdyupEsbvGysWakjTiZWc7WcgO0d2sty3zWOgjoskqnIyb4a+XqnLUtO+5iTzYH2t3Hb6X/l0Uij3KexIOL/F/bi1/wC/HSnRThyHJyeByR9hwMc/XN+m/Tyr3LYFiWv9L98gf1I9sdRwgyazGG6u8jG/TZx9aA0YF/xx8VjnqNVNQhmZZXASx9V7Am32DfHvyOpH438SUvh+kkqQzSTsfKpYIxulqZ5CVjihQH1SM2AMWyxsikh01WsgSmnnLhSiEsHIW4A5/wD6OPpe8J0HTKnxnr/7frFd9KpZHj0mnkVtjx3KSVxU/wDuVNiIWGUpgpx579dikJHtsOR2aPJvcWt8O3XdHTjbJOxN9qdqBqm3BdnOGx1+DfDVdq9Z/wBReI2DVtQGEFMSTFSQOwIhguLAtxLMQGqGH8EISNfozQPCU0/mSUenzVMNDB+LqXhgeQU8UbBfMqGVSIU3FVLuVS5ALXPW/wAN+EJ9Yq6ai0miqa2pcbYKalhaSeZ0RpXEcaKWby0RnOMKpPGeq34efWtBi1SDTayooRq2nTaTqkabR+KoZrCWmmjZTdSUU2w6MDtZT16RCSanpj3YnEe3O11/3cn9mlF+p3jTGN9so39p6alAdwx3JlW3lVmgkhheBo7FQQs0drBbnIIzxx8gX54o6uIIo7RgF7MpsBYXBHGDz3xkc3PSDFpE1JUMCu4MwIOcjFrj+2bG4+eqXDSvNpcclizwnbYi9ktcj9ORa3cdRS0VmsSwBrkpbP8AxR8VW/Rz1YhA7t6zakr3vwmMY6IMQ8W1VyVD/cAnBHIPtnrpRQBMstwTgDFrryRb5PFh1002EvFGXyNu3m9s9+bX+46IrEAQcWXn9Lj6cAdhb56v0yoEcNeeT/esV7HUE9ZZSKRHDn2sa8pyeehdXA9jb8it/TAIHHfHfoUYf3hDCwttNs+9/pYA24yPs4yKJI0wALjdxc2zn7/4PPWcad5sckibQCNt/qc/PP39u4Klz/8ACV75vf8AboYTkO+9RPAvNe1uC/L0DpIldSyrtVF28W573+mb8/GclBQw6tPSUU0wotJ0+F6mvqbYjgWzVMwUfnqJiFhpo+WbYosL9aRTCnHkOnNs9rmx9+bW4uLdBNZ3wwSU0b/9yzuFIswAJUNbsOQD9uuAxfa+/m2WOL2oo+ZbD0zt7pxVuOMiY2znLxx/fqf+NamDWK2YUtOKfToV8igp1s34emjxEHOPMmYASTPazyFjwB1Cdc0OojkGoURWDUaZQsbtcQ1VOrFvwdaFy8LZ8icKz0MhMkW6EzQSfQiaezIXdbJY4tkj3scD49vp0F1PRE8su2074yyNg2+Gxj4xzixxcanN7ppvlae7Z7Q5Db+bObYVD0sSJZcm1dq3UMePBnqYeGddhroQ7Bo545DBU00gAlp547LJBKoJs6m1iLq6lJEcxujNT4apNoKA2K3PxjkkWv8ATj7dQ3XaGfw7qi65TraIqqarEg9L0imyVRXvLQ3BZwNz0XmKcQQgU7TdVjmpkUsh3IDvBH5SMAYPz/bHRMtgquI0fyWyU/jz0TCWpXZXZj1Li2rtazkKzkx18p+PK2pqZ6Xw5Sl3Fc58+SI2lShh2fi/WuFModKUH+Fp1IyM1Dwtp0NJTUtGsY8tY0upRUZcCwAGCotYAfwgDHSF4f046r4irdSkBKw1K6fTnJtFT7ZapwFBv5lVIUbsRSqO3X0Np1DA21nCqVsEfbYEYsQLdv8AR1Jo/UEpIeqI5i8bWyv3w1jHt0X1GnPR0ogEu4tGrqVdtO56cl2DKX4evDqzac8Fbp9RPSVsRV4KimlaGSEFCrbXiIkVgGI3BsgkWtjpzpYPPcKynzmu+458wk3LBj+Zi2Wze+elXSI5AikAum5lD5BJFjcfe+b2B6aleSOyOLXsyMFta2bgiw3fODfjpr6lO3DVO97Y32N+PbrNqTh+7i2pbn9W8iiqR9nrzLEVlKyR3YE7TtsV+oOSv9sHp50FYZKWWJgokGNp4lxfbngsAbcG9wB26X4onqdsrv5jLZSpX13tcW2839+fa/T3TPL4RpK+i1jRdP1Wi8VaHS1mjanBVxyVWlVsUxkodW02tpne0kLpPp+saPWIrPG0kU0cFTDTzDp6O3P85dsV4bPjHjr1sxhM7Uqk2+EvHPt+cdeaDS0jjqHjs8UhLpe11vh1t2KnnjjjrzTUXmSmlYbdzOQxHfsL/a3079D9L1KolNTEeZELqOFMoNmIH/6A3x/F+nTNRSXmSR1C+WPX8ti/e4N78/a3T9NjY1ZZd3d4pxz21jho46XqQY1Vk72avhHLVPXrW/CesaLTUc1fptXRw10IqKKWogeGOqha4EsDOBvRiMEXsM4uOgkFNsj2ySBFCFjc83ubE9/4be9z3t1TPHP/ACH4i8Y02jUGsVEc0GiUaUdCkcKQ2iREjDy7QDJKyIis/dVWwvkgvC/iFvDWr02uPpOnasKeOoU0GqwGejmWeBoLsmPVGH8yNrHYwBsb3D9Y0v1QgvZUe5u8peMR38yj5LQOuaZOQqkWJlopZfG11jF48tqhqFK4o0qYmDuAQbdltbHvYZPSjNE1RYPdgDfi7Ec3Pxg4z7nqt+GYfD2sV+sxa/rUfhumeh1Ct04ijkqaebUAS8GmKiEmCF1JRJCT+VVvm/Sj+yalUqqqmiaalppYYZ5Iwp8k1G4Qh7kE+Ztb8qkAWDEdJrOK4jXOaq/DJoDddurdM7AHTbjSSebYpV/afFe9dJ70qiHe+EVir3BLMLY2DuTwLYHN+lXVFujqhCIMpG5BYA8l7d/i1unTV2mW8KReTsuLWO65zd72+th9ewHU8r1kBbc1r3ux5vkYGf1JN/5HoXTmJ6als27GMVx71xur1RA725+9R9PbVHBu++55rZF8Rw7ofyLN+7IYOiiJlAN0YW9SsCVYH+EkHnMi8P1h03UJ9IbzHp4Sr0UjvvI0+oDmlRjks1KUmoXPJNPvbL9XSeJHiBcmQZBBAuee9rnnr5/8TwtQ6lTzqvlBKqWgkdSVJp60GWnLXtmKshUKRbNS45a/S5elHxQ/dQYtOKP6iNcdOhKMl09qrtiGeL+3et8W+946H+AqRxRwM62cQxzyt/GJ6smplLDG/wBc5H0Atfq+QMsLxR4nHlqSVFjewyRj7Yz9Seo94TZxNWIn7tFkaP17dwWOyqLK1hYIFxa1uqnou+pr4UBTabKS9sItiSDfkD4x1j/RTnqmkAstSguKit4yxr4s226d/wASiR1NRT0aXtOMqO08DxtnnHh902OVJEZNwQWfawJUk+1uL8Yte1rdPMafiQtkCsPzDdcHba5UN61Ptkjt0K0pis/lxQ/ikElk2bdpX5z9rG33HVC08pTziRVVImC71mCORwrWU3K97cdutSWjUqLM1LtaDburtlIod6rCbZrEdS4xq1likKSo1eCQ0/PnOTBSUPlIJAFJseTYgj1D5ye3uB+mn8I8015QSW9V2uA1yMgEWJPdhlttyeevprwp4D/4015Kh5fGoppXrtPpqCOooRStKlTHEaueaLeQiU8jyJu3BAqBnADDqeeNvDFBoPiXUaDRdTj1jS6Sd4KatSwimRFBaWMKXXy9xK77qhYM2AwtVH6fUdI1f+XGXay4UapU+7yGaDqfv/1HRU/UQ3TYb/ZaC8ccdItNSRwuxKAH0quR6bAXPB57Z+cdaownn7LlS7E3tuU2GCw52k/mIHb9OnXwr4F13xXHVvo1LDVCjR2n87UNOpCgUqWYJWVkDuLSKVaNWDMSqklGCqNVFBTPts3mRmzOTYXBuVA/Lt73HXCPbw0q8Bxf/wAdW6emSO1j64mDcMGUzvjODg2Oi1V4Z1qi1mr0nUtNqaep0qNZ9Uhlhdm06mIp71FYYg600AWrpg00jLGhqIlLBpFUq9cHgaakJI8mRkYryVU2wcehhb9DbseukuoTGRpfxEwaYeXI3mvvlQFCRKdxLpdFO1yykopIuoIJHxwGj8RftnStO8RV2u0k0UWraoJf2hpWoVFRTSyaxSTwGMz1zx0/4cfivMgVJJiqBmk8wntlL0rGFtssoGxgLeHFb/lsNNiWxExdL9525plVZTnB0q5llcRJdQR+bARRwC1vi9hxbnrZpesTaXqUFcY/xC01XS1TUzm8E/4WZZVjmT8kiHaUuymwJ9zcK2q+VZUjjj3G8hbJZxcelgBtj22LK24ls3AsOsn7QoqgSneoe+1yOL8enk2x7Ad89FBDNpslc1Xj+++N8lNlCUjB8yvjGxvnn/GOqN/y/wCOtH8b+J5PEWi6Ouix1FDRxVVKRCTLWxRlaioIgCxgP6UUgbnWNXezEgfO2rzww1HlOql7lzLHIzxukgDLGb2UMlyD3ve/bpuq6+CKNwFF8qrHlsXuCbD3ti3HU01eKCql3SBtrcKrlcfJWx973P36KcyVpP1bpdMqrFLxw4XotHRQSPGK3k1uPdb5+KPe+c8loyyOArE8bRa+LXvbj6dQP/kQqsWooH/fGikqoVHeehK1kfAtctABgg+rHbqu2pdk0SwlAhsl3dyeckk/rf56l3i+njmY3Cg2aI+liwVkKvbPcG3z3uOs76rVhDSnTP8AU33jmgauvbGfFdav0OhJ1Yk4kRQ2BkLEVq+HpW8FVRnrJ9s6+p3awVT+Zi6nvzcW9jz1Y9Jl2MQ0jhgCEfbtJvj7f6fYSL/j/TPLFJJtImVUhqFAz5kJNPITjF3ibvgHknr6X07RqUlJJo917EFiAPj6+1vt7dYX0WrEhA02SxaasRjQ7Rjz4N+G+u/X6U5a05CXOl5xuYY1krbNfPRnwexmro0MpWyHb6wgDcKbcE3tfNuTfgdV2lpFeGQCQs6mzMT6b3sbEA/7yelDQYdNpZt/lxoQNq3AsL53G+ce1r8j36PjUUid40YlGcszE7RzwPg/r+nW/pTgaGnWJs5Xm8JEzHIcN4Wr6wdWDPWTs7u2J9p2jk5vO2cmb6Y9OqnpJAjyqVJ2A3I23xfHt/f56ZqaSCJa0zVEbgQPFEiMWVnfN1KW/UcnKjm/U7nqYwgePaL3N/kfY/ce3XPTtS/eNDIzFWaygGx9R/hvgG2b9unaf1H6coknuPUg1mSBdfMrP53yL9KSGeYT7s07mGs2mcdNUmpfh7shWyBRtYelzb8rj0kXPYZBOCDfrjPWRSRrMp3tywJuENuGuTkm4+Rm9yL862n0tBCkVZ+NaSGN5F8l6d46pkDSRMpZ90MDny45wy+eVZxGi7QVA6h+GnZGW8bXsOV5IPccjg/1Geiu6eE22zZXvz1VCHabHdhvztm/kutvbbopPXkb1VUNjgkm698AEAjNvt36BSVE0oZgE2obltvq3YsCN3Az82z3x4qPMWZ2j9SMAVFxcBgSRf4OOeOgbTyKxUttYtYgZH8sn+QPHNuuS3MpW/ufj+5zj4ohGKuPfO2KMDz8dE2mlkJsyBe54AYA9iT7XySfbHWIPGjvvcdhzZj84GQM/wBOuEryrEc3UgE8WPsew9x0IklUNuYMDcbf/EkHn3sR7Y6T3TEoo8W2mM5lznjqmGnGalGM3jbY87t8HW2qdJDbz3RQV54NzYZIN7/AJAOehU8cJuQu4AkZa4IBsGti18dj1p/HxKBviDoO6/m+ovf+vA563Q1Okyne8pUWvtZNrcdrCzZ7m/6Y6GcrSTIi+8cX+R/z0enBhKkQcCFdJ8sdOS+6IKSM7b/YgXvxb69S7xNBCiTzuSColayuVIRVL3N0vuAU8fTqv6qdOkLiGUG4IBHodcdvfPGe/UW8dI8Gi12yoZpaiKSmgVx6jPWlaSIA5P5qgXsOFwMjpGpM1NL0wjKQhgi7+nz+3H4wav0jCOtEmSopZMbwJZ+3PXHw/IdP1bU6S6reqTUYAFF2hq0EcoW9/TDVwOWHANUubsD1bNLqXmiG+S5UAjN224tYX7cY7/XqIeIDJp1XT6yvoSjZ46wRglm02q2CqfGXamZIa1AB/wDGZVBLm7zouo7CoR74ALKwbzFNvyv/ABAg7gRcFSDwRf5r6fWnp6kowgBNdrW7GWWjHcP/ALfnodbTlqaRNxUQlt5xg8g7379VqnnZGtc2JBJYgH6cYH1+Md+i34nco9VrZ9r+/awt7fXv0jxViNneFXgnsfi5F93yPfpmoNQoGlgp613SjM0bTywIrzpFcLI6gkeYVTcVQkbiLfXU0poh+ZS80Dd31k6umL2xKeaq+N1sr+Nuet0+qbYNnYYUd2znv7fqOes0Fe0bh1tuN9hOdp7sT25+mOuOpxUorZJaSV6nTFnmSjnkVIppY1P7t5oQx8tyhUlQbA3sevBeEXOzPl4Pbi4GMGx5+Rnq6HbNG0YnczdwxVDt4yPsHS/0+33wFHG27i7r+/npgp9SlfeCbkr5Zf3UHseRn+XFrdeKmHaVkAY3UC1jY3zf+Vu3QGllCbbk+1/ck4wbe2B3tbp50+emkWMVMYKFCACRYnbe5+cc83x3PVsZd1R7oLQj7UZ3/e/Dx0iaQtM1v/B0FWcGILcqcqM+qxBIz8Nj3z8dL7uzSbHy99ob2ZTgn3DXBPR2qh21O6IWRieBi9zYZGLGx+nSdXtJR1sys2XbzI79iFuQthncPvbI6Kcu3fNelr+Muc43K6Zo5fHp7scbV00axqdJPp2nwQ0i01RRQNBVTxlrVl5N6SuhuFlUHYxBs4ANhnpTEyyckYJ5t1sqZVqaMPHmXZ6l98Yv88373Hc46XXl2x2Ppc9r4JGD+vuOeptWW0sZxR9uO2z2fH/t7hdpFic0bchTuVft7e6gUYRsDftfcFFsdjce+L+/v0MqKiNR5fpFux59ubjt8nr3BUMcWJI5Bz8fb7W6A6tIFkIW3YEkj9QOBi9iecW6V3/qCVitrvIx24fjPzjqkigRbR//AD15rJkVHKML2J+LXvbJxjj68dSPxJUTahqOlUjOSRUHUJLflWm04fuFsCf+7XTRG9vV+Gf2NnWsrxFEyMQWdtg3/lzy24cKg9TNb0qCThTZP0ONdVrKvVhiKfbDR71t/wCggDinfN7GpeSatdTm9SqHCWEOpOTM0ypA3L/qNqHY+7J7DuvWvoaek6LKaxknbpqelvt7q2X02c5ke3TxqlEs0ZQ5uCCGFwQR3U4t2POL46Q9H1A6NWPotU5tDG8umSNe09AhvJTbjzPpdwu3Jk04wOLmlnPVI1FmUFgd2LG3vbPHxi/1vbqY+JKFa2MMrtFUwOJ6eqiP72nqI7tHLGSCLqSQysCkkbPFIGikZSj9GMS2i8RA2e48cBfcu/hesQ+o/otnj1G3ps5xkooxe3L1Q6XWVBVWYFSbqQf/AC9x/O2Sc46ZafUV5JFiBt+fr/j+fXz5pOtTSTfhKxUp62GMvNElxFKim34qk3XJpmwzx3MlE58mbdH5U0tBotSD7ULDAW7Xuf19ge/0+Om9zcbAV8uPVgS6aeOWnx1yGlvJv1O37ZwiBeBy7u2KjFXtUOqq22JT6if4jj1Hg44A7njpooSJA0Q9fF2Gcc8/59xni01palSUVWGbbSCbMfY85tz7cZ6oOnSrTwlr+uQXPH2+l+qGUohfOHxx4ayu3PxsOrAIlbKnvw5+PyX8V1vnCKyql7qLX7dzn+R562JUPGiZuq+578f7m5+nHKy+QZWHNzjPGL47H/cdZGnVACckAY98c9+ef1v13Sl2Nkto9vvcin5pXqXsilxp8nCldM8VUsiLY4BVr824v/U34/wt66sc06N3GQfgAf5sfp1+x1gVgUwpAUi/tc/6P1tfrHWybwHPqtc/cZv2Ns9PdZlFPMQX84c+E67pwkyjhAqwcOI2P77dDqioWCNhEylRbPAN8kG3yLD3tnI6wy2mi3i2RuvzfIubDFweR25ze3QitqB+9jDg3Ugr8kdvf3v9uL9BNO1homalle5B9Bydhvi5vbI97HoNGZMnFlQVbZuY2azF9wqXV7CWl2SibJf5AMe9j08VFVplFooRPMbVnnZ5GuPKSFfyouLl92e3uLY6TpaqKcFZDZnuORn5HcMLZx9OhWp6msbW3gxsbu18K3YkA8Hqfal4jmgrFo6RVn1CVQ8MbAmCGByQKysCkWhXJhguJK11CJaATTJN9ReilCKFZxIT7iXhzmvTT3HWloaZrFuAq1qt6SXjbD5w+Qp4khqZ5k0inYsKmMPqEi7r0enTZMLtjbUamvoVL7o9O86Vtv4qn3HdNgSkhWGBQUVLWAsBjFh1w0GMLFad2nnndpampl9U1RNIbyTTPaxd8YUBUULGirEioGY0YHqTHJtbnHb3v246DQIymq0yzeLHGEHjg23lVq9F9RPtiwjfbGjtTbz4BW1/bYDrtWoCtr9rG3fgWH1/0jN0+qo2JbHPbtbnGOB2+R7dOkhFizf47d/jGB9+T0GmAbcSctwDj47cYtx/fr05KkYjjl+5fL4PA7H4rF0dIgrW/HN4pl7HBgMe/Uy1fSEqthXdFPA/mQ1ML+XLBIAQJIpALg5seUkQskivGzKcdHqcunOsGrhYGPpi1BR5dBOTgCcXtps78HefwEjZSanNoOqFPQ2W+25NyfgD79icfH6dC303zvQ0YdXBVgwB9JwQR7Ec35vbI6EhJfUYqz4w5/292s9WQmVfOR/tW5lsd9uej2hTtJOovxZlB/8AtYg9w65wwup5BNun5tRaJxFcekBcdj+hv7n+Z7AzGk8N1WlQCp0aqNIUsRRzIZ9PZr7iPwzOkkAPdqOWmN7Ehuv2l1rUTWIK/SqtSGG+WhcajSOBjcinya6EHnY8NTtAH75uem6bLUmA90dgrI0GzugqV5bXpOr2yyS8hx6ljs+OC66uqaiFpoIm5c974FuTbm/t8e3XuSakLIJMkAi+619oFre/yM836QJPEGkySU6U+o0YdVAlpZ6gUNXE9vyvTVwpZr4IDIHU3Pq7dGN9ROY2ip5pozgPApmQkqCFEkW9Ln25+LdedaP6soMftl+nFwjWbx5pB/2wmH0kyKRVjQ2Dm6fxt8OU6Pb7O+0EjFsnH+e+P0tzb3NKhhVmcAG1yffNx/QZI64ypVU1O0s9NNBHbMtQohQkLcDzJSiggdrn56m+o+KdPiDQvqdJuWQ/uaeY1k4zx5dEtTLfmw25I6j1vrIlEcORKuzZ2L9utH6b6Kcge1zElcigQOXz258+Lc8NWqttZKiNcljm/b8oz0h6nqYo0eYNeVSfM2kYH/nyAqj3YhQLnAv151XV62efdp+m1MgJuKivIoKft6miXzq10wPSY6ZyBbenS1P4aqtScS6xUmqp5CGNFGn4egVsZanDO9Sw4DVctRt/hCdK0tf/AFiVJDUiLYN9wdxVZqW5jqzU+nhpp3p9vYsNrKq88x7W881zQ3/qWv12RqLRwGQ2So1Nxvo4RfIpgbCvqOdpU/gkOXlqsw9OWi6HBQIUkd55pn86SrnbzKiomawaWaUi7vYBeyoirHGqRqqjnpmjQ0LrHGNqjbb223sPtxjjgDqj0+nxSwLexIGDYW4wcfa3WxpBqQdGa4iS0tRM0gsJb+iztwptLqV1nTe0wXkjzsE/Ml+a5Auus1NH5SgL2Fj2vY837/B7d+9jlNISArm6e/dL/wC/TrzFAoAQj1DAP9P89+t8NJv/ACj1dwO/txwfb+tx0p0kzC4o1Kj1D4fJ79ES/UPUihQ18HbI2o4ev//Z";var c=s;function l(t,e,n){var o=function(t){var e=Math.max(1,a(Math.sqrt(t)));return{width:e,height:Math.max(1,a(t/e))}}(t),s=o.width*o.height,l=new r.Vector2(o.width,o.height),d=new Uint8Array(4*s),f=new Uint8Array(4*s);f.fill(255);var h=new r.DataTexture(d,o.width,o.height),m=new r.DataTexture(f,o.width,o.height),v=new r.Texture(c);v.needsUpdate=!0;for(var g=new r.ShaderMaterial({name:"Primitives (Box)",clipping:!0,clippingPlanes:n,extensions:{fragDepth:!0},vertexShader:i.b.boxPrimitive.vertex,fragmentShader:i.b.boxPrimitive.fragment,side:r.DoubleSide}),y=new r.ShaderMaterial({name:"Primitives (Circle)",clipping:!0,clippingPlanes:n,extensions:{fragDepth:!0},vertexShader:i.b.circlePrimitive.vertex,fragmentShader:i.b.circlePrimitive.fragment,side:r.DoubleSide}),b=new r.ShaderMaterial({name:"Primitives (Nuts)",clipping:!0,clippingPlanes:n,vertexShader:i.b.nutPrimitive.vertex,fragmentShader:i.b.nutPrimitive.fragment,side:r.DoubleSide}),x=new r.ShaderMaterial({name:"Primitives (Quads)",clipping:!0,clippingPlanes:n,vertexShader:i.b.quadPrimitive.vertex,fragmentShader:i.b.quadPrimitive.fragment,side:r.DoubleSide}),_=new r.ShaderMaterial({name:"Primitives (General rings)",clipping:!0,clippingPlanes:n,uniforms:{inverseModelMatrix:{value:new r.Matrix4}},extensions:{fragDepth:!0},vertexShader:i.b.generalRingPrimitive.vertex,fragmentShader:i.b.generalRingPrimitive.fragment,side:r.DoubleSide}),w=new r.ShaderMaterial({name:"Primitives (Cone)",clipping:!0,clippingPlanes:n,uniforms:{inverseModelMatrix:{value:new r.Matrix4}},extensions:{fragDepth:!0},vertexShader:i.b.conePrimitive.vertex,fragmentShader:i.b.conePrimitive.fragment,side:r.DoubleSide}),T=new r.ShaderMaterial({name:"Primitives (Eccentric cone)",clipping:!0,clippingPlanes:n,uniforms:{inverseModelMatrix:{value:new r.Matrix4}},extensions:{fragDepth:!0},vertexShader:i.b.eccentricConePrimitive.vertex,fragmentShader:i.b.eccentricConePrimitive.fragment,side:r.DoubleSide}),S=new r.ShaderMaterial({name:"Primitives (Ellipsoid segments)",clipping:!0,clippingPlanes:n,uniforms:{inverseModelMatrix:{value:new r.Matrix4}},extensions:{fragDepth:!0},vertexShader:i.b.ellipsoidSegmentPrimitive.vertex,fragmentShader:i.b.ellipsoidSegmentPrimitive.fragment,side:r.DoubleSide}),M=new r.ShaderMaterial({name:"Primitives (General cylinder)",clipping:!0,clippingPlanes:n,uniforms:{inverseModelMatrix:{value:new r.Matrix4}},extensions:{fragDepth:!0},vertexShader:i.b.generalCylinderPrimitive.vertex,fragmentShader:i.b.generalCylinderPrimitive.fragment,side:r.DoubleSide}),E=new r.ShaderMaterial({name:"Primitives (Trapezium)",clipping:!0,clippingPlanes:n,uniforms:{inverseModelMatrix:{value:new r.Matrix4}},extensions:{fragDepth:!0},vertexShader:i.b.trapeziumPrimitive.vertex,fragmentShader:i.b.trapeziumPrimitive.fragment,side:r.DoubleSide}),R=new r.ShaderMaterial({name:"Primitives (Torus segment)",clipping:!0,clippingPlanes:n,uniforms:{inverseModelMatrix:{value:new r.Matrix4}},extensions:{fragDepth:!0,derivatives:!0},vertexShader:i.b.torusSegmentPrimitive.vertex,fragmentShader:i.b.torusSegmentPrimitive.fragment,side:r.DoubleSide}),I=new r.ShaderMaterial({name:"Primitives (Spherical segment)",clipping:!0,clippingPlanes:n,uniforms:{inverseModelMatrix:{value:new r.Matrix4}},extensions:{fragDepth:!0},vertexShader:i.b.ellipsoidSegmentPrimitive.vertex,fragmentShader:i.b.ellipsoidSegmentPrimitive.fragment,side:r.DoubleSide}),B=new r.ShaderMaterial({name:"Triangle meshes",clipping:!0,clippingPlanes:n,extensions:{derivatives:!0},side:r.DoubleSide,fragmentShader:i.b.detailedMesh.fragment,vertexShader:i.b.detailedMesh.vertex}),A={box:g,circle:y,nut:b,generalRing:_,quad:x,cone:w,eccentricCone:T,sphericalSegment:I,torusSegment:R,generalCylinder:M,trapezium:E,ellipsoidSegment:S,instancedMesh:new r.ShaderMaterial({name:"Instanced meshes",clipping:!0,clippingPlanes:n,extensions:{derivatives:!0},side:r.DoubleSide,fragmentShader:i.b.instancedMesh.fragment,vertexShader:i.b.instancedMesh.vertex}),triangleMesh:B,simple:new r.ShaderMaterial({name:"Low detail material",clipping:!0,clippingPlanes:n,fragmentShader:i.b.simpleMesh.fragment,vertexShader:i.b.simpleMesh.vertex})},C=0,F=Object.values(A);C<F.length;C++)p(F[C],l,h,m,v,e);return u(u({},A),{},{overrideColorPerTreeIndex:h,overrideVisibilityPerTreeIndex:m})}function p(t,e,n,r,o,a){var s=t.uniforms;t.setValues(u(u({},i.c),{},{uniforms:u(u({},s),{},{renderMode:{value:a},colorDataTexture:{value:n},overrideVisibilityPerTreeIndex:{value:r},dataTextureSize:{value:e},matCapTexture:{value:o}})}))}var m=n(14),v=function(){function t(e){d(this,t),this._renderMode=m.a.Color,this.materialsMap=new Map,this._clippingPlanes=[],this._clipIntersection=!1,this._globalAppearance=e}return f(t,[{key:"addModelMaterials",value:function(t,e,n){var r=l(e+1,this._renderMode,this._clippingPlanes);this.materialsMap.set(t,{materials:r,nodeAppearance:n});for(var i=[],o=0;o<e;o++)i.push(o);this.updateModelNodes(t,i)}},{key:"getModelMaterials",value:function(t){return this.materialsMap.get(t).materials}},{key:"updateGlobalAppearance",value:function(t){this._globalAppearance=t}},{key:"updateLocalAppearance",value:function(t,e){var n=this.materialsMap.get(t);n.nodeAppearance=e,this.materialsMap.set(t,n)}},{key:"setRenderMode",value:function(t){this._renderMode=t,this.applyToAllMaterials((function(e){e.uniforms.renderMode.value=t}))}},{key:"getRenderMode",value:function(){return this._renderMode}},{key:"updateModelNodes",value:function(t,e){var n=this.materialsMap.get(t),r=n.materials,i=n.nodeAppearance;(i||this._globalAppearance)&&0!==e.length&&(i&&void 0!==i.color&&(function(t,e,n){var r,i=h(n);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=t(o)||[0,0,0,0];e.overrideColorPerTreeIndex.image.data[4*o]=a[0],e.overrideColorPerTreeIndex.image.data[4*o+1]=a[1],e.overrideColorPerTreeIndex.image.data[4*o+2]=a[2],e.overrideColorPerTreeIndex.image.data[4*o+3]=a[3]}}catch(s){i.e(s)}finally{i.f()}}(i.color,r,e),r.overrideColorPerTreeIndex.needsUpdate=!0),i&&void 0!==i.visible&&(function(t,e,n){var r,i=h(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;e.overrideVisibilityPerTreeIndex.image.data[4*o]=t(o)?255:0}}catch(a){i.e(a)}finally{i.f()}}(i.visible,r,e),r.overrideVisibilityPerTreeIndex.needsUpdate=!0),this._globalAppearance&&void 0!==this._globalAppearance.color&&(function(t,e,n,r){var i,o=h(r);try{for(o.s();!(i=o.n()).done;){var a=i.value,s=e(t,a)||[0,0,0,0];n.overrideColorPerTreeIndex.image.data[4*a]=s[0],n.overrideColorPerTreeIndex.image.data[4*a+1]=s[1],n.overrideColorPerTreeIndex.image.data[4*a+2]=s[2],n.overrideColorPerTreeIndex.image.data[4*a+3]=s[3]}}catch(u){o.e(u)}finally{o.f()}}(t,this._globalAppearance.color,r,e),r.overrideColorPerTreeIndex.needsUpdate=!0),this._globalAppearance&&void 0!==this._globalAppearance.visible&&(function(t,e,n,r){var i,o=h(r);try{for(o.s();!(i=o.n()).done;){var a=i.value;n.overrideVisibilityPerTreeIndex.image.data[4*a]=e(t,a)?255:0}}catch(s){o.e(s)}finally{o.f()}}(t,this._globalAppearance.visible,r,e),r.overrideVisibilityPerTreeIndex.needsUpdate=!0))}},{key:"applyToAllMaterials",value:function(t){var e,n=h(this.materialsMap.values());try{for(n.s();!(e=n.n()).done;){var r=e.value.materials;t(r.box),t(r.circle),t(r.generalRing),t(r.nut),t(r.quad),t(r.cone),t(r.eccentricCone),t(r.sphericalSegment),t(r.torusSegment),t(r.generalCylinder),t(r.trapezium),t(r.ellipsoidSegment),t(r.instancedMesh),t(r.triangleMesh),t(r.simple)}}catch(i){n.e(i)}finally{n.f()}}},{key:"clippingPlanes",get:function(){return this._clippingPlanes},set:function(t){this._clippingPlanes=t,this.applyToAllMaterials((function(e){e.clippingPlanes=t}))}},{key:"clipIntersection",get:function(){return this._clipIntersection},set:function(t){this._clipIntersection=t,this.applyToAllMaterials((function(e){e.clipIntersection=t}))}}]),t}()},,function(t,e,n){t.exports=n.p+"parser.worker.js"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nconst int RenderTypeColor = 1;\nconst int RenderTypeNormal = 2;\nconst int RenderTypeTreeIndex = 3;\nconst int RenderTypePackColorAndNormal = 4;\nconst int RenderTypeDepth = 5;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(int renderMode, vec3 color, float treeIndex, vec3 normal, float depth, sampler2D matCapTexture) {\n    if (renderMode == RenderTypeColor) {\n        vec3 hsv = rgb2hsv(color);\n        float h = hsv.x;\n        hsv.z = min(0.6 * hsv.z + 0.4, 1.0);\n        color = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        \n        vec4 albedo = vec4(color * (0.4 + 0.6 * amplitude), h);\n\n        vec2 cap = normal.xy * 0.5 + 0.5;\n\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1);\n        \n        gl_FragColor = albedo * mc * 1.7;\n\n    } else if (renderMode == RenderTypePackColorAndNormal) {\n        vec3 hsv = rgb2hsv(color);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex) {\n        color = packIntToColor(treeIndex);\n        gl_FragColor = vec4(color, 1.0);\n    } else if (renderMode == RenderTypeDepth) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n}\n\nbool determineVisibility(sampler2D visibilityTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 visible = texture2D(visibilityTexture, treeIndexUv);\n\n    return visible.r > 0.0;\n}\n\nvec3 determineColor(vec3 originalColor, sampler2D colorDataTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 overrideColor = texture2D(colorDataTexture, treeIndexUv);\n\n    return overrideColor.a * overrideColor.rgb + (1.0 - overrideColor.a) * originalColor;\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isSliced(vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 dataTextureSize;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform int renderMode;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    if (!determineVisibility(overrideVisibilityPerTreeIndex, dataTextureSize, v_treeIndex)) {\n        discard;\n    }\n    if (isSliced(vViewPosition)) {\n        discard;\n    }\n\n    vec3 color = determineColor(v_color, colorDataTexture, dataTextureSize, v_treeIndex);\n    updateFragmentColor(renderMode, color, v_treeIndex, v_normal, gl_FragCoord.z, matCapTexture);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nattribute vec3 color;\nattribute float treeIndex;\nattribute vec4 matrix0;\nattribute vec4 matrix1;\nattribute vec4 matrix2;\nattribute vec4 matrix3;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    v_treeIndex = treeIndex;\n    v_color = color;\n    v_normal = normalMatrix * normal;\n    mat4 instanceMatrix = mat4(matrix0, matrix1, matrix2, matrix3);\n    vec3 transformed = (instanceMatrix * vec4(position, 1.0)).xyz;\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n    vViewPosition = mvPosition.xyz;\n    gl_Position = projectionMatrix * mvPosition;\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nvec3 derivateNormal(vec3 v_viewPosition) {\n  vec3 fdx = vec3(dFdx(v_viewPosition.x), dFdx(v_viewPosition.y), dFdx(v_viewPosition.z));\n  vec3 fdy = vec3(dFdy(v_viewPosition.x), dFdy(v_viewPosition.y), dFdy(v_viewPosition.z));\n  vec3 normal = normalize(cross(fdx, fdy));\n  return normal;\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nconst int RenderTypeColor = 1;\nconst int RenderTypeNormal = 2;\nconst int RenderTypeTreeIndex = 3;\nconst int RenderTypePackColorAndNormal = 4;\nconst int RenderTypeDepth = 5;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(int renderMode, vec3 color, float treeIndex, vec3 normal, float depth, sampler2D matCapTexture) {\n    if (renderMode == RenderTypeColor) {\n        vec3 hsv = rgb2hsv(color);\n        float h = hsv.x;\n        hsv.z = min(0.6 * hsv.z + 0.4, 1.0);\n        color = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        \n        vec4 albedo = vec4(color * (0.4 + 0.6 * amplitude), h);\n\n        vec2 cap = normal.xy * 0.5 + 0.5;\n\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1);\n        \n        gl_FragColor = albedo * mc * 1.7;\n\n    } else if (renderMode == RenderTypePackColorAndNormal) {\n        vec3 hsv = rgb2hsv(color);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex) {\n        color = packIntToColor(treeIndex);\n        gl_FragColor = vec4(color, 1.0);\n    } else if (renderMode == RenderTypeDepth) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n}\n\nvec3 determineColor(vec3 originalColor, sampler2D colorDataTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 overrideColor = texture2D(colorDataTexture, treeIndexUv);\n\n    return overrideColor.a * overrideColor.rgb + (1.0 - overrideColor.a) * originalColor;\n}\n\nbool determineVisibility(sampler2D visibilityTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 visible = texture2D(visibilityTexture, treeIndexUv);\n\n    return visible.r > 0.0;\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isSliced(vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 dataTextureSize;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_viewPosition;\n\nuniform int renderMode;\n\nvoid main()\n{\n    if (!determineVisibility(overrideVisibilityPerTreeIndex, dataTextureSize, v_treeIndex)) {\n        discard;\n    }\n\n    if (isSliced(v_viewPosition)) {\n        discard;\n    }\n\n    vec3 color = determineColor(v_color, colorDataTexture, dataTextureSize, v_treeIndex);\n    vec3 normal = derivateNormal(v_viewPosition);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nattribute vec3 color;\nattribute float treeIndex; \n\nvarying vec3 v_color;\nvarying float v_treeIndex;\nvarying vec3 v_viewPosition;\n\nvoid main() {\n    v_color = color;\n    v_treeIndex = treeIndex;\n\n    vec4 modelViewPosition = modelViewMatrix * vec4(position, 1.0);\n    v_viewPosition = modelViewPosition.xyz;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nvec3 derivateNormal(vec3 v_viewPosition) {\n  vec3 fdx = vec3(dFdx(v_viewPosition.x), dFdx(v_viewPosition.y), dFdx(v_viewPosition.z));\n  vec3 fdy = vec3(dFdy(v_viewPosition.x), dFdy(v_viewPosition.y), dFdy(v_viewPosition.z));\n  vec3 normal = normalize(cross(fdx, fdy));\n  return normal;\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nconst int RenderTypeColor = 1;\nconst int RenderTypeNormal = 2;\nconst int RenderTypeTreeIndex = 3;\nconst int RenderTypePackColorAndNormal = 4;\nconst int RenderTypeDepth = 5;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(int renderMode, vec3 color, float treeIndex, vec3 normal, float depth, sampler2D matCapTexture) {\n    if (renderMode == RenderTypeColor) {\n        vec3 hsv = rgb2hsv(color);\n        float h = hsv.x;\n        hsv.z = min(0.6 * hsv.z + 0.4, 1.0);\n        color = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        \n        vec4 albedo = vec4(color * (0.4 + 0.6 * amplitude), h);\n\n        vec2 cap = normal.xy * 0.5 + 0.5;\n\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1);\n        \n        gl_FragColor = albedo * mc * 1.7;\n\n    } else if (renderMode == RenderTypePackColorAndNormal) {\n        vec3 hsv = rgb2hsv(color);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex) {\n        color = packIntToColor(treeIndex);\n        gl_FragColor = vec4(color, 1.0);\n    } else if (renderMode == RenderTypeDepth) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n}\n\nbool determineVisibility(sampler2D visibilityTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 visible = texture2D(visibilityTexture, treeIndexUv);\n\n    return visible.r > 0.0;\n}\n\nvec3 determineColor(vec3 originalColor, sampler2D colorDataTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 overrideColor = texture2D(colorDataTexture, treeIndexUv);\n\n    return overrideColor.a * overrideColor.rgb + (1.0 - overrideColor.a) * originalColor;\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isSliced(vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 dataTextureSize;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_viewPosition;\n\nuniform int renderMode;\n\nvoid main() {\n    if (!determineVisibility(overrideVisibilityPerTreeIndex, dataTextureSize, v_treeIndex)) {\n        discard;\n    }\n\n    if (isSliced(v_viewPosition)) {\n        discard;\n    }\n\n    vec3 color = determineColor(v_color, colorDataTexture, dataTextureSize, v_treeIndex);\n    vec3 normal = derivateNormal(v_viewPosition);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n// TODO consider passing vec3 from a matrix3x4 to reduce memory usage and data transfer\n// TODO consider fixing Three.js so it is possible to pass a mat4:\n// see https://stackoverflow.com/questions/38853096/webgl-how-to-bind-values-to-a-mat4-attribute\n\nmat4 constructMatrix(vec4 column_0, vec4 column_1, vec4 column_2, vec4 column_3) {\n  return mat4(\n    column_0,\n    column_1,\n    column_2,\n    column_3\n  );\n}\n\nattribute vec4 a_instanceMatrix_column_0;\nattribute vec4 a_instanceMatrix_column_1;\nattribute vec4 a_instanceMatrix_column_2;\nattribute vec4 a_instanceMatrix_column_3;\n\nattribute float a_treeIndex;\nattribute vec3 a_color;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_viewPosition;\n\nvoid main()\n{\n    mat4 instanceMatrix = constructMatrix(\n        a_instanceMatrix_column_0,\n        a_instanceMatrix_column_1,\n        a_instanceMatrix_column_2,\n        a_instanceMatrix_column_3\n    );\n\n    v_color = a_color;\n\n    vec3 transformed = (instanceMatrix * vec4(position, 1.0)).xyz;\n    vec4 modelViewPosition = modelViewMatrix * vec4(transformed, 1.0);\n    v_viewPosition = modelViewPosition.xyz;\n    v_treeIndex = a_treeIndex;\n    gl_Position = projectionMatrix * modelViewPosition;\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nconst int RenderTypeColor = 1;\nconst int RenderTypeNormal = 2;\nconst int RenderTypeTreeIndex = 3;\nconst int RenderTypePackColorAndNormal = 4;\nconst int RenderTypeDepth = 5;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(int renderMode, vec3 color, float treeIndex, vec3 normal, float depth, sampler2D matCapTexture) {\n    if (renderMode == RenderTypeColor) {\n        vec3 hsv = rgb2hsv(color);\n        float h = hsv.x;\n        hsv.z = min(0.6 * hsv.z + 0.4, 1.0);\n        color = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        \n        vec4 albedo = vec4(color * (0.4 + 0.6 * amplitude), h);\n\n        vec2 cap = normal.xy * 0.5 + 0.5;\n\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1);\n        \n        gl_FragColor = albedo * mc * 1.7;\n\n    } else if (renderMode == RenderTypePackColorAndNormal) {\n        vec3 hsv = rgb2hsv(color);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex) {\n        color = packIntToColor(treeIndex);\n        gl_FragColor = vec4(color, 1.0);\n    } else if (renderMode == RenderTypeDepth) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n}\n\nbool determineVisibility(sampler2D visibilityTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 visible = texture2D(visibilityTexture, treeIndexUv);\n\n    return visible.r > 0.0;\n}\n\nvec3 determineColor(vec3 originalColor, sampler2D colorDataTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 overrideColor = texture2D(colorDataTexture, treeIndexUv);\n\n    return overrideColor.a * overrideColor.rgb + (1.0 - overrideColor.a) * originalColor;\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isSliced(vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nvarying float v_treeIndex;\nvarying vec2 v_xy;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 dataTextureSize;\n\nuniform int renderMode;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    if (!determineVisibility(overrideVisibilityPerTreeIndex, dataTextureSize, v_treeIndex)) {\n        discard;\n    }\n\n    if (isSliced(vViewPosition)) {\n        discard;\n    }\n\n    vec3 color = determineColor(v_color, colorDataTexture, dataTextureSize, v_treeIndex);\n    float dist = dot(v_xy, v_xy);\n    vec3 normal = normalize( v_normal );\n    if (dist > 0.25)\n      discard;\n\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n// TODO consider passing vec3 from a matrix3x4 to reduce memory usage and data transfer\n// TODO consider fixing Three.js so it is possible to pass a mat4:\n// see https://stackoverflow.com/questions/38853096/webgl-how-to-bind-values-to-a-mat4-attribute\n\nmat4 constructMatrix(vec4 column_0, vec4 column_1, vec4 column_2, vec4 column_3) {\n  return mat4(\n    column_0,\n    column_1,\n    column_2,\n    column_3\n  );\n}\n\nattribute vec4 a_instanceMatrix_column_0;\nattribute vec4 a_instanceMatrix_column_1;\nattribute vec4 a_instanceMatrix_column_2;\nattribute vec4 a_instanceMatrix_column_3;\n\nattribute float a_treeIndex;\nattribute vec3 a_color;\nattribute vec3 a_normal;\n\nvarying vec2 v_xy;\nvarying vec3 v_color;\nvarying vec3 v_normal;\nvarying float v_treeIndex;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    v_xy = vec2(position.x, position.y);\n    v_treeIndex = a_treeIndex;\n\n    mat4 instanceMatrix = constructMatrix(\n        a_instanceMatrix_column_0,\n        a_instanceMatrix_column_1,\n        a_instanceMatrix_column_2,\n        a_instanceMatrix_column_3\n    );\n\n    vec3 transformed = (instanceMatrix * vec4(position, 1.0)).xyz;\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n    v_color = a_color;\n\n    v_normal = normalMatrix * a_normal;\n    vViewPosition = mvPosition.xyz;\n    gl_Position = projectionMatrix * mvPosition;\n}\n"},function(t,e,n){"use strict";n.r(e),e.default='#define GLSLIFY 1\nvec3 mul3(mat4 M, vec3 v) {\n  vec4 u = M * vec4(v, 1.0);\n  return u.xyz / u.w;\n}\n\nfloat displaceScalar(vec3 point, float scalar, \n  float treeIndex, vec3 cameraPosition, mat4 inverseModelMatrix) {\n\n  // Displaces a scalar based on distance to camera to avoid z-fighting\n  vec3 cameraPositionModelSpace = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n  vec3 pointToCamera = cameraPositionModelSpace - point;\n\n  // "Random" number in the range [0, 1], based on treeIndex\n  float rnd = mod(treeIndex, 64.) / 64.;\n  // Compute distance to camera, but cap it\n  float maxDistanceToCamera = 50.;\n  float distanceToCamera = min(length(pointToCamera), maxDistanceToCamera);\n\n  float maxDisplacement = 0.01;\n  float scaleFactor = 0.01;\n  float displacement = min(maxDisplacement, scaleFactor * rnd * distanceToCamera / maxDistanceToCamera);\n  return scalar + displacement;\n}\n\nfloat computeFragmentDepth(vec3 p, mat4 projectionMatrix) {\n  // Anders Hafreager comments:\n  // Depth value can be calculated by transforming the z-component of the intersection point to projection space.\n  // The w-component is also needed to scale projection space into clip space.\n  // However, the 4th column of the projection matrix is (0, 0, const, 0), so we can exploit this when computing w-value.\n  float projected_intersection_z=projectionMatrix[0][2]*p.x+projectionMatrix[1][2]*p.y+projectionMatrix[2][2]*p.z+projectionMatrix[3][2];\n\n  // If we want to use orthographic camera, the full w-component is found as\n  float projected_intersection_w=projectionMatrix[0][3]*p.x+projectionMatrix[1][3]*p.y+projectionMatrix[2][3]*p.z+projectionMatrix[3][3];\n  // float projected_intersection_w = projectionMatrix[2][3]*newPoint.z; // Optimized for perspective camera\n  return ((gl_DepthRange.diff * (projected_intersection_z / projected_intersection_w)) + gl_DepthRange.near + gl_DepthRange.far) * .5;\n}\n\n#ifdef GL_EXT_frag_depth\n\nfloat updateFragmentDepth(vec3 p,mat4 projectionMatrix) {\n  gl_FragDepthEXT = computeFragmentDepth(p, projectionMatrix);\n  return gl_FragDepthEXT;\n}\n\n#else\n\nfloat updateFragmentDepth(vec3 p, mat4 projectionMatrix){\n  // Extension not available - not much we can do.\n  return computeFragmentDepth(p, projectionMatrix);\n}\n\n#endif\n\nbool determineVisibility(sampler2D visibilityTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 visible = texture2D(visibilityTexture, treeIndexUv);\n\n    return visible.r > 0.0;\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nconst int RenderTypeColor = 1;\nconst int RenderTypeNormal = 2;\nconst int RenderTypeTreeIndex = 3;\nconst int RenderTypePackColorAndNormal = 4;\nconst int RenderTypeDepth = 5;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(int renderMode, vec3 color, float treeIndex, vec3 normal, float depth, sampler2D matCapTexture) {\n    if (renderMode == RenderTypeColor) {\n        vec3 hsv = rgb2hsv(color);\n        float h = hsv.x;\n        hsv.z = min(0.6 * hsv.z + 0.4, 1.0);\n        color = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        \n        vec4 albedo = vec4(color * (0.4 + 0.6 * amplitude), h);\n\n        vec2 cap = normal.xy * 0.5 + 0.5;\n\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1);\n        \n        gl_FragColor = albedo * mc * 1.7;\n\n    } else if (renderMode == RenderTypePackColorAndNormal) {\n        vec3 hsv = rgb2hsv(color);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex) {\n        color = packIntToColor(treeIndex);\n        gl_FragColor = vec4(color, 1.0);\n    } else if (renderMode == RenderTypeDepth) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isSliced(vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nvec3 determineColor(vec3 originalColor, sampler2D colorDataTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 overrideColor = texture2D(colorDataTexture, treeIndexUv);\n\n    return overrideColor.a * overrideColor.rgb + (1.0 - overrideColor.a) * originalColor;\n}\n\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 dataTextureSize;\n\nuniform mat4 projectionMatrix;\n\nvarying vec4 v_centerB;\n\nvarying vec4 v_W;\nvarying vec4 v_U;\n\nvarying float v_angle;\nvarying float v_arcAngle;\n\nvarying vec4 v_centerA;\nvarying vec4 v_V;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform int renderMode;\n\nvoid main() {\n  if (!determineVisibility(overrideVisibilityPerTreeIndex, dataTextureSize, v_treeIndex)) {\n    discard;\n  }\n\n  vec3 normal = normalize( v_normal );\n  vec3 color = determineColor(v_color, colorDataTexture, dataTextureSize, v_treeIndex);\n\n  float R1 = v_centerB.w;\n  vec4 U = v_U;\n  vec4 W = v_W;\n  vec4 V = v_V;\n  float height = length(v_centerA.xyz - v_centerB.xyz);\n  float R2 = v_centerA.w;\n  float dR = R2 - R1;\n\n  mat3 basis = mat3(U.xyz, V.xyz, W.xyz);\n  vec3 surfacePoint = vec3(U.w, V.w, W.w);\n  vec3 rayTarget = surfacePoint;\n\n  #if defined(COGNITE_ORTHOGRAPHIC_CAMERA)\n    vec3 rayDirection = vec3(0.0, 0.0, -1.0);\n  #else\n    vec3 rayDirection = normalize(rayTarget); // rayOrigin is (0,0,0) in camera space\n  #endif\n\n  vec3 diff = rayTarget - v_centerB.xyz;\n  vec3 E = diff * basis;\n  vec3 D = rayDirection * basis;\n\n  float a = dot(D.xy, D.xy);\n  float b = dot(E.xy, D.xy);\n  float c = dot(E.xy, E.xy) - R1*R1;\n\n  if (R1 != R2) {\n    // Additional terms if radii are different\n    float dRLInv = dR / height;\n    float dRdRL2Inv = dRLInv * dRLInv;\n    a -= D.z * D.z * dRdRL2Inv;\n    b -= dRLInv * (E.z * D.z * dRLInv + R1 * D.z);\n    c -= dRLInv * (E.z * E.z * dRLInv + 2.0 * R1 * E.z);\n  }\n\n  // Calculate a dicriminant of the above quadratic equation\n  float d = b*b - a*c;\n\n  // d < 0.0 means the ray hits outside an infinitely long cone\n  if (d < 0.0)\n    discard;\n\n  float sqrtd = sqrt(d);\n  float dist1 = (-b - sqrtd)/a;\n  float dist2 = (-b + sqrtd)/a;\n\n  // Make sure dist1 is the smaller one\n  if (dist2 < dist1) {\n    float tmp = dist1;\n    dist1 = dist2;\n    dist2 = tmp;\n  }\n\n  float dist = dist1;\n  vec3 intersectionPoint = E + dist * D;\n  float theta = atan(intersectionPoint.y, intersectionPoint.x);\n  if (theta < v_angle) theta += 2.0 * PI;\n\n  // Intersection point in camera space\n  vec3 p = rayTarget + dist*rayDirection;\n\n  bool isInner = false;\n\n  if (intersectionPoint.z <= 0.0 ||\n      intersectionPoint.z > height ||\n      theta > v_angle + v_arcAngle ||\n      isSliced(p)\n    ) {\n      // Missed the first point, check the other point\n      isInner = true;\n      dist = dist2;\n      intersectionPoint = E + dist * D;\n      theta = atan(intersectionPoint.y, intersectionPoint.x);\n      p = rayTarget + dist*rayDirection;\n      if (theta < v_angle) theta += 2.0 * PI;\n      if (intersectionPoint.z <= 0.0 ||\n        intersectionPoint.z > height ||\n        theta > v_angle + v_arcAngle ||\n        isSliced(p)\n      ) {\n        // Missed the other point too\n        discard;\n      }\n    }\n\n  #if !defined(COGNITE_RENDER_COLOR_ID) && !defined(COGNITE_RENDER_DEPTH)\n      if (R1 != R2)\n      {\n        // Find normal vector\n        vec3 n = -normalize(W.xyz);\n        vec3 P1 = v_centerB.xyz;\n        vec3 P2 = v_centerA.xyz;\n        vec3 A = cross(P1 - p, P2 - p);\n\n        vec3 t = normalize(cross(n, A));\n        vec3 o1 = P1 + R1 * t;\n        vec3 o2 = P2 + R2 * t;\n        vec3 B = o2-o1;\n        normal = normalize(cross(A, B));\n      }\n      else\n      {\n        // Regular cylinder has simpler normal vector in camera space\n        vec3 p_local = p - v_centerB.xyz;\n        normal = normalize(p_local - W.xyz * dot(p_local, W.xyz));\n      }\n  #endif\n\n    float fragDepth = updateFragmentDepth(p, projectionMatrix);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, fragDepth, matCapTexture);\n}\n'},function(t,e,n){"use strict";n.r(e),e.default='#define GLSLIFY 1\nvec3 mul3(mat4 M, vec3 v) {\n  vec4 u = M * vec4(v, 1.0);\n  return u.xyz / u.w;\n}\n\nfloat displaceScalar(vec3 point, float scalar, \n  float treeIndex, vec3 cameraPosition, mat4 inverseModelMatrix) {\n\n  // Displaces a scalar based on distance to camera to avoid z-fighting\n  vec3 cameraPositionModelSpace = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n  vec3 pointToCamera = cameraPositionModelSpace - point;\n\n  // "Random" number in the range [0, 1], based on treeIndex\n  float rnd = mod(treeIndex, 64.) / 64.;\n  // Compute distance to camera, but cap it\n  float maxDistanceToCamera = 50.;\n  float distanceToCamera = min(length(pointToCamera), maxDistanceToCamera);\n\n  float maxDisplacement = 0.01;\n  float scaleFactor = 0.01;\n  float displacement = min(maxDisplacement, scaleFactor * rnd * distanceToCamera / maxDistanceToCamera);\n  return scalar + displacement;\n}\n\nuniform mat4 inverseModelMatrix;\nuniform mat4 inverseNormalMatrix;\n\nattribute float a_treeIndex;\nattribute vec3 a_centerA;\nattribute vec3 a_centerB;\nattribute float a_radiusA;\nattribute float a_radiusB;\nattribute vec3 a_color;\n// segment attributes\nattribute vec3 a_localXAxis;\nattribute float a_angle;\nattribute float a_arcAngle;\n\nvarying float v_treeIndex;\n// We pack the radii into w-components\nvarying vec4 v_centerB;\n\n// U, V, axis represent the 3x3 cone basis.\n// They are vec4 to pack extra data into the w-component\n// since Safari on iOS only supports 8 varying vec4 registers.\nvarying vec4 v_U;\nvarying vec4 v_W;\n\nvarying vec4 v_centerA;\nvarying vec4 v_V;\n\nvarying float v_angle;\nvarying float v_arcAngle;\n\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nvoid main() {\n    vec3 center = 0.5 * (a_centerA + a_centerB);\n    float halfHeight = 0.5 * length(a_centerA - a_centerB);\n    vec3 dir = normalize(a_centerA - a_centerB);\n    vec3 newPosition = position;\n\n#if defined(COGNITE_ORTHOGRAPHIC_CAMERA)\n    vec3 objectToCameraModelSpace = inverseNormalMatrix*vec3(0.0, 0.0, 1.0);\n#else\n    vec3 rayOrigin = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n    vec3 objectToCameraModelSpace = rayOrigin - center;\n#endif\n\n    float maxRadius = max(a_radiusA, a_radiusB);\n    float leftUpScale = maxRadius;\n\n    vec3 lDir = dir;\n    if (dot(objectToCameraModelSpace, dir) < 0.0) { // direction vector looks away, flip it\n        lDir = -lDir;\n    }\n\n    vec3 left = normalize(cross(objectToCameraModelSpace, lDir));\n    vec3 up = normalize(cross(left, lDir));\n\n#ifndef GL_EXT_frag_depth\n    // make sure the billboard will not overlap with cap geometry (flickering effect), not important if we write to depth buffer\n    newPosition.x *= 1.0 - (maxRadius * (position.x + 1.0) * 0.0025 / halfHeight);\n#endif\n\n    vec3 surfacePoint = center + mat3(halfHeight*lDir, leftUpScale*left, leftUpScale*up) * newPosition;\n    vec3 transformed = surfacePoint;\n    surfacePoint = mul3(modelViewMatrix, surfacePoint);\n\n    // varying data\n    v_treeIndex = a_treeIndex;\n    v_angle = a_angle;\n    v_arcAngle = a_arcAngle;\n\n    // compute basis for cone\n    v_W.xyz = dir;\n    v_U.xyz = a_localXAxis;\n    v_W.xyz = normalize(normalMatrix * v_W.xyz);\n    v_U.xyz = normalize(normalMatrix * v_U.xyz);\n    // We pack surfacePoint as w-components of U and W\n    v_W.w = surfacePoint.z;\n    v_U.w = surfacePoint.x;\n\n    // We pack radii as w-components of v_centerB\n    v_centerB.xyz = mul3(modelViewMatrix, a_centerB);\n    v_centerB.w = displaceScalar(a_centerB, a_radiusB, a_treeIndex, cameraPosition, inverseModelMatrix);\n\n    v_V.xyz = -cross(v_U.xyz, v_W.xyz);\n    v_V.w = surfacePoint.y;\n\n    v_centerA.xyz = mul3(modelViewMatrix, a_centerA);\n    v_centerA.w = displaceScalar(a_centerA, a_radiusA, a_treeIndex, cameraPosition, inverseModelMatrix);\n\n    // START NEW CODE\n    v_color = a_color;\n    v_normal = normalMatrix * normal;\n\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\n    gl_Position = projectionMatrix * mvPosition;\n}\n'},function(t,e,n){"use strict";n.r(e),e.default='#define GLSLIFY 1\nfloat displaceScalar(vec3 point, float scalar, \n  float treeIndex, vec3 cameraPosition, mat4 inverseModelMatrix) {\n\n  // Displaces a scalar based on distance to camera to avoid z-fighting\n  vec3 cameraPositionModelSpace = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n  vec3 pointToCamera = cameraPositionModelSpace - point;\n\n  // "Random" number in the range [0, 1], based on treeIndex\n  float rnd = mod(treeIndex, 64.) / 64.;\n  // Compute distance to camera, but cap it\n  float maxDistanceToCamera = 50.;\n  float distanceToCamera = min(length(pointToCamera), maxDistanceToCamera);\n\n  float maxDisplacement = 0.01;\n  float scaleFactor = 0.01;\n  float displacement = min(maxDisplacement, scaleFactor * rnd * distanceToCamera / maxDistanceToCamera);\n  return scalar + displacement;\n}\n\nfloat computeFragmentDepth(vec3 p, mat4 projectionMatrix) {\n  // Anders Hafreager comments:\n  // Depth value can be calculated by transforming the z-component of the intersection point to projection space.\n  // The w-component is also needed to scale projection space into clip space.\n  // However, the 4th column of the projection matrix is (0, 0, const, 0), so we can exploit this when computing w-value.\n  float projected_intersection_z=projectionMatrix[0][2]*p.x+projectionMatrix[1][2]*p.y+projectionMatrix[2][2]*p.z+projectionMatrix[3][2];\n\n  // If we want to use orthographic camera, the full w-component is found as\n  float projected_intersection_w=projectionMatrix[0][3]*p.x+projectionMatrix[1][3]*p.y+projectionMatrix[2][3]*p.z+projectionMatrix[3][3];\n  // float projected_intersection_w = projectionMatrix[2][3]*newPoint.z; // Optimized for perspective camera\n  return ((gl_DepthRange.diff * (projected_intersection_z / projected_intersection_w)) + gl_DepthRange.near + gl_DepthRange.far) * .5;\n}\n\n#ifdef GL_EXT_frag_depth\n\nfloat updateFragmentDepth(vec3 p,mat4 projectionMatrix) {\n  gl_FragDepthEXT = computeFragmentDepth(p, projectionMatrix);\n  return gl_FragDepthEXT;\n}\n\n#else\n\nfloat updateFragmentDepth(vec3 p, mat4 projectionMatrix){\n  // Extension not available - not much we can do.\n  return computeFragmentDepth(p, projectionMatrix);\n}\n\n#endif\n\nbool determineVisibility(sampler2D visibilityTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 visible = texture2D(visibilityTexture, treeIndexUv);\n\n    return visible.r > 0.0;\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nconst int RenderTypeColor = 1;\nconst int RenderTypeNormal = 2;\nconst int RenderTypeTreeIndex = 3;\nconst int RenderTypePackColorAndNormal = 4;\nconst int RenderTypeDepth = 5;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(int renderMode, vec3 color, float treeIndex, vec3 normal, float depth, sampler2D matCapTexture) {\n    if (renderMode == RenderTypeColor) {\n        vec3 hsv = rgb2hsv(color);\n        float h = hsv.x;\n        hsv.z = min(0.6 * hsv.z + 0.4, 1.0);\n        color = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        \n        vec4 albedo = vec4(color * (0.4 + 0.6 * amplitude), h);\n\n        vec2 cap = normal.xy * 0.5 + 0.5;\n\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1);\n        \n        gl_FragColor = albedo * mc * 1.7;\n\n    } else if (renderMode == RenderTypePackColorAndNormal) {\n        vec3 hsv = rgb2hsv(color);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex) {\n        color = packIntToColor(treeIndex);\n        gl_FragColor = vec4(color, 1.0);\n    } else if (renderMode == RenderTypeDepth) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isSliced(vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nvec3 determineColor(vec3 originalColor, sampler2D colorDataTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 overrideColor = texture2D(colorDataTexture, treeIndexUv);\n\n    return overrideColor.a * overrideColor.rgb + (1.0 - overrideColor.a) * originalColor;\n}\n\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 dataTextureSize;\n\nuniform mat4 projectionMatrix;\n\nvarying vec4 U;\nvarying vec4 V;\nvarying vec4 axis;\n\nvarying vec4 v_centerA;\nvarying vec4 v_centerB;\nvarying float height;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform int renderMode;\n\nvoid main() {\n    if (!determineVisibility(overrideVisibilityPerTreeIndex, dataTextureSize, v_treeIndex)) {\n        discard;\n    }\n\n    vec3 color = determineColor(v_color, colorDataTexture, dataTextureSize, v_treeIndex);\n    vec3 normal = normalize( v_normal );\n    mat3 basis = mat3(U.xyz, V.xyz, axis.xyz);\n    vec3 surfacePoint = vec3(U.w, V.w, axis.w);\n    vec3 rayTarget = surfacePoint;\n\n#if defined(COGNITE_ORTHOGRAPHIC_CAMERA)\n      vec3 rayDirection = vec3(0.0, 0.0, -1.0);\n#else\n      vec3 rayDirection = normalize(rayTarget); // rayOrigin is (0,0,0) in camera space\n#endif\n\n    vec3 diff = rayTarget - v_centerA.xyz;\n    vec3 E = diff * basis;\n    float L = height;\n    vec3 D = rayDirection * basis;\n\n    float R1 = v_centerA.w;\n    float R2 = v_centerB.w;\n    float dR = R2 - R1;\n\n    float a = dot(D.xy, D.xy);\n    float b = dot(E.xy, D.xy);\n    float c = dot(E.xy, E.xy)-R1*R1;\n    float L2Inv = 1.0/(L*L);\n\n    if (R1 != R2) {\n      // Additional terms if radii are different\n      float dRLInv = dR/L;\n      float dRdRL2Inv = dRLInv*dRLInv;\n      a -= D.z*D.z*dRdRL2Inv;\n      b -= dRLInv*(E.z*D.z*dRLInv + R1*D.z);\n      c -= dRLInv*(E.z*E.z*dRLInv + 2.0*R1*E.z);\n    }\n\n    // Additional terms when one of the center points is displaced orthogonal to normal vector\n    vec2 displacement = ((v_centerB.xyz-v_centerA.xyz)*basis).xy; // In the basis where displacement is in XY only\n    float displacementLengthSquared = dot(displacement, displacement);\n    a += D.z*(D.z*displacementLengthSquared - 2.0*L*dot(D.xy, displacement))*L2Inv;\n    b += (D.z*E.z*displacementLengthSquared - L*(D.x*E.z*displacement.x + D.y*E.z*displacement.y + D.z*E.x*displacement.x + D.z*E.y*displacement.y))*L2Inv;\n    c += E.z*(E.z*displacementLengthSquared - 2.*L*dot(E.xy, displacement))*L2Inv;\n\n    // Calculate a dicriminant of the above quadratic equation (factor 2 removed from all b-terms above)\n    float d = b*b - a*c;\n\n    // d < 0.0 means the ray hits outside an infinitely long eccentric cone\n    if (d < 0.0) {\n      discard;\n    }\n    float sqrtd = sqrt(d);\n    float dist1 = (-b - sqrtd)/a;\n    float dist2 = (-b + sqrtd)/a;\n\n    // Make sure dist1 is the smaller one\n    if (dist2 < dist1) {\n      float tmp = dist1;\n      dist1 = dist2;\n      dist2 = tmp;\n    }\n\n    // Check the smallest root, it is closest camera. Only test if the z-component is outside the truncated eccentric cone\n    float dist = dist1;\n    float intersectionPointZ = E.z + dist*D.z;\n    // Intersection point in camera space\n    vec3 p = rayTarget + dist*rayDirection;\n    bool isInner = false;\n\n    if (intersectionPointZ <= 0.0 ||\n      intersectionPointZ >= L ||\n      isSliced(p)\n      ) {\n      // Either intersection point is behind starting point (happens inside the cone),\n      // or the intersection point is outside the end caps. This is not a valid solution.\n      isInner = true;\n      dist = dist2;\n      intersectionPointZ = E.z + dist*D.z;\n      p = rayTarget + dist*rayDirection;\n\n      if (intersectionPointZ <= 0.0 ||\n        intersectionPointZ >= L ||\n        isSliced(p)\n      ) {\n        // Missed the other point too\n        discard;\n      }\n    }\n\n#if !defined(COGNITE_RENDER_COLOR_ID) && !defined(COGNITE_RENDER_DEPTH)\n    // Find normal vector\n    vec3 n = normalize(-axis.xyz);\n    vec3 v_centerA = v_centerA.xyz;\n    vec3 v_centerB = v_centerB.xyz;\n    vec3 A = cross(v_centerA - p, v_centerB - p);\n\n    vec3 t = normalize(cross(n, A));\n    vec3 o1 = v_centerA + R1 * t;\n    vec3 o2 = v_centerB + R2 * t;\n    vec3 B = o2-o1;\n    normal = normalize(cross(A, B));\n#endif\n\n    float fragDepth = updateFragmentDepth(p, projectionMatrix);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, fragDepth, matCapTexture);\n}\n'},function(t,e,n){"use strict";n.r(e),e.default='#define GLSLIFY 1\nvec3 mul3(mat4 M, vec3 v) {\n  vec4 u = M * vec4(v, 1.0);\n  return u.xyz / u.w;\n}\n\nfloat displaceScalar(vec3 point, float scalar, \n  float treeIndex, vec3 cameraPosition, mat4 inverseModelMatrix) {\n\n  // Displaces a scalar based on distance to camera to avoid z-fighting\n  vec3 cameraPositionModelSpace = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n  vec3 pointToCamera = cameraPositionModelSpace - point;\n\n  // "Random" number in the range [0, 1], based on treeIndex\n  float rnd = mod(treeIndex, 64.) / 64.;\n  // Compute distance to camera, but cap it\n  float maxDistanceToCamera = 50.;\n  float distanceToCamera = min(length(pointToCamera), maxDistanceToCamera);\n\n  float maxDisplacement = 0.01;\n  float scaleFactor = 0.01;\n  float displacement = min(maxDisplacement, scaleFactor * rnd * distanceToCamera / maxDistanceToCamera);\n  return scalar + displacement;\n}\n\nuniform mat4 inverseModelMatrix;\n\nattribute float a_treeIndex;\nattribute vec3 a_centerA;\nattribute vec3 a_centerB;\nattribute float a_radiusA;\nattribute float a_radiusB;\nattribute vec3 a_normal;\nattribute vec3 a_color;\n\nvarying float v_treeIndex;\n// We pack the radii into w-components\nvarying vec4 v_centerA;\nvarying vec4 v_centerB;\n\n// U, V, axis represent the 3x3 cone basis.\n// They are vec4 to pack extra data into the w-component\n// since Safari on iOS only supports 8 varying vec4 registers.\nvarying vec4 U;\nvarying vec4 V;\nvarying vec4 axis;\nvarying float height;\n\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nvoid main() {\n    vec3 lDir;\n    height = dot(a_centerA - a_centerB, a_normal);\n    vec3 center = 0.5 * (a_centerA + a_centerB);\n    vec3 newPosition = position;\n\n#if defined(COGNITE_ORTHOGRAPHIC_CAMERA)\n      vec3 objectToCameraModelSpace = inverseNormalMatrix*vec3(0.0, 0.0, 1.0);\n#else\n      vec3 rayOrigin = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n      vec3 objectToCameraModelSpace = rayOrigin - center;\n#endif\n\n    // Find the coordinates of centerA and centerB projected down to the end cap plane\n    vec3 maxCenterProjected = a_centerA - dot(a_centerA, a_normal)*a_normal;\n    vec3 minCenterProjected = a_centerB - dot(a_centerB, a_normal)*a_normal;\n    float distanceBetweenProjectedCenters = length(maxCenterProjected - minCenterProjected);\n\n    lDir = a_normal;\n    float dirSign = 1.0;\n    if (dot(objectToCameraModelSpace, lDir) < 0.0) { // direction vector looks away, flip it\n      dirSign = -1.0;\n      lDir *= -1.;\n    }\n\n    vec3 left = normalize(cross(objectToCameraModelSpace, lDir));\n    vec3 up = normalize(cross(left, lDir));\n\n    // compute basis for cone\n    axis.xyz = -a_normal;\n    U.xyz = cross(objectToCameraModelSpace, axis.xyz);\n    V.xyz = cross(U.xyz, axis.xyz);\n    // Transform to camera space\n    axis.xyz = normalize(normalMatrix * axis.xyz);\n    U.xyz = normalize(normalMatrix * U.xyz);\n    V.xyz = normalize(normalMatrix * V.xyz);\n\n#ifndef GL_EXT_frag_depth\n    // make sure the billboard will not overlap with cap geometry (flickering effect), not important if we write to depth buffer\n    newPosition.x *= 1.0 - (a_radiusA * (position.x + 1.0) * 0.0025 / height);\n#endif\n\n    v_centerA.xyz = mul3(modelViewMatrix, a_centerA);\n    v_centerB.xyz = mul3(modelViewMatrix, a_centerB);\n    // Pack radii as w components of v_centerA and v_centerB\n    v_centerA.w = displaceScalar(a_centerA, a_radiusA, a_treeIndex, cameraPosition, inverseModelMatrix);\n    v_centerB.w = displaceScalar(a_centerB, a_radiusB, a_treeIndex, cameraPosition, inverseModelMatrix);\n\n    float radiusIncludedDisplacement = 0.5*(2.0*max(a_radiusA, a_radiusB) + distanceBetweenProjectedCenters);\n    vec3 surfacePoint = center + mat3(0.5*height*lDir, radiusIncludedDisplacement*left, radiusIncludedDisplacement*up) * newPosition;\n    vec3 transformed = surfacePoint;\n\n    // We pack radii as w-components of coneTop and coneBase\n    surfacePoint = mul3(modelViewMatrix, surfacePoint);\n    // We pack surfacePoint as w-components of U, V and axis\n    U.w = surfacePoint.x;\n    V.w = surfacePoint.y;\n    axis.w = surfacePoint.z;\n\n    v_treeIndex = a_treeIndex;\n    v_color = a_color;\n    v_normal = normalMatrix * normal;\n\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n}\n'},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nfloat computeFragmentDepth(vec3 p, mat4 projectionMatrix) {\n  // Anders Hafreager comments:\n  // Depth value can be calculated by transforming the z-component of the intersection point to projection space.\n  // The w-component is also needed to scale projection space into clip space.\n  // However, the 4th column of the projection matrix is (0, 0, const, 0), so we can exploit this when computing w-value.\n  float projected_intersection_z=projectionMatrix[0][2]*p.x+projectionMatrix[1][2]*p.y+projectionMatrix[2][2]*p.z+projectionMatrix[3][2];\n\n  // If we want to use orthographic camera, the full w-component is found as\n  float projected_intersection_w=projectionMatrix[0][3]*p.x+projectionMatrix[1][3]*p.y+projectionMatrix[2][3]*p.z+projectionMatrix[3][3];\n  // float projected_intersection_w = projectionMatrix[2][3]*newPoint.z; // Optimized for perspective camera\n  return ((gl_DepthRange.diff * (projected_intersection_z / projected_intersection_w)) + gl_DepthRange.near + gl_DepthRange.far) * .5;\n}\n\n#ifdef GL_EXT_frag_depth\n\nfloat updateFragmentDepth(vec3 p,mat4 projectionMatrix) {\n  gl_FragDepthEXT = computeFragmentDepth(p, projectionMatrix);\n  return gl_FragDepthEXT;\n}\n\n#else\n\nfloat updateFragmentDepth(vec3 p, mat4 projectionMatrix){\n  // Extension not available - not much we can do.\n  return computeFragmentDepth(p, projectionMatrix);\n}\n\n#endif\n\nbool determineVisibility(sampler2D visibilityTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 visible = texture2D(visibilityTexture, treeIndexUv);\n\n    return visible.r > 0.0;\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nconst int RenderTypeColor = 1;\nconst int RenderTypeNormal = 2;\nconst int RenderTypeTreeIndex = 3;\nconst int RenderTypePackColorAndNormal = 4;\nconst int RenderTypeDepth = 5;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(int renderMode, vec3 color, float treeIndex, vec3 normal, float depth, sampler2D matCapTexture) {\n    if (renderMode == RenderTypeColor) {\n        vec3 hsv = rgb2hsv(color);\n        float h = hsv.x;\n        hsv.z = min(0.6 * hsv.z + 0.4, 1.0);\n        color = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        \n        vec4 albedo = vec4(color * (0.4 + 0.6 * amplitude), h);\n\n        vec2 cap = normal.xy * 0.5 + 0.5;\n\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1);\n        \n        gl_FragColor = albedo * mc * 1.7;\n\n    } else if (renderMode == RenderTypePackColorAndNormal) {\n        vec3 hsv = rgb2hsv(color);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex) {\n        color = packIntToColor(treeIndex);\n        gl_FragColor = vec4(color, 1.0);\n    } else if (renderMode == RenderTypeDepth) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isSliced(vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nvec3 determineColor(vec3 originalColor, sampler2D colorDataTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 overrideColor = texture2D(colorDataTexture, treeIndexUv);\n\n    return overrideColor.a * overrideColor.rgb + (1.0 - overrideColor.a) * originalColor;\n}\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 dataTextureSize;\n\nuniform mat4 projectionMatrix;\nvarying vec4 center;\nvarying float hRadius;\nvarying float height;\n\nvarying vec4 U;\nvarying vec4 V;\nvarying vec4 sphereNormal;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform int renderMode;\n\nvoid main() {\n    if (!determineVisibility(overrideVisibilityPerTreeIndex, dataTextureSize, v_treeIndex)) {\n        discard;\n    }\n\n    vec3 color = determineColor(v_color, colorDataTexture, dataTextureSize, v_treeIndex);\n    vec3 normal = normalize(sphereNormal.xyz);\n\n    float vRadius = center.w;\n    float ratio = vRadius / hRadius;\n    mat3 basis = mat3(U.xyz, V.xyz, sphereNormal.xyz);\n    mat3 scaledBasis = mat3(ratio * U.xyz, ratio * V.xyz, sphereNormal.xyz);\n    vec3 surfacePoint = vec3(U.w, V.w, sphereNormal.w);\n    vec3 rayTarget = surfacePoint;\n\n#if defined(COGNITE_ORTHOGRAPHIC_CAMERA)\n    vec3 rayDirection = vec3(0.0, 0.0, -1.0);\n#else\n    vec3 rayDirection = normalize(rayTarget); // rayOrigin is (0,0,0) in camera space\n#endif\n\n    vec3 diff = rayTarget - center.xyz;\n    vec3 E = diff * scaledBasis;\n    vec3 D = rayDirection * scaledBasis;\n\n    float a = dot(D, D);\n    float b = dot(E, D);\n    float c = dot(E, E) - vRadius*vRadius;\n\n    // discriminant of sphere equation (factor 2 removed from b above)\n    float d = b*b - a*c;\n    if(d < 0.0)\n        discard;\n\n    float sqrtd = sqrt(d);\n    float dist1 = (-b - sqrtd)/a;\n    float dist2 = (-b + sqrtd)/a;\n\n    // Make sure dist1 is the smaller one\n    if (dist2 < dist1) {\n        float tmp = dist1;\n        dist1 = dist2;\n        dist2 = tmp;\n    }\n\n    float dist = dist1;\n    float intersectionPointZ = E.z + dist*D.z;\n    // Intersection point in camera space\n    vec3 p = rayTarget + dist*rayDirection;\n\n    if (intersectionPointZ <= vRadius - height ||\n        intersectionPointZ > vRadius ||\n        isSliced(p)\n       ) {\n        // Missed the first point, check the other point\n\n        dist = dist2;\n        intersectionPointZ = E.z + dist*D.z;\n        p = rayTarget + dist*rayDirection;\n        if (intersectionPointZ <= vRadius - height ||\n            intersectionPointZ > vRadius ||\n            isSliced(p)\n           ) {\n            // Missed the other point too\n            discard;\n        }\n    }\n\n#if !defined(COGNITE_RENDER_COLOR_ID) && !defined(COGNITE_RENDER_DEPTH)\n    // Find normal vector in local space\n    normal = vec3(p - center.xyz) * basis;\n    normal.z = normal.z * (hRadius / vRadius) * (hRadius / vRadius);\n    // Transform into camera space\n    normal = normalize(basis * normal);\n    if (dot(normal, rayDirection) >  0.) {\n        normal = -normal;\n    }\n#endif\n\n  float fragDepth = updateFragmentDepth(p, projectionMatrix);\n  updateFragmentColor(renderMode, color, v_treeIndex, normal, fragDepth, matCapTexture);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default='#define GLSLIFY 1\nvec3 mul3(mat4 M, vec3 v) {\n  vec4 u = M * vec4(v, 1.0);\n  return u.xyz / u.w;\n}\n\nfloat displaceScalar(vec3 point, float scalar, \n  float treeIndex, vec3 cameraPosition, mat4 inverseModelMatrix) {\n\n  // Displaces a scalar based on distance to camera to avoid z-fighting\n  vec3 cameraPositionModelSpace = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n  vec3 pointToCamera = cameraPositionModelSpace - point;\n\n  // "Random" number in the range [0, 1], based on treeIndex\n  float rnd = mod(treeIndex, 64.) / 64.;\n  // Compute distance to camera, but cap it\n  float maxDistanceToCamera = 50.;\n  float distanceToCamera = min(length(pointToCamera), maxDistanceToCamera);\n\n  float maxDisplacement = 0.01;\n  float scaleFactor = 0.01;\n  float displacement = min(maxDisplacement, scaleFactor * rnd * distanceToCamera / maxDistanceToCamera);\n  return scalar + displacement;\n}\n\nuniform mat4 inverseModelMatrix;\nuniform mat4 inverseNormalMatrix;\n\nattribute float a_treeIndex;\nattribute vec3 a_color;\nattribute vec3 a_center;\nattribute vec3 a_normal;\nattribute float a_horizontalRadius;\nattribute float a_verticalRadius;\nattribute float a_height;\n\nvarying float v_treeIndex;\n// We pack vRadius as w-component of center\nvarying vec4 center;\nvarying float hRadius;\nvarying float height;\n\n// U, V, axis represent the 3x3 sphere basis.\n// They are vec4 to pack extra data into the w-component\n// since Safari on iOS only supports 8 varying vec4 registers.\nvarying vec4 U;\nvarying vec4 V;\nvarying vec4 sphereNormal;\n\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nvoid main() {\n    vec3 lDir;\n    float distanceToCenterOfSegment = a_verticalRadius - a_height*0.5;\n    vec3 centerOfSegment = a_center + a_normal*distanceToCenterOfSegment;\n\n#if defined(COGNITE_ORTHOGRAPHIC_CAMERA)\n      vec3 objectToCameraModelSpace = inverseNormalMatrix*vec3(0.0, 0.0, 1.0);\n#else\n      vec3 rayOrigin = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n      vec3 objectToCameraModelSpace = rayOrigin - centerOfSegment;\n#endif\n\n    vec3 newPosition = position;\n\n    float bb = dot(objectToCameraModelSpace, a_normal);\n    if (bb < 0.0) { // direction vector looks away, flip it\n      lDir = -a_normal;\n    } else { // direction vector already looks in my direction\n      lDir = a_normal;\n    }\n\n    vec3 left = normalize(cross(objectToCameraModelSpace, lDir));\n    vec3 up = normalize(cross(left, lDir));\n\n#ifndef GL_EXT_frag_depth\n    // make sure the billboard will not overlap with cap geometry (flickering effect), not important if we write to depth buffer\n    newPosition.x *= 1.0 - (a_verticalRadius * (position.x + 1.0) * 0.0025 / a_height);\n#endif\n\n    // Negative angle means height larger than radius,\n    // so we should have full size so we can render the largest part of the ellipsoid segment\n    float ratio = max(0.0, 1.0 - a_height / a_verticalRadius);\n    // maxRadiusOfSegment is the radius of the circle (projected ellipsoid) when ellipsoid segment is seen from above\n    float maxRadiusOfSegment = a_horizontalRadius * sqrt(1.0 - ratio * ratio);\n\n    vec3 displacement = vec3(newPosition.x*a_height*0.5, maxRadiusOfSegment*newPosition.y, maxRadiusOfSegment*newPosition.z);\n    vec3 surfacePoint = centerOfSegment + mat3(lDir, left, up) * displacement;\n    vec3 transformed = surfacePoint;\n\n    v_treeIndex = a_treeIndex;\n    surfacePoint = mul3(modelViewMatrix, surfacePoint);\n    center.xyz = mul3(modelViewMatrix, a_center);\n    center.w = a_verticalRadius; // Pack radius into w-component\n    hRadius = a_horizontalRadius;\n    height = a_height;\n    v_color = a_color;\n\n    // compute basis\n    sphereNormal.xyz = normalMatrix * a_normal;\n    U.xyz = normalMatrix * up;\n    V.xyz = normalMatrix * left;\n\n    // We pack surfacePoint as w-components of U, V and axis\n    U.w = surfacePoint.x;\n    V.w = surfacePoint.y;\n    sphereNormal.w = surfacePoint.z;\n\n    // TODO should perhaps be a different normal?\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n}\n'},function(t,e,n){"use strict";n.r(e),e.default='#define GLSLIFY 1\nvec3 mul3(mat4 M, vec3 v) {\n  vec4 u = M * vec4(v, 1.0);\n  return u.xyz / u.w;\n}\n\nfloat displaceScalar(vec3 point, float scalar, \n  float treeIndex, vec3 cameraPosition, mat4 inverseModelMatrix) {\n\n  // Displaces a scalar based on distance to camera to avoid z-fighting\n  vec3 cameraPositionModelSpace = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n  vec3 pointToCamera = cameraPositionModelSpace - point;\n\n  // "Random" number in the range [0, 1], based on treeIndex\n  float rnd = mod(treeIndex, 64.) / 64.;\n  // Compute distance to camera, but cap it\n  float maxDistanceToCamera = 50.;\n  float distanceToCamera = min(length(pointToCamera), maxDistanceToCamera);\n\n  float maxDisplacement = 0.01;\n  float scaleFactor = 0.01;\n  float displacement = min(maxDisplacement, scaleFactor * rnd * distanceToCamera / maxDistanceToCamera);\n  return scalar + displacement;\n}\n\nfloat computeFragmentDepth(vec3 p, mat4 projectionMatrix) {\n  // Anders Hafreager comments:\n  // Depth value can be calculated by transforming the z-component of the intersection point to projection space.\n  // The w-component is also needed to scale projection space into clip space.\n  // However, the 4th column of the projection matrix is (0, 0, const, 0), so we can exploit this when computing w-value.\n  float projected_intersection_z=projectionMatrix[0][2]*p.x+projectionMatrix[1][2]*p.y+projectionMatrix[2][2]*p.z+projectionMatrix[3][2];\n\n  // If we want to use orthographic camera, the full w-component is found as\n  float projected_intersection_w=projectionMatrix[0][3]*p.x+projectionMatrix[1][3]*p.y+projectionMatrix[2][3]*p.z+projectionMatrix[3][3];\n  // float projected_intersection_w = projectionMatrix[2][3]*newPoint.z; // Optimized for perspective camera\n  return ((gl_DepthRange.diff * (projected_intersection_z / projected_intersection_w)) + gl_DepthRange.near + gl_DepthRange.far) * .5;\n}\n\n#ifdef GL_EXT_frag_depth\n\nfloat updateFragmentDepth(vec3 p,mat4 projectionMatrix) {\n  gl_FragDepthEXT = computeFragmentDepth(p, projectionMatrix);\n  return gl_FragDepthEXT;\n}\n\n#else\n\nfloat updateFragmentDepth(vec3 p, mat4 projectionMatrix){\n  // Extension not available - not much we can do.\n  return computeFragmentDepth(p, projectionMatrix);\n}\n\n#endif\n\nbool determineVisibility(sampler2D visibilityTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 visible = texture2D(visibilityTexture, treeIndexUv);\n\n    return visible.r > 0.0;\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nconst int RenderTypeColor = 1;\nconst int RenderTypeNormal = 2;\nconst int RenderTypeTreeIndex = 3;\nconst int RenderTypePackColorAndNormal = 4;\nconst int RenderTypeDepth = 5;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(int renderMode, vec3 color, float treeIndex, vec3 normal, float depth, sampler2D matCapTexture) {\n    if (renderMode == RenderTypeColor) {\n        vec3 hsv = rgb2hsv(color);\n        float h = hsv.x;\n        hsv.z = min(0.6 * hsv.z + 0.4, 1.0);\n        color = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        \n        vec4 albedo = vec4(color * (0.4 + 0.6 * amplitude), h);\n\n        vec2 cap = normal.xy * 0.5 + 0.5;\n\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1);\n        \n        gl_FragColor = albedo * mc * 1.7;\n\n    } else if (renderMode == RenderTypePackColorAndNormal) {\n        vec3 hsv = rgb2hsv(color);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex) {\n        color = packIntToColor(treeIndex);\n        gl_FragColor = vec4(color, 1.0);\n    } else if (renderMode == RenderTypeDepth) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isSliced(vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nvec3 determineColor(vec3 originalColor, sampler2D colorDataTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 overrideColor = texture2D(colorDataTexture, treeIndexUv);\n\n    return overrideColor.a * overrideColor.rgb + (1.0 - overrideColor.a) * originalColor;\n}\n\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n\n// TODO general cylinder and cone are very similar and used\n// the same shader in the old code. Consider de-duplicating\n// parts of this code\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 dataTextureSize;\n\nuniform float dataTextureWidth;\nuniform float dataTextureHeight;\nuniform mat4 projectionMatrix;\n\nvarying vec4 v_centerB;\n\nvarying vec4 v_W;\nvarying vec4 v_U;\n\nvarying float v_angle;\nvarying float v_arcAngle;\n\nvarying float v_surfacePointY;\n\nvarying vec4 v_planeA;\nvarying vec4 v_planeB;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform int renderMode;\n\nvoid main() {\n    if (!determineVisibility(overrideVisibilityPerTreeIndex, dataTextureSize, v_treeIndex)) {\n        discard;\n    }\n\n    vec3 color = determineColor(v_color, colorDataTexture, dataTextureSize, v_treeIndex);\n    vec3 normal = normalize( v_normal );\n\n    float R1 = v_centerB.w;\n    vec4 U = v_U;\n    vec4 W = v_W;\n    vec4 V = vec4(normalize(cross(W.xyz, U.xyz)), v_surfacePointY);\n\n    mat3 basis = mat3(U.xyz, V.xyz, W.xyz);\n    vec3 surfacePoint = vec3(U.w, V.w, W.w);\n    vec3 rayTarget = surfacePoint;\n\n#if defined(COGNITE_ORTHOGRAPHIC_CAMERA)\n    vec3 rayDirection = vec3(0.0, 0.0, -1.0);\n#else\n    vec3 rayDirection = normalize(rayTarget); // rayOrigin is (0,0,0) in camera space\n#endif\n\n    vec3 diff = rayTarget - v_centerB.xyz;\n    vec3 E = diff * basis;\n    vec3 D = rayDirection * basis;\n\n    float a = dot(D.xy, D.xy);\n    float b = dot(E.xy, D.xy);\n    float c = dot(E.xy, E.xy) - R1*R1;\n\n    // Calculate a dicriminant of the above quadratic equation\n    float d = b*b - a*c;\n\n    // d < 0.0 means the ray hits outside an infinitely long cone\n    if (d < 0.0)\n        discard;\n\n    float sqrtd = sqrt(d);\n    float dist1 = (-b - sqrtd)/a;\n    float dist2 = (-b + sqrtd)/a;\n\n    // Make sure dist1 is the smaller one\n    if (dist2 < dist1) {\n        float tmp = dist1;\n        dist1 = dist2;\n        dist2 = tmp;\n    }\n\n    float dist = dist1;\n    vec3 intersectionPoint = E + dist * D;\n    float theta = atan(intersectionPoint.y, intersectionPoint.x);\n    if (theta < v_angle) theta += 2.0 * PI;\n\n    // Intersection point in camera space\n    vec3 p = rayTarget + dist*rayDirection;\n\n    vec3 planeACenter = vec3(0.0, 0.0, v_planeA.w);\n    vec3 planeANormal = v_planeA.xyz;\n    vec3 planeBCenter = vec3(0.0, 0.0, v_planeB.w);\n    vec3 planeBNormal = v_planeB.xyz;\n    bool isInner = false;\n\n    if (dot(intersectionPoint - planeACenter, planeANormal) > 0.0 ||\n        dot(intersectionPoint - planeBCenter, planeBNormal) > 0.0 ||\n        theta > v_arcAngle + v_angle ||\n        isSliced(p)\n       ) {\n        // Missed the first point, check the other point\n        isInner = true;\n        dist = dist2;\n        intersectionPoint = E + dist * D;\n        theta = atan(intersectionPoint.y, intersectionPoint.x);\n        p = rayTarget + dist*rayDirection;\n        if (theta < v_angle) theta += 2.0 * PI;\n        if (dot(intersectionPoint - planeACenter, planeANormal) > 0.0 ||\n            dot(intersectionPoint - planeBCenter, planeBNormal) > 0.0 ||\n            theta > v_arcAngle + v_angle || isSliced(p)\n           ) {\n            // Missed the other point too\n            discard;\n        }\n    }\n\n#if !defined(COGNITE_RENDER_COLOR_ID) && !defined(COGNITE_RENDER_DEPTH)\n    // Regular cylinder has simpler normal vector in camera space\n    vec3 p_local = p - v_centerB.xyz;\n    normal = normalize(p_local - W.xyz * dot(p_local, W.xyz));\n#endif\n\n    float fragDepth = updateFragmentDepth(p, projectionMatrix);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, fragDepth, matCapTexture);\n}\n'},function(t,e,n){"use strict";n.r(e),e.default='#define GLSLIFY 1\nvec3 mul3(mat4 M, vec3 v) {\n  vec4 u = M * vec4(v, 1.0);\n  return u.xyz / u.w;\n}\n\nfloat displaceScalar(vec3 point, float scalar, \n  float treeIndex, vec3 cameraPosition, mat4 inverseModelMatrix) {\n\n  // Displaces a scalar based on distance to camera to avoid z-fighting\n  vec3 cameraPositionModelSpace = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n  vec3 pointToCamera = cameraPositionModelSpace - point;\n\n  // "Random" number in the range [0, 1], based on treeIndex\n  float rnd = mod(treeIndex, 64.) / 64.;\n  // Compute distance to camera, but cap it\n  float maxDistanceToCamera = 50.;\n  float distanceToCamera = min(length(pointToCamera), maxDistanceToCamera);\n\n  float maxDisplacement = 0.01;\n  float scaleFactor = 0.01;\n  float displacement = min(maxDisplacement, scaleFactor * rnd * distanceToCamera / maxDistanceToCamera);\n  return scalar + displacement;\n}\n\nuniform mat4 inverseModelMatrix;\nuniform mat4 inverseNormalMatrix;\n\nattribute float a_treeIndex;\nattribute vec3 a_centerA;\nattribute vec3 a_centerB;\nattribute float a_radius;\nattribute vec3 a_color;\n// slicing plane attributes\nattribute vec4 a_planeA;\nattribute vec4 a_planeB;\n// segment attributes\nattribute vec3 a_localXAxis;\nattribute float a_angle;\nattribute float a_arcAngle;\n\nvarying float v_treeIndex;\n// We pack the radii into w-components\nvarying vec4 v_centerB;\n\n// U, V, axis represent the 3x3 cone basis.\n// They are vec4 to pack extra data into the w-component\n// since Safari on iOS only supports 8 varying vec4 registers.\nvarying vec4 v_U;\nvarying vec4 v_W;\n\nvarying vec4 v_planeA;\nvarying vec4 v_planeB;\n\nvarying float v_surfacePointY;\n\nvarying float v_angle;\nvarying float v_arcAngle;\n\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nvoid main() {\n\n    vec3 center = 0.5 * (a_centerA + a_centerB);\n    float halfHeight = 0.5 * length(a_centerA - a_centerB);\n    vec3 dir = normalize(a_centerA - a_centerB);\n    vec3 newPosition = position;\n\n#if defined(COGNITE_ORTHOGRAPHIC_CAMERA)\n    vec3 objectToCameraModelSpace = inverseNormalMatrix*vec3(0.0, 0.0, 1.0);\n#else\n    vec3 rayOrigin = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n    vec3 objectToCameraModelSpace = rayOrigin - center;\n#endif\n\n    float leftUpScale = a_radius;\n\n    vec3 lDir = dir;\n    if (dot(objectToCameraModelSpace, dir) < 0.0) { // direction vector looks away, flip it\n        lDir = -lDir;\n    }\n\n    vec3 left = normalize(cross(objectToCameraModelSpace, lDir));\n    vec3 up = normalize(cross(left, lDir));\n\n#ifndef GL_EXT_frag_depth\n    // make sure the billboard will not overlap with cap geometry (flickering effect), not important if we write to depth buffer\n    newPosition.x *= 1.0 - (a_radius * (position.x + 1.0) * 0.0025 / halfHeight);\n#endif\n\n    vec3 surfacePoint = center + mat3(halfHeight*lDir, leftUpScale*left, leftUpScale*up) * newPosition;\n    vec3 transformed = surfacePoint;\n    surfacePoint = mul3(modelViewMatrix, surfacePoint);\n\n    // varying data\n    v_treeIndex = a_treeIndex;\n    v_angle = a_angle;\n    v_arcAngle = a_arcAngle;\n\n    // compute basis for cone\n    v_W.xyz = dir;\n    v_U.xyz = a_localXAxis;\n    v_W.xyz = normalize(normalMatrix * v_W.xyz);\n    v_U.xyz = normalize(normalMatrix * v_U.xyz);\n    // We pack surfacePoint as w-components of U and W\n    v_W.w = surfacePoint.z;\n    v_U.w = surfacePoint.x;\n\n    // We pack radii as w-components of v_centerB\n    v_centerB.xyz = mul3(modelViewMatrix, a_centerB);\n    v_centerB.w = displaceScalar(a_centerB, a_radius, a_treeIndex, cameraPosition, inverseModelMatrix);\n\n    v_planeA = a_planeA;\n    v_planeB = a_planeB;\n    v_surfacePointY = surfacePoint.y;\n    v_centerB.w = a_radius;\n\n    v_color = a_color;\n    v_normal = normalMatrix * normal;\n\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n}\n'},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nfloat computeFragmentDepth(vec3 p, mat4 projectionMatrix) {\n  // Anders Hafreager comments:\n  // Depth value can be calculated by transforming the z-component of the intersection point to projection space.\n  // The w-component is also needed to scale projection space into clip space.\n  // However, the 4th column of the projection matrix is (0, 0, const, 0), so we can exploit this when computing w-value.\n  float projected_intersection_z=projectionMatrix[0][2]*p.x+projectionMatrix[1][2]*p.y+projectionMatrix[2][2]*p.z+projectionMatrix[3][2];\n\n  // If we want to use orthographic camera, the full w-component is found as\n  float projected_intersection_w=projectionMatrix[0][3]*p.x+projectionMatrix[1][3]*p.y+projectionMatrix[2][3]*p.z+projectionMatrix[3][3];\n  // float projected_intersection_w = projectionMatrix[2][3]*newPoint.z; // Optimized for perspective camera\n  return ((gl_DepthRange.diff * (projected_intersection_z / projected_intersection_w)) + gl_DepthRange.near + gl_DepthRange.far) * .5;\n}\n\n#ifdef GL_EXT_frag_depth\n\nfloat updateFragmentDepth(vec3 p,mat4 projectionMatrix) {\n  gl_FragDepthEXT = computeFragmentDepth(p, projectionMatrix);\n  return gl_FragDepthEXT;\n}\n\n#else\n\nfloat updateFragmentDepth(vec3 p, mat4 projectionMatrix){\n  // Extension not available - not much we can do.\n  return computeFragmentDepth(p, projectionMatrix);\n}\n\n#endif\n\nbool determineVisibility(sampler2D visibilityTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 visible = texture2D(visibilityTexture, treeIndexUv);\n\n    return visible.r > 0.0;\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nconst int RenderTypeColor = 1;\nconst int RenderTypeNormal = 2;\nconst int RenderTypeTreeIndex = 3;\nconst int RenderTypePackColorAndNormal = 4;\nconst int RenderTypeDepth = 5;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(int renderMode, vec3 color, float treeIndex, vec3 normal, float depth, sampler2D matCapTexture) {\n    if (renderMode == RenderTypeColor) {\n        vec3 hsv = rgb2hsv(color);\n        float h = hsv.x;\n        hsv.z = min(0.6 * hsv.z + 0.4, 1.0);\n        color = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        \n        vec4 albedo = vec4(color * (0.4 + 0.6 * amplitude), h);\n\n        vec2 cap = normal.xy * 0.5 + 0.5;\n\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1);\n        \n        gl_FragColor = albedo * mc * 1.7;\n\n    } else if (renderMode == RenderTypePackColorAndNormal) {\n        vec3 hsv = rgb2hsv(color);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex) {\n        color = packIntToColor(treeIndex);\n        gl_FragColor = vec4(color, 1.0);\n    } else if (renderMode == RenderTypeDepth) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isSliced(vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n\nvec3 determineColor(vec3 originalColor, sampler2D colorDataTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 overrideColor = texture2D(colorDataTexture, treeIndexUv);\n\n    return overrideColor.a * overrideColor.rgb + (1.0 - overrideColor.a) * originalColor;\n}\n\nvarying float v_oneMinusThicknessSqr;\nvarying vec2 v_xy;\nvarying float v_angle;\nvarying float v_arcAngle;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 dataTextureSize;\n\nuniform int renderMode;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    if (!determineVisibility(overrideVisibilityPerTreeIndex, dataTextureSize, v_treeIndex)) {\n        discard;\n    }\n\n    if (isSliced(vViewPosition)) {\n        discard;\n    }\n\n    vec3 color = determineColor(v_color, colorDataTexture, dataTextureSize, v_treeIndex);\n    float dist = dot(v_xy, v_xy);\n    float theta = atan(v_xy.y, v_xy.x);\n    vec3 normal = normalize( v_normal );\n    if (theta < v_angle) {\n        theta += 2.0 * PI;\n    }\n    if (dist > 0.25 || dist < 0.25 * v_oneMinusThicknessSqr || theta >= v_angle + v_arcAngle) {\n        discard;\n    }\n\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n// TODO consider passing vec3 from a matrix3x4 to reduce memory usage and data transfer\n// TODO consider fixing Three.js so it is possible to pass a mat4:\n// see https://stackoverflow.com/questions/38853096/webgl-how-to-bind-values-to-a-mat4-attribute\n\nmat4 constructMatrix(vec4 column_0, vec4 column_1, vec4 column_2, vec4 column_3) {\n  return mat4(\n    column_0,\n    column_1,\n    column_2,\n    column_3\n  );\n}\n\nattribute vec4 a_instanceMatrix_column_0;\nattribute vec4 a_instanceMatrix_column_1;\nattribute vec4 a_instanceMatrix_column_2;\nattribute vec4 a_instanceMatrix_column_3;\n\nattribute float a_treeIndex;\nattribute vec3 a_color;\nattribute float a_angle;\nattribute float a_arcAngle;\nattribute float a_thickness;\nattribute vec3 a_normal;\n\nvarying float v_treeIndex;\nvarying float v_oneMinusThicknessSqr;\nvarying vec2 v_xy;\nvarying float v_angle;\nvarying float v_arcAngle;\n\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    mat4 instanceMatrix = constructMatrix(\n        a_instanceMatrix_column_0,\n        a_instanceMatrix_column_1,\n        a_instanceMatrix_column_2,\n        a_instanceMatrix_column_3\n    );\n\n    v_treeIndex = a_treeIndex;\n    v_oneMinusThicknessSqr = (1.0 - a_thickness) * (1.0 - a_thickness);\n    v_xy = vec2(position.x, position.y);\n    v_angle = a_angle;\n    v_arcAngle = a_arcAngle;\n\n    vec3 transformed = (instanceMatrix * vec4(position, 1.0)).xyz;\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n    v_color = a_color;\n\n    v_normal = normalMatrix * a_normal;\n    vViewPosition = mvPosition.xyz;\n    gl_Position = projectionMatrix * mvPosition;\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nconst int RenderTypeColor = 1;\nconst int RenderTypeNormal = 2;\nconst int RenderTypeTreeIndex = 3;\nconst int RenderTypePackColorAndNormal = 4;\nconst int RenderTypeDepth = 5;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(int renderMode, vec3 color, float treeIndex, vec3 normal, float depth, sampler2D matCapTexture) {\n    if (renderMode == RenderTypeColor) {\n        vec3 hsv = rgb2hsv(color);\n        float h = hsv.x;\n        hsv.z = min(0.6 * hsv.z + 0.4, 1.0);\n        color = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        \n        vec4 albedo = vec4(color * (0.4 + 0.6 * amplitude), h);\n\n        vec2 cap = normal.xy * 0.5 + 0.5;\n\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1);\n        \n        gl_FragColor = albedo * mc * 1.7;\n\n    } else if (renderMode == RenderTypePackColorAndNormal) {\n        vec3 hsv = rgb2hsv(color);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex) {\n        color = packIntToColor(treeIndex);\n        gl_FragColor = vec4(color, 1.0);\n    } else if (renderMode == RenderTypeDepth) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n}\n\nbool determineVisibility(sampler2D visibilityTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 visible = texture2D(visibilityTexture, treeIndexUv);\n\n    return visible.r > 0.0;\n}\n\nvec3 determineColor(vec3 originalColor, sampler2D colorDataTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 overrideColor = texture2D(colorDataTexture, treeIndexUv);\n\n    return overrideColor.a * overrideColor.rgb + (1.0 - overrideColor.a) * originalColor;\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isSliced(vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 dataTextureSize;\n\nuniform int renderMode;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    if (!determineVisibility(overrideVisibilityPerTreeIndex, dataTextureSize, v_treeIndex)) {\n        discard;\n    }\n\n    if (isSliced(vViewPosition)) {\n        discard;\n    }\n\n    vec3 color = determineColor(v_color, colorDataTexture, dataTextureSize, v_treeIndex);\n    vec3 normal = normalize(v_normal);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n// TODO consider passing vec3 from a matrix3x4 to reduce memory usage and data transfer\n// TODO consider fixing Three.js so it is possible to pass a mat4:\n// see https://stackoverflow.com/questions/38853096/webgl-how-to-bind-values-to-a-mat4-attribute\n\nmat4 constructMatrix(vec4 column_0, vec4 column_1, vec4 column_2, vec4 column_3) {\n  return mat4(\n    column_0,\n    column_1,\n    column_2,\n    column_3\n  );\n}\n\nattribute vec4 a_instanceMatrix_column_0;\nattribute vec4 a_instanceMatrix_column_1;\nattribute vec4 a_instanceMatrix_column_2;\nattribute vec4 a_instanceMatrix_column_3;\n\nattribute float a_treeIndex;\nattribute vec3 a_color;\nattribute float a_arcAngle;\nattribute float a_radius;\nattribute float a_tubeRadius;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    mat4 instanceMatrix = constructMatrix(\n        a_instanceMatrix_column_0,\n        a_instanceMatrix_column_1,\n        a_instanceMatrix_column_2,\n        a_instanceMatrix_column_3\n    );\n    // normalized theta and phi are packed into positions\n    float theta = position.x * a_arcAngle;\n    float phi = position.y;\n    float cosTheta = cos(theta);\n    float sinTheta = sin(theta);\n    vec3 pos3 = vec3(0);\n\n    pos3.x = (a_radius + a_tubeRadius*cos(phi)) * cosTheta;\n    pos3.y = (a_radius + a_tubeRadius*cos(phi)) * sinTheta;\n    pos3.z = a_tubeRadius*sin(phi);\n\n    vec3 transformed = (instanceMatrix * vec4(pos3, 1.0)).xyz;\n\n    // Calculate normal vectors if we're not picking\n    vec3 center = (instanceMatrix * vec4(a_radius * cosTheta, a_radius * sinTheta, 0.0, 1.0)).xyz;\n    vec3 objectNormal = normalize(transformed.xyz - center);\n\n    v_treeIndex = a_treeIndex;\n    v_color = a_color;\n    v_normal = normalMatrix * objectNormal;\n\n    vec4 modelViewPosition = modelViewMatrix * vec4(transformed, 1.0);\n\n    vViewPosition = modelViewPosition.xyz;\n\n    gl_Position = projectionMatrix * modelViewPosition;\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nconst int RenderTypeColor = 1;\nconst int RenderTypeNormal = 2;\nconst int RenderTypeTreeIndex = 3;\nconst int RenderTypePackColorAndNormal = 4;\nconst int RenderTypeDepth = 5;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(int renderMode, vec3 color, float treeIndex, vec3 normal, float depth, sampler2D matCapTexture) {\n    if (renderMode == RenderTypeColor) {\n        vec3 hsv = rgb2hsv(color);\n        float h = hsv.x;\n        hsv.z = min(0.6 * hsv.z + 0.4, 1.0);\n        color = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        \n        vec4 albedo = vec4(color * (0.4 + 0.6 * amplitude), h);\n\n        vec2 cap = normal.xy * 0.5 + 0.5;\n\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1);\n        \n        gl_FragColor = albedo * mc * 1.7;\n\n    } else if (renderMode == RenderTypePackColorAndNormal) {\n        vec3 hsv = rgb2hsv(color);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex) {\n        color = packIntToColor(treeIndex);\n        gl_FragColor = vec4(color, 1.0);\n    } else if (renderMode == RenderTypeDepth) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n}\n\nbool determineVisibility(sampler2D visibilityTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 visible = texture2D(visibilityTexture, treeIndexUv);\n\n    return visible.r > 0.0;\n}\n\nvec3 determineColor(vec3 originalColor, sampler2D colorDataTexture, vec2 textureSize, float treeIndex) {\n    float dataTextureWidth = textureSize.x;\n    float dataTextureHeight = textureSize.y;\n\n    float u = mod(treeIndex, dataTextureWidth);\n    float v = floor(treeIndex / dataTextureWidth);\n    float uCoord = (u + 0.5) / dataTextureWidth;\n    float vCoord = (v + 0.5) / dataTextureHeight; // invert Y axis\n    vec2 treeIndexUv = vec2(uCoord, vCoord);\n    vec4 overrideColor = texture2D(colorDataTexture, treeIndexUv);\n\n    return overrideColor.a * overrideColor.rgb + (1.0 - overrideColor.a) * originalColor;\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isSliced(vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 dataTextureSize;\n\nuniform int renderMode;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    if (!determineVisibility(overrideVisibilityPerTreeIndex, dataTextureSize, v_treeIndex)) {\n        discard;\n    }\n\n    if (isSliced(vViewPosition)) {\n        discard;\n    }\n\n    vec3 color = determineColor(v_color, colorDataTexture, dataTextureSize, v_treeIndex);\n    vec3 normal = normalize(v_normal);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nattribute float a_treeIndex;\nattribute vec3 a_color;\nattribute vec3 a_vertex1;\nattribute vec3 a_vertex2;\nattribute vec3 a_vertex3;\nattribute vec3 a_vertex4;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    vec3 transformed;\n    // reduce the avarage branchings\n    if (position.x < 1.5) {\n      transformed = position.x == 0.0 ? a_vertex1 : a_vertex2;\n    } else {\n      transformed = position.x == 2.0 ? a_vertex3 : a_vertex4;\n    }\n\n    vec3 objectNormal = cross(a_vertex1 - a_vertex2, a_vertex1 - a_vertex3);\n\n    v_treeIndex = a_treeIndex;\n    v_color = a_color;\n    v_normal = normalMatrix * objectNormal;\n\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n    vViewPosition = mvPosition.xyz;\n    gl_Position = projectionMatrix * mvPosition;\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n// From http://www.science-and-fiction.org/rendering/noise.html\nfloat rand2d(in vec2 co){\n    return fract(sin(dot(co.xy, vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvarying mediump vec3 v_color;\nvarying lowp float v_coverageFactor;\nvarying lowp vec2 v_seed;\n\nvoid main() {\n    float v = rand2d(gl_FragCoord.xy + v_seed);\n    if (v >= v_coverageFactor) {\n        discard;\n    }\n\n    gl_FragColor = vec4(v_color, 1.0);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nattribute mediump float a_sectorId;\nattribute lowp vec3 a_coverageFactor;\n\nvarying mediump vec3 v_color;\nvarying lowp float v_coverageFactor;\nvarying lowp vec2 v_seed;\n\nvoid main()\n{\n    v_color = packIntToColor(a_sectorId);\n    v_coverageFactor = abs(dot(a_coverageFactor, normal));\n    // A seed to ensure that two overlapping sectors A and B \n    // doesn't produce the same noise pattern\n    v_seed = vec2(a_sectorId / 255.0, a_sectorId / 65025.0);\n    gl_Position = projectionMatrix * modelViewMatrix * instanceMatrix * vec4(position, 1.0);\n}\n"},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0),i=function(){function t(e,n){d(this,t),this._clippingPlanes=[new r.Plane,new r.Plane,new r.Plane,new r.Plane,new r.Plane,new r.Plane],this._box=e||new r.Box3,this._intersection=n||!1,this.updatePlanes()}return f(t,[{key:"updatePlanes",value:function(){this._clippingPlanes[0].setFromNormalAndCoplanarPoint(new r.Vector3(this.intersection?-1:1,0,0),new r.Vector3(this.minX,0,0)),this._clippingPlanes[1].setFromNormalAndCoplanarPoint(new r.Vector3(this.intersection?1:-1,0,0),new r.Vector3(this.maxX,0,0)),this._clippingPlanes[2].setFromNormalAndCoplanarPoint(new r.Vector3(0,this.intersection?-1:1,0),new r.Vector3(0,this.minY,0)),this._clippingPlanes[3].setFromNormalAndCoplanarPoint(new r.Vector3(0,this.intersection?1:-1,0),new r.Vector3(0,this.maxY,0)),this._clippingPlanes[4].setFromNormalAndCoplanarPoint(new r.Vector3(0,0,this.intersection?-1:1),new r.Vector3(0,0,this.minZ)),this._clippingPlanes[5].setFromNormalAndCoplanarPoint(new r.Vector3(0,0,this.intersection?1:-1),new r.Vector3(0,0,this.maxZ))}},{key:"minX",set:function(t){this._box.min.x=t,this.updatePlanes()},get:function(){return this._box.min.x}},{key:"minY",set:function(t){this._box.min.y=t,this.updatePlanes()},get:function(){return this._box.min.y}},{key:"minZ",set:function(t){this._box.min.z=t,this.updatePlanes()},get:function(){return this._box.min.z}},{key:"maxX",set:function(t){this._box.max.x=t,this.updatePlanes()},get:function(){return this._box.max.x}},{key:"maxY",set:function(t){this._box.max.y=t,this.updatePlanes()},get:function(){return this._box.max.y}},{key:"maxZ",set:function(t){this._box.max.z=t,this.updatePlanes()},get:function(){return this._box.max.z}},{key:"intersection",set:function(t){this._intersection=t,this.updatePlanes()},get:function(){return this._intersection}},{key:"clippingPlanes",get:function(){return this._clippingPlanes}}]),t}()},,,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n(2),o=n(18),a=n(13),s=n(6),u=n(8),d=i.mat4.identity(i.mat4.create());function f(t,e){return h.apply(this,arguments)}function h(){return(h=l(c.mark((function t(e,n){var i,f,h,p,m;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return function(t){for(var e=t.getDefaultRequestHeaders(),n=s.XHRFactory.config.customHeaders,i=function(){var t=r(a[o],2),e=t[0],i=t[1];(n=n.filter((function(t){return t.header!==e}))).push({header:e,value:i})},o=0,a=Object.entries(e);o<a.length;o++)i();s.XHRFactory.config.customHeaders=n.filter((function(t){return t.header}))}(e),i=e.getBaseUrl(),f=new a.a(e),t.next=5,f.getOutputs(n,[u.a.EptPointCloud]);case 5:if(h=t.sent.findMostRecentOutput(u.a.EptPointCloud)){t.next=8;break}throw new Error("No point cloud output found for model ".concat(n));case 8:return p=i+f.buildBlobRequestPath(h.blobId)+"/ept.json",m=o.a.load(p),t.abrupt("return",[l(c.mark((function t(){var e;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={modelMatrix:d,inverseModelMatrix:d},t.next=3,m;case 3:return t.t0=t.sent,t.t1=e,t.abrupt("return",[t.t0,t.t1]);case 6:case"end":return t.stop()}}),t)})))]);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n/*!\n *\n * Adapted from:\n * https://github.com/mattdesl/three-shader-fxaa\n * MIT License (MIT) Copyright (c) 2014 Matt DesLauriers\n *\n */\n\nvarying vec2 vUv;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\nuniform vec2 resolution;\n\nvoid main() {\n  vUv = uv;\n\n  vec2 fragCoord = uv * resolution;\n  vec2 inverseVP = 1.0 / resolution.xy;\n  v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n  v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n  v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n  v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n  v_rgbM = vec2(fragCoord * inverseVP);\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n/*!\n *\n * Adapted from:\n * https://github.com/mattdesl/three-shader-fxaa\n * MIT License (MIT) Copyright (c) 2014 Matt DesLauriers\n *\n */\n\nvarying vec2 vUv;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec2 resolution;\nuniform sampler2D tDiffuse;\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n    vec2 v_rgbNW, vec2 v_rgbNE,\n    vec2 v_rgbSW, vec2 v_rgbSE,\n    vec2 v_rgbM) {\n  vec4 color;\n  mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n  vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n  vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n  vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n  vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n  vec4 texColor = texture2D(tex, v_rgbM);\n  vec3 rgbM  = texColor.xyz;\n  vec3 luma = vec3(0.299, 0.587, 0.114);\n  float lumaNW = dot(rgbNW, luma);\n  float lumaNE = dot(rgbNE, luma);\n  float lumaSW = dot(rgbSW, luma);\n  float lumaSE = dot(rgbSE, luma);\n  float lumaM  = dot(rgbM,  luma);\n  float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n  float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n  mediump vec2 dir;\n  dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n  dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n  float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                  (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n  float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n  dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n      max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n      dir * rcpDirMin)) * inverseVP;\n\n  vec4 rgbA = 0.5 * (\n    texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)) +\n    texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)));\n  vec4 rgbB = rgbA * 0.5 + 0.25 * (\n    texture2D(tex, fragCoord * inverseVP + dir * -0.5) +\n    texture2D(tex, fragCoord * inverseVP + dir * 0.5));\n\n  float lumaB = dot(rgbB.rgb, luma);\n  if ((lumaB < lumaMin) || (lumaB > lumaMax)) {\n    color = rgbA;\n  } else {\n    color = rgbB;\n  }\n  return color;\n}\n\nvoid main() {\n  vec2 fragCoord = vUv * resolution;\n  gl_FragColor = fxaa(tDiffuse, fragCoord, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n/*!\n * Copyright 2020 Cognite AS\n * Adapted from three.js (MIT license)\n * @author Mugen87 / https://github.com/Mugen87\n */\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n#define KERNEL_SIZE 32\n\nuniform sampler2D tDiffuse;\nuniform sampler2D tDepth;\nuniform sampler2D tNoise;\n\nuniform vec3 kernel[KERNEL_SIZE]; // TODO move size out\n\nuniform vec2 resolution;\n\nuniform float cameraNear;\nuniform float cameraFar;\nuniform mat4 cameraProjectionMatrix;\nuniform mat4 cameraInverseProjectionMatrix;\n\nuniform float kernelRadius;\nuniform float minDistance;\nuniform float maxDistance;\n\nvarying vec2 vUv;\n\n#include <packing>\n\nfloat getDepth( const in vec2 screenPosition ) {\n    return texture2D( tDepth, screenPosition ).x;\n}\n\nfloat getLinearDepth( const in vec2 screenPosition ) {\n    float fragCoordZ = texture2D( tDepth, screenPosition ).x;\n    float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );\n    return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n}\n\nfloat getViewZ( const in float depth ) {\n    return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n}\n\nvec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {\n    float clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];\n    vec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );\n    clipPosition *= clipW; // unprojection.\n    return ( cameraInverseProjectionMatrix * clipPosition ).xyz;\n}\n\nvec3 getViewNormal( const in vec2 screenPosition ) {\n    vec4 packedColorAndNormal = texture2D(tDiffuse, screenPosition);\n    vec3 normal = unpackRGBToNormal(packedColorAndNormal.rgb);\n    return normalize(normal);\n}\n\nvoid main() {\n    float depth = getDepth( vUv );\n    float viewZ = getViewZ( depth );\n\n    vec3 viewPosition = getViewPosition( vUv, depth, viewZ );\n    vec3 viewNormal = getViewNormal( vUv );\n\n    vec2 noiseScale = vec2( resolution.x / 128.0, resolution.y / 128.0 );\n    vec3 random = texture2D( tNoise, vUv * noiseScale ).xyz;\n\n    // compute matrix used to reorient a kernel vector\n    vec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );\n    vec3 bitangent = cross( viewNormal, tangent );\n    mat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );\n\n    float occlusion = 0.0;\n\n    for ( int i = 0; i < KERNEL_SIZE; i ++ ) {\n        vec3 sampleVector = kernelMatrix * kernel[ i ];\n        vec3 samplePoint = viewPosition + sampleVector * kernelRadius;\n\n        vec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 );\n        samplePointNDC /= samplePointNDC.w;\n\n        vec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5;\n\n        float realDepth = getLinearDepth( samplePointUv );\n        float sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar );\n        float delta = sampleDepth - realDepth;\n\n        if ( delta > minDistance && delta < maxDistance ) {\n            occlusion += 1.0;\n        }\n    }\n\n    occlusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );\n\n    gl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );\n\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n// Copyright Cognite (C) 2019 Cognite\n//\n// Efficient Gaussian blur based on technique described by Daniel R\xe1kos in\n// http://rastergrid.com/blog/2010/09/efficient-gaussian-blur-with-linear-sampling/\n//\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n#include <packing>\n\nvarying vec2 vUv;\n\nuniform sampler2D tDiffuse;\nuniform sampler2D ssaoTexture;\n\nuniform vec2 size;\n\nvec3 unpack(float a) {\n  float h = 0.0;\n  float s = 0.0;\n  float v = 0.0;\n  if (a > 0.095) {\n      // color\n      if (a > 0.55) {\n          // light color\n          float clamped = max(0.55, a);\n          h = (clamped - 0.55) / 0.45;\n          s = 0.6;\n          v = 0.9;\n          return hsv2rgb(vec3(h, s, v));\n      } else {\n          float clamped = max(0.1, a);\n          h = (clamped - 0.1) / 0.45;\n          s = 0.8;\n          v = 0.5;\n          return hsv2rgb(vec3(h, s, v));\n      }\n  } else {\n      // grayscale\n      float h = 0.0;\n      float s = 0.0;\n      float v = a / 0.09;\n      return hsv2rgb(vec3(h, s, v));\n  }\n}\n\nconst bool blur = true;\n\nvoid main() {\n  vec3 blurredAO;\n  if (blur) {\n    vec3 result = 0.5 * (\n      2.0 * texture2D(ssaoTexture, vUv).rgb * 0.2270270270 +\n      texture2D(ssaoTexture, vUv + vec2(1.3746153846, 0.0) / size.x).rgb * 0.3162162162 +\n      texture2D(ssaoTexture, vUv + vec2(3.2307692308, 0.0) / size.x).rgb * 0.0702702703 +\n      texture2D(ssaoTexture, vUv - vec2(1.3746153846, 0.0) / size.x).rgb * 0.3162162162 +\n      texture2D(ssaoTexture, vUv - vec2(3.2307692308, 0.0) / size.x).rgb * 0.0702702703 +\n      texture2D(ssaoTexture, vUv + vec2(0.0, 1.3746153846) / size.y).rgb * 0.3162162162 +\n      texture2D(ssaoTexture, vUv + vec2(0.0, 3.2307692308) / size.y).rgb * 0.0702702703 +\n      texture2D(ssaoTexture, vUv - vec2(0.0, 1.3746153846) / size.y).rgb * 0.3162162162 +\n      texture2D(ssaoTexture, vUv - vec2(0.0, 3.2307692308) / size.y).rgb * 0.0702702703\n    );\n    blurredAO = result;\n  } else {\n    blurredAO = texture2D(ssaoTexture, vUv).rgb;\n  }\n  vec4 packedColor = texture2D(tDiffuse, vUv);\n  vec3 colorRgb = unpack(packedColor.a);\n  vec3 normal = packedColor.xyz;\n  float amplitude = 0.4 + 0.6 * max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n  gl_FragColor = vec4(vec3(amplitude * colorRgb.rgb * blurredAO), 1.0);\n}\n\n"},,function(t,e,n){"use strict";n.r(e),n.d(e,"RevealManager",(function(){return h})),n.d(e,"CadNode",(function(){return p.a})),n.d(e,"loadCadModelFromCdf",(function(){return m.a})),n.d(e,"loadCadModelByUrl",(function(){return v.a})),n.d(e,"intersectCadNodes",(function(){return g.a})),n.d(e,"createPointCloudModel",(function(){return y.a})),n.d(e,"createLocalPointCloudModel",(function(){return b.a})),n.d(e,"internal",(function(){return r})),n.d(e,"utilities",(function(){return I}));var r={};n.r(r),n.d(r,"PotreePointColorType",(function(){return x.a})),n.d(r,"PotreePointShape",(function(){return x.b})),n.d(r,"PotreeNodeWrapper",(function(){return _.a})),n.d(r,"PotreeGroupWrapper",(function(){return w.a})),n.d(r,"suggestCameraConfig",(function(){return T.a})),n.d(r,"traverseDepthFirst",(function(){return S.a})),n.d(r,"traverseUpwards",(function(){return S.b})),n.d(r,"LevelOfDetail",(function(){return M.a})),n.d(r,"ByVisibilityGpuSectorCuller",(function(){return E.a})),n.d(r,"GpuOrderSectorsByVisibilityCoverage",(function(){return R.a}));var i=n(34),o=n(29),u=n(33),c=n(35),l=n(36),h=function(t){a(n,t);var e=s(n);function n(t,r,i){d(this,n);var a=new o.a,s=new l.a,f=new u.a(s);return e.call(this,t,new c.a(a,f),s,r,i)}return f(n,[{key:"clippingPlanes",set:function(t){this._materialManager.clippingPlanes=t},get:function(){return this._materialManager.clippingPlanes}},{key:"clipIntersection",set:function(t){this._materialManager.clipIntersection=t},get:function(){return this._materialManager.clipIntersection}}]),n}(i.a),p=n(19),m=n(76),v=n(78),g=n(28),y=n(68),b=n(77),x=n(16),_=n(17),w=n(25),T=n(24),S=n(9),M=n(7),E=n(27),R=n(23),I=n(10)},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(13),i=function(){function t(e,n){d(this,t),this.clientExtensions=new r.a(e),this.blobId=n}return f(t,[{key:"fetchJson",value:function(){var t=l(c.mark((function t(e){return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.clientExtensions.retrieveJsonBlob(this.blobId,e));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"fetchData",value:function(){var t=l(c.mark((function t(e){return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.clientExtensions.retrieveBinaryBlob(this.blobId,e));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}(),o=n(20),a=n(15),s=n(8),u=[8];function h(t,e){return p.apply(this,arguments)}function p(){return(p=l(c.mark((function t(e,n){var l,d,f,h,p,m;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=new r.a(e),t.next=3,l.getOutputs(n,[s.a.RevealCadModel]);case 3:if(d=t.sent){t.next=6;break}throw new Error("Model is not compatible with Reveal");case 6:if(f=d.findMostRecentOutput(s.a.RevealCadModel,u)){t.next=9;break}throw new Error("Model has no compatible output versions");case 9:if(h={modelMatrix:a.b,inverseModelMatrix:a.a},"externalId"in n&&(p=n.externalId),function(t){return"id"in t}(n)&&(p=""+n.id),void 0!==p){t.next=12;break}throw new Error("Unknown identifier");case 12:return m=new i(e,f.blobId),t.next=15,o.a.create(p,m,h);case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(2),i=n(0),o=n(6),a=function(){function t(){d(this,t)}return f(t,null,[{key:"load",value:function(){var t=l(c.mark((function t(e){var n,r,a,s,u,l,d,f,h,p,m;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new o.PointCloudOctreeGeometry).url=e,t.next=4,fetch(e);case 4:if((r=t.sent).ok){t.next=7;break}throw new Error("Failed to load point clouds: Server responded with ".concat(r.status," '").concat(r.statusText,"'"));case 7:return t.next=9,r.json();case 9:if(a=t.sent,!(s=new o.VersionUtils(a.version)).upTo("1.6")){t.next=13;break}throw new Error("Only point clouds with version 1.7 or newer is supported (got ".concat(s,")"));case 13:return 0===a.octreeDir.indexOf("http")?n.octreeDir=a.octreeDir:n.octreeDir=e+"/../"+a.octreeDir,n.spacing=a.spacing,n.hierarchyStepSize=a.hierarchyStepSize,n.pointAttributes=a.pointAttributes,u=new i.Vector3(a.boundingBox.lx,a.boundingBox.ly,a.boundingBox.lz),l=new i.Vector3(a.boundingBox.ux,a.boundingBox.uy,a.boundingBox.uz),d=new i.Box3(u,l),f=d.clone(),a.tightBoundingBox&&(f.min.copy(new i.Vector3(a.tightBoundingBox.lx,a.tightBoundingBox.ly,a.tightBoundingBox.lz)),f.max.copy(new i.Vector3(a.tightBoundingBox.ux,a.tightBoundingBox.uy,a.tightBoundingBox.uz))),h=u.clone(),d.min.sub(h),d.max.sub(h),f.min.sub(h),f.max.sub(h),n.boundingBox=d,n.tightBoundingBox=f,n.boundingSphere=d.getBoundingSphere(new i.Sphere),n.tightBoundingSphere=f.getBoundingSphere(new i.Sphere),n.offset=h,"LAS"===a.pointAttributes||"LAZ"===a.pointAttributes?n.loader=new o.LasLazLoader(a.version):(n.loader=new o.BinaryLoader(a.version,d,a.scale),n.pointAttributes=new o.PointAttributes(n.pointAttributes)),p={},m=new o.PointCloudOctreeGeometryNode("r",n,d),t.abrupt("return",(m.level=0,m.hasChildren=!0,m.spacing=n.spacing,m.numPoints=0,n.root=m,n.root.load(),p.r=m,n.nodes=p,n));case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),t}(),s=n(18),u=r.mat4.identity(r.mat4.create());function h(t){return p.apply(this,arguments)}function p(){return(p=l(c.mark((function t(e){return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[l(c.mark((function t(){var n;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={modelMatrix:u,inverseModelMatrix:u},!e.endsWith("ept.json")){t.next=9;break}return t.next=4,s.a.load(e);case 4:t.t1=t.sent,t.t2=n,t.t0=[t.t1,t.t2],t.next=14;break;case 9:return t.next=11,a.load(e);case 11:t.t3=t.sent,t.t4=n,t.t0=[t.t3,t.t4];case 14:return t.abrupt("return",t.t0);case 15:case"end":return t.stop()}}),t)})))]);case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(20),i=n(32),o=function(){function t(e){d(this,t),this.baseUrl=e+"/"}return f(t,[{key:"fetchJson",value:function(){var t=l(c.mark((function t(e){return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetchWithStatusCheck(e);case 2:return t.abrupt("return",t.sent.json());case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"fetchData",value:function(){var t=l(c.mark((function t(e){return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetchWithStatusCheck(e);case 2:return t.abrupt("return",t.sent.arrayBuffer());case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"fetchWithStatusCheck",value:function(){var t=l(c.mark((function t(e){var n,r;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.baseUrl+e);case 2:if((n=t.sent).ok){t.next=6;break}throw r={},n.headers.forEach((function(t,e){r[t]=e})),new i.HttpError(n.status,n.body,r);case 6:return t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}(),a=n(15);function s(t){return u.apply(this,arguments)}function u(){return(u=l(c.mark((function t(e){var n,i;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new o(e),i={modelMatrix:a.b,inverseModelMatrix:a.a},t.next=3,r.a.create(e,n,i);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}])},function(t,e,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(t,e){for(var n,s,u=a(t),c=1;c<arguments.length;c++){for(var l in n=Object(arguments[c]))i.call(n,l)&&(u[l]=n[l]);if(r){s=r(n);for(var d=0;d<s.length;d++)o.call(n,s[d])&&(u[s[d]]=n[s[d]])}}return u}},function(t,e,n){var r=n(88);t.exports=function(t,e){if(t){if("string"===typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(106),o=n(110),a=(r=o)&&"object"===typeof r&&"default"in r?r.default:r,s=n(111),u=n(114),c=n(120),l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function d(t,e){function n(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var f=function(){return(f=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function h(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]])}return n}function p(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function m(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function v(t){var e="function"===typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function g(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(g(arguments[e]));return t}var b=function(t){function e(e){var n=t.call(this,e||"Not able to login")||this;return Error.captureStackTrace?Error.captureStackTrace(n,n.constructor):n.stack=new Error(n.message).stack,n}return d(e,t),e}(Error);function x(t){return t||"https://api.cognitedata.com"}function _(t){return"Bearer "+t}function w(t,e){return t.replace(new RegExp("[?&]"+e+"=[^&#]*(#.*)?$"),"$1").replace(new RegExp("([?&])"+e+"=[^&]*&"),"$1")}function T(t){return(c.isArray(t)||c.isObject(t))&&!i.isBuffer(t)&&!(t instanceof Date)}function S(t){return new Promise((function(e){setTimeout(e,t)}))}function M(t,e){return e?e(t):t}function E(t){return c.cloneDeepWith(t,(function(t){if(t instanceof Date)return t.getTime()}))}function R(t){var e=["createdTime","lastUpdatedTime","uploadedTime","deletedTime","timestamp","sourceCreatedTime","sourceModifiedTime"];return c.cloneDeepWith(t,(function(t,n){if(-1!==e.indexOf(""+n))return new Date(t)}))}function I(){return"undefined"!==typeof window&&"undefined"!==typeof window.document&&"https:"===location.protocol.toLowerCase()}function B(t,e){var n;return C(t,((n={}).Authorization=_(e),n))}function A(t,e){return p(this,void 0,void 0,(function(){var n,r,i,o,a;return m(this,(function(s){switch(s.label){case 0:return"cognite-js-sdk-auth-iframe"===window.name?[2,new Promise((function(){}))]:(n=e.project,a=function(){try{var t=U(window.location.search);return F("access_token","id_token"),t}catch(e){throw F("error","error_description"),e}}(),(r=null!==a)?[4,G(t,n,a)]:[3,2]);case 1:r=s.sent(),s.label=2;case 2:if(r)return F("access_token","id_token"),[2,a];i=e.baseUrl,s.label=3;case 3:return s.trys.push([3,5,,6]),o=window.location.href,[4,L({baseUrl:i,project:n,redirectUrl:o,errorRedirectUrl:o})];case 4:return null!==(a=s.sent())?[2,a]:[3,6];case 5:return s.sent(),[3,6];case 6:return[2,null]}}))}))}function C(t,e){return p(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return m(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,t.get("/login/status",{headers:e})];case 1:return n=c.sent(),r=n.data.data,i=r.loggedIn,o=r.user,a=r.project,s=r.projectId,i?[2,{user:o,project:a,projectId:s}]:[2,null];case 2:if(401===(u=c.sent()).status)return[2,null];throw u;case 3:return[2]}}))}))}function F(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=window.location.href;t.forEach((function(t){n=w(n,t)})),window.history.replaceState(null,"",n)}function P(t){var e=t.project,n=t.baseUrl,r=t.redirectUrl,i={project:e,redirectUrl:r,errorRedirectUrl:t.errorRedirectUrl||r};return n+"/login/redirect?"+s.stringify(i)}function N(t){return new Promise((function(e,n){var r=function(t,e){return window.open(t,e,"height=500,width=400,left=100,top=100,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no, status=yes")}(P(t),"cognite-js-sdk-auth-popup");if(null!==r){window.addEventListener("message",(function t(i){i.source===r&&(i.data&&!i.data.error?(window.removeEventListener("message",t),e(i.data)):n(new b))}),!1)}else n(new b("Failed to create login popup window"))}))}function O(){return"cognite-js-sdk-auth-popup"===window.name}function U(t){var e=s.parse(t),n=e.access_token,r=e.id_token,i=e.error,o=e.error_description;if(void 0!==i)throw Error(i+": "+o);return c.isString(n)&&c.isString(r)?{accessToken:n,idToken:r}:null}function L(t){return p(this,void 0,void 0,(function(){return m(this,(function(e){return[2,new Promise((function(e,n){var r=function(t,e){var n=document.createElement("iframe");return n.name=e,n.style.width="0",n.style.height="0",n.style.border="0",n.style.border="none",n.src=t,n}(P(t)+"&prompt=none","cognite-js-sdk-auth-iframe");r.onload=function(){try{var t=U(r.contentWindow.location.search);if(null===t)throw Error("Failed to login");e(t)}catch(i){n(i)}finally{document.body.removeChild(r)}},document.body.appendChild(r)}))]}))}))}function G(t,e,n){return p(this,void 0,void 0,(function(){var r;return m(this,(function(i){switch(i.label){case 0:return[4,B(t,n.accessToken)];case 1:return[2,null!==(r=i.sent())&&(o=r.project,a=e,o.toLowerCase()===a.toLowerCase())]}var o,a}))}))}function D(t){var e=this,n=t.project,r=t.httpClient,i=t.onTokens,o=t.onAuthenticate,a=x(r.getBaseUrl());return function(t){var e=null;return function(){return e||(e=t().then((function(t){return e=null,t})))}}((function(){return p(e,void 0,void 0,(function(){var t,e,s=this;return m(this,(function(u){switch(u.label){case 0:return t=function(t){r.setBearerToken(t.accessToken),i&&i(t)},I()?[4,A(r,{baseUrl:a,project:n})]:[3,2];case 1:if(e=u.sent())return t(e),[2,!0];u.label=2;case 2:return[2,new Promise((function(e,r){o({skip:function(){e(!1)},redirect:function(t){(function(t){return new Promise((function(){var e=P(t);window.location.assign(e)}))})(f({baseUrl:a,project:n},t)).catch(r)},popup:function(i){return p(s,void 0,void 0,(function(){return m(this,(function(o){return N(f({baseUrl:a,project:n},i)).then((function(n){throw n&&(t(n),e(!0)),new b})).catch(r),[2]}))}))}})}))]}}))}))}))}var V=function(){function t(){this.map=new WeakMap}return t.prototype.addAndReturn=function(t,e){return this.map.set(t,{status:e.status,headers:e.headers}),t},t.prototype.get=function(t){return this.map.get(t)},t}();function H(t){var e,n=t,r=0;function i(t){return r<t.items.length?{value:t.items[r++],done:!1}:t.next?(r=0,(n=t.next()).then(i)):{value:void 0,done:!0}}function o(){return p(this,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return[4,n];case 1:return[2,i(t.sent())]}}))}))}var a=function(t){return function(e){return p(this,void 0,void 0,(function(){function n(){return p(this,void 0,void 0,(function(){var r,i;return m(this,(function(o){switch(o.label){case 0:return[4,t()];case 1:return(r=o.sent()).done?[2]:(i=r.value,[4,e(i)]);case 2:return!1===o.sent()?[2]:[4,n()];case 3:return o.sent(),[2]}}))}))}return m(this,(function(t){switch(t.label){case 0:return[4,n()];case 1:return t.sent(),[2]}}))}))}}(o),s=function(t){return function(e){return p(this,void 0,void 0,(function(){var n,r,i=this;return m(this,(function(o){switch(o.label){case 0:return-1===(n=e&&e.limit||25)&&(n=1/0),r=[],[4,t((function(t){return p(i,void 0,void 0,(function(){return m(this,(function(e){return r.push(t),r.length>=n?[2,!1]:[2]}))}))}))];case 1:return o.sent(),[2,r]}}))}))}}(a),u=((e={autoPagingEach:a,autoPagingToArray:s,next:o,return:function(){return{}}})[Symbol.asyncIterator]=function(){return u},e);return u}void 0===Symbol.asyncIterator&&(Symbol.asyncIterator=Symbol.for("asyncIterator"));var k=function(){var t=this;this.add=function(e){t.data.unshift(e)},this.remove=function(){t.data.pop()},this.first=function(){return t.data[0]},this.last=function(){return t.data[t.data.length-1]},this.size=function(){return t.data.length},this.data=[]};function z(t){var e=new k,n=[],r=function(t){var e=new Map;return t.forEach((function(t){e.set(t,[])})),t.forEach((function(t){var n=t.parentNode;n&&e.get(n).push(t)})),e}(t);for(t.forEach((function(t){t.parentNode||e.add(t)}));0!==e.size();){var i=e.last();e.remove(),n.push(i);var o=r.get(i);o&&o.forEach(e.add)}if(n.length!==t.length)throw Error("Impossible to topological sort nodes");return n}var X=function(t){function e(n,r,i,o){void 0===o&&(o={});var a=this,s=n+" | code: "+r;i&&(s+=" | X-Request-ID: "+i);var u=o.missing,c=o.duplicated,l=o.extra;return(u||c)&&(s+="\n"+JSON.stringify(o,null,2)),a=t.call(this,s)||this,Object.setPrototypeOf(a,e.prototype),a.errorMessage=n,a.status=r,a.requestId=i,a.missing=u,a.duplicated=c,a.extra=l,Error.captureStackTrace?Error.captureStackTrace(a,a.constructor):a.stack=new Error(s).stack,a}return d(e,t),e.prototype.toJSON=function(){var t={status:this.status,message:this.errorMessage};return this.requestId&&(t.requestId=this.requestId),this.missing&&(t.missing=this.missing),this.duplicated&&(t.duplicated=this.duplicated),this.extra&&(t.extra=this.extra),t},e}(Error);function W(t){return t.map((function(t){if(t instanceof X)return t;var e=t.message;return{name:t.name,message:e,stack:t.stack}}))}var j=function(t){function e(n){var r,i,o=n.succeded,a=n.responses,s=n.failed,u=n.errors,c=t.call(this,"The API Failed to process some items\n"+JSON.stringify({succeded:o,responses:a,failed:s,errors:W(u)},null,2))||this;c.missing=[],c.duplicated=[],c.statuses=[],c.requestIds=[],c.responses=[],Object.setPrototypeOf(c,e.prototype),c.responses=a.map((function(t){return t.data})),c.errors=u,c.succeded=o.reduce((function(t,e){return t.concat(e)}),[]),c.failed=s.reduce((function(t,e){return t.concat(e)}),[]),c.status=u[0].status,c.requestId=u[0].requestId;try{for(var l=v(u),d=l.next();!d.done;d=l.next()){var f=d.value;f instanceof X&&(f.missing&&(c.missing=c.missing.concat(f.missing)),f.duplicated&&(c.duplicated=c.duplicated.concat(f.duplicated)),f.requestId&&c.requestIds.push(f.requestId),c.statuses.push(f.status))}}catch(h){r={error:h}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return Error.captureStackTrace?Error.captureStackTrace(c,c.constructor):c.stack=new Error(c.message).stack,c}return d(e,t),e}(Error);function Z(t){return z(function(t){var e=new Map,n=t.map((function(t){return{data:t}}));return n.forEach((function(t){var n=t.data.externalId;n&&e.set(n,t)})),n.forEach((function(t){var n=t.data.parentExternalId;n&&e.has(n)&&(t.parentNode=e.get(n))})),n}(t)).map((function(t){return t.data}))}function Q(t,e){return p(this,void 0,void 0,(function(){var n,r,i,o,a,s;return m(this,(function(u){switch(u.label){case 0:return n=[],r=[],i=[],o=[],a=t.map((function(t){return e(t)})),s=a.map((function(e,a){return e.then((function(e){r.push(t[a]),i.push(e)})).catch((function(e){n.push(t[a]),o.push(e)}))})),[4,Promise.all(s)];case 1:if(u.sent(),n.length)throw{succeded:r,responses:i,failed:n,errors:o};return[2,i]}}))}))}function Y(t,e,n){return p(this,void 0,void 0,(function(){var r;return m(this,(function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),n?[4,J(t,e)]:[3,2];case 1:return[2,i.sent()];case 2:return[4,Q(t,e)];case 3:return[2,i.sent()];case 4:return[3,6];case 5:throw r=i.sent(),new j(r);case 6:return[2]}}))}))}function J(t,e){return p(this,void 0,void 0,(function(){var n=this;return m(this,(function(r){return[2,t.reduce((function(r,i,o){return p(n,void 0,void 0,(function(){var n,a,s;return m(this,(function(u){switch(u.label){case 0:return[4,r];case 1:n=u.sent(),u.label=2;case 2:return u.trys.push([2,4,,5]),s=(a=n).concat,[4,e(i)];case 3:return[2,s.apply(a,[u.sent()])];case 4:throw{errors:[u.sent()],failed:t.slice(o),succeded:t.slice(0,o),responses:n};case 5:return[2]}}))}))}),Promise.resolve(new Array))]}))}))}var q,K=function(){function t(t,e,n){var r=this;this.resourcePath=t,this.httpClient=e,this.map=n,this.callListEndpointWithGet=function(t){return p(r,void 0,void 0,(function(){var e;return m(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.get(this.listGetUrl,{params:t})];case 1:return e=n.sent(),[2,this.transformResponse(e)]}}))}))},this.callListEndpointWithPost=function(t){return p(r,void 0,void 0,(function(){var e;return m(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.post(this.listPostUrl,{data:t||{}})];case 1:return e=n.sent(),[2,this.transformResponse(e)]}}))}))}}return Object.defineProperty(t.prototype,"listGetUrl",{get:function(){return this.url("")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"listPostUrl",{get:function(){return this.url("list")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byIdsUrl",{get:function(){return this.url("byids")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updateUrl",{get:function(){return this.url("update")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"searchUrl",{get:function(){return this.url("search")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deleteUrl",{get:function(){return this.url("delete")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aggregateUrl",{get:function(){return this.url("aggregate")},enumerable:!0,configurable:!0}),t.chunk=function(t,e){return 0===t.length?[[]]:c.chunk(t,e)},t.prototype.getMetadataMap=function(){return this.map},t.prototype.url=function(t){return void 0===t&&(t=""),this.resourcePath+"/"+t},t.prototype.createEndpoint=function(t,e,n,r){return void 0===e&&(e=this.url()),p(this,void 0,void 0,(function(){var i=this;return m(this,(function(o){return[2,this.callEndpointWithMergeAndTransform(t,(function(t){return i.callCreateEndpoint(t,e)}),n,r)]}))}))},t.prototype.listEndpoint=function(t,e){var n=this,r=t(e).then((function(r){return n.addNextPageFunction(t.bind(n),r.data,e)})),i=H(r);return Object.assign(r,i)},t.prototype.retrieveEndpoint=function(t,e,n){return p(this,void 0,void 0,(function(){var r=this;return m(this,(function(i){return[2,this.callEndpointWithMergeAndTransform(t,(function(t){return r.callRetrieveEndpoint(t,n,e)}))]}))}))},t.prototype.updateEndpoint=function(t,e){return p(this,void 0,void 0,(function(){var n=this;return m(this,(function(r){return[2,this.callEndpointWithMergeAndTransform(t,(function(t){return n.callUpdateEndpoint(t,e)}))]}))}))},t.prototype.searchEndpoint=function(t){return p(this,void 0,void 0,(function(){return m(this,(function(e){return[2,this.callEndpointWithTransform(t,this.callSearchEndpoint)]}))}))},t.prototype.deleteEndpoint=function(t,e,n){return p(this,void 0,void 0,(function(){var r;return m(this,(function(i){switch(i.label){case 0:return[4,this.callDeleteEndpoint(t,e,n)];case 1:return r=i.sent(),[2,this.addToMapAndReturn({},r[0])]}}))}))},t.prototype.aggregateEndpoint=function(t){return p(this,void 0,void 0,(function(){var e;return m(this,(function(n){switch(n.label){case 0:return[4,this.callAggregateEndpoint(t)];case 1:return e=n.sent(),[2,this.addToMapAndReturn(e.data.items,e)]}}))}))},t.prototype.callRetrieveEndpoint=function(t,e,n){return void 0===e&&(e=this.byIdsUrl),p(this,void 0,void 0,(function(){return m(this,(function(r){return[2,this.postInParallelWithAutomaticChunking({params:n,path:e,items:t})]}))}))},t.prototype.callUpdateEndpoint=function(t,e){return void 0===e&&(e=this.updateUrl),p(this,void 0,void 0,(function(){return m(this,(function(n){return[2,this.postInParallelWithAutomaticChunking({path:e,items:t})]}))}))},t.prototype.callSearchEndpoint=function(t){return p(this,void 0,void 0,(function(){return m(this,(function(e){return[2,this.httpClient.post(this.searchUrl,{data:t})]}))}))},t.prototype.callDeleteEndpoint=function(t,e,n){return void 0===n&&(n=this.deleteUrl),this.postInParallelWithAutomaticChunking({path:n,items:t,params:e})},t.prototype.callAggregateEndpoint=function(t){return p(this,void 0,void 0,(function(){return m(this,(function(e){return[2,this.httpClient.post(this.aggregateUrl,{data:t})]}))}))},t.prototype.addToMapAndReturn=function(t,e){return this.map.addAndReturn(t,e)},t.prototype.transformAndReturn=function(t,e){var n=this.transformToClass(t);return this.addToMapAndReturn(n,e)},t.prototype.callEndpointWithMergeAndTransform=function(t,e,n,r){return p(this,void 0,void 0,(function(){var i,o,a,s;return m(this,(function(u){switch(u.label){case 0:return i=M(t,n),[4,e.bind(this)(i)];case 1:return o=u.sent(),a=this.mergeItemsFromItemsResponse(o),s=M(a,r),[2,this.transformAndReturn(s,o[0])]}}))}))},t.prototype.callEndpointWithTransform=function(t,e){return p(this,void 0,void 0,(function(){var n;return m(this,(function(r){switch(r.label){case 0:return[4,e.bind(this)(t)];case 1:return n=r.sent(),[2,this.transformAndReturn(n.data.items,n)]}}))}))},t.prototype.mergeItemsFromItemsResponse=function(t){return t.map((function(t){return t.data.items})).reduce((function(t,e){return y(t,e)}),[])},t.prototype.addNextPageFunction=function(t,e,n){var r=this;void 0===n&&(n={});var i=e.nextCursor,o=i?function(){return t(f({},n,{cursor:i})).then((function(e){return r.addNextPageFunction(t,e.data,n)}))}:void 0;return f({},e,{next:o})},t.prototype.transformToClass=function(t){return t},t.prototype.transformToList=function(t){return t},t.prototype.postInParallelWithAutomaticChunking=function(e){var n=this,r=e.path,i=e.items,o=e.params,a=e.queryParams,s=e.chunkSize,u=void 0===s?1e3:s;return Y(t.chunk(i,u),(function(t){return n.httpClient.post(r,{data:f({},o,{items:t}),params:a})}),!1)},t.prototype.callCreateEndpoint=function(t,e){return p(this,void 0,void 0,(function(){return m(this,(function(n){return[2,this.postInSequenceWithAutomaticChunking(e,t)]}))}))},t.prototype.transformResponse=function(t){return f({},t,{data:f({},t.data,{items:this.transformToClass(t.data.items)})})},t.prototype.postInSequenceWithAutomaticChunking=function(e,n,r){var i=this;return Y(t.chunk(n,1e3),(function(t){return i.httpClient.post(e,{data:{items:t},params:r})}),!0)},t}(),$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.list=function(n,r,i){var o=e.encodeUrl(n,r);return t.prototype.listEndpoint.call(e,(function(t){return e.httpClient.get(o,{params:t})}),i)},e.create=function(n,r,i){var o=e.encodeUrl(n,r);return t.prototype.createEndpoint.call(e,i,o)},e.delete=function(n,r,i){var o=e.encodeUrl(n,r)+"/delete";return t.prototype.deleteEndpoint.call(e,i,void 0,o)},e}return d(e,t),e.prototype.encodeUrl=function(t,e){return this.url(t+"/revisions/"+e+"/mappings")},e}(K),tt=function(t){function e(n,r,i){var o=t.call(this,"Request failed | status code: "+n)||this;return o.status=n,o.data=r,o.headers=i,Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace?Error.captureStackTrace(o,o.constructor):o.stack=new Error(o.message).stack,o}return d(e,t),e}(Error),et=function(){function t(t){this.baseUrl=t,this.defaultHeaders={}}return t.validateStatusCode=function(t){return t>=200&&t<300},t.throwCustomErrorResponse=function(t){throw new tt(t.status,t.data,t.headers)},t.jsonResponseHandler=function(t){return t.json()},t.textResponseHandler=function(t){return t.text()},t.arrayBufferResponseHandler=function(t){return t.blob().then((function(t){return new o.Response(t).arrayBuffer()}))},t.getResponseHandler=function(e){switch(e){case rt.ArrayBuffer:return t.arrayBufferResponseHandler;case rt.Text:return t.textResponseHandler;default:return t.jsonResponseHandler}},t.convertFetchHeaders=function(t){var e={};return t.forEach((function(t,n){e[n]=t})),e},t.transformRequestBody=function(t){return T(t)?JSON.stringify(t,null,2):t},t.resolveUrl=function(t,e){return t.replace(/\/$/,"")+(("/"===e[0]?"":"/")+e)},t.prototype.setDefaultHeader=function(t,e){return this.defaultHeaders[t]=e,this},t.prototype.getDefaultHeaders=function(){return f({},this.defaultHeaders)},t.prototype.setBaseUrl=function(t){this.baseUrl=t},t.prototype.getBaseUrl=function(){return this.baseUrl},t.prototype.get=function(t,e){return void 0===e&&(e={}),this.request(f({},e,{path:t,method:q.Get}))},t.prototype.post=function(t,e){return void 0===e&&(e={}),this.request(f({},e,{path:t,method:q.Post}))},t.prototype.put=function(t,e){return void 0===e&&(e={}),this.request(f({},e,{path:t,method:q.Put}))},t.prototype.delete=function(t,e){return void 0===e&&(e={}),this.request(f({},e,{path:t,method:q.Delete}))},t.prototype.patch=function(t,e){return void 0===e&&(e={}),this.request(f({},e,{path:t,method:q.Patch}))},t.prototype.preRequest=function(t){return p(this,void 0,void 0,(function(){var e;return m(this,(function(n){return e=this.populateDefaultHeaders(t.headers),[2,f({},t,{headers:e})]}))}))},t.prototype.postRequest=function(e,n){return p(this,void 0,void 0,(function(){return m(this,(function(n){return t.validateStatusCode(e.status)||t.throwCustomErrorResponse(e),[2,e]}))}))},t.prototype.populateDefaultHeaders=function(t){return void 0===t&&(t={}),f({},this.defaultHeaders,t)},t.prototype.rawRequest=function(e){return p(this,void 0,void 0,(function(){var n,r,i,o,s;return m(this,(function(u){switch(u.label){case 0:return n=this.constructUrl(e.path,e.params),r=f({Accept:"application/json"},e.headers),T(i=e.data)&&(i=t.transformRequestBody(i),r["Content-Type"]="application/json"),[4,a(n,{body:i,method:e.method,headers:r})];case 1:return o=u.sent(),[4,t.getResponseHandler(e.responseType)(o)];case 2:return s=u.sent(),[2,{headers:t.convertFetchHeaders(o.headers),status:o.status,data:s}]}}))}))},t.prototype.request=function(t){return p(this,void 0,void 0,(function(){var e,n;return m(this,(function(r){switch(r.label){case 0:return[4,this.preRequest(t)];case 1:return e=r.sent(),[4,this.rawRequest(e)];case 2:return n=r.sent(),[2,this.postRequest(n,t)]}}))}))},t.prototype.constructUrl=function(e,n){void 0===n&&(n={});var r=e;return Object.keys(n).length>0&&(r+="?"+s.stringify(n)),null!==r.match(/^https?:\/\//i)?r:t.resolveUrl(this.baseUrl,r)},t}();!function(t){t.Get="GET",t.Post="POST",t.Put="PUT",t.Delete="DELETE",t.Patch="PATCH"}(q||(q={}));var nt,rt={Json:"json",ArrayBuffer:"arraybuffer",Text:"text"},it=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.retrieve=function(t){return p(e,void 0,void 0,(function(){var e,n;return m(this,(function(r){switch(r.label){case 0:return e=this.url(""+t),[4,this.httpClient.get(e,{responseType:rt.ArrayBuffer})];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},e}return d(e,t),e}(K),ot=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.create=function(n){return t.prototype.createEndpoint.call(e,n)},e.list=function(n){return t.prototype.listEndpoint.call(e,e.callListEndpointWithGet,n)},e.retrieve=function(t){return p(e,void 0,void 0,(function(){var e,n;return m(this,(function(r){switch(r.label){case 0:return e=this.url(""+t),[4,this.httpClient.get(e)];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},e.update=function(n){return t.prototype.updateEndpoint.call(e,n)},e.delete=function(n){return t.prototype.deleteEndpoint.call(e,n)},e}return d(e,t),e}(K),at=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.retrieve=function(n,r,i){var o=e.url(n+"/revisions/"+r+"/nodes/byids");return t.prototype.retrieveEndpoint.call(e,i,{},o)},e}return d(e,t),e.prototype.list=function(e,n,r){var i=this,o=this.url(e+"/revisions/"+n+"/nodes");return t.prototype.listEndpoint.call(this,(function(t){return i.httpClient.get(o,{params:t})}),r)},e.prototype.listAncestors=function(e,n,r,i){var o=this,a=this.url(e+"/revisions/"+n+"/nodes/"+r+"/ancestors");return t.prototype.listEndpoint.call(this,(function(t){return o.httpClient.get(a,{params:t})}),i)},e}(K),st=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.create=function(e,n){return t.prototype.createEndpoint.call(i,n,i.url(e+"/revisions"))},i.list=function(e,n){var r=i.url(e+"/revisions");return t.prototype.listEndpoint.call(i,(function(t){return i.httpClient.get(r,{params:t})}),n)},i.retrieve=function(t,e){return p(i,void 0,void 0,(function(){var n,r;return m(this,(function(i){switch(i.label){case 0:return n=this.url(t+"/revisions/"+e),[4,this.httpClient.get(n)];case 1:return r=i.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},i.update=function(e,n){var r=i.url(e+"/revisions/update");return t.prototype.updateEndpoint.call(i,n,r)},i.delete=function(e,n){var r=i.url(e+"/revisions/delete");return t.prototype.deleteEndpoint.call(i,n,void 0,r)},i.updateThumbnail=function(t,e,n){return p(i,void 0,void 0,(function(){var r,i;return m(this,(function(o){switch(o.label){case 0:return r=this.url(t+"/revisions/"+e+"/thumbnail"),[4,this.httpClient.post(r,{data:{fileId:n}})];case 1:return i=o.sent(),[2,this.addToMapAndReturn({},i)]}}))}))},i.list3DNodes=function(t,e,n){return i.nodes3DApi.list(t,e,n)},i.retrieve3DNodes=function(t,e,n){return i.nodes3DApi.retrieve(t,e,n)},i.list3DNodeAncestors=function(t,e,n,r){return i.nodes3DApi.listAncestors(t,e,n,r)},i.nodes3DApi=new at(e,n,r),i}return d(e,t),e}(K),ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d(e,t),e.prototype.list=function(e,n,r){var i=this,o=this.encodeUrl(e,n);return t.prototype.listEndpoint.call(this,(function(t){return i.httpClient.get(o,{params:t})}),r)},e.prototype.listAncestors=function(e,n,r,i){var o=this,a=this.encodeUrl(e,n)+"/"+r+"/ancestors";return t.prototype.listEndpoint.call(this,(function(t){return o.httpClient.get(a,{params:t})}),i)},e.prototype.encodeUrl=function(t,e){return this.url("models/"+t+"/revisions/"+e+"/nodes")},e}(K),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d(e,t),e.prototype.retrieve=function(t,e){return p(this,void 0,void 0,(function(){var n,r;return m(this,(function(i){switch(i.label){case 0:return n=this.url("models/"+t+"/revisions/"+e),[4,this.httpClient.get(n)];case 1:return r=i.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},e}(K),lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d(e,t),e.prototype.list=function(e,n,r){var i=this,o=this.url("models/"+e+"/revisions/"+n+"/sectors");return t.prototype.listEndpoint.call(this,(function(t){return i.httpClient.get(o,{params:t})}),r)},e}(K),dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d(e,t),e.prototype.retrieve=function(t,e){return p(this,void 0,void 0,(function(){var n,r;return m(this,(function(i){switch(i.label){case 0:return n=this.url("models/"+t+"/revisions/"+e),[4,this.httpClient.get(n)];case 1:return r=i.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},e}(K),ft=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;i.retrieveRevealRevision3D=function(t,e){return i.revealRevisions3DAPI.retrieve(t,e)},i.listRevealNodes3D=function(t,e,n){return i.revealNodes3DAPI.list(t,e,n)},i.listRevealNode3DAncestors=function(t,e,n,r){return i.revealNodes3DAPI.listAncestors(t,e,n,r)},i.listRevealSectors3D=function(t,e,n){return i.revealSectors3DAPI.list(t,e,n)},i.retrieveUnrealRevision3D=function(t,e){return i.unrealRevisions3DAPI.retrieve(t,e)};var o=e+"/reveal",a=e+"/unreal";return i.revealRevisions3DAPI=new ct(o,n,r),i.revealNodes3DAPI=new ut(o,n,r),i.revealSectors3DAPI=new lt(o,n,r),i.unrealRevisions3DAPI=new dt(a,n,r),i}return d(e,t),e}(K),ht=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.create=function(t){return e.createEndpoint(t)},e.list=function(t){return p(e,void 0,void 0,(function(){var e,n;return m(this,(function(r){switch(r.label){case 0:return e=this.url(),[4,this.httpClient.get(e,{params:t})];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},e.delete=function(n){return t.prototype.deleteEndpoint.call(e,n)},e}return d(e,t),e}(K),pt=function(){function t(t){this.client=t,Object.defineProperty(this,"client",{value:this.client,enumerable:!1})}return t.prototype.toString=function(){return JSON.stringify(this.toJSON())},t}(),mt=function(t){function e(e,n){var r=t.call(this,e)||this;return r.externalId=n.externalId,r.name=n.name,r.isString=n.isString,r.metadata=n.metadata,r.unit=n.unit,r.assetId=n.assetId,r.dataSetId=n.dataSetId,r.isStep=n.isStep,r.description=n.description,r.securityCategories=n.securityCategories,r.createdTime=n.createdTime,r.lastUpdatedTime=n.lastUpdatedTime,r.id=n.id,Object.defineProperties(r,{delete:{value:r.delete.bind(r),enumerable:!1},getAsset:{value:r.getAsset.bind(r),enumerable:!1},getDatapoints:{value:r.getDatapoints.bind(r),enumerable:!1},getLatestDatapoints:{value:r.getLatestDatapoints.bind(r),enumerable:!1}}),r}return d(e,t),e.prototype.delete=function(){return p(this,void 0,void 0,(function(){return m(this,(function(t){return[2,this.client.timeseries.delete([{id:this.id}])]}))}))},e.prototype.getAsset=function(){return p(this,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return void 0===this.assetId?[2,null]:[4,this.client.assets.retrieve([{id:this.assetId}])];case 1:return[2,t.sent()[0]]}}))}))},e.prototype.getDatapoints=function(t){return p(this,void 0,void 0,(function(){return m(this,(function(e){return[2,this.client.datapoints.retrieve({items:[f({},t,{id:this.id})]})]}))}))},e.prototype.getLatestDatapoints=function(t){return void 0===t&&(t={}),p(this,void 0,void 0,(function(){var e;return m(this,(function(n){return e=t,[2,this.client.datapoints.retrieveLatest([f({},e,{id:this.id})])]}))}))},e.prototype.toJSON=function(){return f({},this)},e}(pt),vt=function(t){function e(e,n){var r=t.apply(this,y(n))||this;return r.delete=function(){return p(r,void 0,void 0,(function(){return m(this,(function(t){return[2,this.client.timeseries.delete(this.map((function(t){return{id:t.id}})))]}))}))},r.getAllAssets=function(){return p(r,void 0,void 0,(function(){var t;return m(this,(function(e){return t=this.filter((function(t){return void 0!==t.assetId})).map((function(t){return{id:t.assetId}})),[2,this.client.assets.retrieve(c.uniqBy(t,"id"))]}))}))},r.getAllDatapoints=function(t){return void 0===t&&(t={}),p(r,void 0,void 0,(function(){var e;return m(this,(function(n){return e=this.map((function(t){return{id:t.id}})),[2,this.client.datapoints.retrieve(f({items:e},t))]}))}))},r.client=e,r}return d(e,t),e}(Array),gt=function(t){function e(e,n,r,i){var o=t.call(this,n,r,i)||this;return o.client=e,o.create=function(e){return t.prototype.createEndpoint.call(o,e)},o.list=function(e){var n={};if(e){e.includeMetadata;var r=e.limit,i=e.cursor,a=e.partition;n={filter:h(e,["includeMetadata","limit","cursor","partition"]),limit:r,partition:a,cursor:i}}return t.prototype.listEndpoint.call(o,o.callListEndpointWithPost,n)},o.aggregate=function(e){return t.prototype.aggregateEndpoint.call(o,e)},o.retrieve=function(e,n){return void 0===n&&(n={}),t.prototype.retrieveEndpoint.call(o,e,n)},o.update=function(e){return t.prototype.updateEndpoint.call(o,e)},o.search=function(e){return t.prototype.searchEndpoint.call(o,e)},o.delete=function(e){return t.prototype.deleteEndpoint.call(o,e)},o}return d(e,t),e.prototype.transformToList=function(t){var e=this;return t.map((function(t){return new mt(e.client,t)}))},e.prototype.transformToClass=function(t){var e=this.transformToList(t);return new vt(this.client,e)},e}(K),yt=function(t){function e(e,n){var r=t.apply(this,y(n))||this;return r.delete=function(){return p(r,void 0,void 0,(function(){return m(this,(function(t){return[2,this.client.assets.delete(this.map((function(t){return{id:t.id}})))]}))}))},r.timeSeries=function(){return p(r,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return[4,this.getResourcesFromAssets(this.client.timeseries)];case 1:return[2,t.sent()]}}))}))},r.files=function(){return p(r,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return[4,this.getResourcesFromAssets(this.client.files)];case 1:return[2,t.sent()]}}))}))},r.events=function(){return p(r,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return[4,this.getResourcesFromAssets(this.client.events)];case 1:return[2,t.sent()]}}))}))},r.getResourcesFromAssets=function(t){return p(r,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l;return m(this,(function(d){switch(d.label){case 0:r=this.toChunkedArrayOfIds(),i=[];try{for(o=v(r),a=o.next();!a.done;a=o.next())s=a.value,u={assetIds:s},t instanceof gt?i.push(t.list(u).autoPagingToArray({limit:1/0})):i.push(t.list({filter:u}).autoPagingToArray({limit:1/0}))}catch(f){e={error:f}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return[4,Promise.all(i)];case 1:return c=d.sent(),l=[],c.forEach((function(t){l.push.apply(l,y(t))})),[2,l]}}))}))},r.toChunkedArrayOfIds=function(){var t=r.map((function(t){return t.id})),e=[[]];return t.length&&(e=c.chunk(t,100)),e},r.client=e,r}return d(e,t),e}(Array),bt=function(t){function e(e,n){var r=t.call(this,e)||this;return r.id=n.id,r.externalId=n.externalId,r.parentId=n.parentId,r.name=n.name,r.description=n.description,r.metadata=n.metadata,r.source=n.source,r.lastUpdatedTime=n.lastUpdatedTime,r.createdTime=n.createdTime,r.rootId=n.rootId,r.aggregates=n.aggregates,r.parentExternalId=n.parentExternalId,r.dataSetId=n.dataSetId,Object.defineProperties(r,{delete:{value:r.delete.bind(r),enumerable:!1},parent:{value:r.parent.bind(r),enumerable:!1},children:{value:r.children.bind(r),enumerable:!1},subtree:{value:r.subtree.bind(r),enumerable:!1},timeSeries:{value:r.timeSeries.bind(r),enumerable:!1},events:{value:r.events.bind(r),enumerable:!1},files:{value:r.files.bind(r),enumerable:!1}}),r}return d(e,t),e.prototype.delete=function(t){return void 0===t&&(t={}),p(this,void 0,void 0,(function(){return m(this,(function(e){return[2,this.client.assets.delete([{id:this.id}],t)]}))}))},e.prototype.parent=function(){return p(this,void 0,void 0,(function(){var t;return m(this,(function(e){switch(e.label){case 0:return this.parentId?[4,this.client.assets.retrieve([{id:this.parentId}])]:[3,2];case 1:return t=g.apply(void 0,[e.sent(),1]),[2,t[0]];case 2:return[2,null]}}))}))},e.prototype.children=function(){return p(this,void 0,void 0,(function(){var t;return m(this,(function(e){switch(e.label){case 0:return[4,this.client.assets.list({filter:{parentIds:[this.id]}}).autoPagingToArray({limit:1/0})];case 1:return t=e.sent(),[2,new yt(this.client,t)]}}))}))},e.prototype.subtree=function(t){return p(this,void 0,void 0,(function(){var e;return m(this,(function(n){return e=t||{},[2,this.client.assets.retrieveSubtree({id:this.id},e.depth||1/0)]}))}))},e.prototype.timeSeries=function(t){return void 0===t&&(t={}),p(this,void 0,void 0,(function(){return m(this,(function(e){return[2,this.client.timeseries.list(f({},t,{assetIds:[this.id]})).autoPagingToArray({limit:1/0})]}))}))},e.prototype.events=function(t){return void 0===t&&(t={}),p(this,void 0,void 0,(function(){return m(this,(function(e){return[2,this.client.events.list({filter:f({},t,{assetIds:[this.id]})}).autoPagingToArray({limit:1/0})]}))}))},e.prototype.files=function(t){return void 0===t&&(t={}),p(this,void 0,void 0,(function(){return m(this,(function(e){return[2,this.client.files.list({filter:f({},t,{assetIds:[this.id]})}).autoPagingToArray({limit:1/0})]}))}))},e.prototype.toJSON=function(){return f({},this)},e}(pt),xt=function(t){var e=this;this.sortFunction=t,this.originalIndexMap=new Map,this.sort=function(t){return e.originalIndexMap=new Map,e.originalArray=t,t.forEach((function(t,n){e.originalIndexMap.set(t,n)})),e.sortedArray=e.sortFunction(t),e.sortedArray},this.unsort=function(t){if(!e.originalArray||!e.sortedArray)throw Error("Impossible to unsort. Call sort(...) first.");if(t.length!==e.originalArray.length)throw Error("Impossible to unsort. Input array has a different length from original.");var n=[];return e.sortedArray.forEach((function(r,i){var o=e.originalIndexMap.get(r);n[o]=t[i]})),n}},_t=function(t){function e(e,n,r,i){var o=t.call(this,n,r,i)||this;return o.client=e,o.create=function(e){var n=new xt(Z),r=n.sort,i=n.unsort;return t.prototype.createEndpoint.call(o,e,void 0,r,i)},o.list=function(e){return t.prototype.listEndpoint.call(o,o.callListEndpointWithPost,e)},o.aggregate=function(e){return t.prototype.aggregateEndpoint.call(o,e)},o.retrieve=function(e,n){return void 0===n&&(n={}),t.prototype.retrieveEndpoint.call(o,e,n)},o.update=function(e){return t.prototype.updateEndpoint.call(o,e)},o.search=function(e){return t.prototype.searchEndpoint.call(o,e)},o.delete=function(e,n){void 0===n&&(n={});var r=f({},n,{ignoreUnknownIds:!0});return t.prototype.deleteEndpoint.call(o,e,r)},o.retrieveSubtree=function(t,e){return p(o,void 0,void 0,(function(){var n,r;return m(this,(function(i){switch(i.label){case 0:return n=0,[4,this.retrieve([t])];case 1:return r=i.sent(),[2,this.getAssetSubtree(r,n,e)]}}))}))},o.getChildren=function(t){return p(o,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,l,d;return m(this,(function(f){switch(f.label){case 0:r=t.map((function(t){return t.id})),i=c.chunk(r,100),o=[],f.label=1;case 1:f.trys.push([1,6,7,8]),a=v(i),s=a.next(),f.label=2;case 2:return s.done?[3,5]:(u=s.value,[4,this.client.assets.list({filter:{parentIds:u}}).autoPagingToArray({limit:1/0})]);case 3:l=f.sent(),o.push.apply(o,y(l)),f.label=4;case 4:return s=a.next(),[3,2];case 5:return[3,8];case 6:return d=f.sent(),e={error:d},[3,8];case 7:try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}return[7];case 8:return[2,new yt(this.client,o)]}}))}))},o}return d(e,t),e.prototype.transformToList=function(t){var e=this;return t.map((function(t){return new bt(e.client,t)}))},e.prototype.transformToClass=function(t){var e=this.transformToList(t);return new yt(this.client,e)},e.prototype.getAssetSubtree=function(t,e,n){return void 0===n&&(n=1/0),p(this,void 0,void 0,(function(){var r,i,o;return m(this,(function(a){switch(a.label){case 0:return r=t,n>e?[4,this.getChildren(t)]:[3,3];case 1:return 0===(i=a.sent()).length?[3,3]:[4,this.getAssetSubtree(i,e+1,n)];case 2:o=a.sent(),r.push.apply(r,y(o)),a.label=3;case 3:return[2,r]}}))}))},e}(K),wt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.insert=function(t){return e.insertEndpoint(t)},e.retrieve=function(t){return e.retrieveDatapointsEndpoint(t)},e.retrieveLatest=function(t,n){return void 0===n&&(n={}),e.retrieveLatestEndpoint(t,n)},e.delete=function(t){return e.deleteDatapointsEndpoint(t)},e}return d(e,t),e.prototype.insertEndpoint=function(t){return p(this,void 0,void 0,(function(){var e;return m(this,(function(n){switch(n.label){case 0:return e=this.url(),[4,this.postInParallelWithAutomaticChunking({path:e,items:t})];case 1:return n.sent(),[2,{}]}}))}))},e.prototype.retrieveDatapointsEndpoint=function(t){return p(this,void 0,void 0,(function(){var e,n;return m(this,(function(r){switch(r.label){case 0:return e=this.listPostUrl,[4,this.httpClient.post(e,{data:t})];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},e.prototype.retrieveLatestEndpoint=function(t,e){return p(this,void 0,void 0,(function(){var n,r;return m(this,(function(i){switch(i.label){case 0:return n=this.url("latest"),[4,this.httpClient.post(n,{data:f({items:t},e)})];case 1:return r=i.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},e.prototype.deleteDatapointsEndpoint=function(t){return p(this,void 0,void 0,(function(){return m(this,(function(e){switch(e.label){case 0:return[4,this.postInParallelWithAutomaticChunking({chunkSize:1e4,items:t,path:this.deleteUrl})];case 1:return e.sent(),[2,{}]}}))}))},e}(K),Tt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.create=function(n){return t.prototype.createEndpoint.call(e,n)},e.list=function(n){return t.prototype.listEndpoint.call(e,e.callListEndpointWithPost,n)},e.aggregate=function(n){return t.prototype.aggregateEndpoint.call(e,n)},e.retrieve=function(n){return t.prototype.retrieveEndpoint.call(e,n)},e.update=function(n){return t.prototype.updateEndpoint.call(e,n)},e}return d(e,t),e}(K),St=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.create=function(n){return t.prototype.createEndpoint.call(e,n)},e.list=function(n){var r=n||{},i=r.sort,o=void 0===i?{}:i,a=h(r,["sort"]),s=f({sort:e.convertSortObjectToArray(o)},a);return t.prototype.listEndpoint.call(e,e.callListEndpointWithPost,s)},e.aggregate=function(n){return t.prototype.aggregateEndpoint.call(e,n)},e.retrieve=function(n,r){return void 0===r&&(r={}),t.prototype.retrieveEndpoint.call(e,n,r)},e.update=function(n){return t.prototype.updateEndpoint.call(e,n)},e.search=function(n){return t.prototype.searchEndpoint.call(e,n)},e.delete=function(n){return t.prototype.deleteEndpoint.call(e,n)},e}return d(e,t),e.prototype.convertSortObjectToArray=function(t){return Object.entries(t).map((function(t){var e=g(t,2);return e[0]+":"+e[1]}))},e}(K),Mt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.upload=function(t,n,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),e.uploadEndpoint(t,n,r,i)},e.list=function(n){return t.prototype.listEndpoint.call(e,e.callListEndpointWithPost,n)},e.aggregate=function(n){return t.prototype.aggregateEndpoint.call(e,n)},e.retrieve=function(n,r){return void 0===r&&(r={}),t.prototype.retrieveEndpoint.call(e,n,r)},e.update=function(n){return t.prototype.updateEndpoint.call(e,n)},e.search=function(n){return t.prototype.searchEndpoint.call(e,n)},e.delete=function(n){return t.prototype.deleteEndpoint.call(e,n)},e.getDownloadUrls=function(t){return e.getDownloadUrlsEndpoint(t)},e}return d(e,t),e.prototype.uploadEndpoint=function(t,e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!1),p(this,void 0,void 0,(function(){var i,o,a,s,u;return m(this,(function(c){switch(c.label){case 0:if(!(null!=e)&&r)throw Error("Don't set waitUntilAcknowledged to true when you are not uploading a file");return i={overwrite:n},o=this.url(),[4,this.httpClient.post(o,{params:i,data:t})];case 1:return a=c.sent(),s=a.data,null==e?[3,3]:[4,this.uploadFile(s.uploadUrl,e,t.mimeType)];case 2:c.sent(),c.label=3;case 3:return r?[4,this.waitUntilFileIsUploaded(s.id)]:[3,5];case 4:return u=c.sent(),[2,this.addToMapAndReturn(u,a)];case 5:return[2,this.addToMapAndReturn(s,a)]}}))}))},e.prototype.uploadFile=function(t,e,n){var r={"Content-Type":n||"application/octet-stream"};return this.httpClient.put(t,{headers:r,data:e})},e.prototype.waitUntilFileIsUploaded=function(t){return p(this,void 0,void 0,(function(){var e,n,r,i,o;return m(this,(function(a){switch(a.label){case 0:e=10,n=500,r=0,a.label=1;case 1:return[4,this.retrieve([{id:t}])];case 2:return i=g.apply(void 0,[a.sent(),1]),(o=i[0]).uploaded?[2,o]:(r++,[4,S(n)]);case 3:a.sent(),a.label=4;case 4:if(r<e)return[3,1];a.label=5;case 5:throw Error("File never marked as 'uploaded'")}}))}))},e.prototype.getDownloadUrlsEndpoint=function(t){return p(this,void 0,void 0,(function(){var e,n;return m(this,(function(r){switch(r.label){case 0:return e=this.url("downloadlink"),[4,this.httpClient.post(e,{data:{items:t}})];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},e}(K),Et=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.create=function(t){return e.createEndpoint(t)},e.list=function(t){return p(e,void 0,void 0,(function(){var e,n;return m(this,(function(r){switch(r.label){case 0:return e=this.url(),[4,this.httpClient.get(e,{params:t})];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},e.delete=function(n){return t.prototype.deleteEndpoint.call(e,n)},e.listServiceAccounts=function(t){return p(e,void 0,void 0,(function(){var e,n;return m(this,(function(r){switch(r.label){case 0:return e=this.encodeServiceAccountUrl(t),[4,this.httpClient.get(e)];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},e.addServiceAccounts=function(t,n){return p(e,void 0,void 0,(function(){var e,r;return m(this,(function(i){switch(i.label){case 0:return e=this.encodeServiceAccountUrl(t),[4,this.httpClient.post(e,{data:{items:n}})];case 1:return r=i.sent(),[2,this.addToMapAndReturn({},r)]}}))}))},e.removeServiceAccounts=function(t,n){return p(e,void 0,void 0,(function(){var e,r;return m(this,(function(i){switch(i.label){case 0:return e=this.encodeServiceAccountUrl(t)+"/remove",[4,this.httpClient.post(e,{data:{items:n}})];case 1:return r=i.sent(),[2,this.addToMapAndReturn({},r)]}}))}))},e.encodeServiceAccountUrl=function(t){return e.url(t+"/serviceaccounts")},e}return d(e,t),e}(K),Rt=function(t){function e(e,n){var r=t.call(this,"",e,n)||this;return r.status=function(){return C(r.httpClient,{})},r}return d(e,t),e}(K),It=function(t){function e(e,n){var r=t.call(this,"",e,n)||this;return r.getUrl=function(t){return void 0===t&&(t={}),function(t,e){return p(this,void 0,void 0,(function(){var n;return m(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.get("/logout/url",{params:e})];case 1:return[2,r.sent().data.data.url];case 2:if(401===(n=r.sent()).status)return[2,null];throw n;case 3:return[2]}}))}))}(r.httpClient,t)},r}return d(e,t),e}(K),Bt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.retrieve=function(t){return p(e,void 0,void 0,(function(){var e,n;return m(this,(function(r){switch(r.label){case 0:return e=this.encodeUrl(t),[4,this.httpClient.get(e)];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},e.update=function(t,n){return p(e,void 0,void 0,(function(){var e,r;return m(this,(function(i){switch(i.label){case 0:return e=this.encodeUrl(t),[4,this.httpClient.put(e,{data:n})];case 1:return r=i.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},e}return d(e,t),e.prototype.encodeUrl=function(t){return this.url("projects/"+encodeURIComponent(t))},e}(K),At=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d(e,t),e.prototype.insert=function(t,e,n,r){return void 0===r&&(r=!1),p(this,void 0,void 0,(function(){var i;return m(this,(function(o){switch(o.label){case 0:return i=this.encodeUrl(t,e)+"/rows",[4,this.postInParallelWithAutomaticChunking({path:i,items:n,chunkSize:1e4,queryParams:{ensureParent:r}})];case 1:return o.sent(),[2,{}]}}))}))},e.prototype.list=function(e,n,r){var i=this;void 0===r&&(r={});var o=r.onlyRowKeys,a=r.columns,s=h(r,["onlyRowKeys","columns"]);o&&(s.columns=","),a&&(s.columns=a.join(","));var u=this.encodeUrl(e,n)+"/rows";return t.prototype.listEndpoint.call(this,(function(t){return p(i,void 0,void 0,(function(){return m(this,(function(e){return[2,this.httpClient.get(u,{params:t})]}))}))}),s)},e.prototype.retrieve=function(t,e,n){return p(this,void 0,void 0,(function(){var r,i;return m(this,(function(o){switch(o.label){case 0:return r=this.encodeUrl(t,e)+"/rows/"+encodeURIComponent(n),[4,this.httpClient.get(r)];case 1:return i=o.sent(),[2,this.addToMapAndReturn(i.data,i)]}}))}))},e.prototype.delete=function(t,e,n){return p(this,void 0,void 0,(function(){var r;return m(this,(function(i){switch(i.label){case 0:return r=this.encodeUrl(t,e)+"/rows/delete",[4,this.postInParallelWithAutomaticChunking({path:r,items:n})];case 1:return i.sent(),[2,{}]}}))}))},e.prototype.encodeUrl=function(t,e){return this.url(encodeURIComponent(t)+"/tables/"+encodeURIComponent(e))},e}(K),Ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d(e,t),e.prototype.create=function(t,e,n){return void 0===n&&(n=!1),p(this,void 0,void 0,(function(){var r,i;return m(this,(function(o){switch(o.label){case 0:return r=this.encodeUrl(t)+"/tables",[4,this.postInParallelWithAutomaticChunking({queryParams:{ensureParent:n},items:e,path:r})];case 1:return i=o.sent(),[2,this.mergeItemsFromItemsResponse(i)]}}))}))},e.prototype.list=function(e,n){var r=this,i=this.encodeUrl(e)+"/tables";return t.prototype.listEndpoint.call(this,(function(t){return p(r,void 0,void 0,(function(){return m(this,(function(e){return[2,this.httpClient.get(i,{params:t})]}))}))}),n)},e.prototype.delete=function(t,e){var n=this.encodeUrl(t)+"/tables/delete";return this.deleteEndpoint(e,{},n)},e.prototype.encodeUrl=function(t){return this.url(""+encodeURIComponent(t))},e}(K),Ft=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.createDatabases=function(e){return t.prototype.createEndpoint.call(i,e)},i.listDatabases=function(e){return t.prototype.listEndpoint.call(i,i.callListEndpointWithGet,e)},i.deleteDatabases=function(e,n){return t.prototype.deleteEndpoint.call(i,e,n)},i.createTables=function(t,e,n){return void 0===n&&(n=!1),i.rawTablesApi.create(t,e,n)},i.listTables=function(t,e){return i.rawTablesApi.list(t,e)},i.deleteTables=function(t,e){return i.rawTablesApi.delete(t,e)},i.insertRows=function(t,e,n,r){return void 0===r&&(r=!1),i.rawRowsApi.insert(t,e,n,r)},i.listRows=function(t,e,n){return i.rawRowsApi.list(t,e,n)},i.retrieveRow=function(t,e,n){return i.rawRowsApi.retrieve(t,e,n)},i.deleteRows=function(t,e,n){return i.rawRowsApi.delete(t,e,n)},i.rawTablesApi=new Ct(e,n,r),i.rawRowsApi=new At(e,n,r),i}return d(e,t),e}(K),Pt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.create=function(t){return e.createEndpoint(t)},e.list=function(n){return t.prototype.listEndpoint.call(e,e.callListEndpointWithGet,n)},e.delete=function(n){return t.prototype.deleteEndpoint.call(e,n)},e}return d(e,t),e}(K),Nt=function(t){function e(e,n,r){var i=t.apply(this,y(n))||this;return i.rowNumber=e,i.columns=r,i}return d(e,t),e}(Array),Ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d(e,t),e.prototype.insert=function(t){return p(this,void 0,void 0,(function(){return m(this,(function(e){switch(e.label){case 0:return[4,this.postInParallelWithAutomaticChunking({path:this.url(),items:t,chunkSize:1e4})];case 1:return e.sent(),[2,{}]}}))}))},e.prototype.retrieve=function(e){var n=this;return t.prototype.listEndpoint.call(this,(function(t){return n.httpClient.post(n.listPostUrl,{data:t}).then(n.transformRetrieveResponse)}),e)},e.prototype.delete=function(t){return this.deleteEndpoint(t)},e.prototype.transformRetrieveResponse=function(t){var e=t.data,n=e.rows,r=e.nextCursor,i=e.columns,o=n.map((function(t){var e=t.rowNumber,n=t.values;return new Nt(e,n,i)}));return f({},t,{data:{items:o,nextCursor:r}})},e}(K),Ut=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.create=function(e){return t.prototype.createEndpoint.call(i,e)},i.list=function(e){return t.prototype.listEndpoint.call(i,i.callListEndpointWithPost,e)},i.aggregate=function(e){return t.prototype.aggregateEndpoint.call(i,e)},i.retrieve=function(e,n){return void 0===n&&(n={}),t.prototype.retrieveEndpoint.call(i,e,n)},i.update=function(e){return t.prototype.updateEndpoint.call(i,e)},i.search=function(e){return t.prototype.searchEndpoint.call(i,e)},i.delete=function(e){return t.prototype.deleteEndpoint.call(i,e)},i.insertRows=function(t){return i.sequenceRowsAPI.insert(t)},i.retrieveRows=function(t){return i.sequenceRowsAPI.retrieve(t)},i.deleteRows=function(t){return i.sequenceRowsAPI.delete(t)},i.sequenceRowsAPI=new Ot(i.url()+"data",n,r),i}return d(e,t),e}(K),Lt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.create=function(t){return e.createEndpoint(t)},e.list=function(){return p(e,void 0,void 0,(function(){var t,e;return m(this,(function(n){switch(n.label){case 0:return t=this.url(),[4,this.httpClient.get(t)];case 1:return e=n.sent(),[2,this.addToMapAndReturn(e.data.items,e)]}}))}))},e.delete=function(n){return t.prototype.deleteEndpoint.call(e,n)},e}return d(e,t),e}(K),Gt=((nt={})[q.Post]=["/assets/list","/assets/byids","/assets/search","/events/list","/events/byids","/events/search","/files/list","/files/byids","/files/search","/files/initupload","/files/downloadlink","/timeseries/byids","/timeseries/search","/timeseries/data","/timeseries/data/list","/timeseries/data/latest","/timeseries/data/delete"],nt),Dt=function(t,e,n){if(n>=5)return!1;if(!Ht(e.status))return!1;if(Vt(t,e,n))return!0;var r=Gt[t.method]||[];return!!function(t,e){return c.some(e,(function(e){return function(t,e){return-1!==t.toUpperCase().indexOf(e.toUpperCase())}(t,e)}))}(t.path,r)},Vt=function(t,e,n){if(n>=5)return!1;return!(-1===["GET","HEAD","OPTIONS","DELETE","PUT"].indexOf(t.method.toUpperCase()))&&Ht(e.status)};function Ht(t){return c.inRange(t,100,200)||c.inRange(t,429,430)||c.inRange(t,500,600)}var kt=function(t){function e(e){var n=t.call(this,e,Dt)||this;return n.oneTimeHeaders={},n.response401Handler=function(t,e,n){return n()},n}return d(e,t),e.serializeQueryParameters=function(t){return void 0===t&&(t={}),Object.keys(t).reduce((function(e,n){var r=t[n];return e[n]=T(r)?JSON.stringify(r):r,e}),{})},e.transformDateInResponse=function(t){var e=t.data;return T(e)?f({},t,{data:R(e)}):t},e.isSameOrigin=function(t,e){var n=u.parse(t),r=n.protocol,i=n.host,o=u.parse(u.resolve(t,e)),a=o.protocol,s=o.host;return r===a&&i===s},e.filterHeaders=function(t,n){return n.reduce((function(t,n){return e.filterHeader(t,n)}),t)},e.filterHeader=function(t,e){var n=f({},t);return delete n[e],n},e.prototype.addOneTimeHeader=function(t,e){return this.oneTimeHeaders[t]=e,this},e.prototype.setBearerToken=function(t){this.setDefaultHeader("Authorization",_(t))},e.prototype.set401ResponseHandler=function(t){this.response401Handler=t},e.prototype.preRequest=function(t){return p(this,void 0,void 0,(function(){var n,r,i,o,a;return m(this,(function(s){return n=this.populateDefaultHeaders(t.headers),r=t.withCredentials?n:this.preventTokenLeakage(n,t.path),i=E(t.data),o=e.serializeQueryParameters(t.params),a=E(o),[2,f({},t,{data:i,headers:r,params:a})]}))}))},e.prototype.request=function(e){return p(this,void 0,void 0,(function(){return m(this,(function(n){return e.headers=this.enrichWithOneTimeHeaders(e.headers),[2,t.prototype.request.call(this,e)]}))}))},e.prototype.postRequest=function(n,r){return p(this,void 0,void 0,(function(){var i,o,a=this;return m(this,(function(s){switch(s.label){case 0:i=e.transformDateInResponse(n),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,t.prototype.postRequest.call(this,i,r)];case 2:return[2,s.sent()];case 3:if(401===(o=s.sent()).status&&!this.isLoginOrLogoutApi(r.path))return[2,new Promise((function(t,e){a.response401Handler(o,(function(){return t(a.request(r))}),(function(){return e(o)}))}))];throw function(t){var e,n,r,i,o,a;try{e=t.status,n=t.data.error.duplicated,i=t.data.error.message,o=t.data.error.missing,r=t.data.error.extra,a=(t.headers||{})["X-Request-Id"]}catch(s){throw t}throw new X(i,e,a,{duplicated:n,extra:r,missing:o})}(o);case 4:return[2]}}))}))},e.prototype.enrichWithOneTimeHeaders=function(t){var e=this.oneTimeHeaders;return this.oneTimeHeaders={},f({},t,e)},e.prototype.preventTokenLeakage=function(t,n){return e.isSameOrigin(this.baseUrl,n)?t:e.filterHeaders(t,["Authorization","api-key","x-cdp-app","x-cdp-sdk"])},e.prototype.isLoginOrLogoutApi=function(t){var e=t.toLowerCase();return-1!==e.indexOf("/logout/url")||-1!==e.indexOf("/login/status")},e}(function(t){function e(e,n){var r=t.call(this,e)||this;return r.retryValidator=n,r}return d(e,t),e.calculateRetryDelayInMs=function(t){return 250+(Math.pow(2,t)-1)/2*1e3},e.prototype.rawRequest=function(n){return p(this,void 0,void 0,(function(){var r,i;return m(this,(function(o){switch(o.label){case 0:r=0,o.label=1;case 1:return[4,t.prototype.rawRequest.call(this,n)];case 2:return i=o.sent(),this.retryValidator(n,i,r)?[4,S(e.calculateRetryDelayInMs(r))]:[2,i];case 3:o.sent(),r++,o.label=4;case 4:return[3,1];case 5:return[2]}}))}))},e}(et));function zt(t){if(void 0===t)throw Error("Need to login with either loginWithApiKey or loginWithOAuth before you can use the Cognite SDK");return t}function Xt(){throw Error("You cannot re-login with an already logged in Cognite client instance. Try to create a new Cognite client instance instead.")}var Wt=function(){function t(t){var e=this;if(this.projectName="",this.hasBeenLoggedIn=!1,this.authenticate=function(){return p(e,void 0,void 0,(function(){return m(this,(function(t){throw Error("You can only call authenticate after you have called loginWithOAuth")}))}))},this.loginWithApiKey=function(t){if(e.hasBeenLoggedIn&&Xt(),!c.isObject(t))throw Error("`loginWithApiKey` is missing parameter `options`");var n=t.project,r=t.apiKey;["project","apiKey"].forEach((function(e){if(!c.isString(t[e]))throw Error("options."+e+" is required and must be of type string")})),e.projectName=n,e.httpClient.setDefaultHeader("api-key",r),e.initAPIs()},this.loginWithOAuth=function(t){if(e.hasBeenLoggedIn&&Xt(),!c.isObject(t))throw Error("`loginWithOAuth` is missing parameter `options`");var n=t.project;if(!c.isString(n))throw Error("options.project is required and must be of type string");e.projectName=n,I()||console.warn("You should use SSL (https) when you login with OAuth since CDF only allows redirecting back to an HTTPS site");var r=t.onTokens||function(){},i="POPUP"===t.onAuthenticate?Zt:c.isFunction(t.onAuthenticate)?t.onAuthenticate:jt,o=D({project:n,httpClient:e.httpClient,onAuthenticate:i,onTokens:r});e.httpClient.set401ResponseHandler((function(t,n,r){return p(e,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return[4,o()];case 1:return[2,t.sent()?n():r()]}}))}))}));var a=t.accessToken;a&&e.httpClient.setBearerToken(a),e.initAPIs(),e.authenticate=o},this.setBaseUrl=function(t){e.httpClient.setBaseUrl(t)},this.getMetadata=function(t){return e.metadataMap.get(t)},this.get=function(t,n){return e.httpClient.get(t,n)},this.put=function(t,n){return e.httpClient.put(t,n)},this.post=function(t,n){return e.httpClient.post(t,n)},this.delete=function(t,n){return e.httpClient.delete(t,n)},this.patch=function(t,n){return e.httpClient.patch(t,n)},this.initAPIs=function(){var t,n=[e.httpClient,e.metadataMap],r=(t=e.project,"/api/v1/projects/"+encodeURIComponent(t)),i=function(t,e){return new(t.bind.apply(t,y([void 0,r+"/"+e],n)))};e.assetsApi=new(_t.bind.apply(_t,y([void 0,e,r+"/assets"],n))),e.timeSeriesApi=new(gt.bind.apply(gt,y([void 0,e,r+"/timeseries"],n))),e.dataPointsApi=i(wt,"timeseries/data"),e.sequencesApi=i(Ut,"sequences"),e.eventsApi=i(St,"events"),e.filesApi=i(Mt,"files"),e.datasetsApi=i(Tt,"datasets"),e.rawApi=i(Ft,"raw/dbs"),e.groupsApi=i(Et,"groups"),e.securityCategoriesApi=i(Pt,"securitycategories"),e.serviceAccountsApi=i(Lt,"serviceaccounts"),e.apiKeysApi=i(ht,"apikeys"),e.models3DApi=i(ot,"3d/models"),e.revisions3DApi=i(st,"3d/models"),e.files3DApi=i(it,"3d/files"),e.assetMappings3DApi=i($,"3d/models"),e.viewer3DApi=i(ft,"3d"),e.projectsApi=new(Bt.bind.apply(Bt,y([void 0,"/api/v1"],n))),e.loginApi=new(Rt.bind.apply(Rt,y([void 0],n)))},!c.isObject(t))throw Error("`CogniteClient` is missing parameter `options`");if(!c.isString(t.appId))throw Error("options.appId is required and must be of type string");var n=t.baseUrl;this.httpClient=new kt(x(n)),this.httpClient.setDefaultHeader("x-cdp-sdk","CogniteJavaScriptSDK:2.28.0").setDefaultHeader("x-cdp-app",t.appId),this.metadataMap=new V,this.loginApi=new Rt(this.httpClient,this.metadataMap),this.logoutApi=new It(this.httpClient,this.metadataMap)}return Object.defineProperty(t.prototype,"assets",{get:function(){return zt(this.assetsApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeseries",{get:function(){return zt(this.timeSeriesApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"datapoints",{get:function(){return zt(this.dataPointsApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sequences",{get:function(){return zt(this.sequencesApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return zt(this.eventsApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"files",{get:function(){return zt(this.filesApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return zt(this.rawApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"projects",{get:function(){return zt(this.projectsApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groups",{get:function(){return zt(this.groupsApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"securityCategories",{get:function(){return zt(this.securityCategoriesApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serviceAccounts",{get:function(){return zt(this.serviceAccountsApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"models3D",{get:function(){return zt(this.models3DApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"revisions3D",{get:function(){return zt(this.revisions3DApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"files3D",{get:function(){return zt(this.files3DApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"datasets",{get:function(){return zt(this.datasetsApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"assetMappings3D",{get:function(){return zt(this.assetMappings3DApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewer3D",{get:function(){return zt(this.viewer3DApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiKeys",{get:function(){return zt(this.apiKeysApi)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"login",{get:function(){return this.loginApi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logout",{get:function(){return this.logoutApi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"project",{get:function(){return this.projectName},enumerable:!0,configurable:!0}),t.prototype.getBaseUrl=function(){return this.httpClient.getBaseUrl()},t.prototype.getDefaultRequestHeaders=function(){return f({},this.httpClient.getDefaultHeaders())},t.prototype.setOneTimeSdkHeader=function(t){this.httpClient.addOneTimeHeader("x-cdp-sdk",t)},t}();function jt(t){t.redirect({redirectUrl:window.location.href})}function Zt(t){t.popup({redirectUrl:window.location.href})}e.loginPopupHandler=function(){if(O())try{var t=U(window.location.search);window.opener.postMessage(t)}catch(e){window.opener.postMessage({error:e.message})}finally{window.close()}},e.isLoginPopupWindow=O,e.CogniteClient=Wt,e.POPUP="POPUP",e.REDIRECT="REDIRECT",e.CogniteError=X,e.CogniteMultiError=j,e.CogniteLoginError=b,e.HttpError=tt,e.AssetClass=bt,e.TimeSeriesClass=mt,e.AssetList=yt,e.TimeSeriesList=vt,e.SequenceValueType={STRING:"STRING",DOUBLE:"DOUBLE",LONG:"LONG"},e.SortOrder={ASC:"asc",DESC:"desc"}},function(t,e,n){"use strict";var r,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};!function(t){t[t.NONE=0]="NONE",t[t.ROTATE=1]="ROTATE",t[t.TRUCK=2]="TRUCK",t[t.DOLLY=3]="DOLLY",t[t.ZOOM=4]="ZOOM",t[t.TOUCH_ROTATE=5]="TOUCH_ROTATE",t[t.TOUCH_TRUCK=6]="TOUCH_TRUCK",t[t.TOUCH_DOLLY=7]="TOUCH_DOLLY",t[t.TOUCH_ZOOM=8]="TOUCH_ZOOM",t[t.TOUCH_DOLLY_TRUCK=9]="TOUCH_DOLLY_TRUCK",t[t.TOUCH_ZOOM_TRUCK=10]="TOUCH_ZOOM_TRUCK"}(r||(r={}));var o=2*Math.PI,a=Math.PI/2;function s(t){return Math.abs(t)<1e-5}function u(t,e){return Math.round(t/e)*e}function c(t){return isFinite(t)?t:t<0?-Number.MAX_VALUE:Number.MAX_VALUE}function l(t){return Math.abs(t)<Number.MAX_VALUE?t:t*(1/0)}function d(t){return"TouchEvent"in window&&t instanceof TouchEvent}function f(t,e){if(e.set(0,0),d(t)){for(var n=t,r=0;r<n.touches.length;r++)e.x+=n.touches[r].clientX,e.y+=n.touches[r].clientY;return e.x/=n.touches.length,e.y/=n.touches.length,e}var i=t;return e.set(i.clientX,i.clientY),e}function h(t,e){return!t.isPerspectiveCamera&&(console.warn(e+" is not supported in OrthographicCamera"),!0)}var p,m,v,g,y,b,x,_,w,T,S,M,E,R,I,B,A,C=function(){function t(){this._listeners={}}return t.prototype.addEventListener=function(t,e){var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},t.prototype.removeEventListener=function(t,e){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}},t.prototype.removeAllEventListeners=function(t){t?Array.isArray(this._listeners[t])&&(this._listeners[t].length=0):this._listeners={}},t.prototype.dispatchEvent=function(t){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}},t}(),F=/Mac/.test(navigator.platform),P=Object.freeze(r),N=function(t){function e(e,n){var i=t.call(this)||this;if(i.enabled=!0,i.minPolarAngle=0,i.maxPolarAngle=Math.PI,i.minAzimuthAngle=-1/0,i.maxAzimuthAngle=1/0,i.minDistance=0,i.maxDistance=1/0,i.minZoom=.01,i.maxZoom=1/0,i.dampingFactor=.05,i.draggingDampingFactor=.25,i.azimuthRotateSpeed=1,i.polarRotateSpeed=1,i.dollySpeed=1,i.truckSpeed=2,i.dollyToCursor=!1,i.verticalDragToForward=!1,i.boundaryFriction=0,i.colliderMeshes=[],i._state=r.NONE,i._viewport=null,i._dollyControlAmount=0,i._boundaryEnclosesCamera=!1,i._needsUpdate=!0,i._updatedLastTime=!1,i._camera=e,i._yAxisUpSpace=(new p.Quaternion).setFromUnitVectors(i._camera.up,v),i._yAxisUpSpaceInverse=i._yAxisUpSpace.clone().inverse(),i._state=r.NONE,i._domElement=n,i._target=new p.Vector3,i._targetEnd=i._target.clone(),i._spherical=(new p.Spherical).setFromVector3(b.copy(i._camera.position).applyQuaternion(i._yAxisUpSpace)),i._sphericalEnd=i._spherical.clone(),i._zoom=i._camera.zoom,i._zoomEnd=i._zoom,i._nearPlaneCorners=[new p.Vector3,new p.Vector3,new p.Vector3,new p.Vector3],i._updateNearPlaneCorners(),i._boundary=new p.Box3(new p.Vector3(-1/0,-1/0,-1/0),new p.Vector3(1/0,1/0,1/0)),i._target0=i._target.clone(),i._position0=i._camera.position.clone(),i._zoom0=i._zoom,i._dollyControlAmount=0,i._dollyControlCoord=new p.Vector2,i.mouseButtons={left:r.ROTATE,middle:r.DOLLY,right:r.TRUCK,wheel:i._camera.isPerspectiveCamera?r.DOLLY:i._camera.isOrthographicCamera?r.ZOOM:r.NONE},i.touches={one:r.TOUCH_ROTATE,two:i._camera.isPerspectiveCamera?r.TOUCH_DOLLY_TRUCK:i._camera.isOrthographicCamera?r.TOUCH_ZOOM_TRUCK:r.NONE,three:r.TOUCH_TRUCK},i._domElement){var a=new p.Vector2,s=new p.Vector2,u=new p.Vector2,c=new p.Vector4,l=function(t,e){if(i._camera.isPerspectiveCamera){var n=i._camera,r=b.copy(n.position).sub(i._target),o=n.getEffectiveFOV()*p.Math.DEG2RAD,a=r.length()*Math.tan(.5*o),s=i.truckSpeed*t*a/c.w,u=i.truckSpeed*e*a/c.w;i.verticalDragToForward?(i.truck(s,0,!0),i.forward(-u,!0)):i.truck(s,u,!0)}else if(i._camera.isOrthographicCamera){var l=i._camera;s=t*(l.right-l.left)/l.zoom/c.z,u=e*(l.top-l.bottom)/l.zoom/c.w;i.truck(s,u,!0)}},h=function(t,e){var n=o*i.azimuthRotateSpeed*t/c.w,r=o*i.polarRotateSpeed*e/c.w;i.rotate(n,r,!0)},m=function(t,e,n){var r=Math.pow(.95,-t*i.dollySpeed),o=i._sphericalEnd.radius*r,a=i._sphericalEnd.radius;i.dollyTo(o),i.dollyToCursor&&(i._dollyControlAmount+=i._sphericalEnd.radius-a,i._dollyControlCoord.set(e,n))},g=function(t){var e=Math.pow(.95,t*i.dollySpeed);i.zoomTo(i._zoom*e)},x=function(t){if(i.enabled){t.preventDefault();var e=i._state;switch(t.button){case p.MOUSE.LEFT:i._state=i.mouseButtons.left;break;case p.MOUSE.MIDDLE:i._state=i.mouseButtons.middle;break;case p.MOUSE.RIGHT:i._state=i.mouseButtons.right}e!==i._state&&M(t)}},_=function(t){if(i.enabled){t.preventDefault();var e=i._state;switch(t.touches.length){case 1:i._state=i.touches.one;break;case 2:i._state=i.touches.two;break;case 3:i._state=i.touches.three}e!==i._state&&M(t)}},w=-1,T=function(t){if(i.enabled&&i.mouseButtons.wheel!==r.NONE){if(t.preventDefault(),i.dollyToCursor||i.mouseButtons.wheel===r.ROTATE||i.mouseButtons.wheel===r.TRUCK){var e=performance.now();w-e<1e3&&i._getClientRect(c),w=e}var n=F?-1:-3,o=1===t.deltaMode?t.deltaY/n:t.deltaY/(10*n),a=i.dollyToCursor?(t.clientX-c.x)/c.z*2-1:0,s=i.dollyToCursor?(t.clientY-c.y)/c.w*-2+1:0;switch(i.mouseButtons.wheel){case r.ROTATE:h(t.deltaX,t.deltaY);break;case r.TRUCK:l(t.deltaX,t.deltaY);break;case r.DOLLY:m(-o,a,s);break;case r.ZOOM:g(-o)}i.dispatchEvent({type:"control",originalEvent:t})}},S=function(t){i.enabled&&t.preventDefault()},M=function(t){if(i.enabled){if(t.preventDefault(),f(t,y),i._getClientRect(c),a.copy(y),s.copy(y),d(t)&&t.touches.length>=2){var e=t,n=y.x-e.touches[1].clientX,r=y.y-e.touches[1].clientY,o=Math.sqrt(n*n+r*r);u.set(0,o);var l=.5*(e.touches[0].clientX+e.touches[1].clientX),h=.5*(e.touches[0].clientY+e.touches[1].clientY);s.set(l,h)}document.addEventListener("mousemove",E),document.addEventListener("touchmove",E,{passive:!1}),document.addEventListener("mouseup",R),document.addEventListener("touchend",R),i.dispatchEvent({type:"controlstart",originalEvent:t})}},E=function(t){if(i.enabled){t.preventDefault(),f(t,y);var e=s.x-y.x,n=s.y-y.y;switch(s.copy(y),i._state){case r.ROTATE:case r.TOUCH_ROTATE:h(e,n);break;case r.DOLLY:case r.ZOOM:var o=i.dollyToCursor?(a.x-c.x)/c.z*2-1:0,d=i.dollyToCursor?(a.y-c.y)/c.w*-2+1:0;i._state===r.DOLLY?m(n*(1/8),o,d):g(n*(1/8));break;case r.TOUCH_DOLLY:case r.TOUCH_ZOOM:case r.TOUCH_DOLLY_TRUCK:case r.TOUCH_ZOOM_TRUCK:var p=t,v=y.x-p.touches[1].clientX,b=y.y-p.touches[1].clientY,x=Math.sqrt(v*v+b*b),_=u.y-x;u.set(0,x);o=i.dollyToCursor?(s.x-c.x)/c.z*2-1:0,d=i.dollyToCursor?(s.y-c.y)/c.w*-2+1:0;i._state===r.TOUCH_DOLLY||i._state===r.TOUCH_DOLLY_TRUCK?m(_*(1/8),o,d):g(_*(1/8)),i._state!==r.TOUCH_DOLLY_TRUCK&&i._state!==r.TOUCH_ZOOM_TRUCK||l(e,n);break;case r.TRUCK:case r.TOUCH_TRUCK:l(e,n)}i.dispatchEvent({type:"control",originalEvent:t})}},R=function t(e){i.enabled&&(i._state=r.NONE,document.removeEventListener("mousemove",E),document.removeEventListener("touchmove",E,{passive:!1}),document.removeEventListener("mouseup",t),document.removeEventListener("touchend",t),i.dispatchEvent({type:"controlend",originalEvent:e}))};i._domElement.addEventListener("mousedown",x),i._domElement.addEventListener("touchstart",_),i._domElement.addEventListener("wheel",T),i._domElement.addEventListener("contextmenu",S),i._removeAllEventListeners=function(){i._domElement.removeEventListener("mousedown",x),i._domElement.removeEventListener("touchstart",_),i._domElement.removeEventListener("wheel",T),i._domElement.removeEventListener("contextmenu",S),document.removeEventListener("mousemove",E),document.removeEventListener("touchmove",E,{passive:!1}),document.removeEventListener("mouseup",R),document.removeEventListener("touchend",R)}}return i.update(0),i}return function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.install=function(t){p=t.THREE,m=Object.freeze(new p.Vector3(0,0,0)),v=Object.freeze(new p.Vector3(0,1,0)),g=Object.freeze(new p.Vector3(0,0,1)),y=new p.Vector2,b=new p.Vector3,x=new p.Vector3,_=new p.Vector3,w=new p.Vector3,T=new p.Vector3,S=new p.Spherical,M=new p.Spherical,E=new p.Box3,R=new p.Box3,I=new p.Quaternion,B=new p.Matrix4,A=new p.Raycaster},Object.defineProperty(e,"ACTION",{get:function(){return P},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._spherical.radius},set:function(t){this._spherical.radius===t&&this._sphericalEnd.radius===t||(this._spherical.radius=t,this._sphericalEnd.radius=t,this._needsUpdate=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"azimuthAngle",{get:function(){return this._spherical.theta},set:function(t){this._spherical.theta===t&&this._sphericalEnd.theta===t||(this._spherical.theta=t,this._sphericalEnd.theta=t,this._needsUpdate=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"polarAngle",{get:function(){return this._spherical.phi},set:function(t){this._spherical.phi===t&&this._sphericalEnd.phi===t||(this._spherical.phi=t,this._sphericalEnd.phi=t,this._needsUpdate=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"phiSpeed",{set:function(t){console.warn("phiSpeed was renamed. use azimuthRotateSpeed instead"),this.azimuthRotateSpeed=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thetaSpeed",{set:function(t){console.warn("thetaSpeed was renamed. use polarRotateSpeed instead"),this.polarRotateSpeed=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boundaryEnclosesCamera",{get:function(){return this._boundaryEnclosesCamera},set:function(t){this._boundaryEnclosesCamera=t,this._needsUpdate=!0},enumerable:!0,configurable:!0}),e.prototype.rotate=function(t,e,n){void 0===n&&(n=!1),this.rotateTo(this._sphericalEnd.theta+t,this._sphericalEnd.phi+e,n)},e.prototype.rotateTo=function(t,e,n){void 0===n&&(n=!1);var r=p.Math.clamp(t,this.minAzimuthAngle,this.maxAzimuthAngle),i=p.Math.clamp(e,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=r,this._sphericalEnd.phi=i,this._sphericalEnd.makeSafe(),n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi),this._needsUpdate=!0},e.prototype.dolly=function(t,e){void 0===e&&(e=!1),this.dollyTo(this._sphericalEnd.radius-t,e)},e.prototype.dollyTo=function(t,e){void 0===e&&(e=!1),h(this._camera,"dolly")||(this._sphericalEnd.radius=p.Math.clamp(t,this.minDistance,this.maxDistance),e||(this._spherical.radius=this._sphericalEnd.radius),this._needsUpdate=!0)},e.prototype.zoom=function(t,e){void 0===e&&(e=!1),this.zoomTo(this._zoomEnd+t,e)},e.prototype.zoomTo=function(t,e){void 0===e&&(e=!1),this._zoomEnd=p.Math.clamp(t,this.minZoom,this.maxZoom),e||(this._zoom=this._zoomEnd),this._needsUpdate=!0},e.prototype.pan=function(t,e,n){void 0===n&&(n=!1),console.log("`pan` has been renamed to `truck`"),this.truck(t,e,n)},e.prototype.truck=function(t,e,n){void 0===n&&(n=!1),this._camera.updateMatrix(),w.setFromMatrixColumn(this._camera.matrix,0),T.setFromMatrixColumn(this._camera.matrix,1),w.multiplyScalar(t),T.multiplyScalar(-e);var r=b.copy(w).add(T);this._encloseToBoundary(this._targetEnd,r,this.boundaryFriction),n||this._target.copy(this._targetEnd),this._needsUpdate=!0},e.prototype.forward=function(t,e){void 0===e&&(e=!1),b.setFromMatrixColumn(this._camera.matrix,0),b.crossVectors(this._camera.up,b),b.multiplyScalar(t),this._encloseToBoundary(this._targetEnd,b,this.boundaryFriction),e||this._target.copy(this._targetEnd),this._needsUpdate=!0},e.prototype.moveTo=function(t,e,n,r){void 0===r&&(r=!1),this._targetEnd.set(t,e,n),r||this._target.copy(this._targetEnd),this._needsUpdate=!0},e.prototype.fitTo=function(t,e,n){var r=void 0===n?{}:n,i=r.paddingLeft,o=void 0===i?0:i,s=r.paddingRight,c=void 0===s?0:s,l=r.paddingBottom,d=void 0===l?0:l,f=r.paddingTop,p=void 0===f?0:f;if(!h(this._camera,"fitTo")){var m=t.isBox3?E.copy(t):E.setFromObject(t),v=u(this._sphericalEnd.theta,a),y=u(this._sphericalEnd.phi,a);this.rotateTo(v,y,e);var _=b.setFromSpherical(this._sphericalEnd).normalize(),w=I.setFromUnitVectors(_,g),T=R.makeEmpty();x.copy(m.min).applyQuaternion(w),T.expandByPoint(x),x.copy(m.min).setX(m.max.x).applyQuaternion(w),T.expandByPoint(x),x.copy(m.min).setY(m.max.y).applyQuaternion(w),T.expandByPoint(x),x.copy(m.max).setZ(m.min.z).applyQuaternion(w),T.expandByPoint(x),x.copy(m.min).setZ(m.max.z).applyQuaternion(w),T.expandByPoint(x),x.copy(m.max).setY(m.min.y).applyQuaternion(w),T.expandByPoint(x),x.copy(m.max).setX(m.min.x).applyQuaternion(w),T.expandByPoint(x),x.copy(m.max).applyQuaternion(w),T.expandByPoint(x),w.setFromUnitVectors(g,_),T.min.x-=o,T.min.y-=d,T.max.x+=c,T.max.y+=p;var S=T.getSize(x),M=this.getDistanceToFit(S.x,S.y,S.z),B=T.getCenter(x).applyQuaternion(w);this.moveTo(B.x,B.y,B.z,e),this.dollyTo(M,e)}},e.prototype.setLookAt=function(t,e,n,r,i,o,a){void 0===a&&(a=!1);var s=b.set(t,e,n),u=x.set(r,i,o);this._targetEnd.copy(u),this._sphericalEnd.setFromVector3(s.sub(u).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),a||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd)),this._needsUpdate=!0},e.prototype.lerpLookAt=function(t,e,n,r,i,o,a,s,u,c,l,d,f,h){void 0===h&&(h=!1);var p=b.set(t,e,n),m=x.set(r,i,o);S.setFromVector3(p.sub(m).applyQuaternion(this._yAxisUpSpace));var v=b.set(c,l,d);this._targetEnd.copy(m).lerp(v,f);var g=x.set(a,s,u);M.setFromVector3(g.sub(v).applyQuaternion(this._yAxisUpSpace));var y=M.theta-S.theta,_=M.phi-S.phi,w=M.radius-S.radius;this._sphericalEnd.set(S.radius+w*f,S.phi+_*f,S.theta+y*f),this.normalizeRotations(),h||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd)),this._needsUpdate=!0},e.prototype.setPosition=function(t,e,n,r){void 0===r&&(r=!1),this.setLookAt(t,e,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,r)},e.prototype.setTarget=function(t,e,n,r){void 0===r&&(r=!1);var i=this.getPosition(b);this.setLookAt(i.x,i.y,i.z,t,e,n,r)},e.prototype.setBoundary=function(t){if(!t)return this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),void(this._needsUpdate=!0);this._boundary.copy(t),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0},e.prototype.setViewport=function(t,e,n,r){null!==t?(this._viewport=this._viewport||new p.Vector4,"number"===typeof t?this._viewport.set(t,e,n,r):this._viewport.copy(t)):this._viewport=null},e.prototype.getDistanceToFit=function(t,e,n){if(h(this._camera,"getDistanceToFit"))return this._spherical.radius;var r=this._camera,i=t/e,o=r.getEffectiveFOV()*p.Math.DEG2RAD,a=r.aspect;return.5*(i<a?e:t/a)/Math.tan(.5*o)+.5*n},e.prototype.getTarget=function(t){return(t&&t.isVector3?t:new p.Vector3).copy(this._targetEnd)},e.prototype.getPosition=function(t){return(t&&t.isVector3?t:new p.Vector3).setFromSpherical(this._sphericalEnd).applyQuaternion(this._yAxisUpSpaceInverse).add(this._targetEnd)},e.prototype.normalizeRotations=function(){this._sphericalEnd.theta=this._sphericalEnd.theta%o,this._spherical.theta+=o*Math.round((this._sphericalEnd.theta-this._spherical.theta)/o)},e.prototype.reset=function(t){void 0===t&&(t=!1),this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,t),this.zoomTo(this._zoom0,t)},e.prototype.saveState=function(){this._target0.copy(this._target),this._position0.copy(this._camera.position),this._zoom0=this._zoom},e.prototype.updateCameraUp=function(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,v),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).inverse()},e.prototype.update=function(t){var e=this._state===r.NONE?this.dampingFactor:this.draggingDampingFactor,n=1-Math.exp(-e*t*62.5),i=this._sphericalEnd.theta-this._spherical.theta,o=this._sphericalEnd.phi-this._spherical.phi,a=this._sphericalEnd.radius-this._spherical.radius,u=b.subVectors(this._targetEnd,this._target);if(s(i)&&s(o)&&s(a)&&s(u.x)&&s(u.y)&&s(u.z)?(this._spherical.copy(this._sphericalEnd),this._target.copy(this._targetEnd)):(this._spherical.set(this._spherical.radius+a*n,this._spherical.phi+o*n,this._spherical.theta+i*n),this._target.add(u.multiplyScalar(n)),this._needsUpdate=!0),0!==this._dollyControlAmount){if(this._camera.isPerspectiveCamera){var c=this._camera,l=b.setFromSpherical(this._sphericalEnd).applyQuaternion(this._yAxisUpSpaceInverse).normalize().negate(),d=x.copy(l).cross(c.up).normalize();0===d.lengthSq()&&(d.x=1);var f=_.crossVectors(d,l),h=this._sphericalEnd.radius*Math.tan(c.getEffectiveFOV()*p.Math.DEG2RAD*.5),m=(this._sphericalEnd.radius-this._dollyControlAmount-this._sphericalEnd.radius)/this._sphericalEnd.radius,v=b.copy(this._targetEnd).add(d.multiplyScalar(this._dollyControlCoord.x*h*c.aspect)).add(f.multiplyScalar(this._dollyControlCoord.y*h));this._targetEnd.lerp(v,m),this._target.copy(this._targetEnd)}this._dollyControlAmount=0}var g=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,g),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),b.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);var y=this._zoomEnd-this._zoom;this._zoom+=y*n,this._camera.zoom!==this._zoom&&(s(y)&&(this._zoom=this._zoomEnd),this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0);var w=this._needsUpdate;return w&&!this._updatedLastTime?(this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):w?this.dispatchEvent({type:"update"}):!w&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._updatedLastTime=w,this._needsUpdate=!1,w},e.prototype.toJSON=function(){return JSON.stringify({enabled:this.enabled,minDistance:this.minDistance,maxDistance:c(this.maxDistance),minZoom:this.minZoom,maxZoom:c(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:c(this.maxPolarAngle),minAzimuthAngle:c(this.minAzimuthAngle),maxAzimuthAngle:c(this.maxAzimuthAngle),dampingFactor:this.dampingFactor,draggingDampingFactor:this.draggingDampingFactor,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:this._camera.position.toArray(),zoom:this._camera.zoom,target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0})},e.prototype.fromJSON=function(t,e){void 0===e&&(e=!1);var n=JSON.parse(t),r=b.fromArray(n.position);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=l(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=l(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=l(n.maxPolarAngle),this.minAzimuthAngle=l(n.minAzimuthAngle),this.maxAzimuthAngle=l(n.maxAzimuthAngle),this.dampingFactor=n.dampingFactor,this.draggingDampingFactor=n.draggingDampingFactor,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this.verticalDragToForward=n.verticalDragToForward,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this.moveTo(n.target[0],n.target[1],n.target[2],e),S.setFromVector3(r.sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(S.theta,S.phi,e),this.zoomTo(n.zoom,e),this._needsUpdate=!0},e.prototype.dispose=function(){this._removeAllEventListeners()},e.prototype._encloseToBoundary=function(t,e,n){var r=e.lengthSq();if(0===r)return t;var i=x.copy(e).add(t),o=this._boundary.clampPoint(i,_).sub(i),a=o.lengthSq();if(0===a)return t.add(e);if(a===r)return t;if(0===n)return t.add(e).add(o);var s=1+n*a/e.dot(o);return t.add(x.copy(e).multiplyScalar(s)).add(o.multiplyScalar(1-n))},e.prototype._updateNearPlaneCorners=function(){if(this._camera.isPerspectiveCamera){var t=(i=this._camera).near,e=i.getEffectiveFOV()*p.Math.DEG2RAD,n=Math.tan(.5*e)*t,r=n*i.aspect;this._nearPlaneCorners[0].set(-r,-n,0),this._nearPlaneCorners[1].set(r,-n,0),this._nearPlaneCorners[2].set(r,n,0),this._nearPlaneCorners[3].set(-r,n,0)}else if(this._camera.isOrthographicCamera){var i,o=1/(i=this._camera).zoom,a=i.left*o,s=i.right*o,u=i.top*o,c=i.bottom*o;this._nearPlaneCorners[0].set(a,u,0),this._nearPlaneCorners[1].set(s,u,0),this._nearPlaneCorners[2].set(s,c,0),this._nearPlaneCorners[3].set(a,c,0)}},e.prototype._collisionTest=function(){var t=1/0;if(!(this.colliderMeshes.length>=1))return t;if(h(this._camera,"_collisionTest"))return t;t=this._spherical.radius;var e=b.setFromSpherical(this._spherical).divideScalar(t);B.lookAt(m,e,this._camera.up);for(var n=0;n<4;n++){var r=x.copy(this._nearPlaneCorners[n]);r.applyMatrix4(B);var i=_.addVectors(this._target,r);A.set(i,e),A.far=t;var o=A.intersectObjects(this.colliderMeshes);0!==o.length&&o[0].distance<t&&(t=o[0].distance)}return t},e.prototype._getClientRect=function(t){var e=this._domElement.getBoundingClientRect();return t.x=e.left,t.y=e.top,this._viewport?(t.x+=this._viewport.x,t.y+=e.height-this._viewport.w-this._viewport.y,t.z=this._viewport.z,t.w=this._viewport.w):(t.z=e.width,t.w=e.height),t},e.prototype._removeAllEventListeners=function(){},e}(C);e.a=N},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(121),i=n(122),o=n(80),a=n(123);t.exports=function(t,e){return r(t)||i(t,e)||o(t,e)||a()}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}},function(t,e,n){var r=n(124),i=n(125),o=n(80),a=n(126);t.exports=function(t){return r(t)||i(t)||o(t)||a()}},function(t,e,n){var r=n(91);t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e,n){var r=n(82),i=n(93),o=n(127);t.exports=function(t){return function(){var e,n=r(t);if(i()){var a=r(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return o(this,e)}}},function(t,e){t.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}},function(t,e){function n(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}t.exports=function(t){return function(){var e=this,r=arguments;return new Promise((function(i,o){var a=t.apply(e,r);function s(t){n(a,i,o,s,u,"next",t)}function u(t){n(a,i,o,s,u,"throw",t)}s(void 0)}))}}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e,n){var r=n(80);t.exports=function(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=r(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,a=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}},function(t,e,n){"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE){0;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}}(),t.exports=n(102)},function(t,e,n){"use strict";function r(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function s(t){r(a,i,o,s,u,"next",t)}function u(t){r(a,i,o,s,u,"throw",t)}s(void 0)}))}}n.d(e,"a",(function(){return i}))},,function(t,e,n){"use strict";var r=n(79),i="function"===typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,a=i?Symbol.for("react.portal"):60106,s=i?Symbol.for("react.fragment"):60107,u=i?Symbol.for("react.strict_mode"):60108,c=i?Symbol.for("react.profiler"):60114,l=i?Symbol.for("react.provider"):60109,d=i?Symbol.for("react.context"):60110,f=i?Symbol.for("react.forward_ref"):60112,h=i?Symbol.for("react.suspense"):60113,p=i?Symbol.for("react.memo"):60115,m=i?Symbol.for("react.lazy"):60116,v="function"===typeof Symbol&&Symbol.iterator;function g(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function x(t,e,n){this.props=t,this.context=e,this.refs=b,this.updater=n||y}function _(){}function w(t,e,n){this.props=t,this.context=e,this.refs=b,this.updater=n||y}x.prototype.isReactComponent={},x.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error(g(85));this.updater.enqueueSetState(this,t,e,"setState")},x.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},_.prototype=x.prototype;var T=w.prototype=new _;T.constructor=w,r(T,x.prototype),T.isPureReactComponent=!0;var S={current:null},M=Object.prototype.hasOwnProperty,E={key:!0,ref:!0,__self:!0,__source:!0};function R(t,e,n){var r,i={},a=null,s=null;if(null!=e)for(r in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)M.call(e,r)&&!E.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(r in u=t.defaultProps)void 0===i[r]&&(i[r]=u[r]);return{$$typeof:o,type:t,key:a,ref:s,props:i,_owner:S.current}}function I(t){return"object"===typeof t&&null!==t&&t.$$typeof===o}var B=/\/+/g,A=[];function C(t,e,n,r){if(A.length){var i=A.pop();return i.result=t,i.keyPrefix=e,i.func=n,i.context=r,i.count=0,i}return{result:t,keyPrefix:e,func:n,context:r,count:0}}function F(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>A.length&&A.push(t)}function P(t,e,n){return null==t?0:function t(e,n,r,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case o:case a:u=!0}}if(u)return r(i,e,""===n?"."+N(e,0):n),1;if(u=0,n=""===n?".":n+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=n+N(s=e[c],c);u+=t(s,l,r,i)}else if(null===e||"object"!==typeof e?l=null:l="function"===typeof(l=v&&e[v]||e["@@iterator"])?l:null,"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=t(s=s.value,l=n+N(s,c++),r,i);else if("object"===s)throw r=""+e,Error(g(31,"[object Object]"===r?"object with keys {"+Object.keys(e).join(", ")+"}":r,""));return u}(t,"",e,n)}function N(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function O(t,e){t.func.call(t.context,e,t.count++)}function U(t,e,n){var r=t.result,i=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?L(t,r,n,(function(t){return t})):null!=t&&(I(t)&&(t=function(t,e){return{$$typeof:o,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,i+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(B,"$&/")+"/")+n)),r.push(t))}function L(t,e,n,r,i){var o="";null!=n&&(o=(""+n).replace(B,"$&/")+"/"),P(t,U,e=C(e,o,r,i)),F(e)}var G={current:null};function D(){var t=G.current;if(null===t)throw Error(g(321));return t}var V={ReactCurrentDispatcher:G,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:S,IsSomeRendererActing:{current:!1},assign:r};e.Children={map:function(t,e,n){if(null==t)return t;var r=[];return L(t,r,null,e,n),r},forEach:function(t,e,n){if(null==t)return t;P(t,O,e=C(null,null,e,n)),F(e)},count:function(t){return P(t,(function(){return null}),null)},toArray:function(t){var e=[];return L(t,e,null,(function(t){return t})),e},only:function(t){if(!I(t))throw Error(g(143));return t}},e.Component=x,e.Fragment=s,e.Profiler=c,e.PureComponent=w,e.StrictMode=u,e.Suspense=h,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V,e.cloneElement=function(t,e,n){if(null===t||void 0===t)throw Error(g(267,t));var i=r({},t.props),a=t.key,s=t.ref,u=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,u=S.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(l in e)M.call(e,l)&&!E.hasOwnProperty(l)&&(i[l]=void 0===e[l]&&void 0!==c?c[l]:e[l])}var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){c=Array(l);for(var d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}return{$$typeof:o,type:t.type,key:a,ref:s,props:i,_owner:u}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:d,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:l,_context:t},t.Consumer=t},e.createElement=R,e.createFactory=function(t){var e=R.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:f,render:t}},e.isValidElement=I,e.lazy=function(t){return{$$typeof:m,_ctor:t,_status:-1,_result:null}},e.memo=function(t,e){return{$$typeof:p,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return D().useCallback(t,e)},e.useContext=function(t,e){return D().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return D().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return D().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return D().useLayoutEffect(t,e)},e.useMemo=function(t,e){return D().useMemo(t,e)},e.useReducer=function(t,e,n){return D().useReducer(t,e,n)},e.useRef=function(t){return D().useRef(t)},e.useState=function(t){return D().useState(t)},e.version="16.13.1"},function(t,e,n){"use strict";var r=n(15),i=n(79),o=n(103);function a(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(a(227));function s(t,e,n,r,i,o,a,s,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(l){this.onError(l)}}var u=!1,c=null,l=!1,d=null,f={onError:function(t){u=!0,c=t}};function h(t,e,n,r,i,o,a,l,d){u=!1,c=null,s.apply(f,arguments)}var p=null,m=null,v=null;function g(t,e,n){var r=t.type||"unknown-event";t.currentTarget=v(n),function(t,e,n,r,i,o,s,f,p){if(h.apply(this,arguments),u){if(!u)throw Error(a(198));var m=c;u=!1,c=null,l||(l=!0,d=m)}}(r,e,void 0,t),t.currentTarget=null}var y=null,b={};function x(){if(y)for(var t in b){var e=b[t],n=y.indexOf(t);if(!(-1<n))throw Error(a(96,t));if(!w[n]){if(!e.extractEvents)throw Error(a(97,t));for(var r in w[n]=e,n=e.eventTypes){var i=void 0,o=n[r],s=e,u=r;if(T.hasOwnProperty(u))throw Error(a(99,u));T[u]=o;var c=o.phasedRegistrationNames;if(c){for(i in c)c.hasOwnProperty(i)&&_(c[i],s,u);i=!0}else o.registrationName?(_(o.registrationName,s,u),i=!0):i=!1;if(!i)throw Error(a(98,r,t))}}}}function _(t,e,n){if(S[t])throw Error(a(100,t));S[t]=e,M[t]=e.eventTypes[n].dependencies}var w=[],T={},S={},M={};function E(t){var e,n=!1;for(e in t)if(t.hasOwnProperty(e)){var r=t[e];if(!b.hasOwnProperty(e)||b[e]!==r){if(b[e])throw Error(a(102,e));b[e]=r,n=!0}}n&&x()}var R=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),I=null,B=null,A=null;function C(t){if(t=m(t)){if("function"!==typeof I)throw Error(a(280));var e=t.stateNode;e&&(e=p(e),I(t.stateNode,t.type,e))}}function F(t){B?A?A.push(t):A=[t]:B=t}function P(){if(B){var t=B,e=A;if(A=B=null,C(t),e)for(t=0;t<e.length;t++)C(e[t])}}function N(t,e){return t(e)}function O(t,e,n,r,i){return t(e,n,r,i)}function U(){}var L=N,G=!1,D=!1;function V(){null===B&&null===A||(U(),P())}function H(t,e,n){if(D)return t(e,n);D=!0;try{return L(t,e,n)}finally{D=!1,V()}}var k=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,z=Object.prototype.hasOwnProperty,X={},W={};function j(t,e,n,r,i,o){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o}var Z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){Z[t]=new j(t,0,!1,t,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];Z[e]=new j(e,1,!1,t[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){Z[t]=new j(t,2,!1,t.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){Z[t]=new j(t,2,!1,t,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){Z[t]=new j(t,3,!1,t.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(t){Z[t]=new j(t,3,!0,t,null,!1)})),["capture","download"].forEach((function(t){Z[t]=new j(t,4,!1,t,null,!1)})),["cols","rows","size","span"].forEach((function(t){Z[t]=new j(t,6,!1,t,null,!1)})),["rowSpan","start"].forEach((function(t){Z[t]=new j(t,5,!1,t.toLowerCase(),null,!1)}));var Q=/[\-:]([a-z])/g;function Y(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(Q,Y);Z[e]=new j(e,1,!1,t,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(Q,Y);Z[e]=new j(e,1,!1,t,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(Q,Y);Z[e]=new j(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(t){Z[t]=new j(t,1,!1,t.toLowerCase(),null,!1)})),Z.xlinkHref=new j("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(t){Z[t]=new j(t,1,!1,t.toLowerCase(),null,!0)}));var J=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function q(t,e,n,r){var i=Z.hasOwnProperty(e)?Z[e]:null;(null!==i?0===i.type:!r&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,n,r){if(null===e||"undefined"===typeof e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,i,r)&&(n=null),r||null===i?function(t){return!!z.call(W,t)||!z.call(X,t)&&(k.test(t)?W[t]=!0:(X[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=null===n?3!==i.type&&"":n:(e=i.attributeName,r=i.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}J.hasOwnProperty("ReactCurrentDispatcher")||(J.ReactCurrentDispatcher={current:null}),J.hasOwnProperty("ReactCurrentBatchConfig")||(J.ReactCurrentBatchConfig={suspense:null});var K=/^(.*)[\\\/]/,$="function"===typeof Symbol&&Symbol.for,tt=$?Symbol.for("react.element"):60103,et=$?Symbol.for("react.portal"):60106,nt=$?Symbol.for("react.fragment"):60107,rt=$?Symbol.for("react.strict_mode"):60108,it=$?Symbol.for("react.profiler"):60114,ot=$?Symbol.for("react.provider"):60109,at=$?Symbol.for("react.context"):60110,st=$?Symbol.for("react.concurrent_mode"):60111,ut=$?Symbol.for("react.forward_ref"):60112,ct=$?Symbol.for("react.suspense"):60113,lt=$?Symbol.for("react.suspense_list"):60120,dt=$?Symbol.for("react.memo"):60115,ft=$?Symbol.for("react.lazy"):60116,ht=$?Symbol.for("react.block"):60121,pt="function"===typeof Symbol&&Symbol.iterator;function mt(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=pt&&t[pt]||t["@@iterator"])?t:null}function vt(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case nt:return"Fragment";case et:return"Portal";case it:return"Profiler";case rt:return"StrictMode";case ct:return"Suspense";case lt:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case at:return"Context.Consumer";case ot:return"Context.Provider";case ut:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case dt:return vt(t.type);case ht:return vt(t.render);case ft:if(t=1===t._status?t._result:null)return vt(t)}return null}function gt(t){var e="";do{t:switch(t.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break t;default:var r=t._debugOwner,i=t._debugSource,o=vt(t.type);n=null,r&&(n=vt(r.type)),r=o,o="",i?o=" (at "+i.fileName.replace(K,"")+":"+i.lineNumber+")":n&&(o=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+o}e+=n,t=t.return}while(t);return e}function yt(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function bt(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function xt(t){t._valueTracker||(t._valueTracker=function(t){var e=bt(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(t){r=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function _t(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=bt(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function wt(t,e){var n=e.checked;return i({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function Tt(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=yt(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function St(t,e){null!=(e=e.checked)&&q(t,"checked",e,!1)}function Mt(t,e){St(t,e);var n=yt(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?Rt(t,e.type,n):e.hasOwnProperty("defaultValue")&&Rt(t,e.type,yt(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Et(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function Rt(t,e,n){"number"===e&&t.ownerDocument.activeElement===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function It(t,e){return t=i({children:void 0},e),(e=function(t){var e="";return r.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function Bt(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+yt(n),e=null,i=0;i<t.length;i++){if(t[i].value===n)return t[i].selected=!0,void(r&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function At(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(a(91));return i({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ct(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(a(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(a(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:yt(n)}}function Ft(t,e){var n=yt(e.value),r=yt(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function Pt(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var Nt="http://www.w3.org/1999/xhtml",Ot="http://www.w3.org/2000/svg";function Ut(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?Ut(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var Gt,Dt=function(t){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction((function(){return t(e,n)}))}:t}((function(t,e){if(t.namespaceURI!==Ot||"innerHTML"in t)t.innerHTML=e;else{for((Gt=Gt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Gt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}}));function Vt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}function Ht(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var kt={animationend:Ht("Animation","AnimationEnd"),animationiteration:Ht("Animation","AnimationIteration"),animationstart:Ht("Animation","AnimationStart"),transitionend:Ht("Transition","TransitionEnd")},zt={},Xt={};function Wt(t){if(zt[t])return zt[t];if(!kt[t])return t;var e,n=kt[t];for(e in n)if(n.hasOwnProperty(e)&&e in Xt)return zt[t]=n[e];return t}R&&(Xt=document.createElement("div").style,"AnimationEvent"in window||(delete kt.animationend.animation,delete kt.animationiteration.animation,delete kt.animationstart.animation),"TransitionEvent"in window||delete kt.transitionend.transition);var jt=Wt("animationend"),Zt=Wt("animationiteration"),Qt=Wt("animationstart"),Yt=Wt("transitionend"),Jt="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qt=new("function"===typeof WeakMap?WeakMap:Map);function Kt(t){var e=qt.get(t);return void 0===e&&(e=new Map,qt.set(t,e)),e}function $t(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(1026&(e=t).effectTag)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function te(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function ee(t){if($t(t)!==t)throw Error(a(188))}function ne(t){if(!(t=function(t){var e=t.alternate;if(!e){if(null===(e=$t(t)))throw Error(a(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return ee(i),t;if(o===r)return ee(i),e;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?t:e}(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function re(t,e){if(null==e)throw Error(a(30));return null==t?e:Array.isArray(t)?Array.isArray(e)?(t.push.apply(t,e),t):(t.push(e),t):Array.isArray(e)?[t].concat(e):[t,e]}function ie(t,e,n){Array.isArray(t)?t.forEach(e,n):t&&e.call(n,t)}var oe=null;function ae(t){if(t){var e=t._dispatchListeners,n=t._dispatchInstances;if(Array.isArray(e))for(var r=0;r<e.length&&!t.isPropagationStopped();r++)g(t,e[r],n[r]);else e&&g(t,e,n);t._dispatchListeners=null,t._dispatchInstances=null,t.isPersistent()||t.constructor.release(t)}}function se(t){if(null!==t&&(oe=re(oe,t)),t=oe,oe=null,t){if(ie(t,ae),oe)throw Error(a(95));if(l)throw t=d,l=!1,d=null,t}}function ue(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}function ce(t){if(!R)return!1;var e=(t="on"+t)in document;return e||((e=document.createElement("div")).setAttribute(t,"return;"),e="function"===typeof e[t]),e}var le=[];function de(t){t.topLevelType=null,t.nativeEvent=null,t.targetInst=null,t.ancestors.length=0,10>le.length&&le.push(t)}function fe(t,e,n,r){if(le.length){var i=le.pop();return i.topLevelType=t,i.eventSystemFlags=r,i.nativeEvent=e,i.targetInst=n,i}return{topLevelType:t,eventSystemFlags:r,nativeEvent:e,targetInst:n,ancestors:[]}}function he(t){var e=t.targetInst,n=e;do{if(!n){t.ancestors.push(n);break}var r=n;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;5!==(e=n.tag)&&6!==e||t.ancestors.push(n),n=Rn(r)}while(n);for(n=0;n<t.ancestors.length;n++){e=t.ancestors[n];var i=ue(t.nativeEvent);r=t.topLevelType;var o=t.nativeEvent,a=t.eventSystemFlags;0===n&&(a|=64);for(var s=null,u=0;u<w.length;u++){var c=w[u];c&&(c=c.extractEvents(r,e,o,i,a))&&(s=re(s,c))}se(s)}}function pe(t,e,n){if(!n.has(t)){switch(t){case"scroll":Qe(e,"scroll",!0);break;case"focus":case"blur":Qe(e,"focus",!0),Qe(e,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":ce(t)&&Qe(e,t,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Jt.indexOf(t)&&Ze(t,e)}n.set(t,null)}}var me,ve,ge,ye=!1,be=[],xe=null,_e=null,we=null,Te=new Map,Se=new Map,Me=[],Ee="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Re="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function Ie(t,e,n,r,i){return{blockedOn:t,topLevelType:e,eventSystemFlags:32|n,nativeEvent:i,container:r}}function Be(t,e){switch(t){case"focus":case"blur":xe=null;break;case"dragenter":case"dragleave":_e=null;break;case"mouseover":case"mouseout":we=null;break;case"pointerover":case"pointerout":Te.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Se.delete(e.pointerId)}}function Ae(t,e,n,r,i,o){return null===t||t.nativeEvent!==o?(t=Ie(e,n,r,i,o),null!==e&&(null!==(e=In(e))&&ve(e)),t):(t.eventSystemFlags|=r,t)}function Ce(t){var e=Rn(t.target);if(null!==e){var n=$t(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=te(n)))return t.blockedOn=e,void o.unstable_runWithPriority(t.priority,(function(){ge(n)}))}else if(3===e&&n.stateNode.hydrate)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Fe(t){if(null!==t.blockedOn)return!1;var e=Ke(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);if(null!==e){var n=In(e);return null!==n&&ve(n),t.blockedOn=e,!1}return!0}function Pe(t,e,n){Fe(t)&&n.delete(e)}function Ne(){for(ye=!1;0<be.length;){var t=be[0];if(null!==t.blockedOn){null!==(t=In(t.blockedOn))&&me(t);break}var e=Ke(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);null!==e?t.blockedOn=e:be.shift()}null!==xe&&Fe(xe)&&(xe=null),null!==_e&&Fe(_e)&&(_e=null),null!==we&&Fe(we)&&(we=null),Te.forEach(Pe),Se.forEach(Pe)}function Oe(t,e){t.blockedOn===e&&(t.blockedOn=null,ye||(ye=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Ne)))}function Ue(t){function e(e){return Oe(e,t)}if(0<be.length){Oe(be[0],t);for(var n=1;n<be.length;n++){var r=be[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==xe&&Oe(xe,t),null!==_e&&Oe(_e,t),null!==we&&Oe(we,t),Te.forEach(e),Se.forEach(e),n=0;n<Me.length;n++)(r=Me[n]).blockedOn===t&&(r.blockedOn=null);for(;0<Me.length&&null===(n=Me[0]).blockedOn;)Ce(n),null===n.blockedOn&&Me.shift()}var Le={},Ge=new Map,De=new Map,Ve=["abort","abort",jt,"animationEnd",Zt,"animationIteration",Qt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Yt,"transitionEnd","waiting","waiting"];function He(t,e){for(var n=0;n<t.length;n+=2){var r=t[n],i=t[n+1],o="on"+(i[0].toUpperCase()+i.slice(1));o={phasedRegistrationNames:{bubbled:o,captured:o+"Capture"},dependencies:[r],eventPriority:e},De.set(r,e),Ge.set(r,o),Le[i]=o}}He("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),He("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),He(Ve,2);for(var ke="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),ze=0;ze<ke.length;ze++)De.set(ke[ze],0);var Xe=o.unstable_UserBlockingPriority,We=o.unstable_runWithPriority,je=!0;function Ze(t,e){Qe(e,t,!1)}function Qe(t,e,n){var r=De.get(e);switch(void 0===r?2:r){case 0:r=Ye.bind(null,e,1,t);break;case 1:r=Je.bind(null,e,1,t);break;default:r=qe.bind(null,e,1,t)}n?t.addEventListener(e,r,!0):t.addEventListener(e,r,!1)}function Ye(t,e,n,r){G||U();var i=qe,o=G;G=!0;try{O(i,t,e,n,r)}finally{(G=o)||V()}}function Je(t,e,n,r){We(Xe,qe.bind(null,t,e,n,r))}function qe(t,e,n,r){if(je)if(0<be.length&&-1<Ee.indexOf(t))t=Ie(null,t,e,n,r),be.push(t);else{var i=Ke(t,e,n,r);if(null===i)Be(t,r);else if(-1<Ee.indexOf(t))t=Ie(i,t,e,n,r),be.push(t);else if(!function(t,e,n,r,i){switch(e){case"focus":return xe=Ae(xe,t,e,n,r,i),!0;case"dragenter":return _e=Ae(_e,t,e,n,r,i),!0;case"mouseover":return we=Ae(we,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return Te.set(o,Ae(Te.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Se.set(o,Ae(Se.get(o)||null,t,e,n,r,i)),!0}return!1}(i,t,e,n,r)){Be(t,r),t=fe(t,r,null,e);try{H(he,t)}finally{de(t)}}}}function Ke(t,e,n,r){if(null!==(n=Rn(n=ue(r)))){var i=$t(n);if(null===i)n=null;else{var o=i.tag;if(13===o){if(null!==(n=te(i)))return n;n=null}else if(3===o){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}t=fe(t,r,n,e);try{H(he,t)}finally{de(t)}return null}var $e={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tn=["Webkit","ms","Moz","O"];function en(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||$e.hasOwnProperty(t)&&$e[t]?(""+e).trim():e+"px"}function nn(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=en(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}Object.keys($e).forEach((function(t){tn.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),$e[e]=$e[t]}))}));var rn=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function on(t,e){if(e){if(rn[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(a(137,t,""));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(a(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(a(62,""))}}function an(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sn=Nt;function un(t,e){var n=Kt(t=9===t.nodeType||11===t.nodeType?t:t.ownerDocument);e=M[e];for(var r=0;r<e.length;r++)pe(e[r],t,n)}function cn(){}function ln(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function dn(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fn(t,e){var n,r=dn(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=dn(r)}}function hn(){for(var t=window,e=ln();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(r){n=!1}if(!n)break;e=ln((t=e.contentWindow).document)}return e}function pn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var mn=null,vn=null;function gn(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function yn(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var bn="function"===typeof setTimeout?setTimeout:void 0,xn="function"===typeof clearTimeout?clearTimeout:void 0;function _n(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function wn(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var Tn=Math.random().toString(36).slice(2),Sn="__reactInternalInstance$"+Tn,Mn="__reactEventHandlers$"+Tn,En="__reactContainere$"+Tn;function Rn(t){var e=t[Sn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[En]||n[Sn]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=wn(t);null!==t;){if(n=t[Sn])return n;t=wn(t)}return e}n=(t=n).parentNode}return null}function In(t){return!(t=t[Sn]||t[En])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function Bn(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(a(33))}function An(t){return t[Mn]||null}function Cn(t){do{t=t.return}while(t&&5!==t.tag);return t||null}function Fn(t,e){var n=t.stateNode;if(!n)return null;var r=p(n);if(!r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(a(231,e,typeof n));return n}function Pn(t,e,n){(e=Fn(t,n.dispatchConfig.phasedRegistrationNames[e]))&&(n._dispatchListeners=re(n._dispatchListeners,e),n._dispatchInstances=re(n._dispatchInstances,t))}function Nn(t){if(t&&t.dispatchConfig.phasedRegistrationNames){for(var e=t._targetInst,n=[];e;)n.push(e),e=Cn(e);for(e=n.length;0<e--;)Pn(n[e],"captured",t);for(e=0;e<n.length;e++)Pn(n[e],"bubbled",t)}}function On(t,e,n){t&&n&&n.dispatchConfig.registrationName&&(e=Fn(t,n.dispatchConfig.registrationName))&&(n._dispatchListeners=re(n._dispatchListeners,e),n._dispatchInstances=re(n._dispatchInstances,t))}function Un(t){t&&t.dispatchConfig.registrationName&&On(t._targetInst,null,t)}function Ln(t){ie(t,Nn)}var Gn=null,Dn=null,Vn=null;function Hn(){if(Vn)return Vn;var t,e,n=Dn,r=n.length,i="value"in Gn?Gn.value:Gn.textContent,o=i.length;for(t=0;t<r&&n[t]===i[t];t++);var a=r-t;for(e=1;e<=a&&n[r-e]===i[o-e];e++);return Vn=i.slice(t,1<e?1-e:void 0)}function kn(){return!0}function zn(){return!1}function Xn(t,e,n,r){for(var i in this.dispatchConfig=t,this._targetInst=e,this.nativeEvent=n,t=this.constructor.Interface)t.hasOwnProperty(i)&&((e=t[i])?this[i]=e(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?kn:zn,this.isPropagationStopped=zn,this}function Wn(t,e,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,t,e,n,r),i}return new this(t,e,n,r)}function jn(t){if(!(t instanceof this))throw Error(a(279));t.destructor(),10>this.eventPool.length&&this.eventPool.push(t)}function Zn(t){t.eventPool=[],t.getPooled=Wn,t.release=jn}i(Xn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=kn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=kn)},persist:function(){this.isPersistent=kn},isPersistent:zn,destructor:function(){var t,e=this.constructor.Interface;for(t in e)this[t]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=zn,this._dispatchInstances=this._dispatchListeners=null}}),Xn.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Xn.extend=function(t){function e(){}function n(){return r.apply(this,arguments)}var r=this;e.prototype=r.prototype;var o=new e;return i(o,n.prototype),n.prototype=o,n.prototype.constructor=n,n.Interface=i({},r.Interface,t),n.extend=r.extend,Zn(n),n},Zn(Xn);var Qn=Xn.extend({data:null}),Yn=Xn.extend({data:null}),Jn=[9,13,27,32],qn=R&&"CompositionEvent"in window,Kn=null;R&&"documentMode"in document&&(Kn=document.documentMode);var $n=R&&"TextEvent"in window&&!Kn,tr=R&&(!qn||Kn&&8<Kn&&11>=Kn),er=String.fromCharCode(32),nr={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},rr=!1;function ir(t,e){switch(t){case"keyup":return-1!==Jn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function or(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var ar=!1;var sr={eventTypes:nr,extractEvents:function(t,e,n,r){var i;if(qn)t:{switch(t){case"compositionstart":var o=nr.compositionStart;break t;case"compositionend":o=nr.compositionEnd;break t;case"compositionupdate":o=nr.compositionUpdate;break t}o=void 0}else ar?ir(t,n)&&(o=nr.compositionEnd):"keydown"===t&&229===n.keyCode&&(o=nr.compositionStart);return o?(tr&&"ko"!==n.locale&&(ar||o!==nr.compositionStart?o===nr.compositionEnd&&ar&&(i=Hn()):(Dn="value"in(Gn=r)?Gn.value:Gn.textContent,ar=!0)),o=Qn.getPooled(o,e,n,r),i?o.data=i:null!==(i=or(n))&&(o.data=i),Ln(o),i=o):i=null,(t=$n?function(t,e){switch(t){case"compositionend":return or(e);case"keypress":return 32!==e.which?null:(rr=!0,er);case"textInput":return(t=e.data)===er&&rr?null:t;default:return null}}(t,n):function(t,e){if(ar)return"compositionend"===t||!qn&&ir(t,e)?(t=Hn(),Vn=Dn=Gn=null,ar=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return tr&&"ko"!==e.locale?null:e.data;default:return null}}(t,n))?((e=Yn.getPooled(nr.beforeInput,e,n,r)).data=t,Ln(e)):e=null,null===i?e:null===e?i:[i,e]}},ur={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!ur[t.type]:"textarea"===e}var lr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function dr(t,e,n){return(t=Xn.getPooled(lr.change,t,e,n)).type="change",F(n),Ln(t),t}var fr=null,hr=null;function pr(t){se(t)}function mr(t){if(_t(Bn(t)))return t}function vr(t,e){if("change"===t)return e}var gr=!1;function yr(){fr&&(fr.detachEvent("onpropertychange",br),hr=fr=null)}function br(t){if("value"===t.propertyName&&mr(hr))if(t=dr(hr,t,ue(t)),G)se(t);else{G=!0;try{N(pr,t)}finally{G=!1,V()}}}function xr(t,e,n){"focus"===t?(yr(),hr=n,(fr=e).attachEvent("onpropertychange",br)):"blur"===t&&yr()}function _r(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return mr(hr)}function wr(t,e){if("click"===t)return mr(e)}function Tr(t,e){if("input"===t||"change"===t)return mr(e)}R&&(gr=ce("input")&&(!document.documentMode||9<document.documentMode));var Sr={eventTypes:lr,_isInputEventSupported:gr,extractEvents:function(t,e,n,r){var i=e?Bn(e):window,o=i.nodeName&&i.nodeName.toLowerCase();if("select"===o||"input"===o&&"file"===i.type)var a=vr;else if(cr(i))if(gr)a=Tr;else{a=_r;var s=xr}else(o=i.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(a=wr);if(a&&(a=a(t,e)))return dr(a,n,r);s&&s(t,i,e),"blur"===t&&(t=i._wrapperState)&&t.controlled&&"number"===i.type&&Rt(i,"number",i.value)}},Mr=Xn.extend({view:null,detail:null}),Er={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rr(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Er[t])&&!!e[t]}function Ir(){return Rr}var Br=0,Ar=0,Cr=!1,Fr=!1,Pr=Mr.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Ir,button:null,buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},movementX:function(t){if("movementX"in t)return t.movementX;var e=Br;return Br=t.screenX,Cr?"mousemove"===t.type?t.screenX-e:0:(Cr=!0,0)},movementY:function(t){if("movementY"in t)return t.movementY;var e=Ar;return Ar=t.screenY,Fr?"mousemove"===t.type?t.screenY-e:0:(Fr=!0,0)}}),Nr=Pr.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Or={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Ur={eventTypes:Or,extractEvents:function(t,e,n,r,i){var o="mouseover"===t||"pointerover"===t,a="mouseout"===t||"pointerout"===t;if(o&&0===(32&i)&&(n.relatedTarget||n.fromElement)||!a&&!o)return null;(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,a)?(a=e,null!==(e=(e=n.relatedTarget||n.toElement)?Rn(e):null)&&(e!==$t(e)||5!==e.tag&&6!==e.tag)&&(e=null)):a=null;if(a===e)return null;if("mouseout"===t||"mouseover"===t)var s=Pr,u=Or.mouseLeave,c=Or.mouseEnter,l="mouse";else"pointerout"!==t&&"pointerover"!==t||(s=Nr,u=Or.pointerLeave,c=Or.pointerEnter,l="pointer");if(t=null==a?o:Bn(a),o=null==e?o:Bn(e),(u=s.getPooled(u,a,n,r)).type=l+"leave",u.target=t,u.relatedTarget=o,(n=s.getPooled(c,e,n,r)).type=l+"enter",n.target=o,n.relatedTarget=t,l=e,(r=a)&&l)t:{for(c=l,a=0,t=s=r;t;t=Cn(t))a++;for(t=0,e=c;e;e=Cn(e))t++;for(;0<a-t;)s=Cn(s),a--;for(;0<t-a;)c=Cn(c),t--;for(;a--;){if(s===c||s===c.alternate)break t;s=Cn(s),c=Cn(c)}s=null}else s=null;for(c=s,s=[];r&&r!==c&&(null===(a=r.alternate)||a!==c);)s.push(r),r=Cn(r);for(r=[];l&&l!==c&&(null===(a=l.alternate)||a!==c);)r.push(l),l=Cn(l);for(l=0;l<s.length;l++)On(s[l],"bubbled",u);for(l=r.length;0<l--;)On(r[l],"captured",n);return 0===(64&i)?[u]:[u,n]}};var Lr="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},Gr=Object.prototype.hasOwnProperty;function Dr(t,e){if(Lr(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Gr.call(e,n[r])||!Lr(t[n[r]],e[n[r]]))return!1;return!0}var Vr=R&&"documentMode"in document&&11>=document.documentMode,Hr={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},kr=null,zr=null,Xr=null,Wr=!1;function jr(t,e){var n=e.window===e?e.document:9===e.nodeType?e:e.ownerDocument;return Wr||null==kr||kr!==ln(n)?null:("selectionStart"in(n=kr)&&pn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Xr&&Dr(Xr,n)?null:(Xr=n,(t=Xn.getPooled(Hr.select,zr,t,e)).type="select",t.target=kr,Ln(t),t))}var Zr={eventTypes:Hr,extractEvents:function(t,e,n,r,i,o){if(!(o=!(i=o||(r.window===r?r.document:9===r.nodeType?r:r.ownerDocument)))){t:{i=Kt(i),o=M.onSelect;for(var a=0;a<o.length;a++)if(!i.has(o[a])){i=!1;break t}i=!0}o=!i}if(o)return null;switch(i=e?Bn(e):window,t){case"focus":(cr(i)||"true"===i.contentEditable)&&(kr=i,zr=e,Xr=null);break;case"blur":Xr=zr=kr=null;break;case"mousedown":Wr=!0;break;case"contextmenu":case"mouseup":case"dragend":return Wr=!1,jr(n,r);case"selectionchange":if(Vr)break;case"keydown":case"keyup":return jr(n,r)}return null}},Qr=Xn.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Yr=Xn.extend({clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Jr=Mr.extend({relatedTarget:null});function qr(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}var Kr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$r={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ti=Mr.extend({key:function(t){if(t.key){var e=Kr[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=qr(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?$r[t.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Ir,charCode:function(t){return"keypress"===t.type?qr(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?qr(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),ei=Pr.extend({dataTransfer:null}),ni=Mr.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Ir}),ri=Xn.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),ii=Pr.extend({deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null}),oi={eventTypes:Le,extractEvents:function(t,e,n,r){var i=Ge.get(t);if(!i)return null;switch(t){case"keypress":if(0===qr(n))return null;case"keydown":case"keyup":t=ti;break;case"blur":case"focus":t=Jr;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":t=Pr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":t=ei;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":t=ni;break;case jt:case Zt:case Qt:t=Qr;break;case Yt:t=ri;break;case"scroll":t=Mr;break;case"wheel":t=ii;break;case"copy":case"cut":case"paste":t=Yr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":t=Nr;break;default:t=Xn}return Ln(e=t.getPooled(i,e,n,r)),e}};if(y)throw Error(a(101));y=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),x(),p=An,m=In,v=Bn,E({SimpleEventPlugin:oi,EnterLeaveEventPlugin:Ur,ChangeEventPlugin:Sr,SelectEventPlugin:Zr,BeforeInputEventPlugin:sr});var ai=[],si=-1;function ui(t){0>si||(t.current=ai[si],ai[si]=null,si--)}function ci(t,e){si++,ai[si]=t.current,t.current=e}var li={},di={current:li},fi={current:!1},hi=li;function pi(t,e){var n=t.type.contextTypes;if(!n)return li;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=e[i];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function mi(t){return null!==(t=t.childContextTypes)&&void 0!==t}function vi(){ui(fi),ui(di)}function gi(t,e,n){if(di.current!==li)throw Error(a(168));ci(di,e),ci(fi,n)}function yi(t,e,n){var r=t.stateNode;if(t=e.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(a(108,vt(e)||"Unknown",o));return i({},n,{},r)}function bi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||li,hi=di.current,ci(di,t),ci(fi,fi.current),!0}function xi(t,e,n){var r=t.stateNode;if(!r)throw Error(a(169));n?(t=yi(t,e,hi),r.__reactInternalMemoizedMergedChildContext=t,ui(fi),ui(di),ci(di,t)):ui(fi),ci(fi,n)}var _i=o.unstable_runWithPriority,wi=o.unstable_scheduleCallback,Ti=o.unstable_cancelCallback,Si=o.unstable_requestPaint,Mi=o.unstable_now,Ei=o.unstable_getCurrentPriorityLevel,Ri=o.unstable_ImmediatePriority,Ii=o.unstable_UserBlockingPriority,Bi=o.unstable_NormalPriority,Ai=o.unstable_LowPriority,Ci=o.unstable_IdlePriority,Fi={},Pi=o.unstable_shouldYield,Ni=void 0!==Si?Si:function(){},Oi=null,Ui=null,Li=!1,Gi=Mi(),Di=1e4>Gi?Mi:function(){return Mi()-Gi};function Vi(){switch(Ei()){case Ri:return 99;case Ii:return 98;case Bi:return 97;case Ai:return 96;case Ci:return 95;default:throw Error(a(332))}}function Hi(t){switch(t){case 99:return Ri;case 98:return Ii;case 97:return Bi;case 96:return Ai;case 95:return Ci;default:throw Error(a(332))}}function ki(t,e){return t=Hi(t),_i(t,e)}function zi(t,e,n){return t=Hi(t),wi(t,e,n)}function Xi(t){return null===Oi?(Oi=[t],Ui=wi(Ri,ji)):Oi.push(t),Fi}function Wi(){if(null!==Ui){var t=Ui;Ui=null,Ti(t)}ji()}function ji(){if(!Li&&null!==Oi){Li=!0;var t=0;try{var e=Oi;ki(99,(function(){for(;t<e.length;t++){var n=e[t];do{n=n(!0)}while(null!==n)}})),Oi=null}catch(n){throw null!==Oi&&(Oi=Oi.slice(t+1)),wi(Ri,Wi),n}finally{Li=!1}}}function Zi(t,e,n){return 1073741821-(1+((1073741821-t+e/10)/(n/=10)|0))*n}function Qi(t,e){if(t&&t.defaultProps)for(var n in e=i({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}var Yi={current:null},Ji=null,qi=null,Ki=null;function $i(){Ki=qi=Ji=null}function to(t){var e=Yi.current;ui(Yi),t.type._context._currentValue=e}function eo(t,e){for(;null!==t;){var n=t.alternate;if(t.childExpirationTime<e)t.childExpirationTime=e,null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e);else{if(!(null!==n&&n.childExpirationTime<e))break;n.childExpirationTime=e}t=t.return}}function no(t,e){Ji=t,Ki=qi=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(t.expirationTime>=e&&(Aa=!0),t.firstContext=null)}function ro(t,e){if(Ki!==t&&!1!==e&&0!==e)if("number"===typeof e&&1073741823!==e||(Ki=t,e=1073741823),e={context:t,observedBits:e,next:null},null===qi){if(null===Ji)throw Error(a(308));qi=e,Ji.dependencies={expirationTime:0,firstContext:e,responders:null}}else qi=qi.next=e;return t._currentValue}var io=!1;function oo(t){t.updateQueue={baseState:t.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function ao(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,baseQueue:t.baseQueue,shared:t.shared,effects:t.effects})}function so(t,e){return(t={expirationTime:t,suspenseConfig:e,tag:0,payload:null,callback:null,next:null}).next=t}function uo(t,e){if(null!==(t=t.updateQueue)){var n=(t=t.shared).pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}}function co(t,e){var n=t.alternate;null!==n&&ao(n,t),null===(n=(t=t.updateQueue).baseQueue)?(t.baseQueue=e.next=e,e.next=e):(e.next=n.next,n.next=e)}function lo(t,e,n,r){var o=t.updateQueue;io=!1;var a=o.baseQueue,s=o.shared.pending;if(null!==s){if(null!==a){var u=a.next;a.next=s.next,s.next=u}a=s,o.shared.pending=null,null!==(u=t.alternate)&&(null!==(u=u.updateQueue)&&(u.baseQueue=s))}if(null!==a){u=a.next;var c=o.baseState,l=0,d=null,f=null,h=null;if(null!==u)for(var p=u;;){if((s=p.expirationTime)<r){var m={expirationTime:p.expirationTime,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null};null===h?(f=h=m,d=c):h=h.next=m,s>l&&(l=s)}else{null!==h&&(h=h.next={expirationTime:1073741823,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null}),ou(s,p.suspenseConfig);t:{var v=t,g=p;switch(s=e,m=n,g.tag){case 1:if("function"===typeof(v=g.payload)){c=v.call(m,c,s);break t}c=v;break t;case 3:v.effectTag=-4097&v.effectTag|64;case 0:if(null===(s="function"===typeof(v=g.payload)?v.call(m,c,s):v)||void 0===s)break t;c=i({},c,s);break t;case 2:io=!0}}null!==p.callback&&(t.effectTag|=32,null===(s=o.effects)?o.effects=[p]:s.push(p))}if(null===(p=p.next)||p===u){if(null===(s=o.shared.pending))break;p=a.next=s.next,s.next=u,o.baseQueue=a=s,o.shared.pending=null}}null===h?d=c:h.next=f,o.baseState=d,o.baseQueue=h,au(l),t.expirationTime=l,t.memoizedState=c}}function fo(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(null!==i){if(r.callback=null,r=i,i=n,"function"!==typeof r)throw Error(a(191,r));r.call(i)}}}var ho=J.ReactCurrentBatchConfig,po=(new r.Component).refs;function mo(t,e,n,r){n=null===(n=n(r,e=t.memoizedState))||void 0===n?e:i({},e,n),t.memoizedState=n,0===t.expirationTime&&(t.updateQueue.baseState=n)}var vo={isMounted:function(t){return!!(t=t._reactInternalFiber)&&$t(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternalFiber;var r=js(),i=ho.suspense;(i=so(r=Zs(r,t,i),i)).payload=e,void 0!==n&&null!==n&&(i.callback=n),uo(t,i),Qs(t,r)},enqueueReplaceState:function(t,e,n){t=t._reactInternalFiber;var r=js(),i=ho.suspense;(i=so(r=Zs(r,t,i),i)).tag=1,i.payload=e,void 0!==n&&null!==n&&(i.callback=n),uo(t,i),Qs(t,r)},enqueueForceUpdate:function(t,e){t=t._reactInternalFiber;var n=js(),r=ho.suspense;(r=so(n=Zs(n,t,r),r)).tag=2,void 0!==e&&null!==e&&(r.callback=e),uo(t,r),Qs(t,n)}};function go(t,e,n,r,i,o,a){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,o,a):!e.prototype||!e.prototype.isPureReactComponent||(!Dr(n,r)||!Dr(i,o))}function yo(t,e,n){var r=!1,i=li,o=e.contextType;return"object"===typeof o&&null!==o?o=ro(o):(i=mi(e)?hi:di.current,o=(r=null!==(r=e.contextTypes)&&void 0!==r)?pi(t,i):li),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=vo,t.stateNode=e,e._reactInternalFiber=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function bo(t,e,n,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&vo.enqueueReplaceState(e,e.state,null)}function xo(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=po,oo(t);var o=e.contextType;"object"===typeof o&&null!==o?i.context=ro(o):(o=mi(e)?hi:di.current,i.context=pi(t,o)),lo(t,n,i,r),i.state=t.memoizedState,"function"===typeof(o=e.getDerivedStateFromProps)&&(mo(t,e,o,n),i.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(e=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&vo.enqueueReplaceState(i,i.state,null),lo(t,n,i,r),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.effectTag|=4)}var _o=Array.isArray;function wo(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,t));var i=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===i?e.ref:((e=function(t){var e=r.refs;e===po&&(e=r.refs={}),null===t?delete e[i]:e[i]=t})._stringRef=i,e)}if("string"!==typeof t)throw Error(a(284));if(!n._owner)throw Error(a(290,t))}return t}function To(t,e){if("textarea"!==t.type)throw Error(a(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e,""))}function So(t){function e(e,n){if(t){var r=e.lastEffect;null!==r?(r.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e){return(t=Eu(t,e)).index=0,t.sibling=null,t}function o(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.effectTag=2,n):r:(e.effectTag=2,n):n}function s(e){return t&&null===e.alternate&&(e.effectTag=2),e}function u(t,e,n,r){return null===e||6!==e.tag?((e=Bu(n,t.mode,r)).return=t,e):((e=i(e,n)).return=t,e)}function c(t,e,n,r){return null!==e&&e.elementType===n.type?((r=i(e,n.props)).ref=wo(t,e,n),r.return=t,r):((r=Ru(n.type,n.key,n.props,null,t.mode,r)).ref=wo(t,e,n),r.return=t,r)}function l(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Au(n,t.mode,r)).return=t,e):((e=i(e,n.children||[])).return=t,e)}function d(t,e,n,r,o){return null===e||7!==e.tag?((e=Iu(n,t.mode,r,o)).return=t,e):((e=i(e,n)).return=t,e)}function f(t,e,n){if("string"===typeof e||"number"===typeof e)return(e=Bu(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case tt:return(n=Ru(e.type,e.key,e.props,null,t.mode,n)).ref=wo(t,null,e),n.return=t,n;case et:return(e=Au(e,t.mode,n)).return=t,e}if(_o(e)||mt(e))return(e=Iu(e,t.mode,n,null)).return=t,e;To(t,e)}return null}function h(t,e,n,r){var i=null!==e?e.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:u(t,e,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case tt:return n.key===i?n.type===nt?d(t,e,n.props.children,r,i):c(t,e,n,r):null;case et:return n.key===i?l(t,e,n,r):null}if(_o(n)||mt(n))return null!==i?null:d(t,e,n,r,null);To(t,n)}return null}function p(t,e,n,r,i){if("string"===typeof r||"number"===typeof r)return u(e,t=t.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case tt:return t=t.get(null===r.key?n:r.key)||null,r.type===nt?d(e,t,r.props.children,i,r.key):c(e,t,r,i);case et:return l(e,t=t.get(null===r.key?n:r.key)||null,r,i)}if(_o(r)||mt(r))return d(e,t=t.get(n)||null,r,i,null);To(e,r)}return null}function m(i,a,s,u){for(var c=null,l=null,d=a,m=a=0,v=null;null!==d&&m<s.length;m++){d.index>m?(v=d,d=null):v=d.sibling;var g=h(i,d,s[m],u);if(null===g){null===d&&(d=v);break}t&&d&&null===g.alternate&&e(i,d),a=o(g,a,m),null===l?c=g:l.sibling=g,l=g,d=v}if(m===s.length)return n(i,d),c;if(null===d){for(;m<s.length;m++)null!==(d=f(i,s[m],u))&&(a=o(d,a,m),null===l?c=d:l.sibling=d,l=d);return c}for(d=r(i,d);m<s.length;m++)null!==(v=p(d,i,m,s[m],u))&&(t&&null!==v.alternate&&d.delete(null===v.key?m:v.key),a=o(v,a,m),null===l?c=v:l.sibling=v,l=v);return t&&d.forEach((function(t){return e(i,t)})),c}function v(i,s,u,c){var l=mt(u);if("function"!==typeof l)throw Error(a(150));if(null==(u=l.call(u)))throw Error(a(151));for(var d=l=null,m=s,v=s=0,g=null,y=u.next();null!==m&&!y.done;v++,y=u.next()){m.index>v?(g=m,m=null):g=m.sibling;var b=h(i,m,y.value,c);if(null===b){null===m&&(m=g);break}t&&m&&null===b.alternate&&e(i,m),s=o(b,s,v),null===d?l=b:d.sibling=b,d=b,m=g}if(y.done)return n(i,m),l;if(null===m){for(;!y.done;v++,y=u.next())null!==(y=f(i,y.value,c))&&(s=o(y,s,v),null===d?l=y:d.sibling=y,d=y);return l}for(m=r(i,m);!y.done;v++,y=u.next())null!==(y=p(m,i,v,y.value,c))&&(t&&null!==y.alternate&&m.delete(null===y.key?v:y.key),s=o(y,s,v),null===d?l=y:d.sibling=y,d=y);return t&&m.forEach((function(t){return e(i,t)})),l}return function(t,r,o,u){var c="object"===typeof o&&null!==o&&o.type===nt&&null===o.key;c&&(o=o.props.children);var l="object"===typeof o&&null!==o;if(l)switch(o.$$typeof){case tt:t:{for(l=o.key,c=r;null!==c;){if(c.key===l){switch(c.tag){case 7:if(o.type===nt){n(t,c.sibling),(r=i(c,o.props.children)).return=t,t=r;break t}break;default:if(c.elementType===o.type){n(t,c.sibling),(r=i(c,o.props)).ref=wo(t,c,o),r.return=t,t=r;break t}}n(t,c);break}e(t,c),c=c.sibling}o.type===nt?((r=Iu(o.props.children,t.mode,u,o.key)).return=t,t=r):((u=Ru(o.type,o.key,o.props,null,t.mode,u)).ref=wo(t,r,o),u.return=t,t=u)}return s(t);case et:t:{for(c=o.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(t,r.sibling),(r=i(r,o.children||[])).return=t,t=r;break t}n(t,r);break}e(t,r),r=r.sibling}(r=Au(o,t.mode,u)).return=t,t=r}return s(t)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==r&&6===r.tag?(n(t,r.sibling),(r=i(r,o)).return=t,t=r):(n(t,r),(r=Bu(o,t.mode,u)).return=t,t=r),s(t);if(_o(o))return m(t,r,o,u);if(mt(o))return v(t,r,o,u);if(l&&To(t,o),"undefined"===typeof o&&!c)switch(t.tag){case 1:case 0:throw t=t.type,Error(a(152,t.displayName||t.name||"Component"))}return n(t,r)}}var Mo=So(!0),Eo=So(!1),Ro={},Io={current:Ro},Bo={current:Ro},Ao={current:Ro};function Co(t){if(t===Ro)throw Error(a(174));return t}function Fo(t,e){switch(ci(Ao,e),ci(Bo,t),ci(Io,Ro),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Lt(null,"");break;default:e=Lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}ui(Io),ci(Io,e)}function Po(){ui(Io),ui(Bo),ui(Ao)}function No(t){Co(Ao.current);var e=Co(Io.current),n=Lt(e,t.type);e!==n&&(ci(Bo,t),ci(Io,n))}function Oo(t){Bo.current===t&&(ui(Io),ui(Bo))}var Uo={current:0};function Lo(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(64&e.effectTag))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function Go(t,e){return{responder:t,props:e}}var Do=J.ReactCurrentDispatcher,Vo=J.ReactCurrentBatchConfig,Ho=0,ko=null,zo=null,Xo=null,Wo=!1;function jo(){throw Error(a(321))}function Zo(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Lr(t[n],e[n]))return!1;return!0}function Qo(t,e,n,r,i,o){if(Ho=o,ko=e,e.memoizedState=null,e.updateQueue=null,e.expirationTime=0,Do.current=null===t||null===t.memoizedState?ga:ya,t=n(r,i),e.expirationTime===Ho){o=0;do{if(e.expirationTime=0,!(25>o))throw Error(a(301));o+=1,Xo=zo=null,e.updateQueue=null,Do.current=ba,t=n(r,i)}while(e.expirationTime===Ho)}if(Do.current=va,e=null!==zo&&null!==zo.next,Ho=0,Xo=zo=ko=null,Wo=!1,e)throw Error(a(300));return t}function Yo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Xo?ko.memoizedState=Xo=t:Xo=Xo.next=t,Xo}function Jo(){if(null===zo){var t=ko.alternate;t=null!==t?t.memoizedState:null}else t=zo.next;var e=null===Xo?ko.memoizedState:Xo.next;if(null!==e)Xo=e,zo=t;else{if(null===t)throw Error(a(310));t={memoizedState:(zo=t).memoizedState,baseState:zo.baseState,baseQueue:zo.baseQueue,queue:zo.queue,next:null},null===Xo?ko.memoizedState=Xo=t:Xo=Xo.next=t}return Xo}function qo(t,e){return"function"===typeof e?e(t):e}function Ko(t){var e=Jo(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var r=zo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var u=s=o=null,c=i;do{var l=c.expirationTime;if(l<Ho){var d={expirationTime:c.expirationTime,suspenseConfig:c.suspenseConfig,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===u?(s=u=d,o=r):u=u.next=d,l>ko.expirationTime&&(ko.expirationTime=l,au(l))}else null!==u&&(u=u.next={expirationTime:1073741823,suspenseConfig:c.suspenseConfig,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),ou(l,c.suspenseConfig),r=c.eagerReducer===t?c.eagerState:t(r,c.action);c=c.next}while(null!==c&&c!==i);null===u?o=r:u.next=s,Lr(r,e.memoizedState)||(Aa=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}return[e.memoizedState,n.dispatch]}function $o(t){var e=Jo(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=t(o,s.action),s=s.next}while(s!==i);Lr(o,e.memoizedState)||(Aa=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function ta(t){var e=Yo();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:qo,lastRenderedState:t}).dispatch=ma.bind(null,ko,t),[e.memoizedState,t]}function ea(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=ko.updateQueue)?(e={lastEffect:null},ko.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function na(){return Jo().memoizedState}function ra(t,e,n,r){var i=Yo();ko.effectTag|=t,i.memoizedState=ea(1|e,n,void 0,void 0===r?null:r)}function ia(t,e,n,r){var i=Jo();r=void 0===r?null:r;var o=void 0;if(null!==zo){var a=zo.memoizedState;if(o=a.destroy,null!==r&&Zo(r,a.deps))return void ea(e,n,o,r)}ko.effectTag|=t,i.memoizedState=ea(1|e,n,o,r)}function oa(t,e){return ra(516,4,t,e)}function aa(t,e){return ia(516,4,t,e)}function sa(t,e){return ia(4,2,t,e)}function ua(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function ca(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,ia(4,2,ua.bind(null,e,t),n)}function la(){}function da(t,e){return Yo().memoizedState=[t,void 0===e?null:e],t}function fa(t,e){var n=Jo();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&Zo(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ha(t,e){var n=Jo();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&Zo(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function pa(t,e,n){var r=Vi();ki(98>r?98:r,(function(){t(!0)})),ki(97<r?97:r,(function(){var r=Vo.suspense;Vo.suspense=void 0===e?null:e;try{t(!1),n()}finally{Vo.suspense=r}}))}function ma(t,e,n){var r=js(),i=ho.suspense;i={expirationTime:r=Zs(r,t,i),suspenseConfig:i,action:n,eagerReducer:null,eagerState:null,next:null};var o=e.pending;if(null===o?i.next=i:(i.next=o.next,o.next=i),e.pending=i,o=t.alternate,t===ko||null!==o&&o===ko)Wo=!0,i.expirationTime=Ho,ko.expirationTime=Ho;else{if(0===t.expirationTime&&(null===o||0===o.expirationTime)&&null!==(o=e.lastRenderedReducer))try{var a=e.lastRenderedState,s=o(a,n);if(i.eagerReducer=o,i.eagerState=s,Lr(s,a))return}catch(u){}Qs(t,r)}}var va={readContext:ro,useCallback:jo,useContext:jo,useEffect:jo,useImperativeHandle:jo,useLayoutEffect:jo,useMemo:jo,useReducer:jo,useRef:jo,useState:jo,useDebugValue:jo,useResponder:jo,useDeferredValue:jo,useTransition:jo},ga={readContext:ro,useCallback:da,useContext:ro,useEffect:oa,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,ra(4,2,ua.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ra(4,2,t,e)},useMemo:function(t,e){var n=Yo();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Yo();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t=(t=r.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=ma.bind(null,ko,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},Yo().memoizedState=t},useState:ta,useDebugValue:la,useResponder:Go,useDeferredValue:function(t,e){var n=ta(t),r=n[0],i=n[1];return oa((function(){var n=Vo.suspense;Vo.suspense=void 0===e?null:e;try{i(t)}finally{Vo.suspense=n}}),[t,e]),r},useTransition:function(t){var e=ta(!1),n=e[0];return e=e[1],[da(pa.bind(null,e,t),[e,t]),n]}},ya={readContext:ro,useCallback:fa,useContext:ro,useEffect:aa,useImperativeHandle:ca,useLayoutEffect:sa,useMemo:ha,useReducer:Ko,useRef:na,useState:function(){return Ko(qo)},useDebugValue:la,useResponder:Go,useDeferredValue:function(t,e){var n=Ko(qo),r=n[0],i=n[1];return aa((function(){var n=Vo.suspense;Vo.suspense=void 0===e?null:e;try{i(t)}finally{Vo.suspense=n}}),[t,e]),r},useTransition:function(t){var e=Ko(qo),n=e[0];return e=e[1],[fa(pa.bind(null,e,t),[e,t]),n]}},ba={readContext:ro,useCallback:fa,useContext:ro,useEffect:aa,useImperativeHandle:ca,useLayoutEffect:sa,useMemo:ha,useReducer:$o,useRef:na,useState:function(){return $o(qo)},useDebugValue:la,useResponder:Go,useDeferredValue:function(t,e){var n=$o(qo),r=n[0],i=n[1];return aa((function(){var n=Vo.suspense;Vo.suspense=void 0===e?null:e;try{i(t)}finally{Vo.suspense=n}}),[t,e]),r},useTransition:function(t){var e=$o(qo),n=e[0];return e=e[1],[fa(pa.bind(null,e,t),[e,t]),n]}},xa=null,_a=null,wa=!1;function Ta(t,e){var n=Su(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.effectTag=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function Sa(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);case 13:default:return!1}}function Ma(t){if(wa){var e=_a;if(e){var n=e;if(!Sa(t,e)){if(!(e=_n(n.nextSibling))||!Sa(t,e))return t.effectTag=-1025&t.effectTag|2,wa=!1,void(xa=t);Ta(xa,n)}xa=t,_a=_n(e.firstChild)}else t.effectTag=-1025&t.effectTag|2,wa=!1,xa=t}}function Ea(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;xa=t}function Ra(t){if(t!==xa)return!1;if(!wa)return Ea(t),wa=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!yn(e,t.memoizedProps))for(e=_a;e;)Ta(t,e),e=_n(e.nextSibling);if(Ea(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(a(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){_a=_n(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}_a=null}}else _a=xa?_n(t.stateNode.nextSibling):null;return!0}function Ia(){_a=xa=null,wa=!1}var Ba=J.ReactCurrentOwner,Aa=!1;function Ca(t,e,n,r){e.child=null===t?Eo(e,null,n,r):Mo(e,t.child,n,r)}function Fa(t,e,n,r,i){n=n.render;var o=e.ref;return no(e,i),r=Qo(t,e,n,r,o,i),null===t||Aa?(e.effectTag|=1,Ca(t,e,r,i),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=i&&(t.expirationTime=0),Qa(t,e,i))}function Pa(t,e,n,r,i,o){if(null===t){var a=n.type;return"function"!==typeof a||Mu(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Ru(n.type,null,r,null,e.mode,o)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=a,Na(t,e,a,r,i,o))}return a=t.child,i<o&&(i=a.memoizedProps,(n=null!==(n=n.compare)?n:Dr)(i,r)&&t.ref===e.ref)?Qa(t,e,o):(e.effectTag|=1,(t=Eu(a,r)).ref=e.ref,t.return=e,e.child=t)}function Na(t,e,n,r,i,o){return null!==t&&Dr(t.memoizedProps,r)&&t.ref===e.ref&&(Aa=!1,i<o)?(e.expirationTime=t.expirationTime,Qa(t,e,o)):Ua(t,e,n,r,o)}function Oa(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.effectTag|=128)}function Ua(t,e,n,r,i){var o=mi(n)?hi:di.current;return o=pi(e,o),no(e,i),n=Qo(t,e,n,r,o,i),null===t||Aa?(e.effectTag|=1,Ca(t,e,n,i),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=i&&(t.expirationTime=0),Qa(t,e,i))}function La(t,e,n,r,i){if(mi(n)){var o=!0;bi(e)}else o=!1;if(no(e,i),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),yo(e,n,r),xo(e,n,r,i),r=!0;else if(null===t){var a=e.stateNode,s=e.memoizedProps;a.props=s;var u=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=ro(c):c=pi(e,c=mi(n)?hi:di.current);var l=n.getDerivedStateFromProps,d="function"===typeof l||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||u!==c)&&bo(e,a,r,c),io=!1;var f=e.memoizedState;a.state=f,lo(e,r,a,i),u=e.memoizedState,s!==r||f!==u||fi.current||io?("function"===typeof l&&(mo(e,n,l,r),u=e.memoizedState),(s=io||go(e,n,s,r,f,u,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.effectTag|=4)):("function"===typeof a.componentDidMount&&(e.effectTag|=4),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=c,r=s):("function"===typeof a.componentDidMount&&(e.effectTag|=4),r=!1)}else a=e.stateNode,ao(t,e),s=e.memoizedProps,a.props=e.type===e.elementType?s:Qi(e.type,s),u=a.context,"object"===typeof(c=n.contextType)&&null!==c?c=ro(c):c=pi(e,c=mi(n)?hi:di.current),(d="function"===typeof(l=n.getDerivedStateFromProps)||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||u!==c)&&bo(e,a,r,c),io=!1,u=e.memoizedState,a.state=u,lo(e,r,a,i),f=e.memoizedState,s!==r||u!==f||fi.current||io?("function"===typeof l&&(mo(e,n,l,r),f=e.memoizedState),(l=io||go(e,n,s,r,u,f,c))?(d||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,c),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,c)),"function"===typeof a.componentDidUpdate&&(e.effectTag|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.effectTag|=256)):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=256),e.memoizedProps=r,e.memoizedState=f),a.props=r,a.state=f,a.context=c,r=l):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=256),r=!1);return Ga(t,e,n,r,o,i)}function Ga(t,e,n,r,i,o){Oa(t,e);var a=0!==(64&e.effectTag);if(!r&&!a)return i&&xi(e,n,!1),Qa(t,e,o);r=e.stateNode,Ba.current=e;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return e.effectTag|=1,null!==t&&a?(e.child=Mo(e,t.child,null,o),e.child=Mo(e,null,s,o)):Ca(t,e,s,o),e.memoizedState=r.state,i&&xi(e,n,!0),e.child}function Da(t){var e=t.stateNode;e.pendingContext?gi(0,e.pendingContext,e.pendingContext!==e.context):e.context&&gi(0,e.context,!1),Fo(t,e.containerInfo)}var Va,Ha,ka,za={dehydrated:null,retryTime:0};function Xa(t,e,n){var r,i=e.mode,o=e.pendingProps,a=Uo.current,s=!1;if((r=0!==(64&e.effectTag))||(r=0!==(2&a)&&(null===t||null!==t.memoizedState)),r?(s=!0,e.effectTag&=-65):null!==t&&null===t.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(a|=1),ci(Uo,1&a),null===t){if(void 0!==o.fallback&&Ma(e),s){if(s=o.fallback,(o=Iu(null,i,0,null)).return=e,0===(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,o.child=t;null!==t;)t.return=o,t=t.sibling;return(n=Iu(s,i,n,null)).return=e,o.sibling=n,e.memoizedState=za,e.child=o,n}return i=o.children,e.memoizedState=null,e.child=Eo(e,null,i,n)}if(null!==t.memoizedState){if(i=(t=t.child).sibling,s){if(o=o.fallback,(n=Eu(t,t.pendingProps)).return=e,0===(2&e.mode)&&(s=null!==e.memoizedState?e.child.child:e.child)!==t.child)for(n.child=s;null!==s;)s.return=n,s=s.sibling;return(i=Eu(i,o)).return=e,n.sibling=i,n.childExpirationTime=0,e.memoizedState=za,e.child=n,i}return n=Mo(e,t.child,o.children,n),e.memoizedState=null,e.child=n}if(t=t.child,s){if(s=o.fallback,(o=Iu(null,i,0,null)).return=e,o.child=t,null!==t&&(t.return=o),0===(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,o.child=t;null!==t;)t.return=o,t=t.sibling;return(n=Iu(s,i,n,null)).return=e,o.sibling=n,n.effectTag|=2,o.childExpirationTime=0,e.memoizedState=za,e.child=o,n}return e.memoizedState=null,e.child=Mo(e,t,o.children,n)}function Wa(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e),eo(t.return,e)}function ja(t,e,n,r,i,o){var a=t.memoizedState;null===a?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailExpiration:0,tailMode:i,lastEffect:o}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailExpiration=0,a.tailMode=i,a.lastEffect=o)}function Za(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Ca(t,e,r.children,n),0!==(2&(r=Uo.current)))r=1&r|2,e.effectTag|=64;else{if(null!==t&&0!==(64&t.effectTag))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Wa(t,n);else if(19===t.tag)Wa(t,n);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ci(Uo,r),0===(2&e.mode))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;null!==n;)null!==(t=n.alternate)&&null===Lo(t)&&(i=n),n=n.sibling;null===(n=i)?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),ja(e,!1,i,n,o,e.lastEffect);break;case"backwards":for(n=null,i=e.child,e.child=null;null!==i;){if(null!==(t=i.alternate)&&null===Lo(t)){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}ja(e,!0,n,null,o,e.lastEffect);break;case"together":ja(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function Qa(t,e,n){null!==t&&(e.dependencies=t.dependencies);var r=e.expirationTime;if(0!==r&&au(r),e.childExpirationTime<n)return null;if(null!==t&&e.child!==t.child)throw Error(a(153));if(null!==e.child){for(n=Eu(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Eu(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Ya(t,e){switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ja(t,e,n){var r=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return mi(e.type)&&vi(),null;case 3:return Po(),ui(fi),ui(di),(n=e.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==t&&null!==t.child||!Ra(e)||(e.effectTag|=4),null;case 5:Oo(e),n=Co(Ao.current);var o=e.type;if(null!==t&&null!=e.stateNode)Ha(t,e,o,r,n),t.ref!==e.ref&&(e.effectTag|=128);else{if(!r){if(null===e.stateNode)throw Error(a(166));return null}if(t=Co(Io.current),Ra(e)){r=e.stateNode,o=e.type;var s=e.memoizedProps;switch(r[Sn]=e,r[Mn]=s,o){case"iframe":case"object":case"embed":Ze("load",r);break;case"video":case"audio":for(t=0;t<Jt.length;t++)Ze(Jt[t],r);break;case"source":Ze("error",r);break;case"img":case"image":case"link":Ze("error",r),Ze("load",r);break;case"form":Ze("reset",r),Ze("submit",r);break;case"details":Ze("toggle",r);break;case"input":Tt(r,s),Ze("invalid",r),un(n,"onChange");break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ze("invalid",r),un(n,"onChange");break;case"textarea":Ct(r,s),Ze("invalid",r),un(n,"onChange")}for(var u in on(o,s),t=null,s)if(s.hasOwnProperty(u)){var c=s[u];"children"===u?"string"===typeof c?r.textContent!==c&&(t=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(t=["children",""+c]):S.hasOwnProperty(u)&&null!=c&&un(n,u)}switch(o){case"input":xt(r),Et(r,s,!0);break;case"textarea":xt(r),Pt(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=cn)}n=t,e.updateQueue=n,null!==n&&(e.effectTag|=4)}else{switch(u=9===n.nodeType?n:n.ownerDocument,t===sn&&(t=Ut(o)),t===sn?"script"===o?((t=u.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof r.is?t=u.createElement(o,{is:r.is}):(t=u.createElement(o),"select"===o&&(u=t,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):t=u.createElementNS(t,o),t[Sn]=e,t[Mn]=r,Va(t,e),e.stateNode=t,u=an(o,r),o){case"iframe":case"object":case"embed":Ze("load",t),c=r;break;case"video":case"audio":for(c=0;c<Jt.length;c++)Ze(Jt[c],t);c=r;break;case"source":Ze("error",t),c=r;break;case"img":case"image":case"link":Ze("error",t),Ze("load",t),c=r;break;case"form":Ze("reset",t),Ze("submit",t),c=r;break;case"details":Ze("toggle",t),c=r;break;case"input":Tt(t,r),c=wt(t,r),Ze("invalid",t),un(n,"onChange");break;case"option":c=It(t,r);break;case"select":t._wrapperState={wasMultiple:!!r.multiple},c=i({},r,{value:void 0}),Ze("invalid",t),un(n,"onChange");break;case"textarea":Ct(t,r),c=At(t,r),Ze("invalid",t),un(n,"onChange");break;default:c=r}on(o,c);var l=c;for(s in l)if(l.hasOwnProperty(s)){var d=l[s];"style"===s?nn(t,d):"dangerouslySetInnerHTML"===s?null!=(d=d?d.__html:void 0)&&Dt(t,d):"children"===s?"string"===typeof d?("textarea"!==o||""!==d)&&Vt(t,d):"number"===typeof d&&Vt(t,""+d):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(S.hasOwnProperty(s)?null!=d&&un(n,s):null!=d&&q(t,s,d,u))}switch(o){case"input":xt(t),Et(t,r,!1);break;case"textarea":xt(t),Pt(t);break;case"option":null!=r.value&&t.setAttribute("value",""+yt(r.value));break;case"select":t.multiple=!!r.multiple,null!=(n=r.value)?Bt(t,!!r.multiple,n,!1):null!=r.defaultValue&&Bt(t,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof c.onClick&&(t.onclick=cn)}gn(o,r)&&(e.effectTag|=4)}null!==e.ref&&(e.effectTag|=128)}return null;case 6:if(t&&null!=e.stateNode)ka(0,e,t.memoizedProps,r);else{if("string"!==typeof r&&null===e.stateNode)throw Error(a(166));n=Co(Ao.current),Co(Io.current),Ra(e)?(n=e.stateNode,r=e.memoizedProps,n[Sn]=e,n.nodeValue!==r&&(e.effectTag|=4)):((n=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Sn]=e,e.stateNode=n)}return null;case 13:return ui(Uo),r=e.memoizedState,0!==(64&e.effectTag)?(e.expirationTime=n,e):(n=null!==r,r=!1,null===t?void 0!==e.memoizedProps.fallback&&Ra(e):(r=null!==(o=t.memoizedState),n||null===o||null!==(o=t.child.sibling)&&(null!==(s=e.firstEffect)?(e.firstEffect=o,o.nextEffect=s):(e.firstEffect=e.lastEffect=o,o.nextEffect=null),o.effectTag=8)),n&&!r&&0!==(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!==(1&Uo.current)?Rs===xs&&(Rs=_s):(Rs!==xs&&Rs!==_s||(Rs=ws),0!==Fs&&null!==Ss&&(Pu(Ss,Es),Nu(Ss,Fs)))),(n||r)&&(e.effectTag|=4),null);case 4:return Po(),null;case 10:return to(e),null;case 17:return mi(e.type)&&vi(),null;case 19:if(ui(Uo),null===(r=e.memoizedState))return null;if(o=0!==(64&e.effectTag),null===(s=r.rendering)){if(o)Ya(r,!1);else if(Rs!==xs||null!==t&&0!==(64&t.effectTag))for(s=e.child;null!==s;){if(null!==(t=Lo(s))){for(e.effectTag|=64,Ya(r,!1),null!==(o=t.updateQueue)&&(e.updateQueue=o,e.effectTag|=4),null===r.lastEffect&&(e.firstEffect=null),e.lastEffect=r.lastEffect,r=e.child;null!==r;)s=n,(o=r).effectTag&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(t=o.alternate)?(o.childExpirationTime=0,o.expirationTime=s,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null):(o.childExpirationTime=t.childExpirationTime,o.expirationTime=t.expirationTime,o.child=t.child,o.memoizedProps=t.memoizedProps,o.memoizedState=t.memoizedState,o.updateQueue=t.updateQueue,s=t.dependencies,o.dependencies=null===s?null:{expirationTime:s.expirationTime,firstContext:s.firstContext,responders:s.responders}),r=r.sibling;return ci(Uo,1&Uo.current|2),e.child}s=s.sibling}}else{if(!o)if(null!==(t=Lo(s))){if(e.effectTag|=64,o=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.effectTag|=4),Ya(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate)return null!==(e=e.lastEffect=r.lastEffect)&&(e.nextEffect=null),null}else 2*Di()-r.renderingStartTime>r.tailExpiration&&1<n&&(e.effectTag|=64,o=!0,Ya(r,!1),e.expirationTime=e.childExpirationTime=n-1);r.isBackwards?(s.sibling=e.child,e.child=s):(null!==(n=r.last)?n.sibling=s:e.child=s,r.last=s)}return null!==r.tail?(0===r.tailExpiration&&(r.tailExpiration=Di()+500),n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=e.lastEffect,r.renderingStartTime=Di(),n.sibling=null,e=Uo.current,ci(Uo,o?1&e|2:1&e),n):null}throw Error(a(156,e.tag))}function qa(t){switch(t.tag){case 1:mi(t.type)&&vi();var e=t.effectTag;return 4096&e?(t.effectTag=-4097&e|64,t):null;case 3:if(Po(),ui(fi),ui(di),0!==(64&(e=t.effectTag)))throw Error(a(285));return t.effectTag=-4097&e|64,t;case 5:return Oo(t),null;case 13:return ui(Uo),4096&(e=t.effectTag)?(t.effectTag=-4097&e|64,t):null;case 19:return ui(Uo),null;case 4:return Po(),null;case 10:return to(t),null;default:return null}}function Ka(t,e){return{value:t,source:e,stack:gt(e)}}Va=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ha=function(t,e,n,r,o){var a=t.memoizedProps;if(a!==r){var s,u,c=e.stateNode;switch(Co(Io.current),t=null,n){case"input":a=wt(c,a),r=wt(c,r),t=[];break;case"option":a=It(c,a),r=It(c,r),t=[];break;case"select":a=i({},a,{value:void 0}),r=i({},r,{value:void 0}),t=[];break;case"textarea":a=At(c,a),r=At(c,r),t=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(c.onclick=cn)}for(s in on(n,r),n=null,a)if(!r.hasOwnProperty(s)&&a.hasOwnProperty(s)&&null!=a[s])if("style"===s)for(u in c=a[s])c.hasOwnProperty(u)&&(n||(n={}),n[u]="");else"dangerouslySetInnerHTML"!==s&&"children"!==s&&"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(S.hasOwnProperty(s)?t||(t=[]):(t=t||[]).push(s,null));for(s in r){var l=r[s];if(c=null!=a?a[s]:void 0,r.hasOwnProperty(s)&&l!==c&&(null!=l||null!=c))if("style"===s)if(c){for(u in c)!c.hasOwnProperty(u)||l&&l.hasOwnProperty(u)||(n||(n={}),n[u]="");for(u in l)l.hasOwnProperty(u)&&c[u]!==l[u]&&(n||(n={}),n[u]=l[u])}else n||(t||(t=[]),t.push(s,n)),n=l;else"dangerouslySetInnerHTML"===s?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(t=t||[]).push(s,l)):"children"===s?c===l||"string"!==typeof l&&"number"!==typeof l||(t=t||[]).push(s,""+l):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&(S.hasOwnProperty(s)?(null!=l&&un(o,s),t||c===l||(t=[])):(t=t||[]).push(s,l))}n&&(t=t||[]).push("style",n),o=t,(e.updateQueue=o)&&(e.effectTag|=4)}},ka=function(t,e,n,r){n!==r&&(e.effectTag|=4)};var $a="function"===typeof WeakSet?WeakSet:Set;function ts(t,e){var n=e.source,r=e.stack;null===r&&null!==n&&(r=gt(n)),null!==n&&vt(n.type),e=e.value,null!==t&&1===t.tag&&vt(t.type);try{console.error(e)}catch(i){setTimeout((function(){throw i}))}}function es(t){var e=t.ref;if(null!==e)if("function"===typeof e)try{e(null)}catch(n){yu(t,n)}else e.current=null}function ns(t,e){switch(e.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&e.effectTag&&null!==t){var n=t.memoizedProps,r=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?n:Qi(e.type,n),r),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(a(163))}function rs(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==e)}}function is(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function os(t,e,n){switch(n.tag){case 0:case 11:case 15:case 22:return void is(3,n);case 1:if(t=n.stateNode,4&n.effectTag)if(null===e)t.componentDidMount();else{var r=n.elementType===n.type?e.memoizedProps:Qi(n.type,e.memoizedProps);t.componentDidUpdate(r,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate)}return void(null!==(e=n.updateQueue)&&fo(n,e,t));case 3:if(null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}fo(n,e,t)}return;case 5:return t=n.stateNode,void(null===e&&4&n.effectTag&&gn(n.type,n.memoizedProps)&&t.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Ue(n)))));case 19:case 17:case 20:case 21:return}throw Error(a(163))}function as(t,e,n){switch("function"===typeof wu&&wu(e),e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var r=t.next;ki(97<n?97:n,(function(){var t=r;do{var n=t.destroy;if(void 0!==n){var i=e;try{n()}catch(o){yu(i,o)}}t=t.next}while(t!==r)}))}break;case 1:es(e),"function"===typeof(n=e.stateNode).componentWillUnmount&&function(t,e){try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(n){yu(t,n)}}(e,n);break;case 5:es(e);break;case 4:ls(t,e,n)}}function ss(t){var e=t.alternate;t.return=null,t.child=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.alternate=null,t.firstEffect=null,t.lastEffect=null,t.pendingProps=null,t.memoizedProps=null,t.stateNode=null,null!==e&&ss(e)}function us(t){return 5===t.tag||3===t.tag||4===t.tag}function cs(t){t:{for(var e=t.return;null!==e;){if(us(e)){var n=e;break t}e=e.return}throw Error(a(160))}switch(e=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:e=e.containerInfo,r=!0;break;default:throw Error(a(161))}16&n.effectTag&&(Vt(e,""),n.effectTag&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||us(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break t}}r?function t(e,n,r){var i=e.tag,o=5===i||6===i;if(o)e=o?e.stateNode:e.stateNode.instance,n?8===r.nodeType?r.parentNode.insertBefore(e,n):r.insertBefore(e,n):(8===r.nodeType?(n=r.parentNode).insertBefore(e,r):(n=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==n.onclick||(n.onclick=cn));else if(4!==i&&null!==(e=e.child))for(t(e,n,r),e=e.sibling;null!==e;)t(e,n,r),e=e.sibling}(t,n,e):function t(e,n,r){var i=e.tag,o=5===i||6===i;if(o)e=o?e.stateNode:e.stateNode.instance,n?r.insertBefore(e,n):r.appendChild(e);else if(4!==i&&null!==(e=e.child))for(t(e,n,r),e=e.sibling;null!==e;)t(e,n,r),e=e.sibling}(t,n,e)}function ls(t,e,n){for(var r,i,o=e,s=!1;;){if(!s){s=o.return;t:for(;;){if(null===s)throw Error(a(160));switch(r=s.stateNode,s.tag){case 5:i=!1;break t;case 3:case 4:r=r.containerInfo,i=!0;break t}s=s.return}s=!0}if(5===o.tag||6===o.tag){t:for(var u=t,c=o,l=n,d=c;;)if(as(u,d,l),null!==d.child&&4!==d.tag)d.child.return=d,d=d.child;else{if(d===c)break t;for(;null===d.sibling;){if(null===d.return||d.return===c)break t;d=d.return}d.sibling.return=d.return,d=d.sibling}i?(u=r,c=o.stateNode,8===u.nodeType?u.parentNode.removeChild(c):u.removeChild(c)):r.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){r=o.stateNode.containerInfo,i=!0,o.child.return=o,o=o.child;continue}}else if(as(t,o,n),null!==o.child){o.child.return=o,o=o.child;continue}if(o===e)break;for(;null===o.sibling;){if(null===o.return||o.return===e)return;4===(o=o.return).tag&&(s=!1)}o.sibling.return=o.return,o=o.sibling}}function ds(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:return void rs(3,e);case 1:return;case 5:var n=e.stateNode;if(null!=n){var r=e.memoizedProps,i=null!==t?t.memoizedProps:r;t=e.type;var o=e.updateQueue;if(e.updateQueue=null,null!==o){for(n[Mn]=r,"input"===t&&"radio"===r.type&&null!=r.name&&St(n,r),an(t,i),e=an(t,r),i=0;i<o.length;i+=2){var s=o[i],u=o[i+1];"style"===s?nn(n,u):"dangerouslySetInnerHTML"===s?Dt(n,u):"children"===s?Vt(n,u):q(n,s,u,e)}switch(t){case"input":Mt(n,r);break;case"textarea":Ft(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(t=r.value)?Bt(n,!!r.multiple,t,!1):e!==!!r.multiple&&(null!=r.defaultValue?Bt(n,!!r.multiple,r.defaultValue,!0):Bt(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(a(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((e=e.stateNode).hydrate&&(e.hydrate=!1,Ue(e.containerInfo)));case 12:return;case 13:if(n=e,null===e.memoizedState?r=!1:(r=!0,n=e.child,Ns=Di()),null!==n)t:for(t=n;;){if(5===t.tag)o=t.stateNode,r?"function"===typeof(o=o.style).setProperty?o.setProperty("display","none","important"):o.display="none":(o=t.stateNode,i=void 0!==(i=t.memoizedProps.style)&&null!==i&&i.hasOwnProperty("display")?i.display:null,o.style.display=en("display",i));else if(6===t.tag)t.stateNode.nodeValue=r?"":t.memoizedProps;else{if(13===t.tag&&null!==t.memoizedState&&null===t.memoizedState.dehydrated){(o=t.child.sibling).return=t,t=o;continue}if(null!==t.child){t.child.return=t,t=t.child;continue}}if(t===n)break;for(;null===t.sibling;){if(null===t.return||t.return===n)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}return void fs(e);case 19:return void fs(e);case 17:return}throw Error(a(163))}function fs(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new $a),e.forEach((function(e){var r=xu.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}var hs="function"===typeof WeakMap?WeakMap:Map;function ps(t,e,n){(n=so(n,null)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Us||(Us=!0,Ls=r),ts(t,e)},n}function ms(t,e,n){(n=so(n,null)).tag=3;var r=t.type.getDerivedStateFromError;if("function"===typeof r){var i=e.value;n.payload=function(){return ts(t,e),r(i)}}var o=t.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Gs?Gs=new Set([this]):Gs.add(this),ts(t,e));var n=e.stack;this.componentDidCatch(e.value,{componentStack:null!==n?n:""})}),n}var vs,gs=Math.ceil,ys=J.ReactCurrentDispatcher,bs=J.ReactCurrentOwner,xs=0,_s=3,ws=4,Ts=0,Ss=null,Ms=null,Es=0,Rs=xs,Is=null,Bs=1073741823,As=1073741823,Cs=null,Fs=0,Ps=!1,Ns=0,Os=null,Us=!1,Ls=null,Gs=null,Ds=!1,Vs=null,Hs=90,ks=null,zs=0,Xs=null,Ws=0;function js(){return 0!==(48&Ts)?1073741821-(Di()/10|0):0!==Ws?Ws:Ws=1073741821-(Di()/10|0)}function Zs(t,e,n){if(0===(2&(e=e.mode)))return 1073741823;var r=Vi();if(0===(4&e))return 99===r?1073741823:1073741822;if(0!==(16&Ts))return Es;if(null!==n)t=Zi(t,0|n.timeoutMs||5e3,250);else switch(r){case 99:t=1073741823;break;case 98:t=Zi(t,150,100);break;case 97:case 96:t=Zi(t,5e3,250);break;case 95:t=2;break;default:throw Error(a(326))}return null!==Ss&&t===Es&&--t,t}function Qs(t,e){if(50<zs)throw zs=0,Xs=null,Error(a(185));if(null!==(t=Ys(t,e))){var n=Vi();1073741823===e?0!==(8&Ts)&&0===(48&Ts)?$s(t):(qs(t),0===Ts&&Wi()):qs(t),0===(4&Ts)||98!==n&&99!==n||(null===ks?ks=new Map([[t,e]]):(void 0===(n=ks.get(t))||n>e)&&ks.set(t,e))}}function Ys(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e);var r=t.return,i=null;if(null===r&&3===t.tag)i=t.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<e&&(r.childExpirationTime=e),null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return null!==i&&(Ss===i&&(au(e),Rs===ws&&Pu(i,Es)),Nu(i,e)),i}function Js(t){var e=t.lastExpiredTime;if(0!==e)return e;if(!Fu(t,e=t.firstPendingTime))return e;var n=t.lastPingedTime;return 2>=(t=n>(t=t.nextKnownPendingLevel)?n:t)&&e!==t?0:t}function qs(t){if(0!==t.lastExpiredTime)t.callbackExpirationTime=1073741823,t.callbackPriority=99,t.callbackNode=Xi($s.bind(null,t));else{var e=Js(t),n=t.callbackNode;if(0===e)null!==n&&(t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90);else{var r=js();if(1073741823===e?r=99:1===e||2===e?r=95:r=0>=(r=10*(1073741821-e)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==n){var i=t.callbackPriority;if(t.callbackExpirationTime===e&&i>=r)return;n!==Fi&&Ti(n)}t.callbackExpirationTime=e,t.callbackPriority=r,e=1073741823===e?Xi($s.bind(null,t)):zi(r,Ks.bind(null,t),{timeout:10*(1073741821-e)-Di()}),t.callbackNode=e}}}function Ks(t,e){if(Ws=0,e)return Ou(t,e=js()),qs(t),null;var n=Js(t);if(0!==n){if(e=t.callbackNode,0!==(48&Ts))throw Error(a(327));if(mu(),t===Ss&&n===Es||nu(t,n),null!==Ms){var r=Ts;Ts|=16;for(var i=iu();;)try{uu();break}catch(u){ru(t,u)}if($i(),Ts=r,ys.current=i,1===Rs)throw e=Is,nu(t,n),Pu(t,n),qs(t),e;if(null===Ms)switch(i=t.finishedWork=t.current.alternate,t.finishedExpirationTime=n,r=Rs,Ss=null,r){case xs:case 1:throw Error(a(345));case 2:Ou(t,2<n?2:n);break;case _s:if(Pu(t,n),n===(r=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=du(i)),1073741823===Bs&&10<(i=Ns+500-Di())){if(Ps){var o=t.lastPingedTime;if(0===o||o>=n){t.lastPingedTime=n,nu(t,n);break}}if(0!==(o=Js(t))&&o!==n)break;if(0!==r&&r!==n){t.lastPingedTime=r;break}t.timeoutHandle=bn(fu.bind(null,t),i);break}fu(t);break;case ws:if(Pu(t,n),n===(r=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=du(i)),Ps&&(0===(i=t.lastPingedTime)||i>=n)){t.lastPingedTime=n,nu(t,n);break}if(0!==(i=Js(t))&&i!==n)break;if(0!==r&&r!==n){t.lastPingedTime=r;break}if(1073741823!==As?r=10*(1073741821-As)-Di():1073741823===Bs?r=0:(r=10*(1073741821-Bs)-5e3,0>(r=(i=Di())-r)&&(r=0),(n=10*(1073741821-n)-i)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*gs(r/1960))-r)&&(r=n)),10<r){t.timeoutHandle=bn(fu.bind(null,t),r);break}fu(t);break;case 5:if(1073741823!==Bs&&null!==Cs){o=Bs;var s=Cs;if(0>=(r=0|s.busyMinDurationMs)?r=0:(i=0|s.busyDelayMs,r=(o=Di()-(10*(1073741821-o)-(0|s.timeoutMs||5e3)))<=i?0:i+r-o),10<r){Pu(t,n),t.timeoutHandle=bn(fu.bind(null,t),r);break}}fu(t);break;default:throw Error(a(329))}if(qs(t),t.callbackNode===e)return Ks.bind(null,t)}}return null}function $s(t){var e=t.lastExpiredTime;if(e=0!==e?e:1073741823,0!==(48&Ts))throw Error(a(327));if(mu(),t===Ss&&e===Es||nu(t,e),null!==Ms){var n=Ts;Ts|=16;for(var r=iu();;)try{su();break}catch(i){ru(t,i)}if($i(),Ts=n,ys.current=r,1===Rs)throw n=Is,nu(t,e),Pu(t,e),qs(t),n;if(null!==Ms)throw Error(a(261));t.finishedWork=t.current.alternate,t.finishedExpirationTime=e,Ss=null,fu(t),qs(t)}return null}function tu(t,e){var n=Ts;Ts|=1;try{return t(e)}finally{0===(Ts=n)&&Wi()}}function eu(t,e){var n=Ts;Ts&=-2,Ts|=8;try{return t(e)}finally{0===(Ts=n)&&Wi()}}function nu(t,e){t.finishedWork=null,t.finishedExpirationTime=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,xn(n)),null!==Ms)for(n=Ms.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&vi();break;case 3:Po(),ui(fi),ui(di);break;case 5:Oo(r);break;case 4:Po();break;case 13:case 19:ui(Uo);break;case 10:to(r)}n=n.return}Ss=t,Ms=Eu(t.current,null),Es=e,Rs=xs,Is=null,As=Bs=1073741823,Cs=null,Fs=0,Ps=!1}function ru(t,e){for(;;){try{if($i(),Do.current=va,Wo)for(var n=ko.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}if(Ho=0,Xo=zo=ko=null,Wo=!1,null===Ms||null===Ms.return)return Rs=1,Is=e,Ms=null;t:{var i=t,o=Ms.return,a=Ms,s=e;if(e=Es,a.effectTag|=2048,a.firstEffect=a.lastEffect=null,null!==s&&"object"===typeof s&&"function"===typeof s.then){var u=s;if(0===(2&a.mode)){var c=a.alternate;c?(a.updateQueue=c.updateQueue,a.memoizedState=c.memoizedState,a.expirationTime=c.expirationTime):(a.updateQueue=null,a.memoizedState=null)}var l=0!==(1&Uo.current),d=o;do{var f;if(f=13===d.tag){var h=d.memoizedState;if(null!==h)f=null!==h.dehydrated;else{var p=d.memoizedProps;f=void 0!==p.fallback&&(!0!==p.unstable_avoidThisFallback||!l)}}if(f){var m=d.updateQueue;if(null===m){var v=new Set;v.add(u),d.updateQueue=v}else m.add(u);if(0===(2&d.mode)){if(d.effectTag|=64,a.effectTag&=-2981,1===a.tag)if(null===a.alternate)a.tag=17;else{var g=so(1073741823,null);g.tag=2,uo(a,g)}a.expirationTime=1073741823;break t}s=void 0,a=e;var y=i.pingCache;if(null===y?(y=i.pingCache=new hs,s=new Set,y.set(u,s)):void 0===(s=y.get(u))&&(s=new Set,y.set(u,s)),!s.has(a)){s.add(a);var b=bu.bind(null,i,u,a);u.then(b,b)}d.effectTag|=4096,d.expirationTime=e;break t}d=d.return}while(null!==d);s=Error((vt(a.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+gt(a))}5!==Rs&&(Rs=2),s=Ka(s,a),d=o;do{switch(d.tag){case 3:u=s,d.effectTag|=4096,d.expirationTime=e,co(d,ps(d,u,e));break t;case 1:u=s;var x=d.type,_=d.stateNode;if(0===(64&d.effectTag)&&("function"===typeof x.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Gs||!Gs.has(_)))){d.effectTag|=4096,d.expirationTime=e,co(d,ms(d,u,e));break t}}d=d.return}while(null!==d)}Ms=lu(Ms)}catch(w){e=w;continue}break}}function iu(){var t=ys.current;return ys.current=va,null===t?va:t}function ou(t,e){t<Bs&&2<t&&(Bs=t),null!==e&&t<As&&2<t&&(As=t,Cs=e)}function au(t){t>Fs&&(Fs=t)}function su(){for(;null!==Ms;)Ms=cu(Ms)}function uu(){for(;null!==Ms&&!Pi();)Ms=cu(Ms)}function cu(t){var e=vs(t.alternate,t,Es);return t.memoizedProps=t.pendingProps,null===e&&(e=lu(t)),bs.current=null,e}function lu(t){Ms=t;do{var e=Ms.alternate;if(t=Ms.return,0===(2048&Ms.effectTag)){if(e=Ja(e,Ms,Es),1===Es||1!==Ms.childExpirationTime){for(var n=0,r=Ms.child;null!==r;){var i=r.expirationTime,o=r.childExpirationTime;i>n&&(n=i),o>n&&(n=o),r=r.sibling}Ms.childExpirationTime=n}if(null!==e)return e;null!==t&&0===(2048&t.effectTag)&&(null===t.firstEffect&&(t.firstEffect=Ms.firstEffect),null!==Ms.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=Ms.firstEffect),t.lastEffect=Ms.lastEffect),1<Ms.effectTag&&(null!==t.lastEffect?t.lastEffect.nextEffect=Ms:t.firstEffect=Ms,t.lastEffect=Ms))}else{if(null!==(e=qa(Ms)))return e.effectTag&=2047,e;null!==t&&(t.firstEffect=t.lastEffect=null,t.effectTag|=2048)}if(null!==(e=Ms.sibling))return e;Ms=t}while(null!==Ms);return Rs===xs&&(Rs=5),null}function du(t){var e=t.expirationTime;return e>(t=t.childExpirationTime)?e:t}function fu(t){var e=Vi();return ki(99,hu.bind(null,t,e)),null}function hu(t,e){do{mu()}while(null!==Vs);if(0!==(48&Ts))throw Error(a(327));var n=t.finishedWork,r=t.finishedExpirationTime;if(null===n)return null;if(t.finishedWork=null,t.finishedExpirationTime=0,n===t.current)throw Error(a(177));t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90,t.nextKnownPendingLevel=0;var i=du(n);if(t.firstPendingTime=i,r<=t.lastSuspendedTime?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:r<=t.firstSuspendedTime&&(t.firstSuspendedTime=r-1),r<=t.lastPingedTime&&(t.lastPingedTime=0),r<=t.lastExpiredTime&&(t.lastExpiredTime=0),t===Ss&&(Ms=Ss=null,Es=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){var o=Ts;Ts|=32,bs.current=null,mn=je;var s=hn();if(pn(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else t:{var c=(u=(u=s.ownerDocument)&&u.defaultView||window).getSelection&&u.getSelection();if(c&&0!==c.rangeCount){u=c.anchorNode;var l=c.anchorOffset,d=c.focusNode;c=c.focusOffset;try{u.nodeType,d.nodeType}catch(E){u=null;break t}var f=0,h=-1,p=-1,m=0,v=0,g=s,y=null;e:for(;;){for(var b;g!==u||0!==l&&3!==g.nodeType||(h=f+l),g!==d||0!==c&&3!==g.nodeType||(p=f+c),3===g.nodeType&&(f+=g.nodeValue.length),null!==(b=g.firstChild);)y=g,g=b;for(;;){if(g===s)break e;if(y===u&&++m===l&&(h=f),y===d&&++v===c&&(p=f),null!==(b=g.nextSibling))break;y=(g=y).parentNode}g=b}u=-1===h||-1===p?null:{start:h,end:p}}else u=null}u=u||{start:0,end:0}}else u=null;vn={activeElementDetached:null,focusedElem:s,selectionRange:u},je=!1,Os=i;do{try{pu()}catch(E){if(null===Os)throw Error(a(330));yu(Os,E),Os=Os.nextEffect}}while(null!==Os);Os=i;do{try{for(s=t,u=e;null!==Os;){var x=Os.effectTag;if(16&x&&Vt(Os.stateNode,""),128&x){var _=Os.alternate;if(null!==_){var w=_.ref;null!==w&&("function"===typeof w?w(null):w.current=null)}}switch(1038&x){case 2:cs(Os),Os.effectTag&=-3;break;case 6:cs(Os),Os.effectTag&=-3,ds(Os.alternate,Os);break;case 1024:Os.effectTag&=-1025;break;case 1028:Os.effectTag&=-1025,ds(Os.alternate,Os);break;case 4:ds(Os.alternate,Os);break;case 8:ls(s,l=Os,u),ss(l)}Os=Os.nextEffect}}catch(E){if(null===Os)throw Error(a(330));yu(Os,E),Os=Os.nextEffect}}while(null!==Os);if(w=vn,_=hn(),x=w.focusedElem,u=w.selectionRange,_!==x&&x&&x.ownerDocument&&function t(e,n){return!(!e||!n)&&(e===n||(!e||3!==e.nodeType)&&(n&&3===n.nodeType?t(e,n.parentNode):"contains"in e?e.contains(n):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(n))))}(x.ownerDocument.documentElement,x)){null!==u&&pn(x)&&(_=u.start,void 0===(w=u.end)&&(w=_),"selectionStart"in x?(x.selectionStart=_,x.selectionEnd=Math.min(w,x.value.length)):(w=(_=x.ownerDocument||document)&&_.defaultView||window).getSelection&&(w=w.getSelection(),l=x.textContent.length,s=Math.min(u.start,l),u=void 0===u.end?s:Math.min(u.end,l),!w.extend&&s>u&&(l=u,u=s,s=l),l=fn(x,s),d=fn(x,u),l&&d&&(1!==w.rangeCount||w.anchorNode!==l.node||w.anchorOffset!==l.offset||w.focusNode!==d.node||w.focusOffset!==d.offset)&&((_=_.createRange()).setStart(l.node,l.offset),w.removeAllRanges(),s>u?(w.addRange(_),w.extend(d.node,d.offset)):(_.setEnd(d.node,d.offset),w.addRange(_))))),_=[];for(w=x;w=w.parentNode;)1===w.nodeType&&_.push({element:w,left:w.scrollLeft,top:w.scrollTop});for("function"===typeof x.focus&&x.focus(),x=0;x<_.length;x++)(w=_[x]).element.scrollLeft=w.left,w.element.scrollTop=w.top}je=!!mn,vn=mn=null,t.current=n,Os=i;do{try{for(x=t;null!==Os;){var T=Os.effectTag;if(36&T&&os(x,Os.alternate,Os),128&T){_=void 0;var S=Os.ref;if(null!==S){var M=Os.stateNode;switch(Os.tag){case 5:_=M;break;default:_=M}"function"===typeof S?S(_):S.current=_}}Os=Os.nextEffect}}catch(E){if(null===Os)throw Error(a(330));yu(Os,E),Os=Os.nextEffect}}while(null!==Os);Os=null,Ni(),Ts=o}else t.current=n;if(Ds)Ds=!1,Vs=t,Hs=e;else for(Os=i;null!==Os;)e=Os.nextEffect,Os.nextEffect=null,Os=e;if(0===(e=t.firstPendingTime)&&(Gs=null),1073741823===e?t===Xs?zs++:(zs=0,Xs=t):zs=0,"function"===typeof _u&&_u(n.stateNode,r),qs(t),Us)throw Us=!1,t=Ls,Ls=null,t;return 0!==(8&Ts)||Wi(),null}function pu(){for(;null!==Os;){var t=Os.effectTag;0!==(256&t)&&ns(Os.alternate,Os),0===(512&t)||Ds||(Ds=!0,zi(97,(function(){return mu(),null}))),Os=Os.nextEffect}}function mu(){if(90!==Hs){var t=97<Hs?97:Hs;return Hs=90,ki(t,vu)}}function vu(){if(null===Vs)return!1;var t=Vs;if(Vs=null,0!==(48&Ts))throw Error(a(331));var e=Ts;for(Ts|=32,t=t.current.firstEffect;null!==t;){try{var n=t;if(0!==(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:case 22:rs(5,n),is(5,n)}}catch(r){if(null===t)throw Error(a(330));yu(t,r)}n=t.nextEffect,t.nextEffect=null,t=n}return Ts=e,Wi(),!0}function gu(t,e,n){uo(t,e=ps(t,e=Ka(n,e),1073741823)),null!==(t=Ys(t,1073741823))&&qs(t)}function yu(t,e){if(3===t.tag)gu(t,t,e);else for(var n=t.return;null!==n;){if(3===n.tag){gu(n,t,e);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Gs||!Gs.has(r))){uo(n,t=ms(n,t=Ka(e,t),1073741823)),null!==(n=Ys(n,1073741823))&&qs(n);break}}n=n.return}}function bu(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),Ss===t&&Es===n?Rs===ws||Rs===_s&&1073741823===Bs&&Di()-Ns<500?nu(t,Es):Ps=!0:Fu(t,n)&&(0!==(e=t.lastPingedTime)&&e<n||(t.lastPingedTime=n,qs(t)))}function xu(t,e){var n=t.stateNode;null!==n&&n.delete(e),0===(e=0)&&(e=Zs(e=js(),t,null)),null!==(t=Ys(t,e))&&qs(t)}vs=function(t,e,n){var r=e.expirationTime;if(null!==t){var i=e.pendingProps;if(t.memoizedProps!==i||fi.current)Aa=!0;else{if(r<n){switch(Aa=!1,e.tag){case 3:Da(e),Ia();break;case 5:if(No(e),4&e.mode&&1!==n&&i.hidden)return e.expirationTime=e.childExpirationTime=1,null;break;case 1:mi(e.type)&&bi(e);break;case 4:Fo(e,e.stateNode.containerInfo);break;case 10:r=e.memoizedProps.value,i=e.type._context,ci(Yi,i._currentValue),i._currentValue=r;break;case 13:if(null!==e.memoizedState)return 0!==(r=e.child.childExpirationTime)&&r>=n?Xa(t,e,n):(ci(Uo,1&Uo.current),null!==(e=Qa(t,e,n))?e.sibling:null);ci(Uo,1&Uo.current);break;case 19:if(r=e.childExpirationTime>=n,0!==(64&t.effectTag)){if(r)return Za(t,e,n);e.effectTag|=64}if(null!==(i=e.memoizedState)&&(i.rendering=null,i.tail=null),ci(Uo,Uo.current),!r)return null}return Qa(t,e,n)}Aa=!1}}else Aa=!1;switch(e.expirationTime=0,e.tag){case 2:if(r=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,i=pi(e,di.current),no(e,n),i=Qo(null,e,r,t,i,n),e.effectTag|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,mi(r)){var o=!0;bi(e)}else o=!1;e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,oo(e);var s=r.getDerivedStateFromProps;"function"===typeof s&&mo(e,r,s,t),i.updater=vo,e.stateNode=i,i._reactInternalFiber=e,xo(e,r,t,n),e=Ga(null,e,r,!0,o,n)}else e.tag=0,Ca(null,e,i,n),e=e.child;return e;case 16:t:{if(i=e.elementType,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,function(t){if(-1===t._status){t._status=0;var e=t._ctor;e=e(),t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}}(i),1!==i._status)throw i._result;switch(i=i._result,e.type=i,o=e.tag=function(t){if("function"===typeof t)return Mu(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===ut)return 11;if(t===dt)return 14}return 2}(i),t=Qi(i,t),o){case 0:e=Ua(null,e,i,t,n);break t;case 1:e=La(null,e,i,t,n);break t;case 11:e=Fa(null,e,i,t,n);break t;case 14:e=Pa(null,e,i,Qi(i.type,t),r,n);break t}throw Error(a(306,i,""))}return e;case 0:return r=e.type,i=e.pendingProps,Ua(t,e,r,i=e.elementType===r?i:Qi(r,i),n);case 1:return r=e.type,i=e.pendingProps,La(t,e,r,i=e.elementType===r?i:Qi(r,i),n);case 3:if(Da(e),r=e.updateQueue,null===t||null===r)throw Error(a(282));if(r=e.pendingProps,i=null!==(i=e.memoizedState)?i.element:null,ao(t,e),lo(e,r,null,n),(r=e.memoizedState.element)===i)Ia(),e=Qa(t,e,n);else{if((i=e.stateNode.hydrate)&&(_a=_n(e.stateNode.containerInfo.firstChild),xa=e,i=wa=!0),i)for(n=Eo(e,null,r,n),e.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else Ca(t,e,r,n),Ia();e=e.child}return e;case 5:return No(e),null===t&&Ma(e),r=e.type,i=e.pendingProps,o=null!==t?t.memoizedProps:null,s=i.children,yn(r,i)?s=null:null!==o&&yn(r,o)&&(e.effectTag|=16),Oa(t,e),4&e.mode&&1!==n&&i.hidden?(e.expirationTime=e.childExpirationTime=1,e=null):(Ca(t,e,s,n),e=e.child),e;case 6:return null===t&&Ma(e),null;case 13:return Xa(t,e,n);case 4:return Fo(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=Mo(e,null,r,n):Ca(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,Fa(t,e,r,i=e.elementType===r?i:Qi(r,i),n);case 7:return Ca(t,e,e.pendingProps,n),e.child;case 8:case 12:return Ca(t,e,e.pendingProps.children,n),e.child;case 10:t:{r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value;var u=e.type._context;if(ci(Yi,u._currentValue),u._currentValue=o,null!==s)if(u=s.value,0===(o=Lr(u,o)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(u,o):1073741823))){if(s.children===i.children&&!fi.current){e=Qa(t,e,n);break t}}else for(null!==(u=e.child)&&(u.return=e);null!==u;){var c=u.dependencies;if(null!==c){s=u.child;for(var l=c.firstContext;null!==l;){if(l.context===r&&0!==(l.observedBits&o)){1===u.tag&&((l=so(n,null)).tag=2,uo(u,l)),u.expirationTime<n&&(u.expirationTime=n),null!==(l=u.alternate)&&l.expirationTime<n&&(l.expirationTime=n),eo(u.return,n),c.expirationTime<n&&(c.expirationTime=n);break}l=l.next}}else s=10===u.tag&&u.type===e.type?null:u.child;if(null!==s)s.return=u;else for(s=u;null!==s;){if(s===e){s=null;break}if(null!==(u=s.sibling)){u.return=s.return,s=u;break}s=s.return}u=s}Ca(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=(o=e.pendingProps).children,no(e,n),r=r(i=ro(i,o.unstable_observedBits)),e.effectTag|=1,Ca(t,e,r,n),e.child;case 14:return o=Qi(i=e.type,e.pendingProps),Pa(t,e,i,o=Qi(i.type,o),r,n);case 15:return Na(t,e,e.type,e.pendingProps,r,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qi(r,i),null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),e.tag=1,mi(r)?(t=!0,bi(e)):t=!1,no(e,n),yo(e,r,i),xo(e,r,i,n),Ga(null,e,r,!0,t,n);case 19:return Za(t,e,n)}throw Error(a(156,e.tag))};var _u=null,wu=null;function Tu(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function Su(t,e,n,r){return new Tu(t,e,n,r)}function Mu(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Eu(t,e){var n=t.alternate;return null===n?((n=Su(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=t.childExpirationTime,n.expirationTime=t.expirationTime,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{expirationTime:e.expirationTime,firstContext:e.firstContext,responders:e.responders},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ru(t,e,n,r,i,o){var s=2;if(r=t,"function"===typeof t)Mu(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case nt:return Iu(n.children,i,o,e);case st:s=8,i|=7;break;case rt:s=8,i|=1;break;case it:return(t=Su(12,n,e,8|i)).elementType=it,t.type=it,t.expirationTime=o,t;case ct:return(t=Su(13,n,e,i)).type=ct,t.elementType=ct,t.expirationTime=o,t;case lt:return(t=Su(19,n,e,i)).elementType=lt,t.expirationTime=o,t;default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case ot:s=10;break t;case at:s=9;break t;case ut:s=11;break t;case dt:s=14;break t;case ft:s=16,r=null;break t;case ht:s=22;break t}throw Error(a(130,null==t?t:typeof t,""))}return(e=Su(s,n,e,i)).elementType=t,e.type=r,e.expirationTime=o,e}function Iu(t,e,n,r){return(t=Su(7,t,r,e)).expirationTime=n,t}function Bu(t,e,n){return(t=Su(6,t,null,e)).expirationTime=n,t}function Au(t,e,n){return(e=Su(4,null!==t.children?t.children:[],t.key,e)).expirationTime=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Cu(t,e,n){this.tag=e,this.current=null,this.containerInfo=t,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Fu(t,e){var n=t.firstSuspendedTime;return t=t.lastSuspendedTime,0!==n&&n>=e&&t<=e}function Pu(t,e){var n=t.firstSuspendedTime,r=t.lastSuspendedTime;n<e&&(t.firstSuspendedTime=e),(r>e||0===n)&&(t.lastSuspendedTime=e),e<=t.lastPingedTime&&(t.lastPingedTime=0),e<=t.lastExpiredTime&&(t.lastExpiredTime=0)}function Nu(t,e){e>t.firstPendingTime&&(t.firstPendingTime=e);var n=t.firstSuspendedTime;0!==n&&(e>=n?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:e>=t.lastSuspendedTime&&(t.lastSuspendedTime=e+1),e>t.nextKnownPendingLevel&&(t.nextKnownPendingLevel=e))}function Ou(t,e){var n=t.lastExpiredTime;(0===n||n>e)&&(t.lastExpiredTime=e)}function Uu(t,e,n,r){var i=e.current,o=js(),s=ho.suspense;o=Zs(o,i,s);t:if(n){e:{if($t(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(a(170));var u=n;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(mi(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(null!==u);throw Error(a(171))}if(1===n.tag){var c=n.type;if(mi(c)){n=yi(n,c,u);break t}}n=u}else n=li;return null===e.context?e.context=n:e.pendingContext=n,(e=so(o,s)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),uo(i,e),Qs(i,o),o}function Lu(t){if(!(t=t.current).child)return null;switch(t.child.tag){case 5:default:return t.child.stateNode}}function Gu(t,e){null!==(t=t.memoizedState)&&null!==t.dehydrated&&t.retryTime<e&&(t.retryTime=e)}function Du(t,e){Gu(t,e),(t=t.alternate)&&Gu(t,e)}function Vu(t,e,n){var r=new Cu(t,e,n=null!=n&&!0===n.hydrate),i=Su(3,null,null,2===e?7:1===e?3:0);r.current=i,i.stateNode=r,oo(i),t[En]=r.current,n&&0!==e&&function(t,e){var n=Kt(e);Ee.forEach((function(t){pe(t,e,n)})),Re.forEach((function(t){pe(t,e,n)}))}(0,9===t.nodeType?t:t.ownerDocument),this._internalRoot=r}function Hu(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function ku(t,e,n,r,i){var o=n._reactRootContainer;if(o){var a=o._internalRoot;if("function"===typeof i){var s=i;i=function(){var t=Lu(a);s.call(t)}}Uu(e,a,t,i)}else{if(o=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new Vu(t,0,e?{hydrate:!0}:void 0)}(n,r),a=o._internalRoot,"function"===typeof i){var u=i;i=function(){var t=Lu(a);u.call(t)}}eu((function(){Uu(e,a,t,i)}))}return Lu(a)}function zu(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:et,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}function Xu(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Hu(e))throw Error(a(200));return zu(t,e,null,n)}Vu.prototype.render=function(t){Uu(t,this._internalRoot,null,null)},Vu.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;Uu(null,t,null,(function(){e[En]=null}))},me=function(t){if(13===t.tag){var e=Zi(js(),150,100);Qs(t,e),Du(t,e)}},ve=function(t){13===t.tag&&(Qs(t,3),Du(t,3))},ge=function(t){if(13===t.tag){var e=js();Qs(t,e=Zs(e,t,null)),Du(t,e)}},I=function(t,e,n){switch(e){case"input":if(Mt(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=An(r);if(!i)throw Error(a(90));_t(r),Mt(r,i)}}}break;case"textarea":Ft(t,n);break;case"select":null!=(e=n.value)&&Bt(t,!!n.multiple,e,!1)}},N=tu,O=function(t,e,n,r,i){var o=Ts;Ts|=4;try{return ki(98,t.bind(null,e,n,r,i))}finally{0===(Ts=o)&&Wi()}},U=function(){0===(49&Ts)&&(function(){if(null!==ks){var t=ks;ks=null,t.forEach((function(t,e){Ou(e,t),qs(e)})),Wi()}}(),mu())},L=function(t,e){var n=Ts;Ts|=2;try{return t(e)}finally{0===(Ts=n)&&Wi()}};var Wu={Events:[In,Bn,An,E,T,Ln,function(t){ie(t,Un)},F,P,qe,se,mu,{current:!1}]};!function(t){var e=t.findFiberByHostInstance;(function(t){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var n=e.inject(t);_u=function(t){try{e.onCommitFiberRoot(n,t,void 0,64===(64&t.current.effectTag))}catch(r){}},wu=function(t){try{e.onCommitFiberUnmount(n,t)}catch(r){}}}catch(r){}})(i({},t,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:J.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=ne(t))?null:t.stateNode},findFiberByHostInstance:function(t){return e?e(t):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:Rn,bundleType:0,version:"16.13.1",rendererPackageName:"react-dom"}),e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wu,e.createPortal=Xu,e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternalFiber;if(void 0===e){if("function"===typeof t.render)throw Error(a(188));throw Error(a(268,Object.keys(t)))}return t=null===(t=ne(e))?null:t.stateNode},e.flushSync=function(t,e){if(0!==(48&Ts))throw Error(a(187));var n=Ts;Ts|=1;try{return ki(99,t.bind(null,e))}finally{Ts=n,Wi()}},e.hydrate=function(t,e,n){if(!Hu(e))throw Error(a(200));return ku(null,t,e,!0,n)},e.render=function(t,e,n){if(!Hu(e))throw Error(a(200));return ku(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Hu(t))throw Error(a(40));return!!t._reactRootContainer&&(eu((function(){ku(null,null,t,!1,(function(){t._reactRootContainer=null,t[En]=null}))})),!0)},e.unstable_batchedUpdates=tu,e.unstable_createPortal=function(t,e){return Xu(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Hu(n))throw Error(a(200));if(null==t||void 0===t._reactInternalFiber)throw Error(a(38));return ku(t,e,n,!1,r)},e.version="16.13.1"},function(t,e,n){"use strict";t.exports=n(104)},function(t,e,n){"use strict";var r,i,o,a,s;if("undefined"===typeof window||"function"!==typeof MessageChannel){var u=null,c=null,l=function t(){if(null!==u)try{var n=e.unstable_now();u(!0,n),u=null}catch(r){throw setTimeout(t,0),r}},d=Date.now();e.unstable_now=function(){return Date.now()-d},r=function(t){null!==u?setTimeout(r,0,t):(u=t,setTimeout(l,0))},i=function(t,e){c=setTimeout(t,e)},o=function(){clearTimeout(c)},a=function(){return!1},s=e.unstable_forceFrameRate=function(){}}else{var f=window.performance,h=window.Date,p=window.setTimeout,m=window.clearTimeout;if("undefined"!==typeof console){var v=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!==typeof v&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"===typeof f&&"function"===typeof f.now)e.unstable_now=function(){return f.now()};else{var g=h.now();e.unstable_now=function(){return h.now()-g}}var y=!1,b=null,x=-1,_=5,w=0;a=function(){return e.unstable_now()>=w},s=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):_=0<t?Math.floor(1e3/t):5};var T=new MessageChannel,S=T.port2;T.port1.onmessage=function(){if(null!==b){var t=e.unstable_now();w=t+_;try{b(!0,t)?S.postMessage(null):(y=!1,b=null)}catch(n){throw S.postMessage(null),n}}else y=!1},r=function(t){b=t,y||(y=!0,S.postMessage(null))},i=function(t,n){x=p((function(){t(e.unstable_now())}),n)},o=function(){m(x),x=-1}}function M(t,e){var n=t.length;t.push(e);t:for(;;){var r=n-1>>>1,i=t[r];if(!(void 0!==i&&0<I(i,e)))break t;t[r]=e,t[n]=i,n=r}}function E(t){return void 0===(t=t[0])?null:t}function R(t){var e=t[0];if(void 0!==e){var n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,i=t.length;r<i;){var o=2*(r+1)-1,a=t[o],s=o+1,u=t[s];if(void 0!==a&&0>I(a,n))void 0!==u&&0>I(u,a)?(t[r]=u,t[s]=n,r=s):(t[r]=a,t[o]=n,r=o);else{if(!(void 0!==u&&0>I(u,n)))break t;t[r]=u,t[s]=n,r=s}}}return e}return null}function I(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}var B=[],A=[],C=1,F=null,P=3,N=!1,O=!1,U=!1;function L(t){for(var e=E(A);null!==e;){if(null===e.callback)R(A);else{if(!(e.startTime<=t))break;R(A),e.sortIndex=e.expirationTime,M(B,e)}e=E(A)}}function G(t){if(U=!1,L(t),!O)if(null!==E(B))O=!0,r(D);else{var e=E(A);null!==e&&i(G,e.startTime-t)}}function D(t,n){O=!1,U&&(U=!1,o()),N=!0;var r=P;try{for(L(n),F=E(B);null!==F&&(!(F.expirationTime>n)||t&&!a());){var s=F.callback;if(null!==s){F.callback=null,P=F.priorityLevel;var u=s(F.expirationTime<=n);n=e.unstable_now(),"function"===typeof u?F.callback=u:F===E(B)&&R(B),L(n)}else R(B);F=E(B)}if(null!==F)var c=!0;else{var l=E(A);null!==l&&i(G,l.startTime-n),c=!1}return c}finally{F=null,P=r,N=!1}}function V(t){switch(t){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var H=s;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){O||N||(O=!0,r(D))},e.unstable_getCurrentPriorityLevel=function(){return P},e.unstable_getFirstCallbackNode=function(){return E(B)},e.unstable_next=function(t){switch(P){case 1:case 2:case 3:var e=3;break;default:e=P}var n=P;P=e;try{return t()}finally{P=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=H,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=P;P=t;try{return e()}finally{P=n}},e.unstable_scheduleCallback=function(t,n,a){var s=e.unstable_now();if("object"===typeof a&&null!==a){var u=a.delay;u="number"===typeof u&&0<u?s+u:s,a="number"===typeof a.timeout?a.timeout:V(t)}else a=V(t),u=s;return t={id:C++,callback:n,priorityLevel:t,startTime:u,expirationTime:a=u+a,sortIndex:-1},u>s?(t.sortIndex=u,M(A,t),null===E(B)&&t===E(A)&&(U?o():U=!0,i(G,u-s))):(t.sortIndex=a,M(B,t),O||N||(O=!0,r(D))),t},e.unstable_shouldYield=function(){var t=e.unstable_now();L(t);var n=E(B);return n!==F&&null!==F&&null!==n&&null!==n.callback&&n.startTime<=t&&n.expirationTime<F.expirationTime||a()},e.unstable_wrapCallback=function(t){var e=P;return function(){var n=P;P=e;try{return t.apply(this,arguments)}finally{P=n}}}},function(t,e,n){var r=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,r="function"===typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n,r){var i=e&&e.prototype instanceof l?e:l,o=Object.create(i.prototype),a=new w(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return S()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=u(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(t,n,a),o}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(r){return{type:"throw",arg:r}}}t.wrap=s;var c={};function l(){}function d(){}function f(){}var h={};h[i]=function(){return this};var p=Object.getPrototypeOf,m=p&&p(p(T([])));m&&m!==e&&n.call(m,i)&&(h=m);var v=f.prototype=l.prototype=Object.create(h);function g(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function y(t,e){var r;this._invoke=function(i,o){function a(){return new e((function(r,a){!function r(i,o,a,s){var c=u(t[i],t,o);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"===typeof d&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function b(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,b(t,e),"throw"===e.method))return c;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var r=u(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,c;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function w(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function T(t){if(t){var e=t[i];if(e)return e.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:S}}function S(){return{value:void 0,done:!0}}return d.prototype=v.constructor=f,f.constructor=d,f[a]=d.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,a in t||(t[a]="GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},g(y.prototype),y.prototype[o]=function(){return this},t.AsyncIterator=y,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new y(s(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(v),v[a]="Generator",v[i]=function(){return this},v.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=T,w.prototype={constructor:w,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},t}(t.exports);try{regeneratorRuntime=r}catch(i){Function("r","regeneratorRuntime = r")(r)}},function(t,e,n){(function(t){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},i=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(t).replace(i,(function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}})),u=r[n];n<o;u=r[++n])m(u)||!x(u)?a+=" "+u:a+=" "+s(u);return a},e.deprecate=function(n,r){if("undefined"!==typeof t&&!0===t.noDeprecation)return n;if("undefined"===typeof t)return function(){return e.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,a={};function s(t,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&e._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),l(r,t,r.depth)}function u(t,e){var n=s.styles[e];return n?"\x1b["+s.colors[n][0]+"m"+t+"\x1b["+s.colors[n][1]+"m":t}function c(t,e){return t}function l(t,n,r){if(t.customInspect&&n&&T(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return g(i)||(i=l(t,i,r)),i}var o=function(t,e){if(y(e))return t.stylize("undefined","undefined");if(g(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(v(e))return t.stylize(""+e,"number");if(p(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,n);if(o)return o;var a=Object.keys(n),s=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),w(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return d(n);if(0===a.length){if(T(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return t.stylize(Date.prototype.toString.call(n),"date");if(w(n))return d(n)}var c,x="",S=!1,M=["{","}"];(h(n)&&(S=!0,M=["[","]"]),T(n))&&(x=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(x=" "+RegExp.prototype.toString.call(n)),_(n)&&(x=" "+Date.prototype.toUTCString.call(n)),w(n)&&(x=" "+d(n)),0!==a.length||S&&0!=n.length?r<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=S?function(t,e,n,r,i){for(var o=[],a=0,s=e.length;a<s;++a)I(e,String(a))?o.push(f(t,e,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(f(t,e,n,r,i,!0))})),o}(t,n,r,s,a):a.map((function(e){return f(t,n,r,s,e,S)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(c,x,M)):M[0]+x+M[1]}function d(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),I(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(u.value)<0?(s=m(n)?l(t,u.value,null):l(t,u.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),y(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function h(t){return Array.isArray(t)}function p(t){return"boolean"===typeof t}function m(t){return null===t}function v(t){return"number"===typeof t}function g(t){return"string"===typeof t}function y(t){return void 0===t}function b(t){return x(t)&&"[object RegExp]"===S(t)}function x(t){return"object"===typeof t&&null!==t}function _(t){return x(t)&&"[object Date]"===S(t)}function w(t){return x(t)&&("[object Error]"===S(t)||t instanceof Error)}function T(t){return"function"===typeof t}function S(t){return Object.prototype.toString.call(t)}function M(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(y(o)&&(o=Object({NODE_ENV:"production",PUBLIC_URL:"/reveal-distance-measurement",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=t.pid;a[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else a[n]=function(){};return a[n]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=h,e.isBoolean=p,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=v,e.isString=g,e.isSymbol=function(t){return"symbol"===typeof t},e.isUndefined=y,e.isRegExp=b,e.isObject=x,e.isDate=_,e.isError=w,e.isFunction=T,e.isPrimitive=function(t){return null===t||"boolean"===typeof t||"number"===typeof t||"string"===typeof t||"symbol"===typeof t||"undefined"===typeof t},e.isBuffer=n(108);var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var t=new Date,e=[M(t.getHours()),M(t.getMinutes()),M(t.getSeconds())].join(":");return[t.getDate(),E[t.getMonth()],e].join(" ")}function I(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",R(),e.format.apply(e,arguments))},e.inherits=n(109),e._extend=function(t,e){if(!e||!x(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var B="undefined"!==typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!==typeof t)throw new TypeError('The "original" argument must be of type Function');if(B&&t[B]){var e;if("function"!==typeof(e=t[B]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,B,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise((function(t,r){e=t,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(t,r){t?n(t):e(r)}));try{t.apply(this,i)}catch(a){n(a)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),B&&Object.defineProperty(e,B,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=B,e.callbackify=function(e){if("function"!==typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!==typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};e.apply(this,n).then((function(e){t.nextTick(a,null,e)}),(function(e){t.nextTick(A,e,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,r(e)),n}}).call(this,n(107))},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"===typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],l=!1,d=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):d=-1,c.length&&h())}function h(){if(!l){var t=s(f);l=!0;for(var e=c.length;e;){for(u=c,c=[];++d<e;)u&&u[d].run();d=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||l||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"===typeof t&&"function"===typeof t.copy&&"function"===typeof t.fill&&"function"===typeof t.readUInt8}},function(t,e){"function"===typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e){var n=function(t){function e(){this.fetch=!1,this.DOMException=t.DOMException}return e.prototype=t,new e}("undefined"!==typeof self?self:this);!function(t){!function(e){var n="URLSearchParams"in t,r="Symbol"in t&&"iterator"in Symbol,i="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),o="FormData"in t,a="ArrayBuffer"in t;if(a)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(t){return t&&s.indexOf(Object.prototype.toString.call(t))>-1};function c(t){if("string"!==typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function l(t){return"string"!==typeof t&&(t=String(t)),t}function d(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return r&&(e[Symbol.iterator]=function(){return e}),e}function f(t){this.map={},t instanceof f?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function h(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function m(t){var e=new FileReader,n=p(e);return e.readAsArrayBuffer(t),n}function v(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"===typeof t?this._bodyText=t:i&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:o&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:n&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():a&&i&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=v(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(t)||u(t))?this._bodyArrayBuffer=v(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"===typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var t=h(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var t=h(this);if(t)return t;if(this._bodyBlob)return function(t){var e=new FileReader,n=p(e);return e.readAsText(t),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(x)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(t,e){t=c(t),e=l(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},f.prototype.delete=function(t){delete this.map[c(t)]},f.prototype.get=function(t){return t=c(t),this.has(t)?this.map[t]:null},f.prototype.has=function(t){return this.map.hasOwnProperty(c(t))},f.prototype.set=function(t,e){this.map[c(t)]=l(e)},f.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},f.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),d(t)},f.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),d(t)},f.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),d(t)},r&&(f.prototype[Symbol.iterator]=f.prototype.entries);var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(t,e){var n=(e=e||{}).body;if(t instanceof b){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new f(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new f(e.headers)),this.method=function(t){var e=t.toUpperCase();return y.indexOf(e)>-1?e:t}(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function x(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}})),e}function _(t){var e=new f;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}})),e}function w(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new f(e.headers),this.url=e.url||"",this._initBody(t)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},g.call(b.prototype),g.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},w.error=function(){var t=new w(null,{status:0,statusText:""});return t.type="error",t};var T=[301,302,303,307,308];w.redirect=function(t,e){if(-1===T.indexOf(e))throw new RangeError("Invalid status code");return new w(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(M){e.DOMException=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function S(t,n){return new Promise((function(r,o){var a=new b(t,n);if(a.signal&&a.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function u(){s.abort()}s.onload=function(){var t={status:s.status,statusText:s.statusText,headers:_(s.getAllResponseHeaders()||"")};t.url="responseURL"in s?s.responseURL:t.headers.get("X-Request-URL");var e="response"in s?s.response:s.responseText;r(new w(e,t))},s.onerror=function(){o(new TypeError("Network request failed"))},s.ontimeout=function(){o(new TypeError("Network request failed"))},s.onabort=function(){o(new e.DOMException("Aborted","AbortError"))},s.open(a.method,a.url,!0),"include"===a.credentials?s.withCredentials=!0:"omit"===a.credentials&&(s.withCredentials=!1),"responseType"in s&&i&&(s.responseType="blob"),a.headers.forEach((function(t,e){s.setRequestHeader(e,t)})),a.signal&&(a.signal.addEventListener("abort",u),s.onreadystatechange=function(){4===s.readyState&&a.signal.removeEventListener("abort",u)}),s.send("undefined"===typeof a._bodyInit?null:a._bodyInit)}))}S.polyfill=!0,t.fetch||(t.fetch=S,t.Headers=f,t.Request=b,t.Response=w),e.Headers=f,e.Request=b,e.Response=w,e.fetch=S}({})}(n),delete n.fetch.polyfill,(e=n.fetch).default=n.fetch,e.fetch=n.fetch,e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response,t.exports=e},function(t,e,n){"use strict";var r=n(112),i=n(79),o=n(113);function a(t,e){return e.encode?e.strict?r(t):encodeURIComponent(t):t}function s(t){var e=t.indexOf("?");return-1===e?"":t.slice(e+1)}function u(t,e){var n=function(t){var e;switch(t.arrayFormat){case"index":return function(t,n,r){e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===r[t]&&(r[t]={}),r[t][e[1]]=n):r[t]=n};case"bracket":return function(t,n,r){e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0!==r[t]?r[t]=[].concat(r[t],n):r[t]=[n]:r[t]=n};default:return function(t,e,n){void 0!==n[t]?n[t]=[].concat(n[t],e):n[t]=e}}}(e=i({arrayFormat:"none"},e)),r=Object.create(null);return"string"!==typeof t?r:(t=t.trim().replace(/^[?#&]/,""))?(t.split("&").forEach((function(t){var e=t.replace(/\+/g," ").split("="),i=e.shift(),a=e.length>0?e.join("="):void 0;a=void 0===a?null:o(a),n(o(i),a,r)})),Object.keys(r).sort().reduce((function(t,e){var n=r[e];return Boolean(n)&&"object"===typeof n&&!Array.isArray(n)?t[e]=function t(e){return Array.isArray(e)?e.sort():"object"===typeof e?t(Object.keys(e)).sort((function(t,e){return Number(t)-Number(e)})).map((function(t){return e[t]})):e}(n):t[e]=n,t}),Object.create(null))):r}e.extract=s,e.parse=u,e.stringify=function(t,e){!1===(e=i({encode:!0,strict:!0,arrayFormat:"none"},e)).sort&&(e.sort=function(){});var n=function(t){switch(t.arrayFormat){case"index":return function(e,n,r){return null===n?[a(e,t),"[",r,"]"].join(""):[a(e,t),"[",a(r,t),"]=",a(n,t)].join("")};case"bracket":return function(e,n){return null===n?a(e,t):[a(e,t),"[]=",a(n,t)].join("")};default:return function(e,n){return null===n?a(e,t):[a(e,t),"=",a(n,t)].join("")}}}(e);return t?Object.keys(t).sort(e.sort).map((function(r){var i=t[r];if(void 0===i)return"";if(null===i)return a(r,e);if(Array.isArray(i)){var o=[];return i.slice().forEach((function(t){void 0!==t&&o.push(n(r,t,o.length))})),o.join("&")}return a(r,e)+"="+a(i,e)})).filter((function(t){return t.length>0})).join("&"):""},e.parseUrl=function(t,e){return{url:t.split("?")[0]||"",query:u(s(t),e)}}},function(t,e,n){"use strict";t.exports=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,(function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()}))}},function(t,e,n){"use strict";var r=new RegExp("%[a-f0-9]{2}","gi"),i=new RegExp("(%[a-f0-9]{2})+","gi");function o(t,e){try{return decodeURIComponent(t.join(""))}catch(i){}if(1===t.length)return t;e=e||1;var n=t.slice(0,e),r=t.slice(e);return Array.prototype.concat.call([],o(n),o(r))}function a(t){try{return decodeURIComponent(t)}catch(i){for(var e=t.match(r),n=1;n<e.length;n++)e=(t=o(e,n).join("")).match(r);return t}}t.exports=function(t){if("string"!==typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var n={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"},r=i.exec(t);r;){try{n[r[0]]=decodeURIComponent(r[0])}catch(e){var o=a(r[0]);o!==r[0]&&(n[r[0]]=o)}r=i.exec(t)}n["%C2"]="\ufffd";for(var s=Object.keys(n),u=0;u<s.length;u++){var c=s[u];t=t.replace(new RegExp(c,"g"),n[c])}return t}(t)}}},function(t,e,n){"use strict";var r=n(115),i=n(116);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=b,e.resolve=function(t,e){return b(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?b(t,!1,!0).resolveObject(e):e},e.format=function(t){i.isString(t)&&(t=b(t));return t instanceof o?t.format():o.prototype.format.call(t)},e.Url=o;var a=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(c),d=["%","/","?",";","#"].concat(l),f=["/","?","#"],h=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=n(117);function b(t,e,n){if(t&&i.isObject(t)&&t instanceof o)return t;var r=new o;return r.parse(t,e,n),r}o.prototype.parse=function(t,e,n){if(!i.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t.indexOf("?"),s=-1!==o&&o<t.indexOf("#")?"?":"#",c=t.split(s);c[0]=c[0].replace(/\\/g,"/");var b=t=c.join(s);if(b=b.trim(),!n&&1===t.split("#").length){var x=u.exec(b);if(x)return this.path=b,this.href=b,this.pathname=x[1],x[2]?(this.search=x[2],this.query=e?y.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var _=a.exec(b);if(_){var w=(_=_[0]).toLowerCase();this.protocol=w,b=b.substr(_.length)}if(n||_||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var T="//"===b.substr(0,2);!T||_&&v[_]||(b=b.substr(2),this.slashes=!0)}if(!v[_]&&(T||_&&!g[_])){for(var S,M,E=-1,R=0;R<f.length;R++){-1!==(I=b.indexOf(f[R]))&&(-1===E||I<E)&&(E=I)}-1!==(M=-1===E?b.lastIndexOf("@"):b.lastIndexOf("@",E))&&(S=b.slice(0,M),b=b.slice(M+1),this.auth=decodeURIComponent(S)),E=-1;for(R=0;R<d.length;R++){var I;-1!==(I=b.indexOf(d[R]))&&(-1===E||I<E)&&(E=I)}-1===E&&(E=b.length),this.host=b.slice(0,E),b=b.slice(E),this.parseHost(),this.hostname=this.hostname||"";var B="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!B)for(var A=this.hostname.split(/\./),C=(R=0,A.length);R<C;R++){var F=A[R];if(F&&!F.match(h)){for(var P="",N=0,O=F.length;N<O;N++)F.charCodeAt(N)>127?P+="x":P+=F[N];if(!P.match(h)){var U=A.slice(0,R),L=A.slice(R+1),G=F.match(p);G&&(U.push(G[1]),L.unshift(G[2])),L.length&&(b="/"+L.join(".")+b),this.hostname=U.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),B||(this.hostname=r.toASCII(this.hostname));var D=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+D,this.href+=this.host,B&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!m[w])for(R=0,C=l.length;R<C;R++){var H=l[R];if(-1!==b.indexOf(H)){var k=encodeURIComponent(H);k===H&&(k=escape(H)),b=b.split(H).join(k)}}var z=b.indexOf("#");-1!==z&&(this.hash=b.substr(z),b=b.slice(0,z));var X=b.indexOf("?");if(-1!==X?(this.search=b.substr(X),this.query=b.substr(X+1),e&&(this.query=y.parse(this.query)),b=b.slice(0,X)):e&&(this.search="",this.query={}),b&&(this.pathname=b),g[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){D=this.pathname||"";var W=this.search||"";this.path=D+W}return this.href=this.format(),this},o.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,a="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(a=y.stringify(this.query));var s=this.search||a&&"?"+a||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||g[e])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),e+o+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(s=s.replace("#","%23"))+r},o.prototype.resolve=function(t){return this.resolveObject(b(t,!1,!0)).format()},o.prototype.resolveObject=function(t){if(i.isString(t)){var e=new o;e.parse(t,!1,!0),t=e}for(var n=new o,r=Object.keys(this),a=0;a<r.length;a++){var s=r[a];n[s]=this[s]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var u=Object.keys(t),c=0;c<u.length;c++){var l=u[c];"protocol"!==l&&(n[l]=t[l])}return g[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!g[t.protocol]){for(var d=Object.keys(t),f=0;f<d.length;f++){var h=d[f];n[h]=t[h]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||v[t.protocol])n.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var m=n.pathname||"",y=n.search||"";n.path=m+y}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),x=t.host||t.pathname&&"/"===t.pathname.charAt(0),_=x||b||n.host&&t.pathname,w=_,T=n.pathname&&n.pathname.split("/")||[],S=(p=t.pathname&&t.pathname.split("/")||[],n.protocol&&!g[n.protocol]);if(S&&(n.hostname="",n.port=null,n.host&&(""===T[0]?T[0]=n.host:T.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),_=_&&(""===p[0]||""===T[0])),x)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,T=p;else if(p.length)T||(T=[]),T.pop(),T=T.concat(p),n.search=t.search,n.query=t.query;else if(!i.isNullOrUndefined(t.search)){if(S)n.hostname=n.host=T.shift(),(B=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=B.shift(),n.host=n.hostname=B.shift());return n.search=t.search,n.query=t.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!T.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var M=T.slice(-1)[0],E=(n.host||t.host||T.length>1)&&("."===M||".."===M)||""===M,R=0,I=T.length;I>=0;I--)"."===(M=T[I])?T.splice(I,1):".."===M?(T.splice(I,1),R++):R&&(T.splice(I,1),R--);if(!_&&!w)for(;R--;R)T.unshift("..");!_||""===T[0]||T[0]&&"/"===T[0].charAt(0)||T.unshift(""),E&&"/"!==T.join("/").substr(-1)&&T.push("");var B,A=""===T[0]||T[0]&&"/"===T[0].charAt(0);S&&(n.hostname=n.host=A?"":T.length?T.shift():"",(B=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=B.shift(),n.host=n.hostname=B.shift()));return(_=_||n.host&&T.length)&&!A&&T.unshift(""),T.length?n.pathname=T.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var t=this.host,e=s.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,n){(function(t,r){var i;!function(o){e&&e.nodeType,t&&t.nodeType;var a="object"==typeof r&&r;a.global!==a&&a.window!==a&&a.self;var s,u=2147483647,c=/^xn--/,l=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},h=Math.floor,p=String.fromCharCode;function m(t){throw new RangeError(f[t])}function v(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function g(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+v((t=t.replace(d,".")).split("."),e).join(".")}function y(t){for(var e,n,r=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function b(t){return v(t,(function(t){var e="";return t>65535&&(e+=p((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=p(t)})).join("")}function x(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function _(t,e,n){var r=0;for(t=n?h(t/700):t>>1,t+=h(t/e);t>455;r+=36)t=h(t/35);return h(r+36*t/(t+38))}function w(t){var e,n,r,i,o,a,s,c,l,d,f,p=[],v=t.length,g=0,y=128,x=72;for((n=t.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&m("not-basic"),p.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<v;){for(o=g,a=1,s=36;i>=v&&m("invalid-input"),((c=(f=t.charCodeAt(i++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:36)>=36||c>h((u-g)/a))&&m("overflow"),g+=c*a,!(c<(l=s<=x?1:s>=x+26?26:s-x));s+=36)a>h(u/(d=36-l))&&m("overflow"),a*=d;x=_(g-o,e=p.length+1,0==o),h(g/e)>u-y&&m("overflow"),y+=h(g/e),g%=e,p.splice(g++,0,y)}return b(p)}function T(t){var e,n,r,i,o,a,s,c,l,d,f,v,g,b,w,T=[];for(v=(t=y(t)).length,e=128,n=0,o=72,a=0;a<v;++a)(f=t[a])<128&&T.push(p(f));for(r=i=T.length,i&&T.push("-");r<v;){for(s=u,a=0;a<v;++a)(f=t[a])>=e&&f<s&&(s=f);for(s-e>h((u-n)/(g=r+1))&&m("overflow"),n+=(s-e)*g,e=s,a=0;a<v;++a)if((f=t[a])<e&&++n>u&&m("overflow"),f==e){for(c=n,l=36;!(c<(d=l<=o?1:l>=o+26?26:l-o));l+=36)w=c-d,b=36-d,T.push(p(x(d+w%b,0))),c=h(w/b);T.push(p(x(c,0))),o=_(n,g,r==i),n=0,++r}++n,++e}return T.join("")}s={version:"1.4.1",ucs2:{decode:y,encode:b},decode:w,encode:T,toASCII:function(t){return g(t,(function(t){return l.test(t)?"xn--"+T(t):t}))},toUnicode:function(t){return g(t,(function(t){return c.test(t)?w(t.slice(4).toLowerCase()):t}))}},void 0===(i=function(){return s}.call(e,n,e,t))||(t.exports=i)}()}).call(this,n(85)(t),n(86))},function(t,e,n){"use strict";t.exports={isString:function(t){return"string"===typeof t},isObject:function(t){return"object"===typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,n){"use strict";e.decode=e.parse=n(118),e.encode=e.stringify=n(119)},function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var a={};if("string"!==typeof t||0===t.length)return a;var s=/\+/g;t=t.split(e);var u=1e3;o&&"number"===typeof o.maxKeys&&(u=o.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var d,f,h,p,m=t[l].replace(s,"%20"),v=m.indexOf(n);v>=0?(d=m.substr(0,v),f=m.substr(v+1)):(d=m,f=""),h=decodeURIComponent(d),p=decodeURIComponent(f),r(a,h)?i(a[h])?a[h].push(p):a[h]=[a[h],p]:a[h]=p}return a};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,s){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"===typeof t?o(a(t),(function(a){var s=encodeURIComponent(r(a))+n;return i(t[a])?o(t[a],(function(t){return s+encodeURIComponent(r(t))})).join(e):s+encodeURIComponent(r(t[a]))})).join(e):s?encodeURIComponent(r(s))+n+encodeURIComponent(r(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var a=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},function(t,e,n){(function(t,r){var i;(function(){var o="Expected a function",a="__lodash_placeholder__",s=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],u="[object Arguments]",c="[object Array]",l="[object Boolean]",d="[object Date]",f="[object Error]",h="[object Function]",p="[object GeneratorFunction]",m="[object Map]",v="[object Number]",g="[object Object]",y="[object RegExp]",b="[object Set]",x="[object String]",_="[object Symbol]",w="[object WeakMap]",T="[object ArrayBuffer]",S="[object DataView]",M="[object Float32Array]",E="[object Float64Array]",R="[object Int8Array]",I="[object Int16Array]",B="[object Int32Array]",A="[object Uint8Array]",C="[object Uint16Array]",F="[object Uint32Array]",P=/\b__p \+= '';/g,N=/\b(__p \+=) '' \+/g,O=/(__e\(.*?\)|\b__t\)) \+\n'';/g,U=/&(?:amp|lt|gt|quot|#39);/g,L=/[&<>"']/g,G=RegExp(U.source),D=RegExp(L.source),V=/<%-([\s\S]+?)%>/g,H=/<%([\s\S]+?)%>/g,k=/<%=([\s\S]+?)%>/g,z=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X=/^\w*$/,W=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,j=/[\\^$.*+?()[\]{}|]/g,Z=RegExp(j.source),Q=/^\s+|\s+$/g,Y=/^\s+/,J=/\s+$/,q=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,K=/\{\n\/\* \[wrapped with (.+)\] \*/,$=/,? & /,tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,et=/\\(\\)?/g,nt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,rt=/\w*$/,it=/^[-+]0x[0-9a-f]+$/i,ot=/^0b[01]+$/i,at=/^\[object .+?Constructor\]$/,st=/^0o[0-7]+$/i,ut=/^(?:0|[1-9]\d*)$/,ct=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,lt=/($^)/,dt=/['\n\r\u2028\u2029\\]/g,ft="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ht="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pt="[\\ud800-\\udfff]",mt="["+ht+"]",vt="["+ft+"]",gt="\\d+",yt="[\\u2700-\\u27bf]",bt="[a-z\\xdf-\\xf6\\xf8-\\xff]",xt="[^\\ud800-\\udfff"+ht+gt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",_t="\\ud83c[\\udffb-\\udfff]",wt="[^\\ud800-\\udfff]",Tt="(?:\\ud83c[\\udde6-\\uddff]){2}",St="[\\ud800-\\udbff][\\udc00-\\udfff]",Mt="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Et="(?:"+bt+"|"+xt+")",Rt="(?:"+Mt+"|"+xt+")",It="(?:"+vt+"|"+_t+")"+"?",Bt="[\\ufe0e\\ufe0f]?"+It+("(?:\\u200d(?:"+[wt,Tt,St].join("|")+")[\\ufe0e\\ufe0f]?"+It+")*"),At="(?:"+[yt,Tt,St].join("|")+")"+Bt,Ct="(?:"+[wt+vt+"?",vt,Tt,St,pt].join("|")+")",Ft=RegExp("['\u2019]","g"),Pt=RegExp(vt,"g"),Nt=RegExp(_t+"(?="+_t+")|"+Ct+Bt,"g"),Ot=RegExp([Mt+"?"+bt+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?="+[mt,Mt,"$"].join("|")+")",Rt+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?="+[mt,Mt+Et,"$"].join("|")+")",Mt+"?"+Et+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Mt+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",gt,At].join("|"),"g"),Ut=RegExp("[\\u200d\\ud800-\\udfff"+ft+"\\ufe0e\\ufe0f]"),Lt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Gt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Dt=-1,Vt={};Vt[M]=Vt[E]=Vt[R]=Vt[I]=Vt[B]=Vt[A]=Vt["[object Uint8ClampedArray]"]=Vt[C]=Vt[F]=!0,Vt[u]=Vt[c]=Vt[T]=Vt[l]=Vt[S]=Vt[d]=Vt[f]=Vt[h]=Vt[m]=Vt[v]=Vt[g]=Vt[y]=Vt[b]=Vt[x]=Vt[w]=!1;var Ht={};Ht[u]=Ht[c]=Ht[T]=Ht[S]=Ht[l]=Ht[d]=Ht[M]=Ht[E]=Ht[R]=Ht[I]=Ht[B]=Ht[m]=Ht[v]=Ht[g]=Ht[y]=Ht[b]=Ht[x]=Ht[_]=Ht[A]=Ht["[object Uint8ClampedArray]"]=Ht[C]=Ht[F]=!0,Ht[f]=Ht[h]=Ht[w]=!1;var kt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},zt=parseFloat,Xt=parseInt,Wt="object"==typeof t&&t&&t.Object===Object&&t,jt="object"==typeof self&&self&&self.Object===Object&&self,Zt=Wt||jt||Function("return this")(),Qt=e&&!e.nodeType&&e,Yt=Qt&&"object"==typeof r&&r&&!r.nodeType&&r,Jt=Yt&&Yt.exports===Qt,qt=Jt&&Wt.process,Kt=function(){try{var t=Yt&&Yt.require&&Yt.require("util").types;return t||qt&&qt.binding&&qt.binding("util")}catch(e){}}(),$t=Kt&&Kt.isArrayBuffer,te=Kt&&Kt.isDate,ee=Kt&&Kt.isMap,ne=Kt&&Kt.isRegExp,re=Kt&&Kt.isSet,ie=Kt&&Kt.isTypedArray;function oe(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function ae(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var a=t[i];e(r,a,n(a),t)}return r}function se(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function ue(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function ce(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function le(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function de(t,e){return!!(null==t?0:t.length)&&_e(t,e,0)>-1}function fe(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function he(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function pe(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function me(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function ve(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function ge(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var ye=Me("length");function be(t,e,n){var r;return n(t,(function(t,n,i){if(e(t,n,i))return r=n,!1})),r}function xe(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function _e(t,e,n){return e===e?function(t,e,n){var r=n-1,i=t.length;for(;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):xe(t,Te,n)}function we(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function Te(t){return t!==t}function Se(t,e){var n=null==t?0:t.length;return n?Ie(t,e)/n:NaN}function Me(t){return function(e){return null==e?void 0:e[t]}}function Ee(t){return function(e){return null==t?void 0:t[e]}}function Re(t,e,n,r,i){return i(t,(function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)})),n}function Ie(t,e){for(var n,r=-1,i=t.length;++r<i;){var o=e(t[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}function Be(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Ae(t){return function(e){return t(e)}}function Ce(t,e){return he(e,(function(e){return t[e]}))}function Fe(t,e){return t.has(e)}function Pe(t,e){for(var n=-1,r=t.length;++n<r&&_e(e,t[n],0)>-1;);return n}function Ne(t,e){for(var n=t.length;n--&&_e(e,t[n],0)>-1;);return n}function Oe(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var Ue=Ee({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),Le=Ee({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Ge(t){return"\\"+kt[t]}function De(t){return Ut.test(t)}function Ve(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function He(t,e){return function(n){return t(e(n))}}function ke(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s=t[n];s!==e&&s!==a||(t[n]=a,o[i++]=n)}return o}function ze(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function Xe(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function We(t){return De(t)?function(t){var e=Nt.lastIndex=0;for(;Nt.test(t);)++e;return e}(t):ye(t)}function je(t){return De(t)?function(t){return t.match(Nt)||[]}(t):function(t){return t.split("")}(t)}var Ze=Ee({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Qe=function t(e){var n=(e=null==e?Zt:Qe.defaults(Zt.Object(),e,Qe.pick(Zt,Gt))).Array,r=e.Date,i=e.Error,ft=e.Function,ht=e.Math,pt=e.Object,mt=e.RegExp,vt=e.String,gt=e.TypeError,yt=n.prototype,bt=ft.prototype,xt=pt.prototype,_t=e["__core-js_shared__"],wt=bt.toString,Tt=xt.hasOwnProperty,St=0,Mt=function(){var t=/[^.]+$/.exec(_t&&_t.keys&&_t.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Et=xt.toString,Rt=wt.call(pt),It=Zt._,Bt=mt("^"+wt.call(Tt).replace(j,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),At=Jt?e.Buffer:void 0,Ct=e.Symbol,Nt=e.Uint8Array,Ut=At?At.allocUnsafe:void 0,kt=He(pt.getPrototypeOf,pt),Wt=pt.create,jt=xt.propertyIsEnumerable,Qt=yt.splice,Yt=Ct?Ct.isConcatSpreadable:void 0,qt=Ct?Ct.iterator:void 0,Kt=Ct?Ct.toStringTag:void 0,ye=function(){try{var t=Ki(pt,"defineProperty");return t({},"",{}),t}catch(e){}}(),Ee=e.clearTimeout!==Zt.clearTimeout&&e.clearTimeout,Ye=r&&r.now!==Zt.Date.now&&r.now,Je=e.setTimeout!==Zt.setTimeout&&e.setTimeout,qe=ht.ceil,Ke=ht.floor,$e=pt.getOwnPropertySymbols,tn=At?At.isBuffer:void 0,en=e.isFinite,nn=yt.join,rn=He(pt.keys,pt),on=ht.max,an=ht.min,sn=r.now,un=e.parseInt,cn=ht.random,ln=yt.reverse,dn=Ki(e,"DataView"),fn=Ki(e,"Map"),hn=Ki(e,"Promise"),pn=Ki(e,"Set"),mn=Ki(e,"WeakMap"),vn=Ki(pt,"create"),gn=mn&&new mn,yn={},bn=Eo(dn),xn=Eo(fn),_n=Eo(hn),wn=Eo(pn),Tn=Eo(mn),Sn=Ct?Ct.prototype:void 0,Mn=Sn?Sn.valueOf:void 0,En=Sn?Sn.toString:void 0;function Rn(t){if(za(t)&&!Fa(t)&&!(t instanceof Cn)){if(t instanceof An)return t;if(Tt.call(t,"__wrapped__"))return Ro(t)}return new An(t)}var In=function(){function t(){}return function(e){if(!ka(e))return{};if(Wt)return Wt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function Bn(){}function An(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function Cn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Fn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Pn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Nn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function On(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Nn;++e<n;)this.add(t[e])}function Un(t){var e=this.__data__=new Pn(t);this.size=e.size}function Ln(t,e){var n=Fa(t),r=!n&&Ca(t),i=!n&&!r&&Ua(t),o=!n&&!r&&!i&&qa(t),a=n||r||i||o,s=a?Be(t.length,vt):[],u=s.length;for(var c in t)!e&&!Tt.call(t,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||oo(c,u))||s.push(c);return s}function Gn(t){var e=t.length;return e?t[Or(0,e-1)]:void 0}function Dn(t,e){return To(vi(t),Qn(e,0,t.length))}function Vn(t){return To(vi(t))}function Hn(t,e,n){(void 0!==n&&!Ia(t[e],n)||void 0===n&&!(e in t))&&jn(t,e,n)}function kn(t,e,n){var r=t[e];Tt.call(t,e)&&Ia(r,n)&&(void 0!==n||e in t)||jn(t,e,n)}function zn(t,e){for(var n=t.length;n--;)if(Ia(t[n][0],e))return n;return-1}function Xn(t,e,n,r){return $n(t,(function(t,i,o){e(r,t,n(t),o)})),r}function Wn(t,e){return t&&gi(e,bs(e),t)}function jn(t,e,n){"__proto__"==e&&ye?ye(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Zn(t,e){for(var r=-1,i=e.length,o=n(i),a=null==t;++r<i;)o[r]=a?void 0:ps(t,e[r]);return o}function Qn(t,e,n){return t===t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}function Yn(t,e,n,r,i,o){var a,s=1&e,c=2&e,f=4&e;if(n&&(a=i?n(t,r,i,o):n(t)),void 0!==a)return a;if(!ka(t))return t;var w=Fa(t);if(w){if(a=function(t){var e=t.length,n=new t.constructor(e);e&&"string"==typeof t[0]&&Tt.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!s)return vi(t,a)}else{var P=eo(t),N=P==h||P==p;if(Ua(t))return li(t,s);if(P==g||P==u||N&&!i){if(a=c||N?{}:ro(t),!s)return c?function(t,e){return gi(t,to(t),e)}(t,function(t,e){return t&&gi(e,xs(e),t)}(a,t)):function(t,e){return gi(t,$i(t),e)}(t,Wn(a,t))}else{if(!Ht[P])return i?t:{};a=function(t,e,n){var r=t.constructor;switch(e){case T:return di(t);case l:case d:return new r(+t);case S:return function(t,e){var n=e?di(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case M:case E:case R:case I:case B:case A:case"[object Uint8ClampedArray]":case C:case F:return fi(t,n);case m:return new r;case v:case x:return new r(t);case y:return function(t){var e=new t.constructor(t.source,rt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case b:return new r;case _:return i=t,Mn?pt(Mn.call(i)):{}}var i}(t,P,s)}}o||(o=new Un);var O=o.get(t);if(O)return O;o.set(t,a),Qa(t)?t.forEach((function(r){a.add(Yn(r,e,n,r,t,o))})):Xa(t)&&t.forEach((function(r,i){a.set(i,Yn(r,e,n,i,t,o))}));var U=w?void 0:(f?c?Wi:Xi:c?xs:bs)(t);return se(U||t,(function(r,i){U&&(r=t[i=r]),kn(a,i,Yn(r,e,n,i,t,o))})),a}function Jn(t,e,n){var r=n.length;if(null==t)return!r;for(t=pt(t);r--;){var i=n[r],o=e[i],a=t[i];if(void 0===a&&!(i in t)||!o(a))return!1}return!0}function qn(t,e,n){if("function"!=typeof t)throw new gt(o);return bo((function(){t.apply(void 0,n)}),e)}function Kn(t,e,n,r){var i=-1,o=de,a=!0,s=t.length,u=[],c=e.length;if(!s)return u;n&&(e=he(e,Ae(n))),r?(o=fe,a=!1):e.length>=200&&(o=Fe,a=!1,e=new On(e));t:for(;++i<s;){var l=t[i],d=null==n?l:n(l);if(l=r||0!==l?l:0,a&&d===d){for(var f=c;f--;)if(e[f]===d)continue t;u.push(l)}else o(e,d,r)||u.push(l)}return u}Rn.templateSettings={escape:V,evaluate:H,interpolate:k,variable:"",imports:{_:Rn}},Rn.prototype=Bn.prototype,Rn.prototype.constructor=Rn,An.prototype=In(Bn.prototype),An.prototype.constructor=An,Cn.prototype=In(Bn.prototype),Cn.prototype.constructor=Cn,Fn.prototype.clear=function(){this.__data__=vn?vn(null):{},this.size=0},Fn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Fn.prototype.get=function(t){var e=this.__data__;if(vn){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return Tt.call(e,t)?e[t]:void 0},Fn.prototype.has=function(t){var e=this.__data__;return vn?void 0!==e[t]:Tt.call(e,t)},Fn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=vn&&void 0===e?"__lodash_hash_undefined__":e,this},Pn.prototype.clear=function(){this.__data__=[],this.size=0},Pn.prototype.delete=function(t){var e=this.__data__,n=zn(e,t);return!(n<0)&&(n==e.length-1?e.pop():Qt.call(e,n,1),--this.size,!0)},Pn.prototype.get=function(t){var e=this.__data__,n=zn(e,t);return n<0?void 0:e[n][1]},Pn.prototype.has=function(t){return zn(this.__data__,t)>-1},Pn.prototype.set=function(t,e){var n=this.__data__,r=zn(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Nn.prototype.clear=function(){this.size=0,this.__data__={hash:new Fn,map:new(fn||Pn),string:new Fn}},Nn.prototype.delete=function(t){var e=Ji(this,t).delete(t);return this.size-=e?1:0,e},Nn.prototype.get=function(t){return Ji(this,t).get(t)},Nn.prototype.has=function(t){return Ji(this,t).has(t)},Nn.prototype.set=function(t,e){var n=Ji(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},On.prototype.add=On.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},On.prototype.has=function(t){return this.__data__.has(t)},Un.prototype.clear=function(){this.__data__=new Pn,this.size=0},Un.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Un.prototype.get=function(t){return this.__data__.get(t)},Un.prototype.has=function(t){return this.__data__.has(t)},Un.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Pn){var r=n.__data__;if(!fn||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Nn(r)}return n.set(t,e),this.size=n.size,this};var $n=xi(sr),tr=xi(ur,!0);function er(t,e){var n=!0;return $n(t,(function(t,r,i){return n=!!e(t,r,i)})),n}function nr(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],a=e(o);if(null!=a&&(void 0===s?a===a&&!Ja(a):n(a,s)))var s=a,u=o}return u}function rr(t,e){var n=[];return $n(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}function ir(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=io),i||(i=[]);++o<a;){var s=t[o];e>0&&n(s)?e>1?ir(s,e-1,n,r,i):pe(i,s):r||(i[i.length]=s)}return i}var or=_i(),ar=_i(!0);function sr(t,e){return t&&or(t,e,bs)}function ur(t,e){return t&&ar(t,e,bs)}function cr(t,e){return le(e,(function(e){return Da(t[e])}))}function lr(t,e){for(var n=0,r=(e=ai(e,t)).length;null!=t&&n<r;)t=t[Mo(e[n++])];return n&&n==r?t:void 0}function dr(t,e,n){var r=e(t);return Fa(t)?r:pe(r,n(t))}function fr(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Kt&&Kt in pt(t)?function(t){var e=Tt.call(t,Kt),n=t[Kt];try{t[Kt]=void 0;var r=!0}catch(o){}var i=Et.call(t);r&&(e?t[Kt]=n:delete t[Kt]);return i}(t):function(t){return Et.call(t)}(t)}function hr(t,e){return t>e}function pr(t,e){return null!=t&&Tt.call(t,e)}function mr(t,e){return null!=t&&e in pt(t)}function vr(t,e,r){for(var i=r?fe:de,o=t[0].length,a=t.length,s=a,u=n(a),c=1/0,l=[];s--;){var d=t[s];s&&e&&(d=he(d,Ae(e))),c=an(d.length,c),u[s]=!r&&(e||o>=120&&d.length>=120)?new On(s&&d):void 0}d=t[0];var f=-1,h=u[0];t:for(;++f<o&&l.length<c;){var p=d[f],m=e?e(p):p;if(p=r||0!==p?p:0,!(h?Fe(h,m):i(l,m,r))){for(s=a;--s;){var v=u[s];if(!(v?Fe(v,m):i(t[s],m,r)))continue t}h&&h.push(m),l.push(p)}}return l}function gr(t,e,n){var r=null==(t=mo(t,e=ai(e,t)))?t:t[Mo(Go(e))];return null==r?void 0:oe(r,t,n)}function yr(t){return za(t)&&fr(t)==u}function br(t,e,n,r,i){return t===e||(null==t||null==e||!za(t)&&!za(e)?t!==t&&e!==e:function(t,e,n,r,i,o){var a=Fa(t),s=Fa(e),h=a?c:eo(t),p=s?c:eo(e),w=(h=h==u?g:h)==g,M=(p=p==u?g:p)==g,E=h==p;if(E&&Ua(t)){if(!Ua(e))return!1;a=!0,w=!1}if(E&&!w)return o||(o=new Un),a||qa(t)?ki(t,e,n,r,i,o):function(t,e,n,r,i,o,a){switch(n){case S:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case T:return!(t.byteLength!=e.byteLength||!o(new Nt(t),new Nt(e)));case l:case d:case v:return Ia(+t,+e);case f:return t.name==e.name&&t.message==e.message;case y:case x:return t==e+"";case m:var s=Ve;case b:var u=1&r;if(s||(s=ze),t.size!=e.size&&!u)return!1;var c=a.get(t);if(c)return c==e;r|=2,a.set(t,e);var h=ki(s(t),s(e),r,i,o,a);return a.delete(t),h;case _:if(Mn)return Mn.call(t)==Mn.call(e)}return!1}(t,e,h,n,r,i,o);if(!(1&n)){var R=w&&Tt.call(t,"__wrapped__"),I=M&&Tt.call(e,"__wrapped__");if(R||I){var B=R?t.value():t,A=I?e.value():e;return o||(o=new Un),i(B,A,n,r,o)}}if(!E)return!1;return o||(o=new Un),function(t,e,n,r,i,o){var a=1&n,s=Xi(t),u=s.length,c=Xi(e).length;if(u!=c&&!a)return!1;var l=u;for(;l--;){var d=s[l];if(!(a?d in e:Tt.call(e,d)))return!1}var f=o.get(t);if(f&&o.get(e))return f==e;var h=!0;o.set(t,e),o.set(e,t);var p=a;for(;++l<u;){d=s[l];var m=t[d],v=e[d];if(r)var g=a?r(v,m,d,e,t,o):r(m,v,d,t,e,o);if(!(void 0===g?m===v||i(m,v,n,r,o):g)){h=!1;break}p||(p="constructor"==d)}if(h&&!p){var y=t.constructor,b=e.constructor;y==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(h=!1)}return o.delete(t),o.delete(e),h}(t,e,n,r,i,o)}(t,e,n,r,br,i))}function xr(t,e,n,r){var i=n.length,o=i,a=!r;if(null==t)return!o;for(t=pt(t);i--;){var s=n[i];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<o;){var u=(s=n[i])[0],c=t[u],l=s[1];if(a&&s[2]){if(void 0===c&&!(u in t))return!1}else{var d=new Un;if(r)var f=r(c,l,u,t,e,d);if(!(void 0===f?br(l,c,3,r,d):f))return!1}}return!0}function _r(t){return!(!ka(t)||(e=t,Mt&&Mt in e))&&(Da(t)?Bt:at).test(Eo(t));var e}function wr(t){return"function"==typeof t?t:null==t?Ws:"object"==typeof t?Fa(t)?Ir(t[0],t[1]):Rr(t):tu(t)}function Tr(t){if(!lo(t))return rn(t);var e=[];for(var n in pt(t))Tt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Sr(t){if(!ka(t))return function(t){var e=[];if(null!=t)for(var n in pt(t))e.push(n);return e}(t);var e=lo(t),n=[];for(var r in t)("constructor"!=r||!e&&Tt.call(t,r))&&n.push(r);return n}function Mr(t,e){return t<e}function Er(t,e){var r=-1,i=Na(t)?n(t.length):[];return $n(t,(function(t,n,o){i[++r]=e(t,n,o)})),i}function Rr(t){var e=qi(t);return 1==e.length&&e[0][2]?ho(e[0][0],e[0][1]):function(n){return n===t||xr(n,t,e)}}function Ir(t,e){return so(t)&&fo(e)?ho(Mo(t),e):function(n){var r=ps(n,t);return void 0===r&&r===e?ms(n,t):br(e,r,3)}}function Br(t,e,n,r,i){t!==e&&or(e,(function(o,a){if(i||(i=new Un),ka(o))!function(t,e,n,r,i,o,a){var s=go(t,n),u=go(e,n),c=a.get(u);if(c)return void Hn(t,n,c);var l=o?o(s,u,n+"",t,e,a):void 0,d=void 0===l;if(d){var f=Fa(u),h=!f&&Ua(u),p=!f&&!h&&qa(u);l=u,f||h||p?Fa(s)?l=s:Oa(s)?l=vi(s):h?(d=!1,l=li(u,!0)):p?(d=!1,l=fi(u,!0)):l=[]:ja(u)||Ca(u)?(l=s,Ca(s)?l=os(s):ka(s)&&!Da(s)||(l=ro(u))):d=!1}d&&(a.set(u,l),i(l,u,r,o,a),a.delete(u));Hn(t,n,l)}(t,e,a,n,Br,r,i);else{var s=r?r(go(t,a),o,a+"",t,e,i):void 0;void 0===s&&(s=o),Hn(t,a,s)}}),xs)}function Ar(t,e){var n=t.length;if(n)return oo(e+=e<0?n:0,n)?t[e]:void 0}function Cr(t,e,n){var r=-1;return e=he(e.length?e:[Ws],Ae(Yi())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(Er(t,(function(t,n,i){return{criteria:he(e,(function(e){return e(t)})),index:++r,value:t}})),(function(t,e){return function(t,e,n){var r=-1,i=t.criteria,o=e.criteria,a=i.length,s=n.length;for(;++r<a;){var u=hi(i[r],o[r]);if(u){if(r>=s)return u;var c=n[r];return u*("desc"==c?-1:1)}}return t.index-e.index}(t,e,n)}))}function Fr(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var a=e[r],s=lr(t,a);n(s,a)&&Vr(o,ai(a,t),s)}return o}function Pr(t,e,n,r){var i=r?we:_e,o=-1,a=e.length,s=t;for(t===e&&(e=vi(e)),n&&(s=he(t,Ae(n)));++o<a;)for(var u=0,c=e[o],l=n?n(c):c;(u=i(s,l,u,r))>-1;)s!==t&&Qt.call(s,u,1),Qt.call(t,u,1);return t}function Nr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;oo(i)?Qt.call(t,i,1):Kr(t,i)}}return t}function Or(t,e){return t+Ke(cn()*(e-t+1))}function Ur(t,e){var n="";if(!t||e<1||e>9007199254740991)return n;do{e%2&&(n+=t),(e=Ke(e/2))&&(t+=t)}while(e);return n}function Lr(t,e){return xo(po(t,e,Ws),t+"")}function Gr(t){return Gn(Is(t))}function Dr(t,e){var n=Is(t);return To(n,Qn(e,0,n.length))}function Vr(t,e,n,r){if(!ka(t))return t;for(var i=-1,o=(e=ai(e,t)).length,a=o-1,s=t;null!=s&&++i<o;){var u=Mo(e[i]),c=n;if(i!=a){var l=s[u];void 0===(c=r?r(l,u,s):void 0)&&(c=ka(l)?l:oo(e[i+1])?[]:{})}kn(s,u,c),s=s[u]}return t}var Hr=gn?function(t,e){return gn.set(t,e),t}:Ws,kr=ye?function(t,e){return ye(t,"toString",{configurable:!0,enumerable:!1,value:ks(e),writable:!0})}:Ws;function zr(t){return To(Is(t))}function Xr(t,e,r){var i=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(r=r>o?o:r)<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var a=n(o);++i<o;)a[i]=t[i+e];return a}function Wr(t,e){var n;return $n(t,(function(t,r,i){return!(n=e(t,r,i))})),!!n}function jr(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e===e&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=t[o];null!==a&&!Ja(a)&&(n?a<=e:a<e)?r=o+1:i=o}return i}return Zr(t,e,Ws,n)}function Zr(t,e,n,r){e=n(e);for(var i=0,o=null==t?0:t.length,a=e!==e,s=null===e,u=Ja(e),c=void 0===e;i<o;){var l=Ke((i+o)/2),d=n(t[l]),f=void 0!==d,h=null===d,p=d===d,m=Ja(d);if(a)var v=r||p;else v=c?p&&(r||f):s?p&&f&&(r||!h):u?p&&f&&!h&&(r||!m):!h&&!m&&(r?d<=e:d<e);v?i=l+1:o=l}return an(o,4294967294)}function Qr(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],s=e?e(a):a;if(!n||!Ia(s,u)){var u=s;o[i++]=0===a?0:a}}return o}function Yr(t){return"number"==typeof t?t:Ja(t)?NaN:+t}function Jr(t){if("string"==typeof t)return t;if(Fa(t))return he(t,Jr)+"";if(Ja(t))return En?En.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function qr(t,e,n){var r=-1,i=de,o=t.length,a=!0,s=[],u=s;if(n)a=!1,i=fe;else if(o>=200){var c=e?null:Ui(t);if(c)return ze(c);a=!1,i=Fe,u=new On}else u=e?[]:s;t:for(;++r<o;){var l=t[r],d=e?e(l):l;if(l=n||0!==l?l:0,a&&d===d){for(var f=u.length;f--;)if(u[f]===d)continue t;e&&u.push(d),s.push(l)}else i(u,d,n)||(u!==s&&u.push(d),s.push(l))}return s}function Kr(t,e){return null==(t=mo(t,e=ai(e,t)))||delete t[Mo(Go(e))]}function $r(t,e,n,r){return Vr(t,e,n(lr(t,e)),r)}function ti(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?Xr(t,r?0:o,r?o+1:i):Xr(t,r?o+1:0,r?i:o)}function ei(t,e){var n=t;return n instanceof Cn&&(n=n.value()),me(e,(function(t,e){return e.func.apply(e.thisArg,pe([t],e.args))}),n)}function ni(t,e,r){var i=t.length;if(i<2)return i?qr(t[0]):[];for(var o=-1,a=n(i);++o<i;)for(var s=t[o],u=-1;++u<i;)u!=o&&(a[o]=Kn(a[o]||s,t[u],e,r));return qr(ir(a,1),e,r)}function ri(t,e,n){for(var r=-1,i=t.length,o=e.length,a={};++r<i;){var s=r<o?e[r]:void 0;n(a,t[r],s)}return a}function ii(t){return Oa(t)?t:[]}function oi(t){return"function"==typeof t?t:Ws}function ai(t,e){return Fa(t)?t:so(t,e)?[t]:So(as(t))}var si=Lr;function ui(t,e,n){var r=t.length;return n=void 0===n?r:n,!e&&n>=r?t:Xr(t,e,n)}var ci=Ee||function(t){return Zt.clearTimeout(t)};function li(t,e){if(e)return t.slice();var n=t.length,r=Ut?Ut(n):new t.constructor(n);return t.copy(r),r}function di(t){var e=new t.constructor(t.byteLength);return new Nt(e).set(new Nt(t)),e}function fi(t,e){var n=e?di(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function hi(t,e){if(t!==e){var n=void 0!==t,r=null===t,i=t===t,o=Ja(t),a=void 0!==e,s=null===e,u=e===e,c=Ja(e);if(!s&&!c&&!o&&t>e||o&&a&&u&&!s&&!c||r&&a&&u||!n&&u||!i)return 1;if(!r&&!o&&!c&&t<e||c&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!u)return-1}return 0}function pi(t,e,r,i){for(var o=-1,a=t.length,s=r.length,u=-1,c=e.length,l=on(a-s,0),d=n(c+l),f=!i;++u<c;)d[u]=e[u];for(;++o<s;)(f||o<a)&&(d[r[o]]=t[o]);for(;l--;)d[u++]=t[o++];return d}function mi(t,e,r,i){for(var o=-1,a=t.length,s=-1,u=r.length,c=-1,l=e.length,d=on(a-u,0),f=n(d+l),h=!i;++o<d;)f[o]=t[o];for(var p=o;++c<l;)f[p+c]=e[c];for(;++s<u;)(h||o<a)&&(f[p+r[s]]=t[o++]);return f}function vi(t,e){var r=-1,i=t.length;for(e||(e=n(i));++r<i;)e[r]=t[r];return e}function gi(t,e,n,r){var i=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var s=e[o],u=r?r(n[s],t[s],s,n,t):void 0;void 0===u&&(u=t[s]),i?jn(n,s,u):kn(n,s,u)}return n}function yi(t,e){return function(n,r){var i=Fa(n)?ae:Xn,o=e?e():{};return i(n,t,Yi(r,2),o)}}function bi(t){return Lr((function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,a&&ao(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),e=pt(e);++r<i;){var s=n[r];s&&t(e,s,r,o)}return e}))}function xi(t,e){return function(n,r){if(null==n)return n;if(!Na(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=pt(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function _i(t){return function(e,n,r){for(var i=-1,o=pt(e),a=r(e),s=a.length;s--;){var u=a[t?s:++i];if(!1===n(o[u],u,o))break}return e}}function wi(t){return function(e){var n=De(e=as(e))?je(e):void 0,r=n?n[0]:e.charAt(0),i=n?ui(n,1).join(""):e.slice(1);return r[t]()+i}}function Ti(t){return function(e){return me(Ds(Cs(e).replace(Ft,"")),t,"")}}function Si(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=In(t.prototype),r=t.apply(n,e);return ka(r)?r:n}}function Mi(t){return function(e,n,r){var i=pt(e);if(!Na(e)){var o=Yi(n,3);e=bs(e),n=function(t){return o(i[t],t,i)}}var a=t(e,n,r);return a>-1?i[o?e[a]:a]:void 0}}function Ei(t){return zi((function(e){var n=e.length,r=n,i=An.prototype.thru;for(t&&e.reverse();r--;){var a=e[r];if("function"!=typeof a)throw new gt(o);if(i&&!s&&"wrapper"==Zi(a))var s=new An([],!0)}for(r=s?r:n;++r<n;){var u=Zi(a=e[r]),c="wrapper"==u?ji(a):void 0;s=c&&uo(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?s[Zi(c[0])].apply(s,c[3]):1==a.length&&uo(a)?s[u]():s.thru(a)}return function(){var t=arguments,r=t[0];if(s&&1==t.length&&Fa(r))return s.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}}))}function Ri(t,e,r,i,o,a,s,u,c,l){var d=128&e,f=1&e,h=2&e,p=24&e,m=512&e,v=h?void 0:Si(t);return function g(){for(var y=arguments.length,b=n(y),x=y;x--;)b[x]=arguments[x];if(p)var _=Qi(g),w=Oe(b,_);if(i&&(b=pi(b,i,o,p)),a&&(b=mi(b,a,s,p)),y-=w,p&&y<l){var T=ke(b,_);return Ni(t,e,Ri,g.placeholder,r,b,T,u,c,l-y)}var S=f?r:this,M=h?S[t]:t;return y=b.length,u?b=vo(b,u):m&&y>1&&b.reverse(),d&&c<y&&(b.length=c),this&&this!==Zt&&this instanceof g&&(M=v||Si(M)),M.apply(S,b)}}function Ii(t,e){return function(n,r){return function(t,e,n,r){return sr(t,(function(t,i,o){e(r,n(t),i,o)})),r}(n,t,e(r),{})}}function Bi(t,e){return function(n,r){var i;if(void 0===n&&void 0===r)return e;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=Jr(n),r=Jr(r)):(n=Yr(n),r=Yr(r)),i=t(n,r)}return i}}function Ai(t){return zi((function(e){return e=he(e,Ae(Yi())),Lr((function(n){var r=this;return t(e,(function(t){return oe(t,r,n)}))}))}))}function Ci(t,e){var n=(e=void 0===e?" ":Jr(e)).length;if(n<2)return n?Ur(e,t):e;var r=Ur(e,qe(t/We(e)));return De(e)?ui(je(r),0,t).join(""):r.slice(0,t)}function Fi(t){return function(e,r,i){return i&&"number"!=typeof i&&ao(e,r,i)&&(r=i=void 0),e=es(e),void 0===r?(r=e,e=0):r=es(r),function(t,e,r,i){for(var o=-1,a=on(qe((e-t)/(r||1)),0),s=n(a);a--;)s[i?a:++o]=t,t+=r;return s}(e,r,i=void 0===i?e<r?1:-1:es(i),t)}}function Pi(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=is(e),n=is(n)),t(e,n)}}function Ni(t,e,n,r,i,o,a,s,u,c){var l=8&e;e|=l?32:64,4&(e&=~(l?64:32))||(e&=-4);var d=[t,e,i,l?o:void 0,l?a:void 0,l?void 0:o,l?void 0:a,s,u,c],f=n.apply(void 0,d);return uo(t)&&yo(f,d),f.placeholder=r,_o(f,t,e)}function Oi(t){var e=ht[t];return function(t,n){if(t=is(t),(n=null==n?0:an(ns(n),292))&&en(t)){var r=(as(t)+"e").split("e");return+((r=(as(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Ui=pn&&1/ze(new pn([,-0]))[1]==1/0?function(t){return new pn(t)}:Js;function Li(t){return function(e){var n=eo(e);return n==m?Ve(e):n==b?Xe(e):function(t,e){return he(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Gi(t,e,r,i,s,u,c,l){var d=2&e;if(!d&&"function"!=typeof t)throw new gt(o);var f=i?i.length:0;if(f||(e&=-97,i=s=void 0),c=void 0===c?c:on(ns(c),0),l=void 0===l?l:ns(l),f-=s?s.length:0,64&e){var h=i,p=s;i=s=void 0}var m=d?void 0:ji(t),v=[t,e,r,i,s,h,p,u,c,l];if(m&&function(t,e){var n=t[1],r=e[1],i=n|r,o=i<131,s=128==r&&8==n||128==r&&256==n&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!o&&!s)return t;1&r&&(t[2]=e[2],i|=1&n?0:4);var u=e[3];if(u){var c=t[3];t[3]=c?pi(c,u,e[4]):u,t[4]=c?ke(t[3],a):e[4]}(u=e[5])&&(c=t[5],t[5]=c?mi(c,u,e[6]):u,t[6]=c?ke(t[5],a):e[6]);(u=e[7])&&(t[7]=u);128&r&&(t[8]=null==t[8]?e[8]:an(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=i}(v,m),t=v[0],e=v[1],r=v[2],i=v[3],s=v[4],!(l=v[9]=void 0===v[9]?d?0:t.length:on(v[9]-f,0))&&24&e&&(e&=-25),e&&1!=e)g=8==e||16==e?function(t,e,r){var i=Si(t);return function o(){for(var a=arguments.length,s=n(a),u=a,c=Qi(o);u--;)s[u]=arguments[u];var l=a<3&&s[0]!==c&&s[a-1]!==c?[]:ke(s,c);if((a-=l.length)<r)return Ni(t,e,Ri,o.placeholder,void 0,s,l,void 0,void 0,r-a);var d=this&&this!==Zt&&this instanceof o?i:t;return oe(d,this,s)}}(t,e,l):32!=e&&33!=e||s.length?Ri.apply(void 0,v):function(t,e,r,i){var o=1&e,a=Si(t);return function e(){for(var s=-1,u=arguments.length,c=-1,l=i.length,d=n(l+u),f=this&&this!==Zt&&this instanceof e?a:t;++c<l;)d[c]=i[c];for(;u--;)d[c++]=arguments[++s];return oe(f,o?r:this,d)}}(t,e,r,i);else var g=function(t,e,n){var r=1&e,i=Si(t);return function e(){var o=this&&this!==Zt&&this instanceof e?i:t;return o.apply(r?n:this,arguments)}}(t,e,r);return _o((m?Hr:yo)(g,v),t,e)}function Di(t,e,n,r){return void 0===t||Ia(t,xt[n])&&!Tt.call(r,n)?e:t}function Vi(t,e,n,r,i,o){return ka(t)&&ka(e)&&(o.set(e,t),Br(t,e,void 0,Vi,o),o.delete(e)),t}function Hi(t){return ja(t)?void 0:t}function ki(t,e,n,r,i,o){var a=1&n,s=t.length,u=e.length;if(s!=u&&!(a&&u>s))return!1;var c=o.get(t);if(c&&o.get(e))return c==e;var l=-1,d=!0,f=2&n?new On:void 0;for(o.set(t,e),o.set(e,t);++l<s;){var h=t[l],p=e[l];if(r)var m=a?r(p,h,l,e,t,o):r(h,p,l,t,e,o);if(void 0!==m){if(m)continue;d=!1;break}if(f){if(!ge(e,(function(t,e){if(!Fe(f,e)&&(h===t||i(h,t,n,r,o)))return f.push(e)}))){d=!1;break}}else if(h!==p&&!i(h,p,n,r,o)){d=!1;break}}return o.delete(t),o.delete(e),d}function zi(t){return xo(po(t,void 0,Po),t+"")}function Xi(t){return dr(t,bs,$i)}function Wi(t){return dr(t,xs,to)}var ji=gn?function(t){return gn.get(t)}:Js;function Zi(t){for(var e=t.name+"",n=yn[e],r=Tt.call(yn,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function Qi(t){return(Tt.call(Rn,"placeholder")?Rn:t).placeholder}function Yi(){var t=Rn.iteratee||js;return t=t===js?wr:t,arguments.length?t(arguments[0],arguments[1]):t}function Ji(t,e){var n=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?n["string"==typeof e?"string":"hash"]:n.map}function qi(t){for(var e=bs(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,fo(i)]}return e}function Ki(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return _r(n)?n:void 0}var $i=$e?function(t){return null==t?[]:(t=pt(t),le($e(t),(function(e){return jt.call(t,e)})))}:ru,to=$e?function(t){for(var e=[];t;)pe(e,$i(t)),t=kt(t);return e}:ru,eo=fr;function no(t,e,n){for(var r=-1,i=(e=ai(e,t)).length,o=!1;++r<i;){var a=Mo(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&Ha(i)&&oo(a,i)&&(Fa(t)||Ca(t))}function ro(t){return"function"!=typeof t.constructor||lo(t)?{}:In(kt(t))}function io(t){return Fa(t)||Ca(t)||!!(Yt&&t&&t[Yt])}function oo(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&ut.test(t))&&t>-1&&t%1==0&&t<e}function ao(t,e,n){if(!ka(n))return!1;var r=typeof e;return!!("number"==r?Na(n)&&oo(e,n.length):"string"==r&&e in n)&&Ia(n[e],t)}function so(t,e){if(Fa(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Ja(t))||(X.test(t)||!z.test(t)||null!=e&&t in pt(e))}function uo(t){var e=Zi(t),n=Rn[e];if("function"!=typeof n||!(e in Cn.prototype))return!1;if(t===n)return!0;var r=ji(n);return!!r&&t===r[0]}(dn&&eo(new dn(new ArrayBuffer(1)))!=S||fn&&eo(new fn)!=m||hn&&"[object Promise]"!=eo(hn.resolve())||pn&&eo(new pn)!=b||mn&&eo(new mn)!=w)&&(eo=function(t){var e=fr(t),n=e==g?t.constructor:void 0,r=n?Eo(n):"";if(r)switch(r){case bn:return S;case xn:return m;case _n:return"[object Promise]";case wn:return b;case Tn:return w}return e});var co=_t?Da:iu;function lo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||xt)}function fo(t){return t===t&&!ka(t)}function ho(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in pt(n)))}}function po(t,e,r){return e=on(void 0===e?t.length-1:e,0),function(){for(var i=arguments,o=-1,a=on(i.length-e,0),s=n(a);++o<a;)s[o]=i[e+o];o=-1;for(var u=n(e+1);++o<e;)u[o]=i[o];return u[e]=r(s),oe(t,this,u)}}function mo(t,e){return e.length<2?t:lr(t,Xr(e,0,-1))}function vo(t,e){for(var n=t.length,r=an(e.length,n),i=vi(t);r--;){var o=e[r];t[r]=oo(o,n)?i[o]:void 0}return t}function go(t,e){if(("constructor"!==e||"function"!==typeof t[e])&&"__proto__"!=e)return t[e]}var yo=wo(Hr),bo=Je||function(t,e){return Zt.setTimeout(t,e)},xo=wo(kr);function _o(t,e,n){var r=e+"";return xo(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(q,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return se(s,(function(n){var r="_."+n[0];e&n[1]&&!de(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(K);return e?e[1].split($):[]}(r),n)))}function wo(t){var e=0,n=0;return function(){var r=sn(),i=16-(r-n);if(n=r,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function To(t,e){var n=-1,r=t.length,i=r-1;for(e=void 0===e?r:e;++n<e;){var o=Or(n,i),a=t[o];t[o]=t[n],t[n]=a}return t.length=e,t}var So=function(t){var e=wa(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(W,(function(t,n,r,i){e.push(r?i.replace(et,"$1"):n||t)})),e}));function Mo(t){if("string"==typeof t||Ja(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Eo(t){if(null!=t){try{return wt.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function Ro(t){if(t instanceof Cn)return t.clone();var e=new An(t.__wrapped__,t.__chain__);return e.__actions__=vi(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Io=Lr((function(t,e){return Oa(t)?Kn(t,ir(e,1,Oa,!0)):[]})),Bo=Lr((function(t,e){var n=Go(e);return Oa(n)&&(n=void 0),Oa(t)?Kn(t,ir(e,1,Oa,!0),Yi(n,2)):[]})),Ao=Lr((function(t,e){var n=Go(e);return Oa(n)&&(n=void 0),Oa(t)?Kn(t,ir(e,1,Oa,!0),void 0,n):[]}));function Co(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ns(n);return i<0&&(i=on(r+i,0)),xe(t,Yi(e,3),i)}function Fo(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=ns(n),i=n<0?on(r+i,0):an(i,r-1)),xe(t,Yi(e,3),i,!0)}function Po(t){return(null==t?0:t.length)?ir(t,1):[]}function No(t){return t&&t.length?t[0]:void 0}var Oo=Lr((function(t){var e=he(t,ii);return e.length&&e[0]===t[0]?vr(e):[]})),Uo=Lr((function(t){var e=Go(t),n=he(t,ii);return e===Go(n)?e=void 0:n.pop(),n.length&&n[0]===t[0]?vr(n,Yi(e,2)):[]})),Lo=Lr((function(t){var e=Go(t),n=he(t,ii);return(e="function"==typeof e?e:void 0)&&n.pop(),n.length&&n[0]===t[0]?vr(n,void 0,e):[]}));function Go(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var Do=Lr(Vo);function Vo(t,e){return t&&t.length&&e&&e.length?Pr(t,e):t}var Ho=zi((function(t,e){var n=null==t?0:t.length,r=Zn(t,e);return Nr(t,he(e,(function(t){return oo(t,n)?+t:t})).sort(hi)),r}));function ko(t){return null==t?t:ln.call(t)}var zo=Lr((function(t){return qr(ir(t,1,Oa,!0))})),Xo=Lr((function(t){var e=Go(t);return Oa(e)&&(e=void 0),qr(ir(t,1,Oa,!0),Yi(e,2))})),Wo=Lr((function(t){var e=Go(t);return e="function"==typeof e?e:void 0,qr(ir(t,1,Oa,!0),void 0,e)}));function jo(t){if(!t||!t.length)return[];var e=0;return t=le(t,(function(t){if(Oa(t))return e=on(t.length,e),!0})),Be(e,(function(e){return he(t,Me(e))}))}function Zo(t,e){if(!t||!t.length)return[];var n=jo(t);return null==e?n:he(n,(function(t){return oe(e,void 0,t)}))}var Qo=Lr((function(t,e){return Oa(t)?Kn(t,e):[]})),Yo=Lr((function(t){return ni(le(t,Oa))})),Jo=Lr((function(t){var e=Go(t);return Oa(e)&&(e=void 0),ni(le(t,Oa),Yi(e,2))})),qo=Lr((function(t){var e=Go(t);return e="function"==typeof e?e:void 0,ni(le(t,Oa),void 0,e)})),Ko=Lr(jo);var $o=Lr((function(t){var e=t.length,n=e>1?t[e-1]:void 0;return n="function"==typeof n?(t.pop(),n):void 0,Zo(t,n)}));function ta(t){var e=Rn(t);return e.__chain__=!0,e}function ea(t,e){return e(t)}var na=zi((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,i=function(e){return Zn(e,t)};return!(e>1||this.__actions__.length)&&r instanceof Cn&&oo(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:ea,args:[i],thisArg:void 0}),new An(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(void 0),t}))):this.thru(i)}));var ra=yi((function(t,e,n){Tt.call(t,n)?++t[n]:jn(t,n,1)}));var ia=Mi(Co),oa=Mi(Fo);function aa(t,e){return(Fa(t)?se:$n)(t,Yi(e,3))}function sa(t,e){return(Fa(t)?ue:tr)(t,Yi(e,3))}var ua=yi((function(t,e,n){Tt.call(t,n)?t[n].push(e):jn(t,n,[e])}));var ca=Lr((function(t,e,r){var i=-1,o="function"==typeof e,a=Na(t)?n(t.length):[];return $n(t,(function(t){a[++i]=o?oe(e,t,r):gr(t,e,r)})),a})),la=yi((function(t,e,n){jn(t,n,e)}));function da(t,e){return(Fa(t)?he:Er)(t,Yi(e,3))}var fa=yi((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));var ha=Lr((function(t,e){if(null==t)return[];var n=e.length;return n>1&&ao(t,e[0],e[1])?e=[]:n>2&&ao(e[0],e[1],e[2])&&(e=[e[0]]),Cr(t,ir(e,1),[])})),pa=Ye||function(){return Zt.Date.now()};function ma(t,e,n){return e=n?void 0:e,Gi(t,128,void 0,void 0,void 0,void 0,e=t&&null==e?t.length:e)}function va(t,e){var n;if("function"!=typeof e)throw new gt(o);return t=ns(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=void 0),n}}var ga=Lr((function(t,e,n){var r=1;if(n.length){var i=ke(n,Qi(ga));r|=32}return Gi(t,r,e,n,i)})),ya=Lr((function(t,e,n){var r=3;if(n.length){var i=ke(n,Qi(ya));r|=32}return Gi(e,r,t,n,i)}));function ba(t,e,n){var r,i,a,s,u,c,l=0,d=!1,f=!1,h=!0;if("function"!=typeof t)throw new gt(o);function p(e){var n=r,o=i;return r=i=void 0,l=e,s=t.apply(o,n)}function m(t){return l=t,u=bo(g,e),d?p(t):s}function v(t){var n=t-c;return void 0===c||n>=e||n<0||f&&t-l>=a}function g(){var t=pa();if(v(t))return y(t);u=bo(g,function(t){var n=e-(t-c);return f?an(n,a-(t-l)):n}(t))}function y(t){return u=void 0,h&&r?p(t):(r=i=void 0,s)}function b(){var t=pa(),n=v(t);if(r=arguments,i=this,c=t,n){if(void 0===u)return m(c);if(f)return ci(u),u=bo(g,e),p(c)}return void 0===u&&(u=bo(g,e)),s}return e=is(e)||0,ka(n)&&(d=!!n.leading,a=(f="maxWait"in n)?on(is(n.maxWait)||0,e):a,h="trailing"in n?!!n.trailing:h),b.cancel=function(){void 0!==u&&ci(u),l=0,r=c=i=u=void 0},b.flush=function(){return void 0===u?s:y(pa())},b}var xa=Lr((function(t,e){return qn(t,1,e)})),_a=Lr((function(t,e,n){return qn(t,is(e)||0,n)}));function wa(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new gt(o);var n=function n(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(wa.Cache||Nn),n}function Ta(t){if("function"!=typeof t)throw new gt(o);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}wa.Cache=Nn;var Sa=si((function(t,e){var n=(e=1==e.length&&Fa(e[0])?he(e[0],Ae(Yi())):he(ir(e,1),Ae(Yi()))).length;return Lr((function(r){for(var i=-1,o=an(r.length,n);++i<o;)r[i]=e[i].call(this,r[i]);return oe(t,this,r)}))})),Ma=Lr((function(t,e){return Gi(t,32,void 0,e,ke(e,Qi(Ma)))})),Ea=Lr((function(t,e){return Gi(t,64,void 0,e,ke(e,Qi(Ea)))})),Ra=zi((function(t,e){return Gi(t,256,void 0,void 0,void 0,e)}));function Ia(t,e){return t===e||t!==t&&e!==e}var Ba=Pi(hr),Aa=Pi((function(t,e){return t>=e})),Ca=yr(function(){return arguments}())?yr:function(t){return za(t)&&Tt.call(t,"callee")&&!jt.call(t,"callee")},Fa=n.isArray,Pa=$t?Ae($t):function(t){return za(t)&&fr(t)==T};function Na(t){return null!=t&&Ha(t.length)&&!Da(t)}function Oa(t){return za(t)&&Na(t)}var Ua=tn||iu,La=te?Ae(te):function(t){return za(t)&&fr(t)==d};function Ga(t){if(!za(t))return!1;var e=fr(t);return e==f||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!ja(t)}function Da(t){if(!ka(t))return!1;var e=fr(t);return e==h||e==p||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Va(t){return"number"==typeof t&&t==ns(t)}function Ha(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function ka(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function za(t){return null!=t&&"object"==typeof t}var Xa=ee?Ae(ee):function(t){return za(t)&&eo(t)==m};function Wa(t){return"number"==typeof t||za(t)&&fr(t)==v}function ja(t){if(!za(t)||fr(t)!=g)return!1;var e=kt(t);if(null===e)return!0;var n=Tt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&wt.call(n)==Rt}var Za=ne?Ae(ne):function(t){return za(t)&&fr(t)==y};var Qa=re?Ae(re):function(t){return za(t)&&eo(t)==b};function Ya(t){return"string"==typeof t||!Fa(t)&&za(t)&&fr(t)==x}function Ja(t){return"symbol"==typeof t||za(t)&&fr(t)==_}var qa=ie?Ae(ie):function(t){return za(t)&&Ha(t.length)&&!!Vt[fr(t)]};var Ka=Pi(Mr),$a=Pi((function(t,e){return t<=e}));function ts(t){if(!t)return[];if(Na(t))return Ya(t)?je(t):vi(t);if(qt&&t[qt])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[qt]());var e=eo(t);return(e==m?Ve:e==b?ze:Is)(t)}function es(t){return t?(t=is(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t===t?t:0:0===t?t:0}function ns(t){var e=es(t),n=e%1;return e===e?n?e-n:e:0}function rs(t){return t?Qn(ns(t),0,4294967295):0}function is(t){if("number"==typeof t)return t;if(Ja(t))return NaN;if(ka(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=ka(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Q,"");var n=ot.test(t);return n||st.test(t)?Xt(t.slice(2),n?2:8):it.test(t)?NaN:+t}function os(t){return gi(t,xs(t))}function as(t){return null==t?"":Jr(t)}var ss=bi((function(t,e){if(lo(e)||Na(e))gi(e,bs(e),t);else for(var n in e)Tt.call(e,n)&&kn(t,n,e[n])})),us=bi((function(t,e){gi(e,xs(e),t)})),cs=bi((function(t,e,n,r){gi(e,xs(e),t,r)})),ls=bi((function(t,e,n,r){gi(e,bs(e),t,r)})),ds=zi(Zn);var fs=Lr((function(t,e){t=pt(t);var n=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&ao(e[0],e[1],i)&&(r=1);++n<r;)for(var o=e[n],a=xs(o),s=-1,u=a.length;++s<u;){var c=a[s],l=t[c];(void 0===l||Ia(l,xt[c])&&!Tt.call(t,c))&&(t[c]=o[c])}return t})),hs=Lr((function(t){return t.push(void 0,Vi),oe(ws,void 0,t)}));function ps(t,e,n){var r=null==t?void 0:lr(t,e);return void 0===r?n:r}function ms(t,e){return null!=t&&no(t,e,mr)}var vs=Ii((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Et.call(e)),t[e]=n}),ks(Ws)),gs=Ii((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Et.call(e)),Tt.call(t,e)?t[e].push(n):t[e]=[n]}),Yi),ys=Lr(gr);function bs(t){return Na(t)?Ln(t):Tr(t)}function xs(t){return Na(t)?Ln(t,!0):Sr(t)}var _s=bi((function(t,e,n){Br(t,e,n)})),ws=bi((function(t,e,n,r){Br(t,e,n,r)})),Ts=zi((function(t,e){var n={};if(null==t)return n;var r=!1;e=he(e,(function(e){return e=ai(e,t),r||(r=e.length>1),e})),gi(t,Wi(t),n),r&&(n=Yn(n,7,Hi));for(var i=e.length;i--;)Kr(n,e[i]);return n}));var Ss=zi((function(t,e){return null==t?{}:function(t,e){return Fr(t,e,(function(e,n){return ms(t,n)}))}(t,e)}));function Ms(t,e){if(null==t)return{};var n=he(Wi(t),(function(t){return[t]}));return e=Yi(e),Fr(t,n,(function(t,n){return e(t,n[0])}))}var Es=Li(bs),Rs=Li(xs);function Is(t){return null==t?[]:Ce(t,bs(t))}var Bs=Ti((function(t,e,n){return e=e.toLowerCase(),t+(n?As(e):e)}));function As(t){return Gs(as(t).toLowerCase())}function Cs(t){return(t=as(t))&&t.replace(ct,Ue).replace(Pt,"")}var Fs=Ti((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Ps=Ti((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Ns=wi("toLowerCase");var Os=Ti((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));var Us=Ti((function(t,e,n){return t+(n?" ":"")+Gs(e)}));var Ls=Ti((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Gs=wi("toUpperCase");function Ds(t,e,n){return t=as(t),void 0===(e=n?void 0:e)?function(t){return Lt.test(t)}(t)?function(t){return t.match(Ot)||[]}(t):function(t){return t.match(tt)||[]}(t):t.match(e)||[]}var Vs=Lr((function(t,e){try{return oe(t,void 0,e)}catch(n){return Ga(n)?n:new i(n)}})),Hs=zi((function(t,e){return se(e,(function(e){e=Mo(e),jn(t,e,ga(t[e],t))})),t}));function ks(t){return function(){return t}}var zs=Ei(),Xs=Ei(!0);function Ws(t){return t}function js(t){return wr("function"==typeof t?t:Yn(t,1))}var Zs=Lr((function(t,e){return function(n){return gr(n,t,e)}})),Qs=Lr((function(t,e){return function(n){return gr(t,n,e)}}));function Ys(t,e,n){var r=bs(e),i=cr(e,r);null!=n||ka(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=cr(e,bs(e)));var o=!(ka(n)&&"chain"in n)||!!n.chain,a=Da(t);return se(i,(function(n){var r=e[n];t[n]=r,a&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__),i=n.__actions__=vi(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,pe([this.value()],arguments))})})),t}function Js(){}var qs=Ai(he),Ks=Ai(ce),$s=Ai(ge);function tu(t){return so(t)?Me(Mo(t)):function(t){return function(e){return lr(e,t)}}(t)}var eu=Fi(),nu=Fi(!0);function ru(){return[]}function iu(){return!1}var ou=Bi((function(t,e){return t+e}),0),au=Oi("ceil"),su=Bi((function(t,e){return t/e}),1),uu=Oi("floor");var cu=Bi((function(t,e){return t*e}),1),lu=Oi("round"),du=Bi((function(t,e){return t-e}),0);return Rn.after=function(t,e){if("function"!=typeof e)throw new gt(o);return t=ns(t),function(){if(--t<1)return e.apply(this,arguments)}},Rn.ary=ma,Rn.assign=ss,Rn.assignIn=us,Rn.assignInWith=cs,Rn.assignWith=ls,Rn.at=ds,Rn.before=va,Rn.bind=ga,Rn.bindAll=Hs,Rn.bindKey=ya,Rn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Fa(t)?t:[t]},Rn.chain=ta,Rn.chunk=function(t,e,r){e=(r?ao(t,e,r):void 0===e)?1:on(ns(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var o=0,a=0,s=n(qe(i/e));o<i;)s[a++]=Xr(t,o,o+=e);return s},Rn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},Rn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=n(t-1),r=arguments[0],i=t;i--;)e[i-1]=arguments[i];return pe(Fa(r)?vi(r):[r],ir(e,1))},Rn.cond=function(t){var e=null==t?0:t.length,n=Yi();return t=e?he(t,(function(t){if("function"!=typeof t[1])throw new gt(o);return[n(t[0]),t[1]]})):[],Lr((function(n){for(var r=-1;++r<e;){var i=t[r];if(oe(i[0],this,n))return oe(i[1],this,n)}}))},Rn.conforms=function(t){return function(t){var e=bs(t);return function(n){return Jn(n,t,e)}}(Yn(t,1))},Rn.constant=ks,Rn.countBy=ra,Rn.create=function(t,e){var n=In(t);return null==e?n:Wn(n,e)},Rn.curry=function t(e,n,r){var i=Gi(e,8,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=t.placeholder,i},Rn.curryRight=function t(e,n,r){var i=Gi(e,16,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=t.placeholder,i},Rn.debounce=ba,Rn.defaults=fs,Rn.defaultsDeep=hs,Rn.defer=xa,Rn.delay=_a,Rn.difference=Io,Rn.differenceBy=Bo,Rn.differenceWith=Ao,Rn.drop=function(t,e,n){var r=null==t?0:t.length;return r?Xr(t,(e=n||void 0===e?1:ns(e))<0?0:e,r):[]},Rn.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?Xr(t,0,(e=r-(e=n||void 0===e?1:ns(e)))<0?0:e):[]},Rn.dropRightWhile=function(t,e){return t&&t.length?ti(t,Yi(e,3),!0,!0):[]},Rn.dropWhile=function(t,e){return t&&t.length?ti(t,Yi(e,3),!0):[]},Rn.fill=function(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&ao(t,e,n)&&(n=0,r=i),function(t,e,n,r){var i=t.length;for((n=ns(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:ns(r))<0&&(r+=i),r=n>r?0:rs(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},Rn.filter=function(t,e){return(Fa(t)?le:rr)(t,Yi(e,3))},Rn.flatMap=function(t,e){return ir(da(t,e),1)},Rn.flatMapDeep=function(t,e){return ir(da(t,e),1/0)},Rn.flatMapDepth=function(t,e,n){return n=void 0===n?1:ns(n),ir(da(t,e),n)},Rn.flatten=Po,Rn.flattenDeep=function(t){return(null==t?0:t.length)?ir(t,1/0):[]},Rn.flattenDepth=function(t,e){return(null==t?0:t.length)?ir(t,e=void 0===e?1:ns(e)):[]},Rn.flip=function(t){return Gi(t,512)},Rn.flow=zs,Rn.flowRight=Xs,Rn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},Rn.functions=function(t){return null==t?[]:cr(t,bs(t))},Rn.functionsIn=function(t){return null==t?[]:cr(t,xs(t))},Rn.groupBy=ua,Rn.initial=function(t){return(null==t?0:t.length)?Xr(t,0,-1):[]},Rn.intersection=Oo,Rn.intersectionBy=Uo,Rn.intersectionWith=Lo,Rn.invert=vs,Rn.invertBy=gs,Rn.invokeMap=ca,Rn.iteratee=js,Rn.keyBy=la,Rn.keys=bs,Rn.keysIn=xs,Rn.map=da,Rn.mapKeys=function(t,e){var n={};return e=Yi(e,3),sr(t,(function(t,r,i){jn(n,e(t,r,i),t)})),n},Rn.mapValues=function(t,e){var n={};return e=Yi(e,3),sr(t,(function(t,r,i){jn(n,r,e(t,r,i))})),n},Rn.matches=function(t){return Rr(Yn(t,1))},Rn.matchesProperty=function(t,e){return Ir(t,Yn(e,1))},Rn.memoize=wa,Rn.merge=_s,Rn.mergeWith=ws,Rn.method=Zs,Rn.methodOf=Qs,Rn.mixin=Ys,Rn.negate=Ta,Rn.nthArg=function(t){return t=ns(t),Lr((function(e){return Ar(e,t)}))},Rn.omit=Ts,Rn.omitBy=function(t,e){return Ms(t,Ta(Yi(e)))},Rn.once=function(t){return va(2,t)},Rn.orderBy=function(t,e,n,r){return null==t?[]:(Fa(e)||(e=null==e?[]:[e]),Fa(n=r?void 0:n)||(n=null==n?[]:[n]),Cr(t,e,n))},Rn.over=qs,Rn.overArgs=Sa,Rn.overEvery=Ks,Rn.overSome=$s,Rn.partial=Ma,Rn.partialRight=Ea,Rn.partition=fa,Rn.pick=Ss,Rn.pickBy=Ms,Rn.property=tu,Rn.propertyOf=function(t){return function(e){return null==t?void 0:lr(t,e)}},Rn.pull=Do,Rn.pullAll=Vo,Rn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Pr(t,e,Yi(n,2)):t},Rn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Pr(t,e,void 0,n):t},Rn.pullAt=Ho,Rn.range=eu,Rn.rangeRight=nu,Rn.rearg=Ra,Rn.reject=function(t,e){return(Fa(t)?le:rr)(t,Ta(Yi(e,3)))},Rn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=Yi(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return Nr(t,i),n},Rn.rest=function(t,e){if("function"!=typeof t)throw new gt(o);return Lr(t,e=void 0===e?e:ns(e))},Rn.reverse=ko,Rn.sampleSize=function(t,e,n){return e=(n?ao(t,e,n):void 0===e)?1:ns(e),(Fa(t)?Dn:Dr)(t,e)},Rn.set=function(t,e,n){return null==t?t:Vr(t,e,n)},Rn.setWith=function(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:Vr(t,e,n,r)},Rn.shuffle=function(t){return(Fa(t)?Vn:zr)(t)},Rn.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&ao(t,e,n)?(e=0,n=r):(e=null==e?0:ns(e),n=void 0===n?r:ns(n)),Xr(t,e,n)):[]},Rn.sortBy=ha,Rn.sortedUniq=function(t){return t&&t.length?Qr(t):[]},Rn.sortedUniqBy=function(t,e){return t&&t.length?Qr(t,Yi(e,2)):[]},Rn.split=function(t,e,n){return n&&"number"!=typeof n&&ao(t,e,n)&&(e=n=void 0),(n=void 0===n?4294967295:n>>>0)?(t=as(t))&&("string"==typeof e||null!=e&&!Za(e))&&!(e=Jr(e))&&De(t)?ui(je(t),0,n):t.split(e,n):[]},Rn.spread=function(t,e){if("function"!=typeof t)throw new gt(o);return e=null==e?0:on(ns(e),0),Lr((function(n){var r=n[e],i=ui(n,0,e);return r&&pe(i,r),oe(t,this,i)}))},Rn.tail=function(t){var e=null==t?0:t.length;return e?Xr(t,1,e):[]},Rn.take=function(t,e,n){return t&&t.length?Xr(t,0,(e=n||void 0===e?1:ns(e))<0?0:e):[]},Rn.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?Xr(t,(e=r-(e=n||void 0===e?1:ns(e)))<0?0:e,r):[]},Rn.takeRightWhile=function(t,e){return t&&t.length?ti(t,Yi(e,3),!1,!0):[]},Rn.takeWhile=function(t,e){return t&&t.length?ti(t,Yi(e,3)):[]},Rn.tap=function(t,e){return e(t),t},Rn.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new gt(o);return ka(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),ba(t,e,{leading:r,maxWait:e,trailing:i})},Rn.thru=ea,Rn.toArray=ts,Rn.toPairs=Es,Rn.toPairsIn=Rs,Rn.toPath=function(t){return Fa(t)?he(t,Mo):Ja(t)?[t]:vi(So(as(t)))},Rn.toPlainObject=os,Rn.transform=function(t,e,n){var r=Fa(t),i=r||Ua(t)||qa(t);if(e=Yi(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:ka(t)&&Da(o)?In(kt(t)):{}}return(i?se:sr)(t,(function(t,r,i){return e(n,t,r,i)})),n},Rn.unary=function(t){return ma(t,1)},Rn.union=zo,Rn.unionBy=Xo,Rn.unionWith=Wo,Rn.uniq=function(t){return t&&t.length?qr(t):[]},Rn.uniqBy=function(t,e){return t&&t.length?qr(t,Yi(e,2)):[]},Rn.uniqWith=function(t,e){return e="function"==typeof e?e:void 0,t&&t.length?qr(t,void 0,e):[]},Rn.unset=function(t,e){return null==t||Kr(t,e)},Rn.unzip=jo,Rn.unzipWith=Zo,Rn.update=function(t,e,n){return null==t?t:$r(t,e,oi(n))},Rn.updateWith=function(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:$r(t,e,oi(n),r)},Rn.values=Is,Rn.valuesIn=function(t){return null==t?[]:Ce(t,xs(t))},Rn.without=Qo,Rn.words=Ds,Rn.wrap=function(t,e){return Ma(oi(e),t)},Rn.xor=Yo,Rn.xorBy=Jo,Rn.xorWith=qo,Rn.zip=Ko,Rn.zipObject=function(t,e){return ri(t||[],e||[],kn)},Rn.zipObjectDeep=function(t,e){return ri(t||[],e||[],Vr)},Rn.zipWith=$o,Rn.entries=Es,Rn.entriesIn=Rs,Rn.extend=us,Rn.extendWith=cs,Ys(Rn,Rn),Rn.add=ou,Rn.attempt=Vs,Rn.camelCase=Bs,Rn.capitalize=As,Rn.ceil=au,Rn.clamp=function(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=is(n))===n?n:0),void 0!==e&&(e=(e=is(e))===e?e:0),Qn(is(t),e,n)},Rn.clone=function(t){return Yn(t,4)},Rn.cloneDeep=function(t){return Yn(t,5)},Rn.cloneDeepWith=function(t,e){return Yn(t,5,e="function"==typeof e?e:void 0)},Rn.cloneWith=function(t,e){return Yn(t,4,e="function"==typeof e?e:void 0)},Rn.conformsTo=function(t,e){return null==e||Jn(t,e,bs(e))},Rn.deburr=Cs,Rn.defaultTo=function(t,e){return null==t||t!==t?e:t},Rn.divide=su,Rn.endsWith=function(t,e,n){t=as(t),e=Jr(e);var r=t.length,i=n=void 0===n?r:Qn(ns(n),0,r);return(n-=e.length)>=0&&t.slice(n,i)==e},Rn.eq=Ia,Rn.escape=function(t){return(t=as(t))&&D.test(t)?t.replace(L,Le):t},Rn.escapeRegExp=function(t){return(t=as(t))&&Z.test(t)?t.replace(j,"\\$&"):t},Rn.every=function(t,e,n){var r=Fa(t)?ce:er;return n&&ao(t,e,n)&&(e=void 0),r(t,Yi(e,3))},Rn.find=ia,Rn.findIndex=Co,Rn.findKey=function(t,e){return be(t,Yi(e,3),sr)},Rn.findLast=oa,Rn.findLastIndex=Fo,Rn.findLastKey=function(t,e){return be(t,Yi(e,3),ur)},Rn.floor=uu,Rn.forEach=aa,Rn.forEachRight=sa,Rn.forIn=function(t,e){return null==t?t:or(t,Yi(e,3),xs)},Rn.forInRight=function(t,e){return null==t?t:ar(t,Yi(e,3),xs)},Rn.forOwn=function(t,e){return t&&sr(t,Yi(e,3))},Rn.forOwnRight=function(t,e){return t&&ur(t,Yi(e,3))},Rn.get=ps,Rn.gt=Ba,Rn.gte=Aa,Rn.has=function(t,e){return null!=t&&no(t,e,pr)},Rn.hasIn=ms,Rn.head=No,Rn.identity=Ws,Rn.includes=function(t,e,n,r){t=Na(t)?t:Is(t),n=n&&!r?ns(n):0;var i=t.length;return n<0&&(n=on(i+n,0)),Ya(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&_e(t,e,n)>-1},Rn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ns(n);return i<0&&(i=on(r+i,0)),_e(t,e,i)},Rn.inRange=function(t,e,n){return e=es(e),void 0===n?(n=e,e=0):n=es(n),function(t,e,n){return t>=an(e,n)&&t<on(e,n)}(t=is(t),e,n)},Rn.invoke=ys,Rn.isArguments=Ca,Rn.isArray=Fa,Rn.isArrayBuffer=Pa,Rn.isArrayLike=Na,Rn.isArrayLikeObject=Oa,Rn.isBoolean=function(t){return!0===t||!1===t||za(t)&&fr(t)==l},Rn.isBuffer=Ua,Rn.isDate=La,Rn.isElement=function(t){return za(t)&&1===t.nodeType&&!ja(t)},Rn.isEmpty=function(t){if(null==t)return!0;if(Na(t)&&(Fa(t)||"string"==typeof t||"function"==typeof t.splice||Ua(t)||qa(t)||Ca(t)))return!t.length;var e=eo(t);if(e==m||e==b)return!t.size;if(lo(t))return!Tr(t).length;for(var n in t)if(Tt.call(t,n))return!1;return!0},Rn.isEqual=function(t,e){return br(t,e)},Rn.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:void 0)?n(t,e):void 0;return void 0===r?br(t,e,void 0,n):!!r},Rn.isError=Ga,Rn.isFinite=function(t){return"number"==typeof t&&en(t)},Rn.isFunction=Da,Rn.isInteger=Va,Rn.isLength=Ha,Rn.isMap=Xa,Rn.isMatch=function(t,e){return t===e||xr(t,e,qi(e))},Rn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:void 0,xr(t,e,qi(e),n)},Rn.isNaN=function(t){return Wa(t)&&t!=+t},Rn.isNative=function(t){if(co(t))throw new i("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return _r(t)},Rn.isNil=function(t){return null==t},Rn.isNull=function(t){return null===t},Rn.isNumber=Wa,Rn.isObject=ka,Rn.isObjectLike=za,Rn.isPlainObject=ja,Rn.isRegExp=Za,Rn.isSafeInteger=function(t){return Va(t)&&t>=-9007199254740991&&t<=9007199254740991},Rn.isSet=Qa,Rn.isString=Ya,Rn.isSymbol=Ja,Rn.isTypedArray=qa,Rn.isUndefined=function(t){return void 0===t},Rn.isWeakMap=function(t){return za(t)&&eo(t)==w},Rn.isWeakSet=function(t){return za(t)&&"[object WeakSet]"==fr(t)},Rn.join=function(t,e){return null==t?"":nn.call(t,e)},Rn.kebabCase=Fs,Rn.last=Go,Rn.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=ns(n))<0?on(r+i,0):an(i,r-1)),e===e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,i):xe(t,Te,i,!0)},Rn.lowerCase=Ps,Rn.lowerFirst=Ns,Rn.lt=Ka,Rn.lte=$a,Rn.max=function(t){return t&&t.length?nr(t,Ws,hr):void 0},Rn.maxBy=function(t,e){return t&&t.length?nr(t,Yi(e,2),hr):void 0},Rn.mean=function(t){return Se(t,Ws)},Rn.meanBy=function(t,e){return Se(t,Yi(e,2))},Rn.min=function(t){return t&&t.length?nr(t,Ws,Mr):void 0},Rn.minBy=function(t,e){return t&&t.length?nr(t,Yi(e,2),Mr):void 0},Rn.stubArray=ru,Rn.stubFalse=iu,Rn.stubObject=function(){return{}},Rn.stubString=function(){return""},Rn.stubTrue=function(){return!0},Rn.multiply=cu,Rn.nth=function(t,e){return t&&t.length?Ar(t,ns(e)):void 0},Rn.noConflict=function(){return Zt._===this&&(Zt._=It),this},Rn.noop=Js,Rn.now=pa,Rn.pad=function(t,e,n){t=as(t);var r=(e=ns(e))?We(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return Ci(Ke(i),n)+t+Ci(qe(i),n)},Rn.padEnd=function(t,e,n){t=as(t);var r=(e=ns(e))?We(t):0;return e&&r<e?t+Ci(e-r,n):t},Rn.padStart=function(t,e,n){t=as(t);var r=(e=ns(e))?We(t):0;return e&&r<e?Ci(e-r,n)+t:t},Rn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),un(as(t).replace(Y,""),e||0)},Rn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&ao(t,e,n)&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=es(t),void 0===e?(e=t,t=0):e=es(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=cn();return an(t+i*(e-t+zt("1e-"+((i+"").length-1))),e)}return Or(t,e)},Rn.reduce=function(t,e,n){var r=Fa(t)?me:Re,i=arguments.length<3;return r(t,Yi(e,4),n,i,$n)},Rn.reduceRight=function(t,e,n){var r=Fa(t)?ve:Re,i=arguments.length<3;return r(t,Yi(e,4),n,i,tr)},Rn.repeat=function(t,e,n){return e=(n?ao(t,e,n):void 0===e)?1:ns(e),Ur(as(t),e)},Rn.replace=function(){var t=arguments,e=as(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Rn.result=function(t,e,n){var r=-1,i=(e=ai(e,t)).length;for(i||(i=1,t=void 0);++r<i;){var o=null==t?void 0:t[Mo(e[r])];void 0===o&&(r=i,o=n),t=Da(o)?o.call(t):o}return t},Rn.round=lu,Rn.runInContext=t,Rn.sample=function(t){return(Fa(t)?Gn:Gr)(t)},Rn.size=function(t){if(null==t)return 0;if(Na(t))return Ya(t)?We(t):t.length;var e=eo(t);return e==m||e==b?t.size:Tr(t).length},Rn.snakeCase=Os,Rn.some=function(t,e,n){var r=Fa(t)?ge:Wr;return n&&ao(t,e,n)&&(e=void 0),r(t,Yi(e,3))},Rn.sortedIndex=function(t,e){return jr(t,e)},Rn.sortedIndexBy=function(t,e,n){return Zr(t,e,Yi(n,2))},Rn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=jr(t,e);if(r<n&&Ia(t[r],e))return r}return-1},Rn.sortedLastIndex=function(t,e){return jr(t,e,!0)},Rn.sortedLastIndexBy=function(t,e,n){return Zr(t,e,Yi(n,2),!0)},Rn.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=jr(t,e,!0)-1;if(Ia(t[n],e))return n}return-1},Rn.startCase=Us,Rn.startsWith=function(t,e,n){return t=as(t),n=null==n?0:Qn(ns(n),0,t.length),e=Jr(e),t.slice(n,n+e.length)==e},Rn.subtract=du,Rn.sum=function(t){return t&&t.length?Ie(t,Ws):0},Rn.sumBy=function(t,e){return t&&t.length?Ie(t,Yi(e,2)):0},Rn.template=function(t,e,n){var r=Rn.templateSettings;n&&ao(t,e,n)&&(e=void 0),t=as(t),e=cs({},e,r,Di);var i,o,a=cs({},e.imports,r.imports,Di),s=bs(a),u=Ce(a,s),c=0,l=e.interpolate||lt,d="__p += '",f=mt((e.escape||lt).source+"|"+l.source+"|"+(l===k?nt:lt).source+"|"+(e.evaluate||lt).source+"|$","g"),h="//# sourceURL="+(Tt.call(e,"sourceURL")?(e.sourceURL+"").replace(/[\r\n]/g," "):"lodash.templateSources["+ ++Dt+"]")+"\n";t.replace(f,(function(e,n,r,a,s,u){return r||(r=a),d+=t.slice(c,u).replace(dt,Ge),n&&(i=!0,d+="' +\n__e("+n+") +\n'"),s&&(o=!0,d+="';\n"+s+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=u+e.length,e})),d+="';\n";var p=Tt.call(e,"variable")&&e.variable;p||(d="with (obj) {\n"+d+"\n}\n"),d=(o?d.replace(P,""):d).replace(N,"$1").replace(O,"$1;"),d="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var m=Vs((function(){return ft(s,h+"return "+d).apply(void 0,u)}));if(m.source=d,Ga(m))throw m;return m},Rn.times=function(t,e){if((t=ns(t))<1||t>9007199254740991)return[];var n=4294967295,r=an(t,4294967295);t-=4294967295;for(var i=Be(r,e=Yi(e));++n<t;)e(n);return i},Rn.toFinite=es,Rn.toInteger=ns,Rn.toLength=rs,Rn.toLower=function(t){return as(t).toLowerCase()},Rn.toNumber=is,Rn.toSafeInteger=function(t){return t?Qn(ns(t),-9007199254740991,9007199254740991):0===t?t:0},Rn.toString=as,Rn.toUpper=function(t){return as(t).toUpperCase()},Rn.trim=function(t,e,n){if((t=as(t))&&(n||void 0===e))return t.replace(Q,"");if(!t||!(e=Jr(e)))return t;var r=je(t),i=je(e);return ui(r,Pe(r,i),Ne(r,i)+1).join("")},Rn.trimEnd=function(t,e,n){if((t=as(t))&&(n||void 0===e))return t.replace(J,"");if(!t||!(e=Jr(e)))return t;var r=je(t);return ui(r,0,Ne(r,je(e))+1).join("")},Rn.trimStart=function(t,e,n){if((t=as(t))&&(n||void 0===e))return t.replace(Y,"");if(!t||!(e=Jr(e)))return t;var r=je(t);return ui(r,Pe(r,je(e))).join("")},Rn.truncate=function(t,e){var n=30,r="...";if(ka(e)){var i="separator"in e?e.separator:i;n="length"in e?ns(e.length):n,r="omission"in e?Jr(e.omission):r}var o=(t=as(t)).length;if(De(t)){var a=je(t);o=a.length}if(n>=o)return t;var s=n-We(r);if(s<1)return r;var u=a?ui(a,0,s).join(""):t.slice(0,s);if(void 0===i)return u+r;if(a&&(s+=u.length-s),Za(i)){if(t.slice(s).search(i)){var c,l=u;for(i.global||(i=mt(i.source,as(rt.exec(i))+"g")),i.lastIndex=0;c=i.exec(l);)var d=c.index;u=u.slice(0,void 0===d?s:d)}}else if(t.indexOf(Jr(i),s)!=s){var f=u.lastIndexOf(i);f>-1&&(u=u.slice(0,f))}return u+r},Rn.unescape=function(t){return(t=as(t))&&G.test(t)?t.replace(U,Ze):t},Rn.uniqueId=function(t){var e=++St;return as(t)+e},Rn.upperCase=Ls,Rn.upperFirst=Gs,Rn.each=aa,Rn.eachRight=sa,Rn.first=No,Ys(Rn,function(){var t={};return sr(Rn,(function(e,n){Tt.call(Rn.prototype,n)||(t[n]=e)})),t}(),{chain:!1}),Rn.VERSION="4.17.15",se(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Rn[t].placeholder=Rn})),se(["drop","take"],(function(t,e){Cn.prototype[t]=function(n){n=void 0===n?1:on(ns(n),0);var r=this.__filtered__&&!e?new Cn(this):this.clone();return r.__filtered__?r.__takeCount__=an(n,r.__takeCount__):r.__views__.push({size:an(n,4294967295),type:t+(r.__dir__<0?"Right":"")}),r},Cn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),se(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Cn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Yi(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),se(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Cn.prototype[t]=function(){return this[n](1).value()[0]}})),se(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Cn.prototype[t]=function(){return this.__filtered__?new Cn(this):this[n](1)}})),Cn.prototype.compact=function(){return this.filter(Ws)},Cn.prototype.find=function(t){return this.filter(t).head()},Cn.prototype.findLast=function(t){return this.reverse().find(t)},Cn.prototype.invokeMap=Lr((function(t,e){return"function"==typeof t?new Cn(this):this.map((function(n){return gr(n,t,e)}))})),Cn.prototype.reject=function(t){return this.filter(Ta(Yi(t)))},Cn.prototype.slice=function(t,e){t=ns(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Cn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),void 0!==e&&(n=(e=ns(e))<0?n.dropRight(-e):n.take(e-t)),n)},Cn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Cn.prototype.toArray=function(){return this.take(4294967295)},sr(Cn.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),i=Rn[r?"take"+("last"==e?"Right":""):e],o=r||/^find/.test(e);i&&(Rn.prototype[e]=function(){var e=this.__wrapped__,a=r?[1]:arguments,s=e instanceof Cn,u=a[0],c=s||Fa(e),l=function(t){var e=i.apply(Rn,pe([t],a));return r&&d?e[0]:e};c&&n&&"function"==typeof u&&1!=u.length&&(s=c=!1);var d=this.__chain__,f=!!this.__actions__.length,h=o&&!d,p=s&&!f;if(!o&&c){e=p?e:new Cn(this);var m=t.apply(e,a);return m.__actions__.push({func:ea,args:[l],thisArg:void 0}),new An(m,d)}return h&&p?t.apply(this,a):(m=this.thru(l),h?r?m.value()[0]:m.value():m)})})),se(["pop","push","shift","sort","splice","unshift"],(function(t){var e=yt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);Rn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(Fa(i)?i:[],t)}return this[n]((function(n){return e.apply(Fa(n)?n:[],t)}))}})),sr(Cn.prototype,(function(t,e){var n=Rn[e];if(n){var r=n.name+"";Tt.call(yn,r)||(yn[r]=[]),yn[r].push({name:e,func:n})}})),yn[Ri(void 0,2).name]=[{name:"wrapper",func:void 0}],Cn.prototype.clone=function(){var t=new Cn(this.__wrapped__);return t.__actions__=vi(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=vi(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=vi(this.__views__),t},Cn.prototype.reverse=function(){if(this.__filtered__){var t=new Cn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Cn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Fa(t),r=e<0,i=n?t.length:0,o=function(t,e,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=an(e,t+a);break;case"takeRight":t=on(t,e-a)}}return{start:t,end:e}}(0,i,this.__views__),a=o.start,s=o.end,u=s-a,c=r?s:a-1,l=this.__iteratees__,d=l.length,f=0,h=an(u,this.__takeCount__);if(!n||!r&&i==u&&h==u)return ei(t,this.__actions__);var p=[];t:for(;u--&&f<h;){for(var m=-1,v=t[c+=e];++m<d;){var g=l[m],y=g.iteratee,b=g.type,x=y(v);if(2==b)v=x;else if(!x){if(1==b)continue t;break t}}p[f++]=v}return p},Rn.prototype.at=na,Rn.prototype.chain=function(){return ta(this)},Rn.prototype.commit=function(){return new An(this.value(),this.__chain__)},Rn.prototype.next=function(){void 0===this.__values__&&(this.__values__=ts(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?void 0:this.__values__[this.__index__++]}},Rn.prototype.plant=function(t){for(var e,n=this;n instanceof Bn;){var r=Ro(n);r.__index__=0,r.__values__=void 0,e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e},Rn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Cn){var e=t;return this.__actions__.length&&(e=new Cn(this)),(e=e.reverse()).__actions__.push({func:ea,args:[ko],thisArg:void 0}),new An(e,this.__chain__)}return this.thru(ko)},Rn.prototype.toJSON=Rn.prototype.valueOf=Rn.prototype.value=function(){return ei(this.__wrapped__,this.__actions__)},Rn.prototype.first=Rn.prototype.head,qt&&(Rn.prototype[qt]=function(){return this}),Rn}();Zt._=Qe,void 0===(i=function(){return Qe}.call(e,n,e,r))||(r.exports=i)}).call(this)}).call(this,n(86),n(85)(t))},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){var r=n(88);t.exports=function(t){if(Array.isArray(t))return r(t)}},function(t,e){t.exports=function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){var r=n(128),i=n(81);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!==typeof e?i(t):e}},function(t,e){function n(e){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},function(t,e,n){var r=n(130);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}t.exports=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){t.exports=function(t){"string"===typeof t&&(t=[t]);for(var e=[].slice.call(arguments,1),n=[],r=0;r<t.length-1;r++)n.push(t[r],e[r]||"");return n.push(t[r]),n.join("")}},function(t,e,n){var r=n(81),i=n(87),o=n(133),a=n(82),s=n(90),u=n(92),c=n(135),l=n(57),d=n(94),f=n(97),h=n(89),p=n(95),m=n(96);!function(t,e){for(var n in e)t[n]=e[n]}(e,function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./source/Main.js")}({"./node_modules/worker-loader/dist/workers/InlineWorker.js":function(t,e,n){"use strict";var r=window.URL||window.webkitURL;t.exports=function(t,e){try{try{var n;try{(n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(t),n=n.getBlob()}catch(i){n=new Blob([t])}return new Worker(r.createObjectURL(n))}catch(i){return new Worker("data:application/javascript,"+encodeURIComponent(t))}}catch(i){if(!e)throw Error("Inline worker is not supported");return new Worker(e)}}},"./source/Global.js":function(t,e,n){"use strict";n.r(e),n.d(e,"Global",(function(){return o}));var r=n("./source/utils/LRU.js"),i=n("./source/utils/WorkerManager.js");var o={debug:{},workerPath:function(){var t=document&&document.currentScript?document.currentScript:function(){var t=document.getElementsByTagName("script");return t[t.length-1].getAttribute("src")}();if(t&&t.src){var e=new URL(t.src+"/..").href;return"/"===e.slice(-1)&&(e=e.slice(0,-1)),e}return console.error("Potree: Was unable to find its script path using document.currentScript."),""}(),maxNodesLoadGPUFrame:20,maxDEMLevel:0,maxNodesLoading:void 0!==navigator.hardwareConcurrency?navigator.hardwareConcurrency:4,pointLoadLimit:1e10,numNodesLoading:0,measureTimings:!1,workerPool:new i.WorkerManager,lru:new r.LRU,pointcloudTransformVersion:void 0}},"./source/Gradients.js":function(t,e,n){"use strict";n.r(e),n.d(e,"Gradients",(function(){return i}));var r=n("three"),i={RAINBOW:[[0,new r.Color(.278,0,.714)],[1/6,new r.Color(0,0,1)],[2/6,new r.Color(0,1,1)],[.5,new r.Color(0,1,0)],[4/6,new r.Color(1,1,0)],[5/6,new r.Color(1,.64,0)],[1,new r.Color(1,0,0)]],SPECTRAL:[[0,new r.Color(.3686,.3098,.6353)],[.1,new r.Color(.1961,.5333,.7412)],[.2,new r.Color(.4,.7608,.6471)],[.3,new r.Color(.6706,.8667,.6431)],[.4,new r.Color(.902,.9608,.5961)],[.5,new r.Color(1,1,.749)],[.6,new r.Color(.9961,.8784,.5451)],[.7,new r.Color(.9922,.6824,.3804)],[.8,new r.Color(.9569,.4275,.2627)],[.9,new r.Color(.8353,.2431,.3098)],[1,new r.Color(.6196,.0039,.2588)]],PLASMA:[[0,new r.Color(.241,.015,.61)],[.1,new r.Color(.387,.001,.654)],[.2,new r.Color(.524,.025,.653)],[.3,new r.Color(.651,.125,.596)],[.4,new r.Color(.752,.227,.513)],[.5,new r.Color(.837,.329,.431)],[.6,new r.Color(.907,.435,.353)],[.7,new r.Color(.963,.554,.272)],[.8,new r.Color(.992,.681,.195)],[.9,new r.Color(.987,.822,.144)],[1,new r.Color(.94,.975,.131)]],YELLOW_GREEN:[[0,new r.Color(.1647,.2824,.3451)],[.1,new r.Color(.1338,.3555,.4227)],[.2,new r.Color(.061,.4319,.4864)],[.3,new r.Color(0,.5099,.5319)],[.4,new r.Color(0,.5881,.5569)],[.5,new r.Color(.137,.665,.5614)],[.6,new r.Color(.2906,.7395,.5477)],[.7,new r.Color(.4453,.8099,.5201)],[.8,new r.Color(.6102,.8748,.485)],[.9,new r.Color(.7883,.9323,.4514)],[1,new r.Color(.9804,.9804,.4314)]],VIRIDIS:[[0,new r.Color(.267,.005,.329)],[.1,new r.Color(.283,.141,.458)],[.2,new r.Color(.254,.265,.53)],[.3,new r.Color(.207,.372,.553)],[.4,new r.Color(.164,.471,.558)],[.5,new r.Color(.128,.567,.551)],[.6,new r.Color(.135,.659,.518)],[.7,new r.Color(.267,.749,.441)],[.8,new r.Color(.478,.821,.318)],[.9,new r.Color(.741,.873,.15)],[1,new r.Color(.993,.906,.144)]],INFERNO:[[0,new r.Color(.077,.042,.206)],[.1,new r.Color(.225,.036,.388)],[.2,new r.Color(.373,.074,.432)],[.3,new r.Color(.522,.128,.42)],[.4,new r.Color(.665,.182,.37)],[.5,new r.Color(.797,.255,.287)],[.6,new r.Color(.902,.364,.184)],[.7,new r.Color(.969,.516,.063)],[.8,new r.Color(.988,.683,.072)],[.9,new r.Color(.961,.859,.298)],[1,new r.Color(.988,.998,.645)]],GRAYSCALE:[[0,new r.Color(0,0,0)],[1,new r.Color(1,1,1)]]}},"./source/Main.js":function(t,e,n){"use strict";n.r(e);var r=n("./source/Global.js");n.d(e,"Global",(function(){return r.Global}));var i=n("./source/Potree.js");n.d(e,"AttributeLocations",(function(){return i.AttributeLocations})),n.d(e,"Classification",(function(){return i.Classification})),n.d(e,"ClipTask",(function(){return i.ClipTask})),n.d(e,"ClipMethod",(function(){return i.ClipMethod})),n.d(e,"PointSizeType",(function(){return i.PointSizeType})),n.d(e,"PointShape",(function(){return i.PointShape})),n.d(e,"PointColorType",(function(){return i.PointColorType})),n.d(e,"TreeType",(function(){return i.TreeType})),n.d(e,"loadPointCloud",(function(){return i.loadPointCloud})),n.d(e,"updateVisibility",(function(){return i.updateVisibility})),n.d(e,"updatePointClouds",(function(){return i.updatePointClouds})),n.d(e,"updateVisibilityStructures",(function(){return i.updateVisibilityStructures}));var o=n("./source/lib/BinaryHeap.js");n.d(e,"BinaryHeap",(function(){return o.BinaryHeap}));var a=n("./source/utils/LRU.js");n.d(e,"LRU",(function(){return a.LRU}));var s=n("./source/utils/HelperUtils.js");n.d(e,"HelperUtils",(function(){return s.HelperUtils}));var u=n("./source/utils/VersionUtils.js");n.d(e,"VersionUtils",(function(){return u.VersionUtils}));var c=n("./source/utils/WorkerManager.js");n.d(e,"WorkerManager",(function(){return c.WorkerManager}));var l=n("./source/PointAttributes.js");n.d(e,"PointAttribute",(function(){return l.PointAttribute})),n.d(e,"PointAttributes",(function(){return l.PointAttributes})),n.d(e,"PointAttributeNames",(function(){return l.PointAttributeNames})),n.d(e,"PointAttributeTypes",(function(){return l.PointAttributeTypes}));var d=n("./source/Gradients.js");n.d(e,"Gradients",(function(){return d.Gradients}));var f=n("./source/Points.js");n.d(e,"Points",(function(){return f.Points}));var h=n("./source/Shader.js");n.d(e,"Shader",(function(){return h.Shader}));var p=n("./source/WebGLTexture.js");n.d(e,"WebGLTexture",(function(){return p.WebGLTexture}));var m=n("./source/WebGLBuffer.js");n.d(e,"WebGLBuffer",(function(){return m.WebGLBuffer}));var v=n("./source/Shaders.js");n.d(e,"Shaders",(function(){return v.Shaders}));var g=n("./source/pointcloud/DEM.js");n.d(e,"DEM",(function(){return g.DEM}));var y=n("./source/pointcloud/DEMNode.js");n.d(e,"DEMNode",(function(){return y.DEMNode}));var b=n("./source/pointcloud/PointCloudTree.js");n.d(e,"PointCloudTree",(function(){return b.PointCloudTree}));var x=n("./source/pointcloud/PointCloudArena4D.js");n.d(e,"PointCloudArena4D",(function(){return x.PointCloudArena4D}));var _=n("./source/pointcloud/PointCloudOctree.js");n.d(e,"PointCloudOctree",(function(){return _.PointCloudOctree}));var w=n("./source/pointcloud/geometries/PointCloudOctreeGeometry.js");n.d(e,"PointCloudOctreeGeometry",(function(){return w.PointCloudOctreeGeometry})),n.d(e,"PointCloudOctreeGeometryNode",(function(){return w.PointCloudOctreeGeometryNode}));var T=n("./source/pointcloud/geometries/PointCloudArena4DGeometry.js");n.d(e,"PointCloudArena4DGeometry",(function(){return T.PointCloudArena4DGeometry}));var S=n("./source/pointcloud/geometries/PointCloudGreyhoundGeometry.js");n.d(e,"PointCloudGreyhoundGeometry",(function(){return S.PointCloudGreyhoundGeometry}));var M=n("./source/pointcloud/geometries/PointCloudEptGeometry.js");n.d(e,"PointCloudEptGeometry",(function(){return M.PointCloudEptGeometry})),n.d(e,"PointCloudEptGeometryNode",(function(){return M.PointCloudEptGeometryNode}));var E=n("./source/pointcloud/materials/PointCloudMaterial.js");n.d(e,"PointCloudMaterial",(function(){return E.PointCloudMaterial}));var R=n("./source/loaders/LASLoader.js");n.d(e,"LASLoader",(function(){return R.LASLoader}));var I=n("./source/loaders/BinaryLoader.js");n.d(e,"BinaryLoader",(function(){return I.BinaryLoader}));var B=n("./source/loaders/GreyhoundUtils.js");n.d(e,"GreyhoundUtils",(function(){return B.GreyhoundUtils}));var A=n("./source/loaders/GreyhoundLoader.js");n.d(e,"GreyhoundLoader",(function(){return A.GreyhoundLoader}));var C=n("./source/loaders/GreyhoundBinaryLoader.js");n.d(e,"GreyhoundBinaryLoader",(function(){return C.GreyhoundBinaryLoader}));var F=n("./source/loaders/POCLoader.js");n.d(e,"POCLoader",(function(){return F.POCLoader}));var P=n("./source/loaders/LASLAZLoader.js");n.d(e,"LASLAZLoader",(function(){return P.LASLAZLoader}));var N=n("./source/loaders/EptLoader.js");n.d(e,"EptLoader",(function(){return N.EptLoader}));var O=n("./source/loaders/ept/EptLaszipLoader.js");n.d(e,"EptLaszipLoader",(function(){return O.EptLaszipLoader}));var U=n("./source/loaders/ept/EptBinaryLoader.js");n.d(e,"EptBinaryLoader",(function(){return U.EptBinaryLoader}));var L=n("./source/objects/BasicGroup.js");n.d(e,"BasicGroup",(function(){return L.BasicGroup}));var G=n("./source/objects/Group.js");n.d(e,"Group",(function(){return G.Group}));var D=n("./source/XHRFactory.js");n.d(e,"XHRFactory",(function(){return D.XHRFactory}))},"./source/PointAttributes.js":function(t,e,n){"use strict";n.r(e),n.d(e,"PointAttribute",(function(){return s})),n.d(e,"PointAttributes",(function(){return u})),n.d(e,"PointAttributeNames",(function(){return r})),n.d(e,"PointAttributeTypes",(function(){return i}));var r={POSITION_CARTESIAN:0,COLOR_PACKED:1,COLOR_FLOATS_1:2,COLOR_FLOATS_255:3,NORMAL_FLOATS:4,FILLER:5,INTENSITY:6,CLASSIFICATION:7,NORMAL_SPHEREMAPPED:8,NORMAL_OCT16:9,NORMAL:10,RETURN_NUMBER:11,NUMBER_OF_RETURNS:12,SOURCE_ID:13,INDICES:14,SPACING:15},i={DATA_TYPE_DOUBLE:{ordinal:0,size:8},DATA_TYPE_FLOAT:{ordinal:1,size:4},DATA_TYPE_INT8:{ordinal:2,size:1},DATA_TYPE_UINT8:{ordinal:3,size:1},DATA_TYPE_INT16:{ordinal:4,size:2},DATA_TYPE_UINT16:{ordinal:5,size:2},DATA_TYPE_INT32:{ordinal:6,size:4},DATA_TYPE_UINT32:{ordinal:7,size:4},DATA_TYPE_INT64:{ordinal:8,size:8},DATA_TYPE_UINT64:{ordinal:9,size:8}},o=0;for(var a in i)i[o]=i[a],o++;function s(t,e,n){this.name=t,this.type=e,this.numElements=n,this.byteSize=this.numElements*this.type.size}function u(t){if(this.attributes=[],this.byteSize=0,this.size=0,null!=t)for(var e=0;e<t.length;e++){var n=s[t[e]];this.attributes.push(n),this.byteSize+=n.byteSize,this.size++}}s.POSITION_CARTESIAN=new s(r.POSITION_CARTESIAN,i.DATA_TYPE_FLOAT,3),s.RGBA_PACKED=new s(r.COLOR_PACKED,i.DATA_TYPE_INT8,4),s.COLOR_PACKED=s.RGBA_PACKED,s.RGB_PACKED=new s(r.COLOR_PACKED,i.DATA_TYPE_INT8,3),s.NORMAL_FLOATS=new s(r.NORMAL_FLOATS,i.DATA_TYPE_FLOAT,3),s.FILLER_1B=new s(r.FILLER,i.DATA_TYPE_UINT8,1),s.INTENSITY=new s(r.INTENSITY,i.DATA_TYPE_UINT16,1),s.CLASSIFICATION=new s(r.CLASSIFICATION,i.DATA_TYPE_UINT8,1),s.NORMAL_SPHEREMAPPED=new s(r.NORMAL_SPHEREMAPPED,i.DATA_TYPE_UINT8,2),s.NORMAL_OCT16=new s(r.NORMAL_OCT16,i.DATA_TYPE_UINT8,2),s.NORMAL=new s(r.NORMAL,i.DATA_TYPE_FLOAT,3),s.RETURN_NUMBER=new s(r.RETURN_NUMBER,i.DATA_TYPE_UINT8,1),s.NUMBER_OF_RETURNS=new s(r.NUMBER_OF_RETURNS,i.DATA_TYPE_UINT8,1),s.SOURCE_ID=new s(r.SOURCE_ID,i.DATA_TYPE_UINT8,1),s.INDICES=new s(r.INDICES,i.DATA_TYPE_UINT32,1),s.SPACING=new s(r.SPACING,i.DATA_TYPE_FLOAT,1),u.prototype.add=function(t){this.attributes.push(t),this.byteSize+=t.byteSize,this.size++},u.prototype.hasColors=function(){for(var t in this.attributes){if(this.attributes[t].name===r.COLOR_PACKED)return!0}return!1},u.prototype.hasNormals=function(){for(var t in this.attributes){var e=this.attributes[t];if(e===s.NORMAL_SPHEREMAPPED||e===s.NORMAL_FLOATS||e===s.NORMAL||e===s.NORMAL_OCT16)return!0}return!1}},"./source/Points.js":function(t,e,n){"use strict";n.r(e),n.d(e,"Points",(function(){return i}));var r=n("three"),i=function(){function t(){p(this,t),this.boundingBox=new r.Box3,this.numPoints=0,this.data={}}return m(t,[{key:"add",value:function(t){var e,n=this.numPoints,r=n+t.numPoints,i=Object.keys(this.data),o=Object.keys(t.data),a=new Set([].concat(h(i),h(o))),s=f(a);try{for(s.s();!(e=s.n()).done;){var u=e.value;if(i.includes(u)&&o.includes(u)){var c=new(0,this.data[u].constructor)(this.data[u].length+t.data[u].length);c.set(this.data[u],0),c.set(t.data[u],this.data[u].length),this.data[u]=c}else if(i.includes(u)&&!o.includes(u)){var l=this.data[u].length/this.numPoints;(d=new(0,this.data[u].constructor)(l*r)).set(this.data[u],0),this.data[u]=d}else if(!i.includes(u)&&o.includes(u)){var d;l=t.data[u].length/t.numPoints;(d=new(0,t.data[u].constructor)(l*r)).set(t.data[u],l*n),this.data[u]=d}}}catch(p){s.e(p)}finally{s.f()}this.numPoints=r,this.boundingBox.union(t.boundingBox)}}]),t}()},"./source/Potree.js":function(t,e,n){"use strict";n.r(e),n.d(e,"AttributeLocations",(function(){return h})),n.d(e,"Classification",(function(){return p})),n.d(e,"ClipTask",(function(){return m})),n.d(e,"ClipMethod",(function(){return v})),n.d(e,"PointSizeType",(function(){return g})),n.d(e,"PointShape",(function(){return y})),n.d(e,"PointColorType",(function(){return b})),n.d(e,"TreeType",(function(){return x})),n.d(e,"loadPointCloud",(function(){return _})),n.d(e,"updateVisibility",(function(){return w})),n.d(e,"updatePointClouds",(function(){return T})),n.d(e,"updateVisibilityStructures",(function(){return S}));var r=n("three"),i=n("./source/loaders/GreyhoundLoader.js"),o=n("./source/loaders/POCLoader.js"),a=n("./source/loaders/EptLoader.js"),s=n("./source/pointcloud/PointCloudOctree.js"),u=n("./source/pointcloud/PointCloudArena4D.js"),c=n("./source/pointcloud/geometries/PointCloudArena4DGeometry.js"),l=n("./source/lib/BinaryHeap.js"),d=n("./source/Global.js"),h={position:0,color:1,intensity:2,classification:3,returnNumber:4,numberOfReturns:5,pointSourceID:6,indices:7,normal:8,spacing:9},p={DEFAULT:{0:new r.Vector4(.5,.5,.5,1),1:new r.Vector4(.5,.5,.5,1),2:new r.Vector4(.63,.32,.18,1),3:new r.Vector4(0,1,0,1),4:new r.Vector4(0,.8,0,1),5:new r.Vector4(0,.6,0,1),6:new r.Vector4(1,.66,0,1),7:new r.Vector4(1,0,1,1),8:new r.Vector4(1,0,0,1),9:new r.Vector4(0,0,1,1),12:new r.Vector4(1,1,0,1),DEFAULT:new r.Vector4(.3,.6,.6,.5)}},m={NONE:0,HIGHLIGHT:1,SHOW_INSIDE:2,SHOW_OUTSIDE:3},v={INSIDE_ANY:0,INSIDE_ALL:1},g={FIXED:0,ATTENUATED:1,ADAPTIVE:2},y={SQUARE:0,CIRCLE:1,PARABOLOID:2},b={RGB:0,COLOR:1,DEPTH:2,HEIGHT:3,ELEVATION:3,INTENSITY:4,INTENSITY_GRADIENT:5,LOD:6,LEVEL_OF_DETAIL:6,POINT_INDEX:7,CLASSIFICATION:8,RETURN_NUMBER:9,SOURCE:10,NORMAL:11,PHONG:12,RGB_HEIGHT:13,COMPOSITE:50},x={OCTREE:0,KDTREE:1};function _(t,e,n){var r=function(t){void 0!==e&&(t.name=e),n({type:"pointcloud_loaded",pointcloud:t})};if(0===t.indexOf("greyhound://"))i.GreyhoundLoader.load(t,(function(t){void 0!==t&&r(new s.PointCloudOctree(t))}));else if(t.indexOf("cloud.js")>0)o.POCLoader.load(t,(function(t){void 0!==t&&r(new s.PointCloudOctree(t))}));else if(t.indexOf("ept.json")>0)a.EptLoader.load(t,(function(t){void 0!==t&&r(new s.PointCloudOctree(t))}));else{if(!(t.indexOf(".vpc")>0))throw new Error("Potree: Failed to load point cloud from URL "+t);c.PointCloudArena4DGeometry.load(t,(function(t){void 0!==t&&r(new u.PointCloudArena4D(t))}))}}function w(t,e,n){var i=0,o=new Map(t.map((function(t){return[t,0]}))),a=[],s=[],u=[],c=1/0,l=S(t,e,n),h=l.frustums,p=l.camObjPositions,m=l.priorityQueue,v=0,g=(n.domElement.clientWidth,n.domElement.clientHeight);d.Global.pointcloudTransformVersion||(d.Global.pointcloudTransformVersion=new Map);for(var y=d.Global.pointcloudTransformVersion,b=0;b<t.length;b++){if((M=t[b]).visible)if(M.updateMatrixWorld(),y.has(M)){var x=y.get(M);x.transform.equals(M.matrixWorld)||(x.number++,x.transform.copy(M.matrixWorld),M.dispatchEvent({type:"transformation_changed",target:M}))}else y.set(M,{number:0,transform:M.matrixWorld.clone()})}for(;m.size()>0;){var _=m.pop(),w=_.node,T=_.parent,M=t[_.pointcloud],E=w.getBoundingBox(),R=h[_.pointcloud],I=p[_.pointcloud],B=R.intersectsBox(E),A=M.maxLevel||1/0,C=w.getLevel(),F=B;if(F=(F=F&&!(o.get(M)+w.getNumPoints()>M.pointBudget))&&C<A,w.spacing?c=Math.min(c,w.spacing):w.geometryNode&&w.geometryNode.spacing&&(c=Math.min(c,w.geometryNode.spacing)),F){i+=w.getNumPoints();var P=o.get(M);if(o.set(M,P+w.getNumPoints()),M.numVisibleNodes++,M.numVisiblePoints+=w.getNumPoints(),!w.isGeometryNode()||T&&!T.isTreeNode()||(w.isLoaded()&&v<d.Global.maxNodesLoadGPUFrame?(w=M.toTreeNode(w,T),v++):(u.push(w),s.push(w))),w.isTreeNode()){d.Global.lru.touch(w.geometryNode),w.sceneNode.visible=!0,w.sceneNode.material=M.material,a.push(w),M.visibleNodes.push(w),void 0===w._transformVersion&&(w._transformVersion=-1);var N=y.get(M);if(w._transformVersion!==N.number&&(w.sceneNode.updateMatrix(),w.sceneNode.matrixWorld.multiplyMatrices(M.matrixWorld,w.sceneNode.matrix),w._transformVersion=N.number),M.showBoundingBox&&!w.boundingBoxNode&&w.getBoundingBox){var O=new r.Box3Helper(w.getBoundingBox());O.matrixAutoUpdate=!1,M.boundingBoxNodes.push(O),w.boundingBoxNode=O,w.boundingBoxNode.matrix.copy(M.matrixWorld)}else M.showBoundingBox?(w.boundingBoxNode.visible=!0,w.boundingBoxNode.matrix.copy(M.matrixWorld)):!M.showBoundingBox&&w.boundingBoxNode&&(w.boundingBoxNode.visible=!1)}var U=w.getChildren();for(b=0;b<U.length;b++){var L=U[b],G=0;if(e.isPerspectiveCamera){var D=L.getBoundingSphere(new r.Sphere),V=(D.center,D.center.distanceTo(I)),H=D.radius,k=e.fov*Math.PI/180,z=H*(.5*g/(Math.tan(k/2)*V));if(z<M.minimumNodePixelSize)continue;G=z,V-H<0&&(G=Number.MAX_VALUE)}else{var X=L.getBoundingBox();V=L.getBoundingSphere(new r.Sphere).center.distanceTo(I);G=X.max.clone().sub(X.min).length()/V}m.push({pointcloud:_.pointcloud,node:L,parent:w,weight:G})}}}var W,j=t.filter((function(t){return t.generateDEM&&t.dem instanceof DEM})),Z=f(j);try{for(Z.s();!(W=Z.n()).done;){var Q=(M=W.value).visibleNodes.filter((function(t){return t.getLevel()<=d.Global.maxDEMLevel}));M.dem.update(Q)}}catch(Y){Z.e(Y)}finally{Z.f()}for(b=0;b<Math.min(d.Global.maxNodesLoading,u.length);b++)u[b].load();return{visibleNodes:a,numVisiblePoints:i,lowestSpacing:c}}function T(t,e,n){for(var r=w(t,e,n),i=0;i<t.length;i++)t[i].updateMaterial(t[i].material,t[i].visibleNodes,e,n),t[i].updateVisibleBounds();return d.Global.lru.freeMemory(),r}function S(t,e,n){for(var i=[],o=[],a=new l.BinaryHeap((function(t){return 1/t.weight})),s=0;s<t.length;s++){var u=t[s];if(u.initialized()){u.numVisibleNodes=0,u.numVisiblePoints=0,u.deepestVisibleLevel=0,u.visibleNodes=[],u.visibleGeometry=[],e.updateMatrixWorld();var c=new r.Frustum,d=e.matrixWorldInverse,f=u.matrixWorld,h=e.clone();h.near=e.near,h.updateProjectionMatrix();var p=e.projectionMatrix,m=(new r.Matrix4).multiply(p).multiply(d).multiply(f);c.setFromProjectionMatrix(m),i.push(c);var v=e.matrixWorld,g=(new r.Matrix4).getInverse(f),y=(new r.Matrix4).multiply(g).multiply(v),b=(new r.Vector3).setFromMatrixPosition(y);o.push(b),u.visible&&null!==u.root&&a.push({pointcloud:s,node:u.root,weight:Number.MAX_VALUE}),u.root.isTreeNode()&&u.hideDescendants(u.root.sceneNode);for(var x=0;x<u.boundingBoxNodes.length;x++)u.boundingBoxNodes[x].visible=!1}}return{frustums:i,camObjPositions:o,priorityQueue:a}}},"./source/Shader.js":function(t,e,n){"use strict";n.r(e),n.d(e,"Shader",(function(){return a}));var r=n("three"),i=n("./source/WebGLTexture.js"),o=n("./source/Potree.js"),a=function(){function t(e,n,r,i){p(this,t),this.gl=e,this.name=n,this.vsSource=r,this.fsSource=i,this.cache=new Map,this.vs=null,this.fs=null,this.program=null,this.uniformLocations={},this.attributeLocations={},this.update(r,i)}return m(t,[{key:"update",value:function(t,e){this.vsSource=t,this.fsSource=e,this.linkProgram()}},{key:"compileShader",value:function(t,e){var n=this.gl;if(n.shaderSource(t,e),n.compileShader(t),!n.getShaderParameter(t,n.COMPILE_STATUS)){var r=n.getShaderInfoLog(t);throw new Error("Potree: Could not compile shader "+this.name+", "+r)}}},{key:"linkProgram",value:function(){var t=this.gl;if(this.uniformLocations={},this.attributeLocations={},t.useProgram(null),h=this.cache.get("".concat(this.vsSource,", ").concat(this.fsSource)))return this.program=h.program,this.vs=h.vs,this.fs=h.fs,this.attributeLocations=h.attributeLocations,void(this.uniformLocations=h.uniformLocations);this.vs=t.createShader(t.VERTEX_SHADER),this.fs=t.createShader(t.FRAGMENT_SHADER),this.program=t.createProgram();for(var e=0,n=Object.keys(o.AttributeLocations);e<n.length;e++){var r=n[e],i=o.AttributeLocations[r];t.bindAttribLocation(this.program,i,r)}this.compileShader(this.vs,this.vsSource),this.compileShader(this.fs,this.fsSource);var a=this.program;if(t.attachShader(a,this.vs),t.attachShader(a,this.fs),t.linkProgram(a),t.detachShader(a,this.vs),t.detachShader(a,this.fs),!t.getProgramParameter(a,t.LINK_STATUS)){var s=t.getProgramInfoLog(a);throw new Error("Potree: Could not link program "+this.name+", "+s)}for(var u=t.getProgramParameter(a,t.ACTIVE_ATTRIBUTES),c=0;c<u;c++){var l=t.getActiveAttrib(a,c);i=t.getAttribLocation(a,l.name);this.attributeLocations[l.name]=i}var d=t.getProgramParameter(a,t.ACTIVE_UNIFORMS);for(c=0;c<d;c++){var f=t.getActiveUniform(a,c);i=t.getUniformLocation(a,f.name);this.uniformLocations[f.name]=i}var h={program:this.program,vs:this.vs,fs:this.fs,attributeLocations:this.attributeLocations,uniformLocations:this.uniformLocations};this.cache.set("".concat(this.vsSource,", ").concat(this.fsSource),h)}},{key:"setUniformMatrix4",value:function(t,e){var n=this.gl,r=this.uniformLocations[t];if(null!=r){var i=new Float32Array(e.elements);n.uniformMatrix4fv(r,!1,i)}}},{key:"setUniform1f",value:function(t,e){var n=this.gl,r=this.uniformLocations[t];null!=r&&n.uniform1f(r,e)}},{key:"setUniformBoolean",value:function(t,e){var n=this.gl,r=this.uniformLocations[t];null!=r&&n.uniform1i(r,e)}},{key:"setUniformTexture",value:function(t,e){var n=this.gl,r=this.uniformLocations[t];null!=r&&n.uniform1i(r,e)}},{key:"setUniform2f",value:function(t,e){var n=this.gl,r=this.uniformLocations[t];null!=r&&n.uniform2f(r,e[0],e[1])}},{key:"setUniform3f",value:function(t,e){var n=this.gl,r=this.uniformLocations[t];null!=r&&n.uniform3f(r,e[0],e[1],e[2])}},{key:"setUniform",value:function(t,e){e.constructor===r.Matrix4?this.setUniformMatrix4(t,e):"number"===typeof e?this.setUniform1f(t,e):"boolean"===typeof e?this.setUniformBoolean(t,e):e instanceof i.WebGLTexture?this.setUniformTexture(t,e):e instanceof Array?2===e.length?this.setUniform2f(t,e):3===e.length&&this.setUniform3f(t,e):console.error("Potree: Unhandled uniform type: ",t,e)}},{key:"setUniform1i",value:function(t,e){var n=this.gl,r=this.uniformLocations[t];null!=r&&n.uniform1i(r,e)}}]),t}()},"./source/Shaders.js":function(t,e,n){"use strict";n.r(e),n.d(e,"Shaders",(function(){return i}));var r=n("three"),i={};i.vertex="\nprecision highp float;\nprecision highp int;\n\n#define MAX_CLIP_POLYGONS 8\n\n"+r.ShaderChunk.common+"\n"+r.ShaderChunk.logdepthbuf_pars_vertex+"\n\nattribute vec3 position;\nattribute vec3 color;\nattribute float intensity;\nattribute float classification;\nattribute float returnNumber;\nattribute float numberOfReturns;\nattribute float pointSourceID;\nattribute vec4 indices;\nattribute float spacing;\n\nuniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 uViewInv;\n\nuniform float uScreenWidth;\nuniform float uScreenHeight;\nuniform float fov;\nuniform float near;\nuniform float far;\n\nuniform bool uDebug;\n\nuniform bool uUseOrthographicCamera;\nuniform float uOrthoWidth;\nuniform float uOrthoHeight;\n\n#define CLIPTASK_NONE 0\n#define CLIPTASK_HIGHLIGHT 1\n#define CLIPTASK_SHOW_INSIDE 2\n#define CLIPTASK_SHOW_OUTSIDE 3\n\n#define CLIPMETHOD_INSIDE_ANY 0\n#define CLIPMETHOD_INSIDE_ALL 1\n\nuniform int clipTask;\nuniform int clipMethod;\n\n#if defined(num_clipboxes) && num_clipboxes > 0\n\tuniform mat4 clipBoxes[num_clipboxes];\n#endif\n\n#if defined(num_clipspheres) && num_clipspheres > 0\n\tuniform mat4 uClipSpheres[num_clipspheres];\n#endif\n\n#if defined(num_clippolygons) && num_clippolygons > 0\n\tuniform int uClipPolygonVCount[num_clippolygons];\n\tuniform vec3 uClipPolygonVertices[num_clippolygons * 8];\n\tuniform mat4 uClipPolygonWVP[num_clippolygons];\n#endif\n\nuniform float size;\nuniform float minSize;\nuniform float maxSize;\n\nuniform float uPCIndex;\nuniform float uOctreeSpacing;\nuniform float uNodeSpacing;\nuniform float uOctreeSize;\nuniform vec3 uBBSize;\nuniform float uLevel;\nuniform float uVNStart;\nuniform bool uIsLeafNode;\n\nuniform vec3 uColor;\nuniform float uOpacity;\n\nuniform vec2 elevationRange;\nuniform vec2 intensityRange;\nuniform float intensityGamma;\nuniform float intensityContrast;\nuniform float intensityBrightness;\nuniform float rgbGamma;\nuniform float rgbContrast;\nuniform float rgbBrightness;\nuniform float uTransition;\nuniform float wRGB;\nuniform float wIntensity;\nuniform float wElevation;\nuniform float wClassification;\nuniform float wReturnNumber;\nuniform float wSourceID;\n\nuniform vec3 uShadowColor;\n\nuniform sampler2D visibleNodes;\nuniform sampler2D gradient;\nuniform sampler2D classificationLUT;\n\n#if defined(num_shadowmaps) && num_shadowmaps > 0\n\tuniform sampler2D uShadowMap[num_shadowmaps];\n\tuniform mat4 uShadowWorldView[num_shadowmaps];\n\tuniform mat4 uShadowProj[num_shadowmaps];\n#endif\n\nvarying vec3 vColor;\nvarying float vLogDepth;\nvarying vec3 vViewPosition;\nvarying float vRadius;\nvarying float vPointSize;\n\nfloat round(float number)\n{\n\treturn floor(number + 0.5);\n}\n\n//---------------------\n//OCTREE\n//---------------------\n\n#if (defined(adaptive_point_size) || defined(color_type_lod)) && defined(tree_type_octree)\n\n\t/**\n\t * number of 1-bits up to inclusive index position\n\t * number is treated as if it were an integer in the range 0-255\n\t */\n\tint numberOfOnes(int number, int index)\n\t{\n\t\tint numOnes = 0;\n\t\tint tmp = 128;\n\n\t\tfor(int i = 7; i >= 0; i--)\n\t\t{\n\t\t\tif(number >= tmp)\n\t\t\t{\n\t\t\t\tnumber = number - tmp;\n\n\t\t\t\tif(i <= index)\n\t\t\t\t{\n\t\t\t\t\tnumOnes++;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\ttmp = tmp / 2;\n\t\t}\n\n\t\treturn numOnes;\n\t}\n\n\t/**\n\t * checks whether the bit at index is 1\n\t * number is treated as if it were an integer in the range 0-255\n\t */\n\tbool isBitSet(int number, int index)\n\t{\n\t\t//weird multi else if due to lack of proper array, int and bitwise support in WebGL 1.0\n\t\tint powi = 1;\n\n\t\tif(index == 0)\n\t\t{\n\t\t\tpowi = 1;\n\t\t}\n\t\telse if(index == 1)\n\t\t{\n\t\t\tpowi = 2;\n\t\t}\n\t\telse if(index == 2)\n\t\t{\n\t\t\tpowi = 4;\n\t\t}\n\t\telse if(index == 3)\n\t\t{\n\t\t\tpowi = 8;\n\t\t}\n\t\telse if(index == 4)\n\t\t{\n\t\t\tpowi = 16;\n\t\t}\n\t\telse if(index == 5)\n\t\t{\n\t\t\tpowi = 32;\n\t\t}\n\t\telse if(index == 6)\n\t\t{\n\t\t\tpowi = 64;\n\t\t}\n\t\telse if(index == 7)\n\t\t{\n\t\t\tpowi = 128;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tint ndp = number / powi;\n\n\t\treturn mod(float(ndp), 2.0) != 0.0;\n\t}\n\n\t/**\n\t * find the LOD at the point position\n\t */\n\tfloat getLOD()\n\t{\n\t\tvec3 offset = vec3(0.0, 0.0, 0.0);\n\t\tint iOffset = int(uVNStart);\n\t\tfloat depth = uLevel;\n\n\t\tfor(float i = 0.0; i <= 30.0; i++)\n\t\t{\n\t\t\tfloat nodeSizeAtLevel = uOctreeSize / pow(2.0, i + uLevel + 0.0);\n\t\t\t\n\t\t\tvec3 index3d = (position-offset) / nodeSizeAtLevel;\n\t\t\tindex3d = floor(index3d + 0.5);\n\t\t\tint index = int(round(4.0 * index3d.x + 2.0 * index3d.y + index3d.z));\n\t\t\t\n\t\t\tvec4 value = texture2D(visibleNodes, vec2(float(iOffset) / 2048.0, 0.0));\n\t\t\tint mask = int(round(value.r * 255.0));\n\n\t\t\tif(isBitSet(mask, index))\n\t\t\t{\n\t\t\t\t//there are more visible child nodes at this position\n\t\t\t\tint advanceG = int(round(value.g * 255.0)) * 256;\n\t\t\t\tint advanceB = int(round(value.b * 255.0));\n\t\t\t\tint advanceChild = numberOfOnes(mask, index - 1);\n\t\t\t\tint advance = advanceG + advanceB + advanceChild;\n\n\t\t\t\tiOffset = iOffset + advance;\n\t\t\t\t\n\t\t\t\tdepth++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t//no more visible child nodes at this position\n\t\t\t\treturn value.a * 255.0;\n\t\t\t\t//return depth;\n\t\t\t}\n\t\t\t\n\t\t\toffset = offset + (vec3(1.0, 1.0, 1.0) * nodeSizeAtLevel * 0.5) * index3d;\n\t\t}\n\t\t\t\n\t\treturn depth;\n\t}\n\n\tfloat getSpacing()\n\t{\n\t\tvec3 offset = vec3(0.0, 0.0, 0.0);\n\t\tint iOffset = int(uVNStart);\n\t\tfloat depth = uLevel;\n\t\tfloat spacing = uNodeSpacing;\n\n\t\tfor(float i = 0.0; i <= 30.0; i++)\n\t\t{\n\t\t\tfloat nodeSizeAtLevel = uOctreeSize / pow(2.0, i + uLevel + 0.0);\n\t\t\t\n\t\t\tvec3 index3d = (position-offset) / nodeSizeAtLevel;\n\t\t\tindex3d = floor(index3d + 0.5);\n\t\t\tint index = int(round(4.0 * index3d.x + 2.0 * index3d.y + index3d.z));\n\t\t\t\n\t\t\tvec4 value = texture2D(visibleNodes, vec2(float(iOffset) / 2048.0, 0.0));\n\t\t\tint mask = int(round(value.r * 255.0));\n\t\t\tfloat spacingFactor = value.a;\n\n\t\t\tif(i > 0.0)\n\t\t\t{\n\t\t\t\tspacing = spacing / (255.0 * spacingFactor);\n\t\t\t}\n\t\t\t\n\t\t\tif(isBitSet(mask, index))\n\t\t\t{\n\t\t\t\t//there are more visible child nodes at this position\n\t\t\t\tint advanceG = int(round(value.g * 255.0)) * 256;\n\t\t\t\tint advanceB = int(round(value.b * 255.0));\n\t\t\t\tint advanceChild = numberOfOnes(mask, index - 1);\n\t\t\t\tint advance = advanceG + advanceB + advanceChild;\n\n\t\t\t\tiOffset = iOffset + advance;\n\n\t\t\t\tdepth++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t//no more visible child nodes at this position\n\t\t\t\treturn spacing;\n\t\t\t}\n\t\t\t\n\t\t\toffset = offset + (vec3(1.0, 1.0, 1.0) * nodeSizeAtLevel * 0.5) * index3d;\n\t\t}\n\t\t\t\n\t\treturn spacing;\n\t}\n\n\tfloat getPointSizeAttenuation()\n\t{\n\t\treturn pow(2.0, getLOD());\n\t}\n#endif\n\n//---------------------\n//KD-TREE\n//---------------------\n#if (defined(adaptive_point_size) || defined(color_type_lod)) && defined(tree_type_kdtree)\n\tfloat getLOD()\n\t{\n\t\tvec3 offset = vec3(0.0, 0.0, 0.0);\n\t\tfloat iOffset = 0.0;\n\t\tfloat depth = 0.0;\n\t\t\t\n\t\tvec3 size = uBBSize;\t\n\t\tvec3 pos = position;\n\t\t\t\n\t\tfor(float i = 0.0; i <= 1000.0; i++)\n\t\t{\n\t\t\tvec4 value = texture2D(visibleNodes, vec2(iOffset / 2048.0, 0.0));\n\t\t\t\n\t\t\tint children = int(value.r * 255.0);\n\t\t\tfloat next = value.g * 255.0;\n\t\t\tint split = int(value.b * 255.0);\n\t\t\t\n\t\t\tif(next == 0.0)\n\t\t\t{\n\t\t\t \treturn depth;\n\t\t\t}\n\t\t\t\n\t\t\tvec3 splitv = vec3(0.0, 0.0, 0.0);\n\t\t\tif(split == 1)\n\t\t\t{\n\t\t\t\tsplitv.x = 1.0;\n\t\t\t}\n\t\t\telse if(split == 2)\n\t\t\t{\n\t\t\t \tsplitv.y = 1.0;\n\t\t\t}\n\t\t\telse if(split == 4)\n\t\t\t{\n\t\t\t \tsplitv.z = 1.0;\n\t\t\t}\n\t\t\t\n\t\t\tiOffset = iOffset + next;\n\t\t\t\n\t\t\tfloat factor = length(pos * splitv / size);\n\n\t\t\t//Left\n\t\t\tif(factor < 0.5)\n\t\t\t{\n\t\t\t\tif(children == 0 || children == 2)\n\t\t\t\t{\n\t\t\t\t\treturn depth;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//Right\n\t\t\telse\n\t\t\t{\n\t\t\t\tpos = pos - size * splitv * 0.5;\n\t\t\t\tif(children == 0 || children == 1)\n\t\t\t\t{\n\t\t\t\t\treturn depth;\n\t\t\t\t}\n\t\t\t\tif(children == 3)\n\t\t\t\t{\n\t\t\t\t\tiOffset = iOffset + 1.0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsize = size * ((1.0 - (splitv + 1.0) / 2.0) + 0.5);\n\t\t\tdepth++;\n\t\t}\n\t\t\t\n\t\treturn depth;\t\n\t}\n\n\tfloat getPointSizeAttenuation()\n\t{\n\t\treturn 0.5 * pow(1.3, getLOD());\n\t}\n#endif\n\n//formula adapted from: http://www.dfstudios.co.uk/articles/programming/image-programming-algorithms/image-processing-algorithms-part-5-contrast-adjustment/\nfloat getContrastFactor(float contrast)\n{\n\treturn (1.0158730158730156 * (contrast + 1.0)) / (1.0158730158730156 - contrast);\n}\n\nvec3 getRGB()\n{\n\tvec3 rgb = color;\n\t\n\trgb = pow(rgb, vec3(rgbGamma));\n\trgb = rgb + rgbBrightness;\n\trgb = clamp(rgb, 0.0, 1.0);\n\t\n\treturn rgb;\n}\n\nfloat getIntensity()\n{\n\tfloat w = (intensity - intensityRange.x) / (intensityRange.y - intensityRange.x);\n\tw = pow(w, intensityGamma);\n\tw = w + intensityBrightness;\n\tw = (w - 0.5) * getContrastFactor(intensityContrast) + 0.5;\n\tw = clamp(w, 0.0, 1.0);\n\n\treturn w;\n}\n\nvec3 getElevation()\n{\n\tvec4 world = modelMatrix * vec4( position, 1.0 );\n\tfloat w = (world.z - elevationRange.x) / (elevationRange.y - elevationRange.x);\n\treturn texture2D(gradient, vec2(w,1.0-w)).rgb;\n}\n\nvec4 getClassification()\n{\n\tvec2 uv = vec2(classification / 255.0, 0.5);\n\treturn texture2D(classificationLUT, uv);\n}\n\nvec3 getReturnNumber()\n{\n\tif(numberOfReturns == 1.0)\n\t{\n\t\treturn vec3(1.0, 1.0, 0.0);\n\t}\n\telse\n\t{\n\t\tif(returnNumber == 1.0)\n\t\t{\n\t\t\treturn vec3(1.0, 0.0, 0.0);\n\t\t}\n\t\telse if(returnNumber == numberOfReturns)\n\t\t{\n\t\t\treturn vec3(0.0, 0.0, 1.0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn vec3(0.0, 1.0, 0.0);\n\t\t}\n\t}\n}\n\nvec3 getSourceID()\n{\n\tfloat w = mod(pointSourceID, 10.0) / 10.0;\n\treturn texture2D(gradient, vec2(w,1.0 - w)).rgb;\n}\n\nvec3 getCompositeColor()\n{\n\tvec3 c;\n\tfloat w;\n\n\tc += wRGB * getRGB();\n\tw += wRGB;\n\t\n\tc += wIntensity * getIntensity() * vec3(1.0, 1.0, 1.0);\n\tw += wIntensity;\n\t\n\tc += wElevation * getElevation();\n\tw += wElevation;\n\t\n\tc += wReturnNumber * getReturnNumber();\n\tw += wReturnNumber;\n\t\n\tc += wSourceID * getSourceID();\n\tw += wSourceID;\n\t\n\tvec4 cl = wClassification * getClassification();\n    c += cl.a * cl.rgb;\n\tw += wClassification * cl.a;\n\n\tc = c / w;\n\t\n\tif(w == 0.0)\n\t{\n\t\tgl_Position = vec4(100.0, 100.0, 100.0, 0.0);\n\t}\n\t\n\treturn c;\n}\n\nvec3 getColor()\n{\n\tvec3 color;\n\t\n\t#ifdef color_type_rgb\n\t\tcolor = getRGB();\n\t#elif defined color_type_height\n\t\tcolor = getElevation();\n\t#elif defined color_type_rgb_height\n\t\tvec3 cHeight = getElevation();\n\t\tcolor = (1.0 - uTransition) * getRGB() + uTransition * cHeight;\n\t#elif defined color_type_depth\n\t\tfloat linearDepth = gl_Position.w;\n\t\tfloat expDepth = (gl_Position.z / gl_Position.w) * 0.5 + 0.5;\n\t\tcolor = vec3(linearDepth, expDepth, 0.0);\n\t#elif defined color_type_intensity\n\t\tfloat w = getIntensity();\n\t\tcolor = vec3(w, w, w);\n\t#elif defined color_type_intensity_gradient\n\t\tfloat w = getIntensity();\n\t\tcolor = texture2D(gradient, vec2(w,1.0-w)).rgb;\n\t#elif defined color_type_color\n\t\tcolor = uColor;\n\t#elif defined color_type_lod\n\t\tfloat depth = getLOD();\n\t\tfloat w = depth / 10.0;\n\t\tcolor = texture2D(gradient, vec2(w,1.0-w)).rgb;\n\t#elif defined color_type_point_index\n\t\tcolor = indices.rgb;\n\t#elif defined color_type_classification\n\t\tvec4 cl = getClassification(); \n\t\tcolor = cl.rgb;\n\t#elif defined color_type_return_number\n\t\tcolor = getReturnNumber();\n\t#elif defined color_type_source\n\t\tcolor = getSourceID();\n\t#elif defined color_type_normal\n\t\tcolor = (modelMatrix * vec4(normal, 0.0)).xyz;\n\t#elif defined color_type_phong\n\t\tcolor = color;\n\t#elif defined color_type_composite\n\t\tcolor = getCompositeColor();\n\t#endif\n\t\n\treturn color;\n}\n\nfloat getPointSize()\n{\n\tfloat pointSize = 1.0;\n\t\n\tfloat slope = tan(fov / 2.0);\n\tfloat projFactor = -0.5 * uScreenHeight / (slope * vViewPosition.z);\n\t\n\tfloat r = uOctreeSpacing * 1.7;\n\tvRadius = r;\n\n\t#if defined fixed_point_size\n\t\tpointSize = size;\n\t#elif defined attenuated_point_size\n\t\tif(uUseOrthographicCamera)\n\t\t{\n\t\t\tpointSize = size;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpointSize = size * spacing * projFactor;\n\t\t}\n\t#elif defined adaptive_point_size\n\t\tif(uUseOrthographicCamera)\n\t\t{\n\t\t\tfloat worldSpaceSize = 1.0 * size * r / getPointSizeAttenuation();\n\t\t\tpointSize = (worldSpaceSize / uOrthoWidth) * uScreenWidth;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(uIsLeafNode && false)\n\t\t\t{\n\t\t\t\tpointSize = size * spacing * projFactor;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfloat worldSpaceSize = 1.0 * size * r / getPointSizeAttenuation();\n\t\t\t\tpointSize = worldSpaceSize * projFactor;\n\t\t\t}\n\t\t}\n\t#endif\n\n\tpointSize = max(minSize, pointSize);\n\tpointSize = min(maxSize, pointSize);\n\t\n\tvRadius = pointSize / projFactor;\n\n\treturn pointSize;\n}\n\n#if defined num_clippolygons && num_clippolygons > 0\n\tbool pointInClipPolygon(vec3 point, int polyIdx)\n\t{\n\t\tmat4 wvp = uClipPolygonWVP[polyIdx];\n\n\t\tvec4 pointNDC = wvp * vec4(point, 1.0);\n\t\tpointNDC.xy = pointNDC.xy / pointNDC.w;\n\n\t\tint j = uClipPolygonVCount[polyIdx] - 1;\n\t\tbool c = false;\n\t\tfor(int i = 0; i < 8; i++)\n\t\t{\n\t\t\tif(i == uClipPolygonVCount[polyIdx])\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvec3 verti = uClipPolygonVertices[polyIdx * 8 + i];\n\t\t\tvec3 vertj = uClipPolygonVertices[polyIdx * 8 + j];\n\n\t\t\tif(((verti.y > pointNDC.y) != (vertj.y > pointNDC.y)) && (pointNDC.x < (vertj.x-verti.x) * (pointNDC.y-verti.y) / (vertj.y-verti.y) + verti.x))\n\t\t\t{\n\t\t\t\tc = !c;\n\t\t\t}\n\n\t\t\tj = i;\n\t\t}\n\n\t\treturn c;\n\t}\n#endif\n\nvoid doClipping()\n{\n\t#if !defined color_type_composite\n\t\tvec4 cl = getClassification(); \n\t\tif(cl.a == 0.0)\n\t\t{\n\t\t\tgl_Position = vec4(100.0, 100.0, 100.0, 0.0);\n\t\t\t\n\t\t\treturn;\n\t\t}\n\t#endif\n\n\tint clipVolumesCount = 0;\n\tint insideCount = 0;\n\n\t#if defined(num_clipboxes) && num_clipboxes > 0\n\t\tfor(int i = 0; i < num_clipboxes; i++)\n\t\t{\n\t\t\tvec4 clipPosition = clipBoxes[i] * modelMatrix * vec4( position, 1.0 );\n\t\t\tbool inside = -0.5 <= clipPosition.x && clipPosition.x <= 0.5;\n\t\t\tinside = inside && -0.5 <= clipPosition.y && clipPosition.y <= 0.5;\n\t\t\tinside = inside && -0.5 <= clipPosition.z && clipPosition.z <= 0.5;\n\n\t\t\tinsideCount = insideCount + (inside ? 1 : 0);\n\t\t\tclipVolumesCount++;\n\t\t}\t\n\t#endif\n\n\t#if defined(num_clippolygons) && num_clippolygons > 0\n\t\tfor(int i = 0; i < num_clippolygons; i++)\n\t\t{\n\t\t\tbool inside = pointInClipPolygon(position, i);\n\n\t\t\tinsideCount = insideCount + (inside ? 1 : 0);\n\t\t\tclipVolumesCount++;\n\t\t}\n\t#endif\n\n\tbool insideAny = insideCount > 0;\n\tbool insideAll = (clipVolumesCount > 0) && (clipVolumesCount == insideCount);\n\n\tif(clipMethod == CLIPMETHOD_INSIDE_ANY)\n\t{\n\t\tif(insideAny && clipTask == CLIPTASK_HIGHLIGHT)\n\t\t{\n\t\t\tvColor.r += 0.5;\n\t\t}\n\t\telse if(!insideAny && clipTask == CLIPTASK_SHOW_INSIDE)\n\t\t{\n\t\t\tgl_Position = vec4(100.0, 100.0, 100.0, 1.0);\n\t\t}\n\t\telse if(insideAny && clipTask == CLIPTASK_SHOW_OUTSIDE)\n\t\t{\n\t\t\tgl_Position = vec4(100.0, 100.0, 100.0, 1.0);\n\t\t}\n\t}\n\telse if(clipMethod == CLIPMETHOD_INSIDE_ALL)\n\t{\n\t\tif(insideAll && clipTask == CLIPTASK_HIGHLIGHT)\n\t\t{\n\t\t\tvColor.r += 0.5;\n\t\t}\n\t\telse if(!insideAll && clipTask == CLIPTASK_SHOW_INSIDE)\n\t\t{\n\t\t\tgl_Position = vec4(100.0, 100.0, 100.0, 1.0);\n\t\t}\n\t\telse if(insideAll && clipTask == CLIPTASK_SHOW_OUTSIDE)\n\t\t{\n\t\t\tgl_Position = vec4(100.0, 100.0, 100.0, 1.0);\n\t\t}\n\t}\n}\n\nvoid main()\n{\n\tvec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n\tvViewPosition = mvPosition.xyz;\n\tgl_Position = projectionMatrix * mvPosition;\n\n\tvLogDepth = log2(-mvPosition.z);\n\n\t//POINT SIZE\n\tfloat pointSize = getPointSize();\n\tgl_PointSize = pointSize;\n\tvPointSize = pointSize;\n\n\t"+r.ShaderChunk.logdepthbuf_vertex+"\n\n\t//COLOR\n\tvColor = getColor();\n\n\t#if defined hq_depth_pass\n\t\tfloat originalDepth = gl_Position.w;\n\t\tfloat adjustedDepth = originalDepth + 2.0 * vRadius;\n\t\tfloat adjust = adjustedDepth / originalDepth;\n\n\t\tmvPosition.xyz = mvPosition.xyz * adjust;\n\t\tgl_Position = projectionMatrix * mvPosition;\n\t#endif\n\n\t//CLIPPING\n\tdoClipping();\n\n\t#if defined num_clipspheres && num_clipspheres > 0\n\t\tfor(int i = 0; i < num_clipspheres; i++)\n\t\t{\n\t\t\tvec4 sphereLocal = uClipSpheres[i] * mvPosition;\n\n\t\t\tfloat distance = length(sphereLocal.xyz);\n\n\t\t\tif(distance < 1.0)\n\t\t\t{\n\t\t\t\tfloat w = distance;\n\t\t\t\tvec3 cGradient = texture2D(gradient, vec2(w, 1.0 - w)).rgb;\n\t\t\t\t\n\t\t\t\tvColor = cGradient;\n\t\t\t}\n\t\t}\n\t#endif\n\n\t#if defined num_shadowmaps && num_shadowmaps > 0\n\n\t\tconst float sm_near = 0.1;\n\t\tconst float sm_far = 10000.0;\n\n\t\tfor(int i = 0; i < num_shadowmaps; i++)\n\t\t{\n\t\t\tvec3 viewPos = (uShadowWorldView[i] * vec4(position, 1.0)).xyz;\n\t\t\tfloat distanceToLight = abs(viewPos.z);\n\t\t\t\n\t\t\tvec4 projPos = uShadowProj[i] * uShadowWorldView[i] * vec4(position, 1);\n\t\t\tvec3 nc = projPos.xyz / projPos.w;\n\t\t\t\n\t\t\tfloat u = nc.x * 0.5 + 0.5;\n\t\t\tfloat v = nc.y * 0.5 + 0.5;\n\n\t\t\tvec2 sampleStep = vec2(1.0 / (2.0*1024.0), 1.0 / (2.0*1024.0)) * 1.5;\n\t\t\tvec2 sampleLocations[9];\n\n\t\t\tsampleLocations[0] = vec2(0.0, 0.0);\n\t\t\tsampleLocations[1] = sampleStep;\n\t\t\tsampleLocations[2] = -sampleStep;\n\t\t\tsampleLocations[3] = vec2(sampleStep.x, -sampleStep.y);\n\t\t\tsampleLocations[4] = vec2(-sampleStep.x, sampleStep.y);\n\t\t\tsampleLocations[5] = vec2(0.0, sampleStep.y);\n\t\t\tsampleLocations[6] = vec2(0.0, -sampleStep.y);\n\t\t\tsampleLocations[7] = vec2(sampleStep.x, 0.0);\n\t\t\tsampleLocations[8] = vec2(-sampleStep.x, 0.0);\n\n\t\t\tfloat visibleSamples = 0.0;\n\t\t\tfloat numSamples = 0.0;\n\n\t\t\tfloat bias = vRadius * 2.0;\n\n\t\t\tfor(int j = 0; j < 9; j++)\n\t\t\t{\n\t\t\t\tvec4 depthMapValue = texture2D(uShadowMap[i], vec2(u, v) + sampleLocations[j]);\n\n\t\t\t\tfloat linearDepthFromSM = depthMapValue.x + bias;\n\t\t\t\tfloat linearDepthFromViewer = distanceToLight;\n\n\t\t\t\tif(linearDepthFromSM > linearDepthFromViewer)\n\t\t\t\t{\n\t\t\t\t\tvisibleSamples += 1.0;\n\t\t\t\t}\n\n\t\t\t\tnumSamples += 1.0;\n\t\t\t}\n\n\t\t\tfloat visibility = visibleSamples / numSamples;\n\n\t\t\tif(u < 0.0 || u > 1.0 || v < 0.0 || v > 1.0 || nc.x < -1.0 || nc.x > 1.0 || nc.y < -1.0 || nc.y > 1.0 || nc.z < -1.0 || nc.z > 1.0)\n\t\t\t{\n\t\t\t\t//vColor = vec3(0.0, 0.0, 0.2);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvColor = vColor * visibility + vColor * uShadowColor * (1.0 - visibility);\n\t\t\t}\n\t\t}\n\n\t#endif\n}",i.fragment="\n\n#if defined USE_LOGDEPTHBUF_EXT || defined paraboloid_point_shape\n\t#extension GL_EXT_frag_depth : enable\n#endif\n\nprecision highp float;\nprecision highp int;\n\n"+r.ShaderChunk.common+"\n"+r.ShaderChunk.logdepthbuf_pars_fragment+"\n\nuniform mat4 viewMatrix;\nuniform mat4 uViewInv;\nuniform mat4 uProjInv;\nuniform vec3 cameraPosition;\n\nuniform mat4 projectionMatrix;\nuniform float uOpacity;\n\nuniform float blendHardness;\nuniform float blendDepthSupplement;\nuniform float fov;\nuniform float uSpacing;\nuniform float near;\nuniform float far;\nuniform float uPCIndex;\nuniform float uScreenWidth;\nuniform float uScreenHeight;\n\nvarying vec3 vColor;\nvarying float vLogDepth;\nvarying vec3 vViewPosition;\nvarying float vRadius;\nvarying float vPointSize;\nvarying vec3 vPosition;\n\nvoid main()\n{\n\tvec3 color = vColor;\n\tfloat depth = gl_FragCoord.z;\n\n\t#if defined circle_point_shape || defined paraboloid_point_shape\n\t\tfloat u = (2.0 * gl_PointCoord.x) - 1.0;\n\t\tfloat v = (2.0 * gl_PointCoord.y) - 1.0;\n\t#endif\n\t\n\t#if defined circle_point_shape\n\t\tfloat cc = (u*u) + (v*v);\n\t\tif(cc > 1.0)\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n\n\t#if defined color_type_point_index\n\t\tgl_FragColor = vec4(color, uPCIndex / 255.0);\n\t#else\n\t\tgl_FragColor = vec4(color, uOpacity);\n\t#endif\n\n\t#if defined paraboloid_point_shape\n\t\tfloat wi = -( u*u + v*v);\n\t\tvec4 pos = vec4(vViewPosition, 1.0);\n\t\tpos.z += wi * vRadius;\n\t\tfloat linearDepth = -pos.z;\n\t\tpos = projectionMatrix * pos;\n\t\tpos = pos / pos.w;\n\t\tfloat expDepth = pos.z;\n\t\tdepth = (pos.z + 1.0) / 2.0;\n\n\t\tgl_FragDepthEXT = depth;\n\t\t\n\t\t#if defined color_type_depth\n\t\t\tcolor.r = linearDepth;\n\t\t\tcolor.g = expDepth;\n\t\t#endif\n\t#endif\n\t\n\t"+r.ShaderChunk.logdepthbuf_fragment+"\n\n\t#if defined weighted_splats\n\t\tfloat distance = 2.0 * length(gl_PointCoord.xy - 0.5);\n\t\tfloat weight = max(0.0, 1.0 - distance);\n\t\tweight = pow(weight, 1.5);\n\n\t\tgl_FragColor.a = weight;\n\t\tgl_FragColor.xyz = gl_FragColor.xyz * weight;\n\t#endif\n}"},"./source/WebGLBuffer.js":function(t,e,n){"use strict";n.r(e),n.d(e,"WebGLBuffer",(function(){return r}));var r=function t(){p(this,t),this.numElements=0,this.vao=null,this.vbos=new Map}},"./source/WebGLTexture.js":function(t,e,n){"use strict";n.r(e),n.d(e,"WebGLTexture",(function(){return o}));var r=n("three");function i(t,e){var n;if(e===r.RepeatWrapping)return t.REPEAT;if(e===r.ClampToEdgeWrapping)return t.CLAMP_TO_EDGE;if(e===r.MirroredRepeatWrapping)return t.MIRRORED_REPEAT;if(e===r.NearestFilter)return t.NEAREST;if(e===r.NearestMipMapNearestFilter)return t.NEAREST_MIPMAP_NEAREST;if(e===r.NearestMipMapLinearFilter)return t.NEAREST_MIPMAP_LINEAR;if(e===r.LinearFilter)return t.LINEAR;if(e===r.LinearMipMapNearestFilter)return t.LINEAR_MIPMAP_NEAREST;if(e===r.LinearMipMapLinearFilter)return t.LINEAR_MIPMAP_LINEAR;if(e===r.UnsignedByteType)return t.UNSIGNED_BYTE;if(e===r.UnsignedShort4444Type)return t.UNSIGNED_SHORT_4_4_4_4;if(e===r.UnsignedShort5551Type)return t.UNSIGNED_SHORT_5_5_5_1;if(e===r.UnsignedShort565Type)return t.UNSIGNED_SHORT_5_6_5;if(e===r.ByteType)return t.BYTE;if(e===r.ShortType)return t.SHORT;if(e===r.UnsignedShortType)return t.UNSIGNED_SHORT;if(e===r.IntType)return t.INT;if(e===r.UnsignedIntType)return t.UNSIGNED_INT;if(e===r.FloatType)return t.FLOAT;if(e===r.HalfFloatType&&null!==(n=extensions.get("OES_texture_half_float")))return n.HALF_FLOAT_OES;if(e===r.AlphaFormat)return t.ALPHA;if(e===r.RGBFormat)return t.RGB;if(e===r.RGBAFormat)return t.RGBA;if(e===r.LuminanceFormat)return t.LUMINANCE;if(e===r.LuminanceAlphaFormat)return t.LUMINANCE_ALPHA;if(e===r.DepthFormat)return t.DEPTH_COMPONENT;if(e===r.DepthStencilFormat)return t.DEPTH_STENCIL;if(e===r.AddEquation)return t.FUNC_ADD;if(e===r.SubtractEquation)return t.FUNC_SUBTRACT;if(e===r.ReverseSubtractEquation)return t.FUNC_REVERSE_SUBTRACT;if(e===r.ZeroFactor)return t.ZERO;if(e===r.OneFactor)return t.ONE;if(e===r.SrcColorFactor)return t.SRC_COLOR;if(e===r.OneMinusSrcColorFactor)return t.ONE_MINUS_SRC_COLOR;if(e===r.SrcAlphaFactor)return t.SRC_ALPHA;if(e===r.OneMinusSrcAlphaFactor)return t.ONE_MINUS_SRC_ALPHA;if(e===r.DstAlphaFactor)return t.DST_ALPHA;if(e===r.OneMinusDstAlphaFactor)return t.ONE_MINUS_DST_ALPHA;if(e===r.DstColorFactor)return t.DST_COLOR;if(e===r.OneMinusDstColorFactor)return t.ONE_MINUS_DST_COLOR;if(e===r.SrcAlphaSaturateFactor)return t.SRC_ALPHA_SATURATE;if((e===r.RGB_S3TC_DXT1_Format||e===RGBA_S3TC_DXT1_Format||e===r.RGBA_S3TC_DXT3_Format||e===RGBA_S3TC_DXT5_Format)&&null!==(n=extensions.get("WEBGL_compressed_texture_s3tc"))){if(e===r.RGB_S3TC_DXT1_Format)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===r.RGBA_S3TC_DXT1_Format)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===r.RGBA_S3TC_DXT3_Format)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===r.RGBA_S3TC_DXT5_Format)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((e===r.RGB_PVRTC_4BPPV1_Format||e===r.RGB_PVRTC_2BPPV1_Format||e===r.RGBA_PVRTC_4BPPV1_Format||e===r.RGBA_PVRTC_2BPPV1_Format)&&null!==(n=extensions.get("WEBGL_compressed_texture_pvrtc"))){if(e===r.RGB_PVRTC_4BPPV1_Format)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===r.RGB_PVRTC_2BPPV1_Format)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===r.RGBA_PVRTC_4BPPV1_Format)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===r.RGBA_PVRTC_2BPPV1_Format)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===r.RGB_ETC1_Format&&null!==(n=extensions.get("WEBGL_compressed_texture_etc1")))return n.COMPRESSED_RGB_ETC1_WEBGL;if((e===r.MinEquation||e===r.MaxEquation)&&null!==(n=extensions.get("EXT_blend_minmax"))){if(e===r.MinEquation)return n.MIN_EXT;if(e===r.MaxEquation)return n.MAX_EXT}return e===UnsignedInt248Type&&null!==(n=extensions.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:0}var o=function(){function t(e,n){p(this,t),this.gl=e,this.texture=n,this.id=e.createTexture(),this.target=e.TEXTURE_2D,this.version=-1,this.update(n)}return m(t,[{key:"update",value:function(){if(this.texture.image){var t=this.gl,e=this.texture;if(this.version!==e.version){this.target=t.TEXTURE_2D,t.bindTexture(this.target,this.id);var n,o=i(t,e.format),a=e.image.width,s=e.image.height,u=o,c=i(t,e.type);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,e.unpackAlignment),e instanceof r.DataTexture?(n=e.image.data,t.texParameteri(this.target,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(this.target,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(this.target,t.TEXTURE_MAG_FILTER,i(t,e.magFilter)),t.texParameteri(this.target,t.TEXTURE_MIN_FILTER,i(t,e.minFilter)),t.texImage2D(this.target,0,o,a,s,0,u,c,n)):e instanceof r.CanvasTexture&&(n=e.image,t.texParameteri(this.target,t.TEXTURE_WRAP_S,i(t,e.wrapS)),t.texParameteri(this.target,t.TEXTURE_WRAP_T,i(t,e.wrapT)),t.texParameteri(this.target,t.TEXTURE_MAG_FILTER,i(t,e.magFilter)),t.texParameteri(this.target,t.TEXTURE_MIN_FILTER,i(t,e.minFilter)),t.texImage2D(this.target,0,o,o,c,n)),t.bindTexture(this.target,null),this.version=e.version}}else this.version=this.texture.version}}]),t}()},"./source/XHRFactory.js":function(t,e,n){"use strict";n.r(e),n.d(e,"XHRFactory",(function(){return r}));var r={config:{withCredentials:!1,customHeaders:[{header:null,value:null}]},createXMLHttpRequest:function(){var t=new XMLHttpRequest;if(this.config.customHeaders&&Array.isArray(this.config.customHeaders)&&this.config.customHeaders.length>0){var e=t.open,n=this.config.customHeaders;t.open=function(){e.apply(this,[].slice.call(arguments)),n.forEach((function(e){e.header&&e.value&&t.setRequestHeader(e.header,e.value)}))}}return t},fetch:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=d(l.mark((function t(e){var n,i;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Headers,this.config.customHeaders&&this.config.customHeaders.forEach((function(t){t.header&&t.value&&n.append(t.header,t.value)})),i={headers:n,credentials:r.config.withCredentials?"include":"same-origin"},t.abrupt("return",fetch(e,i));case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}())}},"./source/lib/BinaryHeap.js":function(t,e,n){"use strict";function r(t){this.content=[],this.scoreFunction=t}n.r(e),n.d(e,"BinaryHeap",(function(){return r})),r.prototype={push:function(t){this.content.push(t),this.bubbleUp(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.sinkDown(0)),t},remove:function(t){for(var e=this.content.length,n=0;n<e;n++)if(this.content[n]==t){var r=this.content.pop();if(n==e-1)break;this.content[n]=r,this.bubbleUp(n),this.sinkDown(n);break}},size:function(){return this.content.length},bubbleUp:function(t){for(var e=this.content[t],n=this.scoreFunction(e);t>0;){var r=Math.floor((t+1)/2)-1,i=this.content[r];if(n>=this.scoreFunction(i))break;this.content[r]=e,this.content[t]=i,t=r}},sinkDown:function(t){for(var e=this.content.length,n=this.content[t],r=this.scoreFunction(n);;){var i=2*(t+1),o=i-1,a=null;if(o<e){var s=this.content[o],u=this.scoreFunction(s);u<r&&(a=o)}if(i<e){var c=this.content[i];this.scoreFunction(c)<(null==a?r:u)&&(a=i)}if(null==a)break;this.content[t]=this.content[a],this.content[a]=n,t=a}}}},"./source/loaders/BinaryLoader.js":function(t,e,n){"use strict";n.r(e),n.d(e,"BinaryLoader",(function(){return l}));var r=n("three"),i=n("./source/PointAttributes.js"),o=n("./source/utils/VersionUtils.js"),a=n("./source/utils/WorkerManager.js"),s=n("./source/Global.js"),u=n("./source/XHRFactory.js"),l=function(){function t(e,n,r){p(this,t),this.version="string"===typeof e?new o.VersionUtils(e):e,this.boundingBox=n,this.scale=r}return m(t,[{key:"load",value:function(t){if(!t.loaded){var e=t.getURL();this.version.equalOrHigher("1.4")&&(e+=".bin");var n=this,r=u.XHRFactory.createXMLHttpRequest();r.open("GET",e,!0),r.responseType="arraybuffer",r.overrideMimeType("text/plain; charset=x-user-defined"),r.onload=function(){try{n.parse(t,r.response)}catch(e){s.Global.numNodesLoading--,console.error("Potree: Exception thrown parsing points.",e)}},r.onerror=function(t){s.Global.numNodesLoading--,console.error("Potree: Failed to load file.",r,e)},r.send(null)}}},{key:"parse",value:function(t,e){var n=t.pcoGeometry.pointAttributes,o=e.byteLength/t.pcoGeometry.pointAttributes.byteSize;this.version.upTo("1.5")&&(t.numPoints=o);var u={buffer:e,pointAttributes:n,version:this.version.version,min:[t.boundingBox.min.x,t.boundingBox.min.y,t.boundingBox.min.z],offset:[t.pcoGeometry.offset.x,t.pcoGeometry.offset.y,t.pcoGeometry.offset.z],scale:this.scale,spacing:t.spacing,hasChildren:t.hasChildren,name:t.name};s.Global.workerPool.runTask(a.WorkerManager.BINARY_DECODER,(function(e){var o=e.data;if(void 0!==o.error)return s.Global.numNodesLoading--,void console.error("Potree: Binary worker error.",o);var a=o.attributeBuffers,u=new r.Box3((new r.Vector3).fromArray(o.tightBoundingBox.min),(new r.Vector3).fromArray(o.tightBoundingBox.max)),l=new r.BufferGeometry;for(var d in a){var f=a[d].buffer;if(parseInt(d)===i.PointAttributeNames.POSITION_CARTESIAN)l.setAttribute("position",new r.BufferAttribute(new Float32Array(f),3));else if(parseInt(d)===i.PointAttributeNames.COLOR_PACKED)l.setAttribute("color",new r.BufferAttribute(new Uint8Array(f),4,!0));else if(parseInt(d)===i.PointAttributeNames.INTENSITY)l.setAttribute("intensity",new r.BufferAttribute(new Float32Array(f),1));else if(parseInt(d)===i.PointAttributeNames.CLASSIFICATION)l.setAttribute("classification",new r.BufferAttribute(new Uint8Array(f),1));else if(parseInt(d)===i.PointAttributeNames.NORMAL_SPHEREMAPPED)l.setAttribute("normal",new r.BufferAttribute(new Float32Array(f),3));else if(parseInt(d)===i.PointAttributeNames.NORMAL_OCT16)l.setAttribute("normal",new r.BufferAttribute(new Float32Array(f),3));else if(parseInt(d)===i.PointAttributeNames.NORMAL)l.setAttribute("normal",new r.BufferAttribute(new Float32Array(f),3));else if(parseInt(d)===i.PointAttributeNames.INDICES){(p=new r.BufferAttribute(new Uint8Array(f),4)).normalized=!0,l.setAttribute("indices",p)}else if(parseInt(d)===i.PointAttributeNames.SPACING){var p=new r.BufferAttribute(new Float32Array(f),1);l.setAttribute("spacing",p)}}u.max.sub(u.min),u.min.set(0,0,0);var m=e.data.buffer.byteLength/n.byteSize;t.numPoints=m,t.geometry=l,t.mean=c(r.Vector3,h(o.mean)),t.tightBoundingBox=u,t.loaded=!0,t.loading=!1,t.estimatedSpacing=o.estimatedSpacing,s.Global.numNodesLoading--}),u,[u.buffer])}}]),t}()},"./source/loaders/EptLoader.js":function(t,e,n){"use strict";n.r(e),n.d(e,"EptLoader",(function(){return o}));var r=n("./source/pointcloud/geometries/PointCloudEptGeometry.js"),i=n("./source/XHRFactory.js"),o=function(){function t(){p(this,t)}return m(t,null,[{key:"load",value:function(){var t=d(l.mark((function t(e,n){var o,a,s,u,c;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.XHRFactory.fetch(e);case 2:return o=t.sent,t.next=5,o.json();case 5:a=t.sent,s=e.substr(0,e.lastIndexOf("ept.json")),u=new r.PointCloudEptGeometry(s,a),c=new r.PointCloudEptGeometryNode(u),u.root=c,u.root.load(),n(u);case 12:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),t}()},"./source/loaders/GreyhoundBinaryLoader.js":function(t,e,n){"use strict";n.r(e),n.d(e,"GreyhoundBinaryLoader",(function(){return u}));var r=n("./source/PointAttributes.js"),i=n("./source/utils/VersionUtils.js"),o=n("./source/utils/WorkerManager.js"),a=n("./source/Global.js"),s=n("./source/XHRFactory.js"),u=function(){function t(e,n,r){p(this,t),this.version="string"===typeof e?new i.VersionUtils(e):e,this.boundingBox=n,this.scale=r}return m(t,[{key:"load",value:function(t){if(!t.loaded){var e=this,n=t.getURL(),r=s.XHRFactory.createXMLHttpRequest();r.overrideMimeType("text/plain"),r.open("GET",n,!0),r.responseType="arraybuffer",r.overrideMimeType("text/plain; charset=x-user-defined"),r.onload=function(){try{e.parse(t,r.response)}catch(n){console.error("Potree: Exception thrown parsing points.",n),a.Global.numNodesLoading--}},r.onerror=function(t){a.Global.numNodesLoading--,console.error("Potree: Failed to load file.",r,n)},r.send(null)}}},{key:"parse",value:function(t,e){var n=new DataView(e,e.byteLength-4,4).getUint32(0,!0),i=t.pcoGeometry.pointAttributes;t.numPoints=n;var s=t.boundingBox,u=new THREE.Vector3,l=t.pcoGeometry.boundingBox.getCenter(u).sub(t.boundingBox.min),d={buffer:e,pointAttributes:i,version:this.version.version,schema:t.pcoGeometry.schema,min:[s.min.x,s.min.y,s.min.z],max:[s.max.x,s.max.y,s.max.z],offset:l.toArray(),scale:this.scale,normalize:t.pcoGeometry.normalize};a.Global.workerPool.runTask(o.WorkerManager.GREYHOUND,(function(e){var n=e.data,i=n.attributeBuffers,o=new THREE.Box3((new THREE.Vector3).fromArray(n.tightBoundingBox.min),(new THREE.Vector3).fromArray(n.tightBoundingBox.max)),s=new THREE.BufferGeometry;for(var u in i){var l=i[u].buffer;if(parseInt(u)===r.PointAttributeNames.POSITION_CARTESIAN)s.setAttribute("position",new THREE.BufferAttribute(new Float32Array(l),3));else if(parseInt(u)===r.PointAttributeNames.COLOR_PACKED)s.setAttribute("color",new THREE.BufferAttribute(new Uint8Array(l),4,!0));else if(parseInt(u)===r.PointAttributeNames.INTENSITY)s.setAttribute("intensity",new THREE.BufferAttribute(new Float32Array(l),1));else if(parseInt(u)===r.PointAttributeNames.CLASSIFICATION)s.setAttribute("classification",new THREE.BufferAttribute(new Uint8Array(l),1));else if(parseInt(u)===r.PointAttributeNames.NORMAL_SPHEREMAPPED)s.setAttribute("normal",new THREE.BufferAttribute(new Float32Array(l),3));else if(parseInt(u)===r.PointAttributeNames.NORMAL_OCT16)s.setAttribute("normal",new THREE.BufferAttribute(new Float32Array(l),3));else if(parseInt(u)===r.PointAttributeNames.NORMAL)s.setAttribute("normal",new THREE.BufferAttribute(new Float32Array(l),3));else if(parseInt(u)===r.PointAttributeNames.INDICES){(d=new THREE.BufferAttribute(new Uint8Array(l),4)).normalized=!0,s.setAttribute("indices",d)}else if(parseInt(u)===r.PointAttributeNames.SPACING){var d=new THREE.BufferAttribute(new Float32Array(l),1);s.setAttribute("spacing",d)}}o.max.sub(o.min),o.min.set(0,0,0),t.numPoints=n.numPoints,t.geometry=s,t.mean=c(THREE.Vector3,h(n.mean)),t.tightBoundingBox=o,t.loaded=!0,t.loading=!1,a.Global.numNodesLoading--}),d,[d.buffer])}}]),t}()},"./source/loaders/GreyhoundLoader.js":function(t,e,n){"use strict";n.r(e),n.d(e,"GreyhoundLoader",(function(){return u}));var r=n("./source/PointAttributes.js"),i=n("./source/pointcloud/geometries/PointCloudGreyhoundGeometry.js"),o=n("./source/loaders/GreyhoundBinaryLoader.js"),a=n("./source/utils/VersionUtils.js"),s=n("./source/loaders/GreyhoundUtils.js");function u(){}u.loadInfoJSON=function(t,e){},u.load=function(t,e){try{var n=t.split("greyhound://")[1];1===n.split("http://").length&&1===n.split("https://").length&&(n="http://"+n),s.GreyhoundUtils.fetch(n+"info",(function(t,u){if(t)throw new Error(t);var c=JSON.parse(u),l=new a.VersionUtils("1.4"),d=c.bounds,f=c.scale||.01;Array.isArray(f)&&(f=Math.min(f[0],f[1],f[2])),s.GreyhoundUtils.getQueryParam("scale")&&(f=parseFloat(s.GreyhoundUtils.getQueryParam("scale")));var h=Math.max(8,c.baseDepth),p=["POSITION_CARTESIAN"],m=!1,v=!1,g=!1;c.schema.forEach((function(t){"Intensity"===t.name&&p.push("INTENSITY"),"Classification"===t.name&&p.push("CLASSIFICATION"),"Red"===t.name?m=!0:"Green"===t.name?v=!0:"Blue"===t.name&&(g=!0)})),m&&v&&g&&p.push("COLOR_PACKED");var y=new i.PointCloudGreyhoundGeometry;y.serverURL=n,y.spacing=(d[3]-d[0])/Math.pow(2,h),y.baseDepth=h,y.hierarchyStepSize=5,y.schema=s.GreyhoundUtils.createSchema(p);var b=s.GreyhoundUtils.pointSizeFrom(y.schema);y.pointAttributes=new r.PointAttributes(p),y.pointAttributes.byteSize=b;var x=new THREE.Box3((new THREE.Vector3).fromArray(d,0),(new THREE.Vector3).fromArray(d,3)),_=x.min.clone();x.max.sub(x.min),x.min.set(0,0,0),y.projection=c.srs,y.boundingBox=x,y.boundingSphere=x.getBoundingSphere(new THREE.Sphere),y.scale=f,y.offset=_,y.loader=new o.GreyhoundBinaryLoader(l,x,y.scale);var w={},T=new i.PointCloudGreyhoundGeometryNode("r",y,x,f,_);T.level=0,T.hasChildren=!0,T.numPoints=c.numPoints,T.spacing=y.spacing,y.root=T,y.root.load(),w.r=T,y.nodes=w,s.GreyhoundUtils.getNormalization(n,c.baseDepth,(function(t,n){n.color&&(y.normalize.color=!0),n.intensity&&(y.normalize.intensity=!0),e(y)}))}))}catch(u){console.log("Potree: Loading failed.",t,u),e()}},u.loadPointAttributes=function(t){for(var e=t.pointAttributes,n=new r.PointAttributes,i=0;i<e.length;i++){var o=r.PointAttribute[e[i]];n.add(o)}return n},u.createChildAABB=function(t,e){var n=t.min,r=t.max,i=(new THREE.Vector3).copy(r).sub(n).multiplyScalar(.5),o=new THREE.Vector3(i.x,0,0),a=new THREE.Vector3(0,i.y,0),s=new THREE.Vector3(0,0,i.z),u=n,c=(new THREE.Vector3).add(n).add(i);return 1===e?(n=(new THREE.Vector3).copy(u).add(s),r=(new THREE.Vector3).copy(c).add(s)):3===e?(n=(new THREE.Vector3).copy(u).add(s).add(a),r=(new THREE.Vector3).copy(c).add(s).add(a)):0===e?(n=u,r=c):2===e?(n=(new THREE.Vector3).copy(u).add(a),r=(new THREE.Vector3).copy(c).add(a)):5===e?(n=(new THREE.Vector3).copy(u).add(s).add(o),r=(new THREE.Vector3).copy(c).add(s).add(o)):7===e?(n=(new THREE.Vector3).copy(u).add(i),r=(new THREE.Vector3).copy(c).add(i)):4===e?(n=(new THREE.Vector3).copy(u).add(o),r=(new THREE.Vector3).copy(c).add(o)):6===e&&(n=(new THREE.Vector3).copy(u).add(o).add(a),r=(new THREE.Vector3).copy(c).add(o).add(a)),new THREE.Box3(n,r)}},"./source/loaders/GreyhoundUtils.js":function(t,e,n){"use strict";n.r(e),n.d(e,"GreyhoundUtils",(function(){return i}));var r=n("./source/XHRFactory.js"),i=function(){function t(){p(this,t)}return m(t,null,[{key:"getQueryParam",value:function(t){t=t.replace(/[[\]]/g,"\\$&");var e=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(window.location.href);return e?e[2]?decodeURIComponent(e[2].replace(/\+/g," ")):"":null}},{key:"createSchema",value:function(t){var e=[{name:"X",size:4,type:"signed"},{name:"Y",size:4,type:"signed"},{name:"Z",size:4,type:"signed"}];return t.forEach((function(t){"COLOR_PACKED"===t?(e.push({name:"Red",size:2,type:"unsigned"}),e.push({name:"Green",size:2,type:"unsigned"}),e.push({name:"Blue",size:2,type:"unsigned"})):"INTENSITY"===t?e.push({name:"Intensity",size:2,type:"unsigned"}):"CLASSIFICATION"===t&&e.push({name:"Classification",size:1,type:"unsigned"})})),e}},{key:"fetch",value:function(t,e){var n=r.XHRFactory.createXMLHttpRequest();n.overrideMimeType("text/plain"),n.open("GET",t,!0),n.onreadystatechange=function(){4===n.readyState&&(200===n.status||0===n.status?e(null,n.responseText):e(n.responseText))},n.send(null)}},{key:"fetchBinary",value:function(t,e){var n=r.XHRFactory.createXMLHttpRequest();n.overrideMimeType("text/plain"),n.open("GET",t,!0),n.responseType="arraybuffer",n.onreadystatechange=function(){4===n.readyState&&(200===n.status||0===n.status?e(null,n.response):e(n.responseText))},n.send(null)}},{key:"pointSizeFrom",value:function(t){return t.reduce((function(t,e){return t+e.size}),0)}},{key:"getNormalization",value:function(e,n,r){var i=[{name:"X",size:4,type:"floating"},{name:"Y",size:4,type:"floating"},{name:"Z",size:4,type:"floating"},{name:"Red",size:2,type:"unsigned"},{name:"Green",size:2,type:"unsigned"},{name:"Blue",size:2,type:"unsigned"},{name:"Intensity",size:2,type:"unsigned"}],o=e+"read?depth="+n+"&schema="+JSON.stringify(i);t.fetchBinary(o,(function(e,n){if(e)throw new Error(e);for(var o=new DataView(n),a=n.byteLength-4,s=t.pointSizeFrom(i),u=!1,c=!1,l=0;l<a&&((o.getUint16(l+12,!0)>255||o.getUint16(l+14,!0)>255||o.getUint16(l+16,!0)>255)&&(u=!0),o.getUint16(l+18,!0)>255&&(c=!0),!u||!c);l+=s);r(null,{color:u,intensity:c})}))}}]),t}()},"./source/loaders/LASLAZLoader.js":function(t,e,n){"use strict";n.r(e),n.d(e,"LASLAZLoader",(function(){return l}));var r=n("three"),i=n("./source/utils/VersionUtils.js"),o=n("./source/utils/WorkerManager.js"),a=n("./source/loaders/LASLoader.js"),s=n("./source/Global.js"),u=n("./source/XHRFactory.js"),l=function(){function t(e){p(this,t),this.version="string"===typeof e?new i.VersionUtils(e):e}return m(t,[{key:"load",value:function(t){if(!t.loaded){var e=t.pcoGeometry.pointAttributes,n=t.getURL();this.version.equalOrHigher("1.4")&&(n+="."+e.toLowerCase());var r=this,i=u.XHRFactory.createXMLHttpRequest();i.open("GET",n,!0),i.responseType="arraybuffer",i.overrideMimeType("text/plain; charset=x-user-defined"),i.onload=function(){if(i.response instanceof ArrayBuffer)try{r.parse(t,i.response)}catch(e){console.error("Potree: Exception thrown parsing points.",e),s.Global.numNodesLoading--}else s.Global.numNodesLoading--,console.log("Potree: LASLAZLoader xhr response is not a ArrayBuffer.")},i.onerror=function(){s.Global.numNodesLoading--,console.log("Potree: LASLAZLoader failed to load file, "+i.status+", file: "+n)},i.send(null)}}},{key:"parse",value:function(t,e){var n=new a.LASFile(e),r=new d(t);n.open().then((function(t){return n.isOpen=!0,n})).catch((function(t){console.log("Potree: Failed to open file.")})).then((function(t){return t.getHeader().then((function(e){return[t,e]}))})).then((function(t){var e=t[0],n=t[1],i=0;n.pointsCount;return function t(){return e.readData(1e6,0,1).then((function(o){return r.push(new a.LASDecoder(o.buffer,n.pointsFormatId,n.pointsStructSize,o.count,n.scale,n.offset,n.mins,n.maxs)),i+=o.count,o.hasMoreData?t():(n.totalRead=i,n.versionAsString=e.versionAsString,n.isCompressed=e.isCompressed,[e,n,r])}))}()})).then((function(t){var e=t[0];return e.close().then((function(){return e.isOpen=!1,t.slice(1)})).catch((function(t){if(e.isOpen)return e.close().then((function(){throw e.isOpen=!1,t}));throw t}))}))}},{key:"handle",value:function(t,e){}}]),t}(),d=function(){function t(e){p(this,t),this.node=e}return m(t,[{key:"push",value:function(t){var e=this,n={buffer:t.arrayb,numPoints:t.pointsCount,pointSize:t.pointSize,pointFormatID:2,scale:t.scale,offset:t.offset,mins:t.mins,maxs:t.maxs},i=s.Global.workerPool.getWorker(o.WorkerManager.LAS_DECODER);i.onmessage=function(n){var a=new r.BufferGeometry,u=t.pointsCount,l=new Float32Array(n.data.position),d=new Uint8Array(n.data.color),f=new Float32Array(n.data.intensity),p=new Uint8Array(n.data.classification),m=new Uint8Array(n.data.returnNumber),v=new Uint8Array(n.data.numberOfReturns),g=new Uint16Array(n.data.pointSourceID),y=new Uint8Array(n.data.indices);a.setAttribute("position",new r.BufferAttribute(l,3)),a.setAttribute("color",new r.BufferAttribute(d,4,!0)),a.setAttribute("intensity",new r.BufferAttribute(f,1)),a.setAttribute("classification",new r.BufferAttribute(p,1)),a.setAttribute("returnNumber",new r.BufferAttribute(m,1)),a.setAttribute("numberOfReturns",new r.BufferAttribute(v,1)),a.setAttribute("pointSourceID",new r.BufferAttribute(g,1)),a.setAttribute("indices",new r.BufferAttribute(y,4)),a.attributes.indices.normalized=!0;var b=new r.Box3((new r.Vector3).fromArray(n.data.tightBoundingBox.min),(new r.Vector3).fromArray(n.data.tightBoundingBox.max));a.boundingBox=e.node.boundingBox,e.node.tightBoundingBox=b,e.node.geometry=a,e.node.numPoints=u,e.node.loaded=!0,e.node.loading=!1,s.Global.numNodesLoading--,e.node.mean=c(r.Vector3,h(n.data.mean)),s.Global.workerPool.returnWorker(o.WorkerManager.LAS_DECODER,i)},i.postMessage(n,[n.buffer])}}]),t}()},"./source/loaders/LASLoader.js":function(t,e,n){"use strict";n.r(e),n.d(e,"LASLoader",(function(){return s})),n.d(e,"LAZLoader",(function(){return u})),n.d(e,"LASFile",(function(){return c})),n.d(e,"LASDecoder",(function(){return l}));var r=n("./source/utils/WorkerManager.js"),i=n("./source/Global.js"),o=[function(t){return{position:[t.getInt32(0,!0),t.getInt32(4,!0),t.getInt32(8,!0)],intensity:t.getUint16(12,!0),classification:t.getUint8(16,!0)}},function(t){return{position:[t.getInt32(0,!0),t.getInt32(4,!0),t.getInt32(8,!0)],intensity:t.getUint16(12,!0),classification:t.getUint8(16,!0)}},function(t){return{position:[t.getInt32(0,!0),t.getInt32(4,!0),t.getInt32(8,!0)],intensity:t.getUint16(12,!0),classification:t.getUint8(16,!0),color:[t.getUint16(20,!0),t.getUint16(22,!0),t.getUint16(24,!0)]}},function(t){return{position:[t.getInt32(0,!0),t.getInt32(4,!0),t.getInt32(8,!0)],intensity:t.getUint16(12,!0),classification:t.getUint8(16,!0),color:[t.getUint16(28,!0),t.getUint16(30,!0),t.getUint16(32,!0)]}}];function a(t,e,n,r){r=void 0===r||0===r?1:r;var i=new e(t.slice(n,n+e.BYTES_PER_ELEMENT*r));if(void 0===r||1===r)return i[0];for(var o=[],a=0;a<r;a++)o.push(i[a]);return o}function s(t){this.arraybuffer=t}function u(t){var e=this;this.arraybuffer=t,this.nextCB=null,this.dorr=function(t,n){e.nextCB=n,i.Global.workerPool.runTask(r.WorkerManager.LAS_LAZ,(function(t){null!==e.nextCB&&(e.nextCB(t.data),e.nextCB=null)}),t)}}function c(t){if(this.arraybuffer=t,this.determineVersion(),this.version>12)throw new Error("Only file versions <= 1.2 are supported at this time");if(this.determineFormat(),void 0===o[this.formatId])throw new Error("The point format ID is not supported");this.loader=this.isCompressed?new u(this.arraybuffer):new s(this.arraybuffer)}function l(t,e,n,r,i,a,s,u){this.arrayb=t,this.decoder=o[e],this.pointsCount=r,this.pointSize=n,this.scale=i,this.offset=a,this.mins=s,this.maxs=u}s.prototype.open=function(){return this.readOffset=0,new Promise((function(t,e){setTimeout(t,0)}))},s.prototype.getHeader=function(){var t=this;return new Promise((function(e,n){setTimeout((function(){t.header=function(t){var e={};e.pointsOffset=a(t,Uint32Array,96),e.pointsFormatId=a(t,Uint8Array,104),e.pointsStructSize=a(t,Uint16Array,105),e.pointsCount=a(t,Uint32Array,107);var n=131;e.scale=a(t,Float64Array,n,3),n+=24,e.offset=a(t,Float64Array,n,3),n+=24;var r=a(t,Float64Array,n,6);return n+=48,e.maxs=[r[0],r[2],r[4]],e.mins=[r[1],r[3],r[5]],e}(t.arraybuffer),e(t.header)}),0)}))},s.prototype.readData=function(t,e,n){var r=this;return new Promise((function(e,i){setTimeout((function(){if(!r.header)return i(new Error("Cannot start reading data till a header request is issued"));var o;if(n<=1){t=Math.min(t,r.header.pointsCount-r.readOffset);var a=(o=r.header.pointsOffset+r.readOffset*r.header.pointsStructSize)+t*r.header.pointsStructSize;e({buffer:r.arraybuffer.slice(o,a),count:t,hasMoreData:r.readOffset+t<r.header.pointsCount}),r.readOffset+=t}else{for(var s=Math.min(t*n,r.header.pointsCount-r.readOffset),u=Math.ceil(s/n),c=0,l=new Uint8Array(u*r.header.pointsStructSize),d=0;d<s;d++){if(d%n===0){o=r.header.pointsOffset+r.readOffset*r.header.pointsStructSize;var f=new Uint8Array(r.arraybuffer,o,r.header.pointsStructSize);l.set(f,c*r.header.pointsStructSize),c++}r.readOffset++}e({buffer:l.buffer,count:c,hasMoreData:r.readOffset<r.header.pointsCount})}}),0)}))},s.prototype.close=function(){var t=this;return new Promise((function(e,n){t.arraybuffer=null,setTimeout(e,0)}))},u.prototype.open=function(){var t=this;return new Promise((function(e,n){t.dorr({type:"open",arraybuffer:t.arraybuffer},(function(t){if(1!==t.status)return n(new Error("Failed to open file"));e(!0)}))}))},u.prototype.getHeader=function(){var t=this;return new Promise((function(e,n){t.dorr({type:"header"},(function(t){if(1!==t.status)return n(new Error("Failed to get header"));e(t.header)}))}))},u.prototype.readData=function(t,e,n){var r=this;return new Promise((function(i,o){r.dorr({type:"read",count:t,offset:e,skip:n},(function(t){if(1!==t.status)return o(new Error("Failed to read data"));i({buffer:t.buffer,count:t.count,hasMoreData:t.hasMoreData})}))}))},u.prototype.close=function(){var t=this;return new Promise((function(e,n){t.dorr({type:"close"},(function(t){if(1!==t.status)return n(new Error("Failed to close file"));e(!0)}))}))},c.prototype.determineFormat=function(){var t=a(this.arraybuffer,Uint8Array,104),e=(128&t)>>7,n=(64&t)>>6;if(1===e&&1===n)throw new Error("Old style compression not supported");this.formatId=63&t,this.isCompressed=1===e||1===n},c.prototype.determineVersion=function(){var t=new Int8Array(this.arraybuffer,24,2);this.version=10*t[0]+t[1],this.versionAsString=t[0]+"."+t[1]},c.prototype.open=function(){return this.loader.open()},c.prototype.getHeader=function(){return this.loader.getHeader()},c.prototype.readData=function(t,e,n){return this.loader.readData(t,e,n)},c.prototype.close=function(){return this.loader.close()},l.prototype.getPoint=function(t){if(t<0||t>=this.pointsCount)throw new Error("Point index out of range");return this.decoder(new DataView(this.arrayb,t*this.pointSize,this.pointSize))}},"./source/loaders/POCLoader.js":function(t,e,n){"use strict";n.r(e),n.d(e,"POCLoader",(function(){return d}));var r=n("three"),i=n("./source/loaders/BinaryLoader.js"),o=n("./source/loaders/LASLAZLoader.js"),a=n("./source/PointAttributes.js"),s=n("./source/pointcloud/geometries/PointCloudOctreeGeometry.js"),u=n("./source/utils/VersionUtils.js"),c=n("./source/Global.js"),l=n("./source/XHRFactory.js"),d=function(){function t(){p(this,t)}return m(t,null,[{key:"load",value:function(e,n){var d=new s.PointCloudOctreeGeometry;d.url=e;var f=l.XHRFactory.createXMLHttpRequest();f.overrideMimeType("text/plain"),f.open("GET",e,!0),f.onload=function(){var c=JSON.parse(f.responseText),l=new u.VersionUtils(c.version);0===c.octreeDir.indexOf("http")?d.octreeDir=c.octreeDir:d.octreeDir=e+"/../"+c.octreeDir,d.spacing=c.spacing,d.hierarchyStepSize=c.hierarchyStepSize,d.pointAttributes=c.pointAttributes;var h=new r.Vector3(c.boundingBox.lx,c.boundingBox.ly,c.boundingBox.lz),p=new r.Vector3(c.boundingBox.ux,c.boundingBox.uy,c.boundingBox.uz),m=(M=new r.Box3(h,p)).clone();c.tightBoundingBox&&(m.min.copy(new r.Vector3(c.tightBoundingBox.lx,c.tightBoundingBox.ly,c.tightBoundingBox.lz)),m.max.copy(new r.Vector3(c.tightBoundingBox.ux,c.tightBoundingBox.uy,c.tightBoundingBox.uz)));var v=h.clone();M.min.sub(v),M.max.sub(v),m.min.sub(v),m.max.sub(v),d.projection=c.projection,d.boundingBox=M,d.tightBoundingBox=m,d.boundingSphere=M.getBoundingSphere(new r.Sphere),d.tightBoundingSphere=m.getBoundingSphere(new r.Sphere),d.offset=v,"LAS"===c.pointAttributes||"LAZ"===c.pointAttributes?d.loader=new o.LASLAZLoader(c.version):(d.loader=new i.BinaryLoader(c.version,M,c.scale),d.pointAttributes=new a.PointAttributes(d.pointAttributes));var g={},y="r",b=new s.PointCloudOctreeGeometryNode(y,d,M);if(b.level=0,b.hasChildren=!0,b.spacing=d.spacing,b.numPoints=l.upTo("1.5")?c.hierarchy[0][1]:0,d.root=b,d.root.load(),g[y]=b,l.upTo("1.4"))for(var x=1;x<c.hierarchy.length;x++){y=c.hierarchy[x][0];var _=c.hierarchy[x][1],w=parseInt(y.charAt(y.length-1)),T=g[y.substring(0,y.length-1)],S=y.length-1,M=t.createChildAABB(T.boundingBox,w),E=new s.PointCloudOctreeGeometryNode(y,d,M);E.level=S,E.numPoints=_,E.spacing=d.spacing/Math.pow(2,S),T.addChild(E),g[y]=E}d.nodes=g,n(d)},f.onerror=function(t){c.Global.numNodesLoading--,console.log("Potree: loading file failed.",e,t),n()},f.send(null)}},{key:"loadPointAttributes",value:function(t){for(var e=t.pointAttributes,n=new a.PointAttributes,r=0;r<e.length;r++)n.add(a.PointAttribute[e[r]]);return n}},{key:"createChildAABB",value:function(t,e){var n=t.min.clone(),i=t.max.clone(),o=(new r.Vector3).subVectors(i,n);return(1&e)>0?n.z+=o.z/2:i.z-=o.z/2,(2&e)>0?n.y+=o.y/2:i.y-=o.y/2,(4&e)>0?n.x+=o.x/2:i.x-=o.x/2,new r.Box3(n,i)}}]),t}()},"./source/loaders/ept/EptBinaryLoader.js":function(t,e,n){"use strict";n.r(e),n.d(e,"EptBinaryLoader",(function(){return s}));var r=n("three"),i=n("./source/Global.js"),o=n("./source/utils/WorkerManager.js"),a=n("./source/XHRFactory.js"),s=function(){function t(){p(this,t)}return m(t,[{key:"load",value:function(t){var e=this;if(!t.loaded){var n=t.url()+".bin",r=a.XHRFactory.createXMLHttpRequest();r.open("GET",n,!0),r.responseType="arraybuffer",r.overrideMimeType("text/plain; charset=x-user-defined"),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var i=r.response;e.parse(t,i)}else console.log("Failed "+n+": "+r.status)};try{r.send(null)}catch(i){console.log("Failed request: "+i)}}}},{key:"parse",value:function(t,e){var n=i.Global.workerPool.getWorker(o.WorkerManager.EPT_BINARY_DECODER);n.onmessage=function(e){var a=new r.BufferGeometry,s=e.data.numPoints,u=new Float32Array(e.data.position);a.setAttribute("position",new r.BufferAttribute(u,3));var l=new Uint8Array(e.data.indices);if(a.setAttribute("indices",new r.BufferAttribute(l,4)),e.data.color){var d=new Uint8Array(e.data.color);a.setAttribute("color",new r.BufferAttribute(d,4,!0))}if(e.data.intensity){var f=new Float32Array(e.data.intensity);a.setAttribute("intensity",new r.BufferAttribute(f,1))}if(e.data.classification){var p=new Uint8Array(e.data.classification);a.setAttribute("classification",new r.BufferAttribute(p,1))}if(e.data.returnNumber){var m=new Uint8Array(e.data.returnNumber);a.setAttribute("returnNumber",new r.BufferAttribute(m,1))}if(e.data.numberOfReturns){var v=new Uint8Array(e.data.numberOfReturns);a.setAttribute("numberOfReturns",new r.BufferAttribute(v,1))}if(e.data.pointSourceId){var g=new Uint16Array(e.data.pointSourceId);a.setAttribute("pointSourceID",new r.BufferAttribute(g,1))}a.attributes.indices.normalized=!0;var y=new r.Box3((new r.Vector3).fromArray(e.data.tightBoundingBox.min),(new r.Vector3).fromArray(e.data.tightBoundingBox.max));t.doneLoading(a,y,s,c(r.Vector3,h(e.data.mean))),i.Global.workerPool.returnWorker(o.WorkerManager.EPT_BINARY_DECODER,n)};var a,s={buffer:e,schema:t.ept.schema,scale:t.ept.eptScale,offset:t.ept.eptOffset,mins:(a=t.key.b.min,[a.x,a.y,a.z])};n.postMessage(s,[s.buffer])}}]),t}()},"./source/loaders/ept/EptLaszipLoader.js":function(t,e,n){"use strict";n.r(e),n.d(e,"EptLaszipLoader",(function(){return u})),n.d(e,"EptLazBatcher",(function(){return l}));var r=n("three"),i=n("./source/Global.js"),o=n("./source/loaders/LASLoader.js"),a=n("./source/utils/WorkerManager.js"),s=n("./source/XHRFactory.js"),u=function(){function t(){p(this,t)}return m(t,[{key:"load",value:function(t){var e=this;if(!t.loaded){var n=t.url()+".laz",r=s.XHRFactory.createXMLHttpRequest();r.open("GET",n,!0),r.responseType="arraybuffer",r.overrideMimeType("text/plain; charset=x-user-defined"),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var i=r.response;e.parse(t,i)}else console.log("Failed "+n+": "+r.status)},r.send(null)}}},{key:"parse",value:function(t,e){var n=new o.LASFile(e),r=new l(t);n.open().then((function(){return n.isOpen=!0,n.getHeader()})).then((function(e){var i=0,a=(e.pointsCount,function(t){return[t.x,t.y,t.z]}),s=a(t.key.b.min),u=a(t.key.b.max);return function t(){return n.readData(1e6,0,1).then((function(a){var c=new o.LASDecoder(a.buffer,e.pointsFormatId,e.pointsStructSize,a.count,e.scale,e.offset,s,u);return c.extraBytes=e.extraBytes,c.pointsFormatId=e.pointsFormatId,r.push(c),i+=a.count,a.hasMoreData?t():(e.totalRead=i,e.versionAsString=n.versionAsString,e.isCompressed=n.isCompressed,null)}))}()})).then((function(){return n.close()})).then((function(){return n.isOpen=!1})).catch((function(t){if(console.log("Error reading LAZ:",t),!n.isOpen)throw t;n.close().then((function(){throw n.isOpen=!1,t}))}))}}]),t}(),l=function(){function t(e){p(this,t),this.node=e}return m(t,[{key:"push",value:function(t){var e=this,n=i.Global.workerPool.getWorker(a.WorkerManager.EPT_LAS_ZIP_DECODER);n.onmessage=function(o){var s=new r.BufferGeometry,u=t.pointsCount,l=new Float32Array(o.data.position),d=new Uint8Array(o.data.color),f=new Float32Array(o.data.intensity),p=new Uint8Array(o.data.classification),m=new Uint8Array(o.data.returnNumber),v=new Uint8Array(o.data.numberOfReturns),g=new Uint16Array(o.data.pointSourceID),y=new Uint8Array(o.data.indices);s.setAttribute("position",new r.BufferAttribute(l,3)),s.setAttribute("color",new r.BufferAttribute(d,4,!0)),s.setAttribute("intensity",new r.BufferAttribute(f,1)),s.setAttribute("classification",new r.BufferAttribute(p,1)),s.setAttribute("returnNumber",new r.BufferAttribute(m,1)),s.setAttribute("numberOfReturns",new r.BufferAttribute(v,1)),s.setAttribute("pointSourceID",new r.BufferAttribute(g,1)),s.setAttribute("indices",new r.BufferAttribute(y,4)),s.attributes.indices.normalized=!0;var b=new r.Box3((new r.Vector3).fromArray(o.data.tightBoundingBox.min),(new r.Vector3).fromArray(o.data.tightBoundingBox.max));e.node.doneLoading(s,b,u,c(r.Vector3,h(o.data.mean))),i.Global.workerPool.returnWorker(a.WorkerManager.EPT_LAS_ZIP_DECODER,n)};var o={buffer:t.arrayb,numPoints:t.pointsCount,pointSize:t.pointSize,pointFormatID:t.pointsFormatId,scale:t.scale,offset:t.offset,mins:t.mins,maxs:t.maxs};n.postMessage(o,[o.buffer])}}]),t}()},"./source/objects/BasicGroup.js":function(t,e,n){"use strict";n.r(e),n.d(e,"BasicGroup",(function(){return c}));var r=n("three"),i=n("./source/utils/HelperUtils.js"),o=n("./source/Potree.js"),a=n("./source/pointcloud/PointCloudTree.js"),c=function(t){s(n,t);var e=u(n);function n(){var t;return p(this,n),(t=e.call(this,new r.Geometry,new r.MeshBasicMaterial({opacity:0,wireframe:!1,transparent:!0}))).rotation.set(-Math.PI/2,0,0),t.frustumCulled=!0,t.pointclouds=[],t.nodeSize=30,t.pointBudget=1e10,t.nodeLoadRate=2,t}return m(n,[{key:"raycast",value:function(t,e){}},{key:"setPointBudget",value:function(t){this.pointBudget=t}},{key:"onBeforeRender",value:function(t,e,n,r,i,a){for(var s=0;s<this.pointclouds.length;s++)this.pointclouds[s].minimumNodePixelSize=this.nodeSize;Object(o.updatePointClouds)(this.pointclouds,n,t)}},{key:"recalculateBoxGeometry",value:function(){var t=this.getBoundingBox(),e=t.getSize(new r.Vector3),n=t.getCenter(new r.Vector3),i=new r.Matrix4;i.makeTranslation(n.x,-n.z,n.y);var o=new r.BoxBufferGeometry(e.x,e.z,e.y);o.applyMatrix(i),this.geometry=o}},{key:"add",value:function(t){r.Object3D.prototype.add.call(this,t),t instanceof a.PointCloudTree&&(t.showBoundingBox=!1,t.generateDEM=!1,this.pointclouds.push(t),this.recalculateBoxGeometry())}},{key:"remove",value:function(t){if(r.Object3D.prototype.remove.call(this,t),t instanceof a.PointCloudTree){var e=this.pointclouds.indexOf(t);-1!==e&&(this.pointclouds.splice(e,1),this.recalculateBoxGeometry())}}},{key:"getBoundingBox",value:function(){var t=new r.Box3;this.updateMatrixWorld(!0);for(var e=0;e<this.pointclouds.length;e++){var n=this.pointclouds[e];n.updateMatrixWorld(!0);var o=n.pcoGeometry.tightBoundingBox?n.pcoGeometry.tightBoundingBox:n.boundingBox,a=i.HelperUtils.computeTransformedBoundingBox(o,n.matrixWorld);t.union(a)}return t}},{key:"estimateHeightAt",value:function(t){var e,n=null,i=1/0,o=f(this.pointclouds);try{for(o.s();!(e=o.n()).done;){var a=e.value;if(void 0!==a.root.geometryNode){var s=null,u=1/0,c=t.clone().sub(a.position);c.z=0;for(var l=new r.Ray(c,new r.Vector3(0,0,1)),d=[a.root];d.length>0;){var h=d.pop(),p=h.getBoundingBox();if(l.intersectBox(p)){var m=h.geometryNode.mean.z+a.position.z+h.geometryNode.boundingBox.min.z;h.geometryNode.spacing<=u&&(s=m,u=h.geometryNode.spacing);for(var v=0,g=Object.keys(h.children);v<g.length;v++){var y=g[v];h.children[y].geometryNode&&d.push(h.children[y])}}}(null===n||u<i)&&(n=s,i=u)}}}catch(b){o.e(b)}finally{o.f()}return n}}]),n}(r.Mesh)},"./source/objects/Group.js":function(t,e,n){"use strict";n.r(e),n.d(e,"Group",(function(){return _}));var r=n("three"),i=n("./source/WebGLBuffer.js"),c=n("./source/objects/BasicGroup.js"),l=n("./source/pointcloud/PointCloudTree.js"),d=n("./source/pointcloud/PointCloudOctree.js"),v=n("./source/pointcloud/PointCloudArena4D.js"),g=n("./source/Potree.js"),y=n("./source/Global.js"),b=n("./source/Shader.js"),x=n("./source/WebGLTexture.js"),_=function(t){s(n,t);var e=u(n);function n(){var t;return p(this,n),(t=e.call(this)).buffers=new Map,t.shaders=new Map,t.textures=new Map,t.types=new Map,t}return m(n,[{key:"getExtensions",value:function(t){this.types.set(Float32Array,t.FLOAT),this.types.set(Uint8Array,t.UNSIGNED_BYTE),this.types.set(Uint16Array,t.UNSIGNED_SHORT);var e=t.getExtension("OES_vertex_array_object");t.createVertexArray=e.createVertexArrayOES.bind(e),t.bindVertexArray=e.bindVertexArrayOES.bind(e)}},{key:"onBeforeRender",value:function(t,e,r,i,s,u){o(a(n.prototype),"onBeforeRender",this).call(this,t,e,r,i,s,u);var c=t.getContext();void 0===c.bindVertexArray&&this.getExtensions(c);var l,d=this.fetchOctrees(),h=f(d.octrees);try{for(h.s();!(l=h.n()).done;){var p=l.value,m=p.visibleNodes;this.renderOctree(t,p,m,r)}}catch(v){h.e(v)}finally{h.f()}c.activeTexture(c.TEXTURE1),c.bindTexture(c.TEXTURE_2D,null),t.state.reset()}},{key:"createBuffer",value:function(t,e){var n=new i.WebGLBuffer;for(var r in n.vao=t.createVertexArray(),n.numElements=e.attributes.position.count,t.bindVertexArray(n.vao),e.attributes){var o=e.attributes[r],a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,o.array,t.STATIC_DRAW);var s=g.AttributeLocations[r],u=o.normalized,c=this.types.get(o.array.constructor);void 0!==c&&(t.vertexAttribPointer(s,o.itemSize,c,u,0,0),t.enableVertexAttribArray(s)),n.vbos.set(r,{handle:a,name:r,count:o.count,itemSize:o.itemSize,type:e.attributes.position.array.constructor,version:0})}return t.bindBuffer(t.ARRAY_BUFFER,null),t.bindVertexArray(null),n}},{key:"updateBuffer",value:function(t,e){var n=this.buffers.get(e);for(var r in t.bindVertexArray(n.vao),e.attributes){var i=e.attributes[r],o=g.AttributeLocations[r],a=i.normalized,s=this.types.get(i.array.constructor),u=null;n.vbos.has(r)?(u=n.vbos.get(r).handle,n.vbos.get(r).version=i.version):(u=t.createBuffer(),n.vbos.set(r,{handle:u,name:r,count:i.count,itemSize:i.itemSize,type:e.attributes.position.array.constructor,version:i.version})),t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,i.array,t.STATIC_DRAW),t.vertexAttribPointer(o,i.itemSize,s,a,0,0),t.enableVertexAttribArray(o)}t.bindBuffer(t.ARRAY_BUFFER,null),t.bindVertexArray(null)}},{key:"fetchOctrees",value:function(){for(var t=[],e=[this];e.length>0;){var n=e.pop();if(n instanceof l.PointCloudTree)t.push(n);else{var r=n.children.filter((function(t){return t.visible}));e.push.apply(e,h(r))}}return{octrees:t}}},{key:"renderNodes",value:function(t,e,n,i,o,a){var s,u=t.getContext(),c=e.material,l=o.matrixWorldInverse,p=new r.Matrix4,m=new Float32Array(16),g=f(n);try{for(g.s();!(s=g.n()).done;){var b=s.value;if(void 0===y.Global.debug.allowedNodes||y.Global.debug.allowedNodes.includes(b.name)){var x=b.sceneNode.matrixWorld;if(p.multiplyMatrices(l,x),i){var _=i.offsets.get(b);a.setUniform1f("uVNStart",_)}var w,T=b.getLevel();a.setUniform("uDebug",!0===b.debug),b instanceof d.PointCloudOctreeNode?w=0===Object.keys(b.children).length:b instanceof v.PointCloudArena4DNode&&(w=b.geometryNode.isLeaf),a.setUniform("uIsLeafNode",w);var S=a.uniformLocations.modelMatrix;S&&(m.set(x.elements),u.uniformMatrix4fv(S,!1,m));var M=a.uniformLocations.modelViewMatrix;if(m.set(p.elements),u.uniformMatrix4fv(M,!1,m),c.clipPolygons&&c.clipPolygons.length>0){var E,R,I=[],B=[],A=f(c.clipPolygons);try{for(A.s();!(R=A.n()).done;){l=(O=R.value).viewMatrix;var C=O.projMatrix.clone().multiply(l).multiply(x);I.push(O.markers.length),B.push(C)}}catch(z){A.e(z)}finally{A.f()}for(var F=(E=[]).concat.apply(E,h(B.map((function(t){return t.elements})))),P=new Array(24*c.clipPolygons.length),N=0;N<c.clipPolygons.length;N++)for(var O=c.clipPolygons[N],U=0;U<O.markers.length;U++)P[24*N+(3*U+0)]=O.markers[U].position.x,P[24*N+(3*U+1)]=O.markers[U].position.y,P[24*N+(3*U+2)]=O.markers[U].position.z;var L=a.uniformLocations["uClipPolygonVCount[0]"];u.uniform1iv(L,I);var G=a.uniformLocations["uClipPolygonWVP[0]"];u.uniformMatrix4fv(G,!1,F);var D=a.uniformLocations["uClipPolygonVertices[0]"];u.uniform3fv(D,P)}a.setUniform1f("uLevel",T),a.setUniform1f("uNodeSpacing",b.geometryNode.estimatedSpacing),a.setUniform1f("uPCIndex",N);var V=b.geometryNode.geometry,H=null;if(this.buffers.has(V))for(var k in H=this.buffers.get(V),V.attributes){V.attributes[k].version>H.vbos.get(k).version&&this.updateBuffer(u,V)}else H=this.createBuffer(u,V),this.buffers.set(V,H);u.bindVertexArray(H.vao),u.drawArrays(u.POINTS,0,H.numElements)}}}catch(z){g.e(z)}finally{g.f()}u.bindVertexArray(null)}},{key:"renderOctree",value:function(t,e,n,i){var o=t.getContext(),a=e.material,s=i.matrixWorldInverse,u=i.matrixWorld,c=i.projectionMatrix,l=(new r.Matrix4).getInverse(c),d=(new r.Matrix4,null),f=0;if(a.pointSizeType===g.PointSizeType.ADAPTIVE||a.pointColorType===g.PointColorType.LOD){d=e.computeVisibilityTextureData(n,i);var p=a.visibleNodesTexture;p.image.data.set(d.data),p.needsUpdate=!0}var m=null;this.shaders.has(a)?m=this.shaders.get(a):(m=new b.Shader(o,"pointcloud",a.vertexShader,a.fragmentShader),this.shaders.set(a,m));var v=a.snapEnabled?a.numSnapshots:0,y=a.clipBoxes&&a.clipBoxes.length?a.clipBoxes.length:0,_=a.clipPolygons&&a.clipPolygons.length?a.clipPolygons.length:0,w=["#define num_shadowmaps"+[].length,"#define num_snapshots"+v,"#define num_clipboxes"+y,"#define num_clipspheres0","#define num_clippolygons"+_].join("\n"),T=w+"\n"+a.vertexShader,S=w+"\n"+a.fragmentShader;m.update(T,S),a.needsUpdate=!1;for(var M=0,E=Object.keys(a.uniforms);M<E.length;M++){var R=E[M],I=a.uniforms[R];if("t"==I.type){if(!(j=I.value))continue;if(!this.textures.has(j)){var B=new x.WebGLTexture(o,j);this.textures.set(j,B)}this.textures.get(j).update()}}o.useProgram(m.program),a.opacity<1?(o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE),o.depthMask(!1),o.disable(o.DEPTH_TEST)):(o.disable(o.BLEND),o.depthMask(!0),o.enable(o.DEPTH_TEST)),m.setUniformMatrix4("projectionMatrix",c),m.setUniformMatrix4("viewMatrix",s),m.setUniformMatrix4("uViewInv",u),m.setUniformMatrix4("uProjInv",l);var A=a.screenWidth,C=a.screenHeight;if(m.setUniform1f("uScreenWidth",A),m.setUniform1f("uScreenHeight",C),m.setUniform1f("fov",Math.PI*i.fov/180),m.setUniform1f("near",i.near),m.setUniform1f("far",i.far),t.capabilities.logarithmicDepthBuffer&&m.setUniform("logDepthBufFC",2/(Math.log(i.far+1)/Math.LN2)),i instanceof r.OrthographicCamera?(m.setUniform("uUseOrthographicCamera",!0),m.setUniform("uOrthoWidth",i.right-i.left),m.setUniform("uOrthoHeight",i.top-i.bottom)):m.setUniform("uUseOrthographicCamera",!1),a.clipBoxes.length+a.clipPolygons.length===0?m.setUniform1i("clipTask",g.ClipTask.NONE):m.setUniform1i("clipTask",a.clipTask),m.setUniform1i("clipMethod",a.clipMethod),a.clipBoxes&&a.clipBoxes.length>0){var F=m.uniformLocations["clipBoxes[0]"];o.uniformMatrix4fv(F,!1,a.uniforms.clipBoxes.value)}m.setUniform1f("size",a.size),m.setUniform1f("maxSize",a.uniforms.maxSize.value),m.setUniform1f("minSize",a.uniforms.minSize.value),m.setUniform1f("uOctreeSpacing",a.spacing),m.setUniform("uOctreeSize",a.uniforms.octreeSize.value),m.setUniform3f("uColor",a.color.toArray()),m.setUniform1f("uOpacity",a.opacity),m.setUniform2f("elevationRange",a.elevationRange),m.setUniform2f("intensityRange",a.intensityRange),m.setUniform1f("intensityGamma",a.intensityGamma),m.setUniform1f("intensityContrast",a.intensityContrast),m.setUniform1f("intensityBrightness",a.intensityBrightness),m.setUniform1f("rgbGamma",a.rgbGamma),m.setUniform1f("rgbContrast",a.rgbContrast),m.setUniform1f("rgbBrightness",a.rgbBrightness),m.setUniform1f("uTransition",a.transition),m.setUniform1f("wRGB",a.weightRGB),m.setUniform1f("wIntensity",a.weightIntensity),m.setUniform1f("wElevation",a.weightElevation),m.setUniform1f("wClassification",a.weightClassification),m.setUniform1f("wReturnNumber",a.weightReturnNumber),m.setUniform1f("wSourceID",a.weightSourceID);var P=this.textures.get(a.visibleNodesTexture);m.setUniform1i("visibleNodesTexture",f),o.activeTexture(o.TEXTURE0+f),o.bindTexture(P.target,P.id),f++;var N=this.textures.get(a.gradientTexture);m.setUniform1i("gradient",f),o.activeTexture(o.TEXTURE0+f),o.bindTexture(N.target,N.id),f++;var O=this.textures.get(a.classificationTexture);if(m.setUniform1i("classificationLUT",f),o.activeTexture(o.TEXTURE0+f),o.bindTexture(O.target,O.id),f++,!0===a.snapEnabled){var U,L,G,D,V=m.uniformLocations["uSnapshot[0]"],H=m.uniformLocations["uSnapshotDepth[0]"],k=f,z=new Array(5).fill(k).map((function(t,e){return t+e})),X=new Array(5).fill(1+Math.max.apply(Math,h(z))).map((function(t,e){return t+e}));f=1+Math.max.apply(Math,h(X)),o.uniform1iv(V,z),o.uniform1iv(H,X);for(var W=0;W<5;W++){var j=a.uniforms.uSnapshot.value[W],Z=a.uniforms.uSnapshotDepth.value[W];if(!j)break;var Q=t.properties.get(j).__webglTexture,Y=t.properties.get(Z).__webglTexture,J=z[W],q=X[W];o.activeTexture(o["TEXTURE".concat(J)]),o.bindTexture(o.TEXTURE_2D,Q),o.activeTexture(o["TEXTURE".concat(q)]),o.bindTexture(o.TEXTURE_2D,Y)}var K=(U=[]).concat.apply(U,h(a.uniforms.uSnapView.value.map((function(t){return t.elements})))),$=m.uniformLocations["uSnapView[0]"];o.uniformMatrix4fv($,!1,K),K=(L=[]).concat.apply(L,h(a.uniforms.uSnapProj.value.map((function(t){return t.elements}))));var tt=m.uniformLocations["uSnapProj[0]"];o.uniformMatrix4fv(tt,!1,K),K=(G=[]).concat.apply(G,h(a.uniforms.uSnapProjInv.value.map((function(t){return t.elements}))));var et=m.uniformLocations["uSnapProjInv[0]"];o.uniformMatrix4fv(et,!1,K),K=(D=[]).concat.apply(D,h(a.uniforms.uSnapViewInv.value.map((function(t){return t.elements}))));var nt=m.uniformLocations["uSnapViewInv[0]"];o.uniformMatrix4fv(nt,!1,K)}this.renderNodes(t,e,n,d,i,m),o.activeTexture(o.TEXTURE2),o.bindTexture(o.TEXTURE_2D,null),o.activeTexture(o.TEXTURE0)}}]),n}(c.BasicGroup)},"./source/pointcloud/DEM.js":function(t,e,n){"use strict";n.r(e),n.d(e,"DEM",(function(){return u}));var r=n("three"),o=n("./source/utils/WorkerManager.js"),a=n("./source/Global.js"),s=n("./source/pointcloud/DEMNode.js"),u=function(){function t(e){p(this,t),this.pointcloud=e,this.matrix=null,this.boundingBox=null,this.tileSize=64,this.root=null,this.version=0}return m(t,[{key:"expandAndFindByBox",value:function(t,e){if(0===e)return[this.root];for(var n=[],i=[this.root];i.length>0;){var o,a=i.pop(),u=a.box.getSize(new r.Vector3),c={x:(t.min.x-a.box.min.x)/u.x,y:(t.min.y-a.box.min.y)/u.y},l={x:(t.max.x-a.box.max.x)/u.x,y:(t.max.y-a.box.max.y)/u.y};c.x=c.x<.5?0:1,c.y=c.y<.5?0:1,l.x=l.x<.5?0:1,l.y=l.y<.5?0:1,o=0===c.x&&0===c.y&&1===l.x&&1===l.y?[0,1,2,3]:c.x===l.x&&c.y===l.y?[c.x<<1|c.y]:[c.x<<1|c.y,l.x<<1|l.y];var d,h=f(o);try{for(h.s();!(d=h.n()).done;){var p=d.value;if(void 0===a.children[p]){var m=a.box.clone();(2&p)>0?m.min.x+=u.x/2:m.max.x-=u.x/2,(1&p)>0?m.min.y+=u.y/2:m.max.y-=u.y/2;var v=new s.DEMNode(a.name+p,m,this.tileSize);a.children[p]=v}(v=a.children[p]).level<e?i.push(v):n.push(v)}}catch(g){h.e(g)}finally{h.f()}}return n}},{key:"childIndex",value:function(t){var e=t.map((function(t){return t<.5?0:1})),n=i(e,2);return n[0]<<1|n[1]}},{key:"height",value:function(t){if(!this.root)return 0;for(var e=null,n=[this.root];;){var r=n[n.length-1],i=r.height(t);null!==i&&(e=i);var o=r.uv(t),a=this.childIndex(o);if(!r.children[a])break;n.push(r.children[a])}return e+this.pointcloud.position.z}},{key:"update",value:function(t){null!==this.matrix&&this.matrix.equals(this.pointcloud.matrixWorld)||(this.matrix=this.pointcloud.matrixWorld.clone(),this.boundingBox=this.pointcloud.boundingBox.clone().applyMatrix4(this.matrix),this.root=new s.DEMNode("r",this.boundingBox,this.tileSize),this.version++);var e,n=null,i=f(t);try{for(i.s();!(e=i.n()).done;){var u=e.value;if(void 0===u.demVersion||u.demVersion<this.version){n=u;break}}}catch(g){i.e(g)}finally{i.f()}if(null!==n){var c=n.getBoundingBox().clone().applyMatrix4(this.matrix),l=c.getSize(new r.Vector3),d=this.expandAndFindByBox(c,n.getLevel());n.demVersion=this.version;var h=n.geometryNode.geometry.attributes.position.array,p={boundingBox:{min:n.getBoundingBox().min.toArray(),max:n.getBoundingBox().max.toArray()},position:new Float32Array(h).buffer},m=[p.position],v=this;a.Global.workerPool.runTask(o.WorkerManager.DEM,(function(t){var e,n=new Float32Array(t.data.dem.data),i=f(d);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,a=o.box.getSize(new r.Vector3),s=0;s<v.tileSize;s++)for(var u=0;u<v.tileSize;u++){var h=s/(v.tileSize-1),p=u/(v.tileSize-1),m=o.box.min.x+h*a.x,y=o.box.min.y+p*a.y,b=v.tileSize*(m-c.min.x)/l.x,x=v.tileSize*(y-c.min.y)/l.y;b<0||b>v.tileSize||(x<0||x>v.tileSize||(b=Math.min(Math.floor(b),v.tileSize-1),x=Math.min(Math.floor(x),v.tileSize-1),o.data[s+v.tileSize*u]=n[b+v.tileSize*x]))}o.createMipMap(),o.mipMapNeedsUpdate=!0}}catch(g){i.e(g)}finally{i.f()}}),p,m)}}}]),t}()},"./source/pointcloud/DEMNode.js":function(t,e,n){"use strict";n.r(e),n.d(e,"DEMNode",(function(){return i}));var r=n("three"),i=function(){function t(e,n,r){p(this,t),this.name=e,this.box=n,this.tileSize=r,this.level=this.name.length-1,this.data=new Float32Array(r*r),this.data.fill(-1/0),this.children=[],this.mipMap=[this.data],this.mipMapNeedsUpdate=!0}return m(t,[{key:"createMipMap",value:function(){this.mipMap=[this.data];for(var t=this.tileSize,e=parseInt(t/2),n=this.data;e>1;){for(var r=new Float32Array(e*e),i=0;i<e;i++)for(var o=0;o<e;o++){var a=n[2*i+0+2*o*t],s=n[2*i+0+2*o*t+t],u=n[2*i+1+2*o*t],c=n[2*i+1+2*o*t+t],l=0,d=0;isFinite(a)&&(l+=a,d+=1),isFinite(s)&&(l+=s,d+=1),isFinite(u)&&(l+=u,d+=1),isFinite(c)&&(l+=c,d+=1),l/=d,r[i+o*e]=l}this.mipMap.push(r),n=r,t=e,e=parseInt(e/2)}this.mipMapNeedsUpdate=!1}},{key:"uv",value:function(t){var e=this.box.getSize(new r.Vector3);return[(t.x-this.box.min.x)/e.x,(t.y-this.box.min.y)/e.y]}},{key:"heightAtMipMapLevel",value:function(t,e){var n=this.uv(t),r=parseInt(this.tileSize/parseInt(Math.pow(2,e))),i=this.mipMap[e],o=Math.min(n[0]*r,r-1),a=Math.min(n[1]*r,r-1),s=o%1,u=a%1,c=[Math.floor(o),Math.ceil(o)],l=c[0],d=c[1],f=[Math.floor(a),Math.ceil(a)],h=f[0],p=f[1],m=i[l+r*h],v=i[l+r*p],g=i[d+r*h],y=i[d+r*p],b=isFinite(m)?(1-s)*(1-u):0,x=isFinite(v)?(1-s)*u:0,_=isFinite(g)?s*(1-u):0,w=isFinite(y)?s*u:0,T=b+x+_+w;if(b/=T,x/=T,_/=T,w/=T,0===T)return null;var S=0;return isFinite(m)&&(S+=m*b),isFinite(v)&&(S+=v*x),isFinite(g)&&(S+=g*_),isFinite(y)&&(S+=y*w),S}},{key:"height",value:function(t){for(var e=null,n=0;n<this.mipMap.length;n++)if(null!==(e=this.heightAtMipMapLevel(t,n)))return e;return e}},{key:"traverse",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t(this,e);var n,r=f(this.children.filter((function(t){return void 0!==t})));try{for(r.s();!(n=r.n()).done;){var i=n.value;i.traverse(t,e+1)}}catch(o){r.e(o)}finally{r.f()}}}]),t}()},"./source/pointcloud/PointCloudArena4D.js":function(t,e,n){"use strict";n.r(e),n.d(e,"PointCloudArena4D",(function(){return f})),n.d(e,"PointCloudArena4DNode",(function(){return d}));var r=n("three"),i=n("./source/utils/HelperUtils.js"),o=n("./source/pointcloud/PointCloudTree.js"),a=n("./source/Potree.js"),c=n("./source/Global.js"),l=n("./source/pointcloud/materials/PointCloudMaterial.js"),d=function(t){s(n,t);var e=u(n);function n(){var t;return p(this,n),(t=e.call(this)).left=null,t.right=null,t.sceneNode=null,t.kdtree=null,t}return m(n,[{key:"getNumPoints",value:function(){return this.geometryNode.numPoints}},{key:"isLoaded",value:function(){return!0}},{key:"isTreeNode",value:function(){return!0}},{key:"isGeometryNode",value:function(){return!1}},{key:"getLevel",value:function(){return this.geometryNode.level}},{key:"getBoundingSphere",value:function(){return this.geometryNode.boundingSphere}},{key:"getBoundingBox",value:function(){return this.geometryNode.boundingBox}},{key:"toTreeNode",value:function(t){var e=null;if(this.left===t?e=this.left:this.right===t&&(e=this.right),e.loaded){var i=new n,o=r.PointCloud(e.geometry,this.kdtree.material);o.visible=!1,i.kdtree=this.kdtree,i.geometryNode=e,i.sceneNode=o,i.parent=this,i.left=this.geometryNode.left,i.right=this.geometryNode.right}}},{key:"getChildren",value:function(){var t=[];return this.left&&t.push(this.left),this.right&&t.push(this.right),t}}]),n}(o.PointCloudTreeNode),f=function(t){s(n,t);var e=u(n);function n(t){var i;return p(this,n),(i=e.call(this)).root=null,t.root?i.root=t.root:t.addEventListener("hierarchy_loaded",(function(){i.root=t.root})),i.visiblePointsTarget=2e6,i.minimumNodePixelSize=150,i.position.sub(t.offset),i.updateMatrix(),i.numVisibleNodes=0,i.numVisiblePoints=0,i.boundingBoxNodes=[],i.loadQueue=[],i.visibleNodes=[],i.pcoGeometry=t,i.boundingBox=i.pcoGeometry.boundingBox,i.boundingSphere=i.pcoGeometry.boundingSphere,i.material=new l.PointCloudMaterial({vertexColors:r.VertexColors,size:.05,treeType:a.TreeType.KDTREE}),i.material.sizeType=a.PointSizeType.ATTENUATED,i.material.size=.05,i.profileRequests=[],i.name="",i}return m(n,[{key:"getBoundingBoxWorld",value:function(){this.updateMatrixWorld(!0);var t=this.boundingBox,e=this.matrixWorld;return i.HelperUtils.computeTransformedBoundingBox(t,e)}},{key:"setName",value:function(t){this.name!==t&&(this.name=t,this.dispatchEvent({type:"name_changed",name:t,pointcloud:this}))}},{key:"getName",value:function(){return this.name}},{key:"getLevel",value:function(){return this.level}},{key:"toTreeNode",value:function(t,e){var n=this,i=new d,o=new r.Points(t.geometry,this.material);o.frustumCulled=!0,o.onBeforeRender=function(e,r,o,a,s,u){if(s.program){if(e.getContext().useProgram(s.program.program),s.program.getUniforms().map.level){var c=t.getLevel();s.uniforms.level.value=c,s.program.getUniforms().map.level.setValue(e.getContext(),c)}if(n.visibleNodeTextureOffsets&&s.program.getUniforms().map.vnStart){var l=n.visibleNodeTextureOffsets.get(i);s.uniforms.vnStart.value=l,s.program.getUniforms().map.vnStart.setValue(e.getContext(),l)}if(s.program.getUniforms().map.pcIndex){var d=i.pcIndex?i.pcIndex:n.visibleNodes.indexOf(i);s.uniforms.pcIndex.value=d,s.program.getUniforms().map.pcIndex.setValue(e.getContext(),d)}}},i.geometryNode=t,i.sceneNode=o,i.pointcloud=this,i.left=t.left,i.right=t.right,e?(e.sceneNode.add(o),e.left===t?e.left=i:e.right===t&&(e.right=i)):(this.root=i,this.add(o));return t.oneTimeDisposeHandlers.push((function(){e.sceneNode.remove(i.sceneNode),e.left===i?e.left=t:e.right===i&&(e.right=t)})),i}},{key:"updateMaterial",value:function(t,e,n,i){t.fov=n.fov*(Math.PI/180),t.screenWidth=i.domElement.clientWidth,t.screenHeight=i.domElement.clientHeight,t.spacing=this.pcoGeometry.spacing,t.near=n.near,t.far=n.far,this.maxLevel>t.levels&&(t.levels=this.maxLevel+2);var o=this.boundingBox.getSize(new r.Vector3);t.bbSize=[o.x,o.y,o.z]}},{key:"updateVisibleBounds",value:function(){}},{key:"hideDescendants",value:function(t){for(var e=[],n=0;n<t.children.length;n++){(r=t.children[n]).visible&&e.push(r)}for(;e.length>0;){var r;(r=e.shift()).visible=!1,r.boundingBoxNode&&(r.boundingBoxNode.visible=!1);for(n=0;n<r.children.length;n++){var i=r.children[n];i.visible&&e.push(i)}}}},{key:"updateMatrixWorld",value:function(t){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==t||(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0)}},{key:"nodesOnRay",value:function(t,e){for(var n=[],i=e.clone(),o=0;o<t.length;o++){var a=t[o],s=a.getBoundingSphere(new r.Sphere).clone().applyMatrix4(a.sceneNode.matrixWorld);i.intersectsSphere(s)&&n.push(a)}return n}},{key:"pick",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=t.renderer,s=t.pRenderer;performance.mark("pick-start");var u=function(t,e){return void 0!==t?t:e},c=u(i.pickWindowSize,17),d=(u(i.pickOutsideClipRegion,!1),o.getSize(new r.Vector3)),f=Math.ceil(u(i.width,d.width)),h=Math.ceil(u(i.height,d.height)),p=u(i.pointSizeType,this.material.pointSizeType),m=u(i.pointSize,this.material.size),v=this.nodesOnRay(this.visibleNodes,n);if(0===v.length)return null;if(!this.pickState){var g=new r.Scene,y=new l.PointCloudMaterial;y.pointColorType=a.PointColorType.POINT_INDEX;var b=new r.WebGLRenderTarget(1,1,{minFilter:r.LinearFilter,magFilter:r.NearestFilter,format:r.RGBAFormat});this.pickState={renderTarget:b,material:y,scene:g}}var x=this.pickState,_=x.material;_.pointSizeType=p,_.shape=this.material.shape,_.size=m,_.uniforms.minSize.value=this.material.uniforms.minSize.value,_.uniforms.maxSize.value=this.material.uniforms.maxSize.value,_.classification=this.material.classification,i.pickClipped?(_.clipBoxes=this.material.clipBoxes,this.material.clipTask===a.ClipTask.HIGHLIGHT?_.clipTask=a.ClipTask.NONE:_.clipTask=this.material.clipTask):_.clipBoxes=[],this.updateMaterial(_,v,e,o),x.renderTarget.setSize(f,h);var w=new r.Vector2(i.x,i.y),T=o.getContext();T.enable(T.SCISSOR_TEST),T.scissor(parseInt(w.x-(c-1)/2),parseInt(w.y-(c-1)/2),parseInt(c),parseInt(c)),o.state.buffers.depth.setTest(_.depthTest),o.state.buffers.depth.setMask(_.depthWrite),o.state.setBlending(r.NoBlending),o.clearTarget(x.renderTarget,!0,!0,!0),o.setRenderTarget(x.renderTarget),T.clearColor(0,0,0,0),o.clearTarget(x.renderTarget,!0,!0,!0);var S=this.material;this.material=_,s.renderOctree(this,v,e,x.renderTarget),this.material=S;var M=function(t,e,n){return Math.min(Math.max(e,t),n)},E=parseInt(M(w.x-(c-1)/2,0,f)),R=parseInt(M(w.y-(c-1)/2,0,h)),I=parseInt(Math.min(E+c,f)-E),B=parseInt(Math.min(R+c,h)-R),A=I*B,C=new Uint8Array(4*A);T.readPixels(E,R,c,c,T.RGBA,T.UNSIGNED_BYTE,C),o.setRenderTarget(null),o.resetGLState(),o.setScissorTest(!1),T.disable(T.SCISSOR_TEST);for(var F=C,P=new Uint32Array(C.buffer),N=(Number.MAX_VALUE,[]),O=0;O<c;O++)for(var U=0;U<c;U++){var L=O+U*c,G=Math.pow(O-(c-1)/2,2)+Math.pow(U-(c-1)/2,2),D=F[4*L+3];F[4*L+3]=0;var V=P[L];if((0!==D||0!==V)&&void 0!==D&&void 0!==V){var H={pIndex:V,pcIndex:D,distanceToCenter:G};i.all?N.push(H):N.length>0?G<N[0].distanceToCenter&&(N[0]=H):N.push(H)}}for(var k=0,z=N;k<z.length;k++){var X={};if(!v[(H=z[k]).pcIndex])return null;var W=v[H.pcIndex],j=W.sceneNode,Z=W.geometryNode.geometry;for(var Q in Z.attributes){var Y=Z.attributes[Q];if("position"===Q){E=Y.array[3*H.pIndex+0],R=Y.array[3*H.pIndex+1];var J=Y.array[3*H.pIndex+2],q=new r.Vector3(E,R,J);q.applyMatrix4(j.matrixWorld),X[Q]=q}}H.point=X}return performance.mark("pick-end"),performance.measure("pick","pick-start","pick-end"),i.all?N.map((function(t){return t.point})):0===N.length?null:N[0].point}},{key:"computeVisibilityTextureData",value:function(t){c.Global.measureTimings&&performance.mark("computeVisibilityTextureData-start");var e=new Uint8Array(3*t.length),n=new Map;(t=t.slice()).sort((function(t,e){var n=t.geometryNode.level,r=e.geometryNode.level,i=t.geometryNode.number,o=e.geometryNode.number;return n!==r?n-r:i<o?-1:i>o?1:0}));for(var r=[],i=0;i<t.length;i++)r.push(t[i].geometryNode.number);for(i=0;i<t.length;i++){var o=t[i];n.set(o,i);var a=0,s=0,u=0;o.geometryNode.left&&r.indexOf(o.geometryNode.left.number)>0&&(a+=1,s=r.indexOf(o.geometryNode.left.number)-i),o.geometryNode.right&&r.indexOf(o.geometryNode.right.number)>0&&(a+=2,s=0===s?r.indexOf(o.geometryNode.right.number)-i:s),"X"===o.geometryNode.split?u=1:"Y"===o.geometryNode.split?u=2:"Z"===o.geometryNode.split&&(u=4),e[3*i+0]=a,e[3*i+1]=s,e[3*i+2]=u}return c.Global.measureTimings&&(performance.mark("computeVisibilityTextureData-end"),performance.measure("render.computeVisibilityTextureData","computeVisibilityTextureData-start","computeVisibilityTextureData-end")),{data:e,offsets:n}}},{key:"progress",get:function(){return this.pcoGeometry.root?c.Global.numNodesLoading>0?0:1:0}}]),n}(o.PointCloudTree)},"./source/pointcloud/PointCloudOctree.js":function(t,e,n){"use strict";n.r(e),n.d(e,"PointCloudOctree",(function(){return y})),n.d(e,"PointCloudOctreeNode",(function(){return g}));var r=n("three"),o=n("./source/pointcloud/geometries/PointCloudOctreeGeometry.js"),a=n("./source/utils/HelperUtils.js"),c=n("./source/pointcloud/PointCloudTree.js"),d=n("./source/pointcloud/materials/PointCloudMaterial.js"),h=n("./source/Potree.js"),v=n("./source/Global.js"),g=function(t){s(n,t);var e=u(n);function n(){var t;return p(this,n),(t=e.call(this)).children={},t.sceneNode=null,t.octree=null,t}return m(n,[{key:"getNumPoints",value:function(){return this.geometryNode.numPoints}},{key:"isLoaded",value:function(){return!0}},{key:"isTreeNode",value:function(){return!0}},{key:"isGeometryNode",value:function(){return!1}},{key:"getLevel",value:function(){return this.geometryNode.level}},{key:"getBoundingSphere",value:function(){return this.geometryNode.boundingSphere}},{key:"getBoundingBox",value:function(){return this.geometryNode.boundingBox}},{key:"getChildren",value:function(){for(var t=[],e=0;e<8;e++)this.children[e]&&t.push(this.children[e]);return t}},{key:"getPointsInBox",value:function(t){if(!this.sceneNode)return null;for(var e=this.geometryNode.buffer,n=e.offset("position"),i=e.stride,o=new DataView(e.data),a=(new r.Matrix4).getInverse(t.matrixWorld),s=(new r.Matrix4).multiplyMatrices(a,this.sceneNode.matrixWorld),u=[],c=new r.Vector4,l=0;l<e.numElements;l++){var d=o.getFloat32(l*i+n+0,!0),f=o.getFloat32(l*i+n+4,!0),h=o.getFloat32(l*i+n+8,!0);c.set(d,f,h,1),c.applyMatrix4(s),-.5<c.x&&c.x<.5&&-.5<c.y&&c.y<.5&&-.5<c.z&&c.z<.5&&(c.set(d,f,h,1).applyMatrix4(this.sceneNode.matrixWorld),u.push(new r.Vector3(c.x,c.y,c.z)))}return u}},{key:"name",get:function(){return this.geometryNode.name}}]),n}(c.PointCloudTreeNode),y=function(t){s(n,t);var e=u(n);function n(t,i){var o;p(this,n),(o=e.call(this)).pointBudget=1/0,o.pcoGeometry=t,o.boundingBox=o.pcoGeometry.boundingBox,o.boundingSphere=o.boundingBox.getBoundingSphere(new r.Sphere),o.material=i||new d.PointCloudMaterial,o.visiblePointsTarget=2e6,o.minimumNodePixelSize=150,o.level=0,o.position.copy(t.offset),o.updateMatrix(),o.showBoundingBox=!1,o.boundingBoxNodes=[],o.loadQueue=[],o.visibleBounds=new r.Box3,o.visibleNodes=[],o.visibleGeometry=[],o.generateDEM=!1,o.profileRequests=[],o.name="",o.tempVector3=new r.Vector3;var s=[o.pcoGeometry.tightBoundingBox,o.getBoundingBoxWorld()].find((function(t){return void 0!==t}));o.updateMatrixWorld(!0);var u=(s=a.HelperUtils.computeTransformedBoundingBox(s,o.matrixWorld)).min.z,c=s.max.z;return o.material.heightMin=u,o.material.heightMax=c,o.projection=t.projection,o.root=o.pcoGeometry.root,o}return m(n,[{key:"setName",value:function(t){this.name!==t&&(this.name=t,this.dispatchEvent({type:"name_changed",name:t,pointcloud:this}))}},{key:"getName",value:function(){return this.name}},{key:"toTreeNode",value:function(t,e){var n=this,i=new g,o=new r.Points(t.geometry,this.material);for(var a in o.name=t.name,o.position.copy(t.boundingBox.min),o.frustumCulled=!0,o.onBeforeRender=function(e,r,o,a,s,u){if(s.program){if(e.getContext().useProgram(s.program.program),s.program.getUniforms().map.level){var c=t.getLevel();s.uniforms.level.value=c,s.program.getUniforms().map.level.setValue(e.getContext(),c)}if(n.visibleNodeTextureOffsets&&s.program.getUniforms().map.vnStart){var l=n.visibleNodeTextureOffsets.get(i);s.uniforms.vnStart.value=l,s.program.getUniforms().map.vnStart.setValue(e.getContext(),l)}if(s.program.getUniforms().map.pcIndex){var d=i.pcIndex?i.pcIndex:n.visibleNodes.indexOf(i);s.uniforms.pcIndex.value=d,s.program.getUniforms().map.pcIndex.setValue(e.getContext(),d)}}},i.geometryNode=t,i.sceneNode=o,i.pointcloud=this,i.children={},t.children)i.children[a]=t.children[a];if(e){var s=parseInt(t.name[t.name.length-1]);e.sceneNode.add(o),e.children[s]=i}else this.root=i,this.add(o);return t.oneTimeDisposeHandlers.push((function(){var n=parseInt(t.name[t.name.length-1]);e.sceneNode.remove(i.sceneNode),e.children[n]=t})),i}},{key:"updateVisibleBounds",value:function(){for(var t=[],e=0;e<this.visibleNodes.length;e++){for(var n=this.visibleNodes[e],i=!0,a=0;a<n.children.length;a++){var s=n.children[a];s instanceof g?i=i&&!s.sceneNode.visible:s instanceof o.PointCloudOctreeGeometryNode&&(i=!0)}i&&t.push(n)}this.visibleBounds.min=new r.Vector3(1/0,1/0,1/0),this.visibleBounds.max=new r.Vector3(-1/0,-1/0,-1/0);for(e=0;e<t.length;e++){n=t[e];this.visibleBounds.expandByPoint(n.getBoundingBox().min),this.visibleBounds.expandByPoint(n.getBoundingBox().max)}}},{key:"updateMaterial",value:function(t,e,n,i){t.fov=n.fov*(Math.PI/180),t.screenWidth=i.domElement.clientWidth,t.screenHeight=i.domElement.clientHeight,t.spacing=this.pcoGeometry.spacing*Math.max(this.scale.x,this.scale.y,this.scale.z),t.near=n.near,t.far=n.far,t.uniforms.octreeSize.value=this.pcoGeometry.boundingBox.getSize(new r.Vector3).x}},{key:"computeVisibilityTextureData",value:function(t,e){v.Global.measureTimings&&performance.mark("computeVisibilityTextureData-start");var n=new Uint8Array(4*t.length),o=new Map;(t=t.slice()).sort((function(t,e){var n=t.geometryNode.name,r=e.geometryNode.name;return n.length!==r.length?n.length-r.length:n<r?-1:n>r?1:0}));for(var a=new r.Vector3,s=function(t,e){a.subVectors(e.center,t.origin);var n=a.dot(t.direction),r=a.dot(a)-n*n,i=e.radius*e.radius;if(r>i)return null;var o=n+Math.sqrt(i-r);return o<0?null:o},u=new Map,c=new Map,l=0;l<t.length;l++){var d=t[l];o.set(d,l);for(var h=[],p=0;p<8;p++){(m=d.children[p])&&m.constructor===g&&t.includes(m,l)&&h.push(m)}d.geometryNode.estimatedSpacing;n[4*l+0]=0,n[4*l+1]=0,n[4*l+2]=0,n[4*l+3]=d.getLevel();for(p=0;p<h.length;p++){var m=h[p],y=parseInt(m.geometryNode.name.substr(-1));if(n[4*l+0]+=Math.pow(2,y),0===p){var b=t.indexOf(m,l);n[4*l+1]=b-l>>8,n[4*l+2]=(b-l)%256}}var x=d.getBoundingBox().clone().getBoundingSphere(new r.Sphere);x.applyMatrix4(d.sceneNode.matrixWorld),x.applyMatrix4(e.matrixWorldInverse);var _=s(new r.Ray(e.position,e.getWorldDirection(this.tempVector3)),x),w=x.center.distanceTo(e.position)+x.radius;if(null===_&&(_=w),_=Math.max(_,w),u.has(d.getLevel())){var T=u.get(d.getLevel()),S=Math.max(T,_);u.set(d.getLevel(),S)}else u.set(d.getLevel(),_);if(!d.geometryNode.hasChildren){var M={distance:_,i:l};c.set(d,M)}}var E,R=f(c);try{for(R.s();!(E=R.n()).done;){var I=i(E.value,2),B=(d=I[0],M=I[1],d.getLevel());_=M.distance,l=M.i;if(!(B<4)){var A,C=f(u);try{for(C.s();!(A=C.n()).done;){var F=i(A.value,2),P=F[0];_<1.2*F[1]&&(n[4*l+3]=P)}}catch(N){C.e(N)}finally{C.f()}}}}catch(N){R.e(N)}finally{R.f()}return v.Global.measureTimings&&(performance.mark("computeVisibilityTextureData-end"),performance.measure("render.computeVisibilityTextureData","computeVisibilityTextureData-start","computeVisibilityTextureData-end")),{data:n,offsets:o}}},{key:"nodeIntersectsProfile",value:function(t,e){for(var n=t.boundingBox.clone().applyMatrix4(this.matrixWorld).getBoundingSphere(new r.Sphere),i=!1,o=0;o<e.points.length-1;o++){var a=new r.Vector3(e.points[o+0].x,e.points[o+0].y,n.center.z),s=new r.Vector3(e.points[o+1].x,e.points[o+1].y,n.center.z),u=new r.Line3(a,s).closestPointToPoint(n.center,!0).distanceTo(n.center);i=i||u<n.radius+e.width}return i}},{key:"nodesOnRay",value:function(t,e){for(var n=[],i=e.clone(),o=0;o<t.length;o++){var a=t[o],s=a.getBoundingSphere(new r.Sphere).clone().applyMatrix4(this.matrixWorld);i.intersectsSphere(s)&&n.push(a)}return n}},{key:"updateMatrixWorld",value:function(t){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==t||(this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0)}},{key:"hideDescendants",value:function(t){for(var e=[],n=0;n<t.children.length;n++){(r=t.children[n]).visible&&e.push(r)}for(;e.length>0;){(t=e.shift()).visible=!1;for(n=0;n<t.children.length;n++){var r;(r=t.children[n]).visible&&e.push(r)}}}},{key:"moveToOrigin",value:function(){this.position.set(0,0,0),this.updateMatrixWorld(!0);var t=this.boundingBox,e=this.matrixWorld,n=a.HelperUtils.computeTransformedBoundingBox(t,e);this.position.set(0,0,0).sub(n.getCenter(new r.Vector3))}},{key:"moveToGroundPlane",value:function(){this.updateMatrixWorld(!0);var t=this.boundingBox,e=this.matrixWorld,n=a.HelperUtils.computeTransformedBoundingBox(t,e);this.position.y+=-n.min.y}},{key:"getBoundingBoxWorld",value:function(){this.updateMatrixWorld(!0);var t=this.boundingBox,e=this.matrixWorld;return a.HelperUtils.computeTransformedBoundingBox(t,e)}},{key:"getPointsInProfile",value:function(t,e,n){for(var i={segments:[],boundingBox:new r.Box3,projectedBoundingBox:new r.Box2},o=0;o<t.points.length-1;o++){var a=t.points[o],s=t.points[o+1],u=this.getProfile(a,s,t.width,e),c={start:a,end:s,points:u,project:null};i.segments.push(c),i.boundingBox.expandByPoint(u.boundingBox.min),i.boundingBox.expandByPoint(u.boundingBox.max)}var l=new r.Vector3;for(o=0;o<i.segments.length;o++){var d=function(t,e,n,i){var o=t,a=e,s=n,u=i,c=new r.Vector3(1,0,0),l=(new r.Vector3).subVectors(a,o);l.y=0,l.normalize();var d=Math.acos(c.dot(l));return l.z>0&&(d=-d),function(t){var e=(new r.Matrix4).makeTranslation(-o.x,-u.min.y,-o.z),n=(new r.Matrix4).makeRotationY(-d),i=(new r.Matrix4).makeTranslation(s.x,0,0),a=t.clone();return a.applyMatrix4(e),a.applyMatrix4(n),a.applyMatrix4(i),a}}(a=(c=i.segments[o]).start,s=c.end,l.clone(),i.boundingBox.clone());c.project=d,l.x+=new r.Vector3(a.x,0,a.z).distanceTo(new r.Vector3(s.x,0,s.z)),l.y+=s.y-a.y}return i.projectedBoundingBox.min.x=0,i.projectedBoundingBox.min.y=i.boundingBox.min.y,i.projectedBoundingBox.max.x=l.x,i.projectedBoundingBox.max.y=i.boundingBox.max.y,i}},{key:"getProfile",value:function(t,e,n,r,i){}},{key:"getVisibleExtent",value:function(){return this.visibleBounds.applyMatrix4(this.matrixWorld)}},{key:"pick",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=t.renderer,a=t.pRenderer;performance.mark("pick-start");var s=function(t,e){return void 0!==t?t:e},u=s(i.pickWindowSize,17),c=(s(i.pickOutsideClipRegion,!1),o.getSize(new r.Vector3)),l=Math.ceil(s(i.width,c.width)),f=Math.ceil(s(i.height,c.height)),p=s(i.pointSizeType,this.material.pointSizeType),m=s(i.pointSize,this.material.size),v=this.nodesOnRay(this.visibleNodes,n);if(0===v.length)return null;if(!this.pickState){var g=new r.Scene,y=new d.PointCloudMaterial;y.pointColorType=h.PointColorType.POINT_INDEX;var b=new r.WebGLRenderTarget(1,1,{minFilter:r.LinearFilter,magFilter:r.NearestFilter,format:r.RGBAFormat});this.pickState={renderTarget:b,material:y,scene:g}}var x=this.pickState,_=x.material;_.pointSizeType=p,_.shape=this.material.shape,_.size=m,_.uniforms.minSize.value=this.material.uniforms.minSize.value,_.uniforms.maxSize.value=this.material.uniforms.maxSize.value,_.classification=this.material.classification,i.pickClipped?(_.clipBoxes=this.material.clipBoxes,this.material.clipTask===h.ClipTask.HIGHLIGHT?_.clipTask=h.ClipTask.NONE:_.clipTask=this.material.clipTask):_.clipBoxes=[],this.updateMaterial(_,v,e,o),x.renderTarget.setSize(l,f);var w=new r.Vector2(i.x,i.y),T=o.getContext();T.enable(T.SCISSOR_TEST),T.scissor(parseInt(w.x-(u-1)/2),parseInt(w.y-(u-1)/2),parseInt(u),parseInt(u)),o.state.buffers.depth.setTest(_.depthTest),o.state.buffers.depth.setMask(_.depthWrite),o.state.setBlending(r.NoBlending),o.setRenderTarget(x.renderTarget),T.clearColor(0,0,0,0),o.clearTarget(x.renderTarget,!0,!0,!0);var S=this.material;this.material=_,a.renderOctree(this,v,e,x.renderTarget),this.material=S;var M=function(t,e,n){return Math.min(Math.max(e,t),n)},E=parseInt(M(w.x-(u-1)/2,0,l)),R=parseInt(M(w.y-(u-1)/2,0,f)),I=parseInt(Math.min(E+u,l)-E),B=parseInt(Math.min(R+u,f)-R),A=I*B,C=new Uint8Array(4*A);T.readPixels(E,R,u,u,T.RGBA,T.UNSIGNED_BYTE,C),o.setRenderTarget(null),o.resetGLState(),o.setScissorTest(!1),T.disable(T.SCISSOR_TEST);for(var F=C,P=new Uint32Array(C.buffer),N=(Number.MAX_VALUE,[]),O=0;O<u;O++)for(var U=0;U<u;U++){var L=O+U*u,G=Math.pow(O-(u-1)/2,2)+Math.pow(U-(u-1)/2,2),D=F[4*L+3];F[4*L+3]=0;var V=P[L];if((0!==D||0!==V)&&void 0!==D&&void 0!==V){var H={pIndex:V,pcIndex:D,distanceToCenter:G};i.all?N.push(H):N.length>0?G<N[0].distanceToCenter&&(N[0]=H):N.push(H)}}for(var k=0,z=N;k<z.length;k++){var X={};if(!v[(H=z[k]).pcIndex])return null;var W=v[H.pcIndex],j=W.sceneNode,Z=W.geometryNode.geometry;for(var Q in Z.attributes){var Y=Z.attributes[Q];if("position"===Q){E=Y.array[3*H.pIndex+0],R=Y.array[3*H.pIndex+1];var J=Y.array[3*H.pIndex+2],q=new r.Vector3(E,R,J);q.applyMatrix4(j.matrixWorld),X[Q]=q}}H.point=X}return performance.mark("pick-end"),performance.measure("pick","pick-start","pick-end"),i.all?N.map((function(t){return t.point})):0===N.length?null:N[0].point}},{key:"getFittedBoxGen",value:l.mark((function t(e){var n,i,o,a,s,u,c,d,h,p,m,v,g,y,b,x,_,w;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new r.Box3,i=(new r.Matrix4).getInverse(e.matrixWorld),o=f(this.visibleNodes),t.prev=3,o.s();case 5:if((a=o.n()).done){t.next=20;break}if((s=a.value).sceneNode){t.next=9;break}return t.abrupt("continue",18);case 9:for(u=s.geometryNode.buffer,c=u.offset("position"),d=u.stride,h=new DataView(u.data),p=(new r.Matrix4).multiplyMatrices(i,s.sceneNode.matrixWorld),m=new r.Vector4,v=0;v<u.numElements;v++)g=h.getFloat32(v*d+c+0,!0),y=h.getFloat32(v*d+c+4,!0),b=h.getFloat32(v*d+c+8,!0),m.set(g,y,b,1),m.applyMatrix4(p),-.5<m.x&&m.x<.5&&-.5<m.y&&m.y<.5&&-.5<m.z&&m.z<.5&&n.expandByPoint(m);return void(t.next=18);case 18:t.next=5;break;case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(3),o.e(t.t0);case 25:return t.prev=25,o.f(),t.finish(25);case 28:return x=n.getCenter(new r.Vector3).applyMatrix4(e.matrixWorld),(_=new r.Object3D).position.copy(x),_.scale.copy(e.scale),_.rotation.copy(e.rotation),w=(new r.Vector3).subVectors(n.max,n.min),_.scale.multiply(w),t.next=37,_;case 37:case"end":return t.stop()}}),t,this,[[3,22,25,28]])}))},{key:"getFittedBox",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,i=new r.Box3,o=(new r.Matrix4).getInverse(t.matrixWorld),a=f(this.visibleNodes);try{for(a.s();!(e=a.n()).done;){var s=e.value;if(s.sceneNode&&!(s.getLevel()>n))for(var u=s.geometryNode.buffer,c=u.offset("position"),l=u.stride,d=new DataView(u.data),h=(new r.Matrix4).multiplyMatrices(o,s.sceneNode.matrixWorld),p=new r.Vector4,m=0;m<u.numElements;m++){var v=d.getFloat32(m*l+c+0,!0),g=d.getFloat32(m*l+c+4,!0),y=d.getFloat32(m*l+c+8,!0);p.set(v,g,y,1),p.applyMatrix4(h),-.5<p.x&&p.x<.5&&-.5<p.y&&p.y<.5&&-.5<p.z&&p.z<.5&&i.expandByPoint(p)}}}catch(w){a.e(w)}finally{a.f()}var b=i.getCenter(new r.Vector3).applyMatrix4(t.matrixWorld),x=new r.Object3D;x.position.copy(b),x.scale.copy(t.scale),x.rotation.copy(t.rotation);var _=(new r.Vector3).subVectors(i.max,i.min);return x.scale.multiply(_),x}},{key:"find",value:function(t){var e,n=null,r=f(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n="r"===i?this.root:n.children[i]}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"progress",get:function(){return this.visibleNodes.length/this.visibleGeometry.length}}]),n}(c.PointCloudTree)},"./source/pointcloud/PointCloudTree.js":function(t,e,n){"use strict";n.r(e),n.d(e,"PointCloudTree",(function(){return c})),n.d(e,"PointCloudTreeNode",(function(){return a}));var i=n("three"),o=n("./source/pointcloud/DEM.js"),a=function(){function t(){p(this,t),this.needsTransformUpdate=!0}return m(t,[{key:"getChildren",value:function(){}},{key:"getBoundingBox",value:function(){}},{key:"isLoaded",value:function(){}},{key:"isGeometryNode",value:function(){}},{key:"isTreeNode",value:function(){}},{key:"getLevel",value:function(){}},{key:"getBoundingSphere",value:function(){}}]),t}(),c=function(t){s(n,t);var e=u(n);function n(){var t;return p(this,n),(t=e.call(this)).dem=new o.DEM(r(t)),t}return m(n,[{key:"initialized",value:function(){return null!==this.root}}]),n}(i.Object3D)},"./source/pointcloud/geometries/PointCloudArena4DGeometry.js":function(t,e,n){"use strict";n.r(e),n.d(e,"PointCloudArena4DGeometry",(function(){return l})),n.d(e,"PointCloudArena4DGeometryNode",(function(){return c}));var r=n("three"),i=n("./source/PointAttributes.js"),o=n("./source/Global.js"),a=n("./source/XHRFactory.js"),c=function(){function t(){p(this,t),this.left=null,this.right=null,this.boundingBox=null,this.number=null,this.pcoGeometry=null,this.loaded=!1,this.numPoints=0,this.level=0,this.children=[],this.oneTimeDisposeHandlers=[]}return m(t,[{key:"isGeometryNode",value:function(){return!0}},{key:"isTreeNode",value:function(){return!1}},{key:"isLoaded",value:function(){return this.loaded}},{key:"getBoundingSphere",value:function(){return this.boundingSphere}},{key:"getBoundingBox",value:function(){return this.boundingBox}},{key:"getChildren",value:function(){var t=[];return this.left&&t.push(this.left),this.right&&t.push(this.right),t}},{key:"getLevel",value:function(){return this.level}},{key:"load",value:function(){if(!this.loaded&&!this.loading&&!(o.Global.numNodesLoading>=o.Global.maxNodesLoading)){this.loading=!0,o.Global.numNodesLoading++;var t=this,e=this.pcoGeometry.url+"?node="+this.number,n=a.XHRFactory.createXMLHttpRequest();n.overrideMimeType("text/plain"),n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){try{for(var e=n.response,a=new DataView(e),s=e.byteLength/17,u=new ArrayBuffer(28*s),c=(new DataView(u),i.PointAttribute.POSITION_CARTESIAN,i.PointAttribute.RGBA_PACKED,i.PointAttribute.INTENSITY,i.PointAttribute.CLASSIFICATION,new Float32Array(3*s)),l=new Uint8Array(4*s),d=new Float32Array(s),f=new Uint8Array(s),h=new ArrayBuffer(4*s),p=new Uint32Array(h),m=new r.Box3,v=0;v<s;v++){var g=a.getFloat32(17*v+0,!0)+t.boundingBox.min.x,y=a.getFloat32(17*v+4,!0)+t.boundingBox.min.y,b=a.getFloat32(17*v+8,!0)+t.boundingBox.min.z,x=a.getUint8(17*v+12,!0),_=a.getUint8(17*v+13,!0),w=a.getUint8(17*v+14,!0),T=a.getUint8(17*v+15,!0),S=a.getUint8(17*v+16,!0);m.expandByPoint(new r.Vector3(g,y,b)),c[3*v+0]=g,c[3*v+1]=y,c[3*v+2]=b,l[4*v+0]=x,l[4*v+1]=_,l[4*v+2]=w,l[4*v+3]=255,d[v]=T,f[v]=S,p[v]=v}var M=new r.BufferGeometry;M.setAttribute("position",new r.BufferAttribute(c,3)),M.setAttribute("color",new r.BufferAttribute(l,4,!0)),M.setAttribute("intensity",new r.BufferAttribute(d,1)),M.setAttribute("classification",new r.BufferAttribute(f,1));var E=new r.BufferAttribute(new Uint8Array(h),4,!0);M.setAttribute("indices",E),t.geometry=M,t.numPoints=s,t.loaded=!0,t.loading=!1,o.Global.numNodesLoading--}catch(R){console.error("Potree: Exception thrown parsing points.",R),o.Global.numNodesLoading--}},n.onerror=function(){o.Global.numNodesLoading--,console.log("Potree: Failed to load file, "+n.status+", file: "+e)},n.send(null)}}},{key:"dispose",value:function(){if(this.geometry&&null!=this.parent){this.geometry.dispose(),this.geometry=null,this.loaded=!1;for(var t=0;t<this.oneTimeDisposeHandlers.length;t++){(0,this.oneTimeDisposeHandlers[t])()}this.oneTimeDisposeHandlers=[]}}},{key:"getNumPoints",value:function(){return this.numPoints}}]),t}(),l=function(t){s(n,t);var e=u(n);function n(){var t;return p(this,n),(t=e.call(this)).numPoints=0,t.version=0,t.boundingBox=null,t.numNodes=0,t.name=null,t.provider=null,t.url=null,t.root=null,t.levels=0,t._spacing=null,t.pointAttributes=new i.PointAttributes(["POSITION_CARTESIAN","COLOR_PACKED"]),t}return m(n,[{key:"loadHierarchy",value:function(){var t=this,e=this.url+"?tree",n=a.XHRFactory.createXMLHttpRequest();n.overrideMimeType("text/plain"),n.open("GET",e,!0),n.responseType="arraybuffer",n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){for(var e=n.response,i=e.byteLength/3,o=new DataView(e),a=[],s=null,u=0,l=0;l<i;l++){var d=o.getUint8(3*l+0,!0),f=(1&d)>0,h=(2&d)>0,p=null;(4&d)>0?p="X":(8&d)>0&&(p="Y"),(16&d)>0&&(p="Z");var m=new c;if(m.hasLeft=f,m.hasRight=h,m.split=p,m.isLeaf=!f&&!h,m.number=l,m.left=null,m.right=null,m.pcoGeometry=t,m.level=a.length,u=Math.max(u,m.level),a.length>0){var v=a[a.length-1];m.boundingBox=v.boundingBox.clone();var g=v.boundingBox.getSize(new r.Vector3);if(v.hasLeft&&!v.left){v.left=m,v.children.push(m),"X"===v.split?m.boundingBox.max.x=m.boundingBox.min.x+g.x/2:"Y"===v.split?m.boundingBox.max.y=m.boundingBox.min.y+g.y/2:"Z"===v.split&&(m.boundingBox.max.z=m.boundingBox.min.z+g.z/2);var y=new r.Vector3;m.boundingBox.getCenter(y);var b=m.boundingBox.getSize(new r.Vector3).length()/2;m.boundingSphere=new r.Sphere(y,b)}else{v.right=m,v.children.push(m),"X"===v.split?m.boundingBox.min.x=m.boundingBox.min.x+g.x/2:"Y"===v.split?m.boundingBox.min.y=m.boundingBox.min.y+g.y/2:"Z"===v.split&&(m.boundingBox.min.z=m.boundingBox.min.z+g.z/2);y=new r.Vector3;m.boundingBox.getCenter(y);b=m.boundingBox.getSize(new r.Vector3).length()/2;m.boundingSphere=new r.Sphere(y,b)}}else{(s=m).boundingBox=t.boundingBox.clone();y=new r.Vector3;s.boundingBox.getCenter(y);b=s.boundingBox.getSize(new r.Vector3).length()/2;s.boundingSphere=new r.Sphere(y,b)}var x=m.boundingBox.getSize(new r.Vector3);if(m.spacing=(x.x+x.y+x.z)/3/75,m.estimatedSpacing=m.spacing,a.push(m),m.isLeaf)for(var _=!1;!_&&a.length>0;){a.pop();var w=a[a.length-1];_=a.length>0&&w.hasRight&&null==w.right}}t.root=s,t.levels=u,t.dispatchEvent({type:"hierarchy_loaded"})}},n.send(null)}},{key:"spacing",get:function(){return this._spacing?this._spacing:this.root?this.root.spacing:void 0},set:function(t){this._spacing=t}}],[{key:"load",value:function(t,e){var i=a.XHRFactory.createXMLHttpRequest();i.overrideMimeType("text/plain"),i.open("GET",t+"?info",!0),i.onreadystatechange=function(){try{if(4===i.readyState&&200===i.status){var o=JSON.parse(i.responseText),a=new n;a.url=t,a.name=o.Name,a.provider=o.Provider,a.numNodes=o.Nodes,a.numPoints=o.Points,a.version=o.Version,a.boundingBox=new r.Box3((new r.Vector3).fromArray(o.BoundingBox.slice(0,3)),(new r.Vector3).fromArray(o.BoundingBox.slice(3,6))),o.Spacing&&(a.spacing=o.Spacing);var s=a.boundingBox.min.clone().multiplyScalar(-1);a.boundingBox.min.add(s),a.boundingBox.max.add(s),a.offset=s;var u=new r.Vector3;a.boundingBox.getCenter(u);var c=a.boundingBox.getSize(new r.Vector3).length()/2;a.boundingSphere=new r.Sphere(u,c),a.loadHierarchy(),e(a)}else 4===i.readyState&&e(null)}catch(l){console.error(l.message),e(null)}},i.send(null)}}]),n}(r.EventDispatcher)},"./source/pointcloud/geometries/PointCloudEptGeometry.js":function(t,e,n){"use strict";n.r(e),n.d(e,"PointCloudEptGeometry",(function(){return y})),n.d(e,"PointCloudEptGeometryNode",(function(){return x})),n.d(e,"EptKey",(function(){return b}));var r=n("three"),o=n("./source/loaders/ept/EptBinaryLoader.js"),a=n("./source/loaders/ept/EptLaszipLoader.js"),c=n("./source/utils/VersionUtils.js"),f=n("./source/pointcloud/PointCloudTree.js"),h=n("./source/Global.js"),v=n("./source/XHRFactory.js"),g=function(){function t(){p(this,t)}return m(t,null,[{key:"toVector3",value:function(t,e){return(new r.Vector3).fromArray(t,e||0)}},{key:"toBox3",value:function(e){return new r.Box3(t.toVector3(e),t.toVector3(e,3))}},{key:"findDim",value:function(t,e){var n=t.find((function(t){return t.name==e}));if(!n)throw new Error("Failed to find "+e+" in schema");return n}},{key:"sphereFrom",value:function(t){return t.getBoundingSphere(new r.Sphere)}}]),t}(),y=function t(e,n){p(this,t);n.version;var r=n.schema,i=n.bounds,s=n.boundsConforming,u=[g.findDim(r,"X"),g.findDim(r,"Y"),g.findDim(r,"Z")],l=u.map((function(t){return t.scale||1})),d=u.map((function(t){return t.offset||0}));this.eptScale=g.toVector3(l),this.eptOffset=g.toVector3(d),this.url=e,this.info=n,this.type="ept",this.schema=r,this.span=n.span||n.ticks,this.boundingBox=g.toBox3(i),this.tightBoundingBox=g.toBox3(s),this.offset=g.toVector3([0,0,0]),this.boundingSphere=g.sphereFrom(this.boundingBox),this.tightBoundingSphere=g.sphereFrom(this.tightBoundingBox),this.version=new c.VersionUtils("1.6"),this.projection=null,this.fallbackProjection=null,n.srs&&n.srs.horizontal&&(this.projection=n.srs.authority+":"+n.srs.horizontal),n.srs.wkt&&(this.projection?this.fallbackProjection=n.srs.wkt:this.projection=n.srs.wkt),this.pointAttributes="LAZ",this.spacing=(this.boundingBox.max.x-this.boundingBox.min.x)/this.span;n.hierarchyType;var f=n.dataType||"laszip";this.loader="binary"==f?new o.EptBinaryLoader:new a.EptLaszipLoader},b=function(){function t(e,n,r,i,o,a){p(this,t),this.ept=e,this.b=n,this.d=r,this.x=i||0,this.y=o||0,this.z=a||0}return m(t,[{key:"name",value:function(){return this.d+"-"+this.x+"-"+this.y+"-"+this.z}},{key:"step",value:function(e,n,i){var o=this.b.min.clone(),a=this.b.max.clone(),s=(new r.Vector3).subVectors(a,o);return e?o.x+=s.x/2:a.x-=s.x/2,n?o.y+=s.y/2:a.y-=s.y/2,i?o.z+=s.z/2:a.z-=s.z/2,new t(this.ept,new r.Box3(o,a),this.d+1,2*this.x+e,2*this.y+n,2*this.z+i)}},{key:"children",value:function(){for(var t=[],e=0;e<2;++e)for(var n=0;n<2;++n)for(var r=0;r<2;++r){var i=this.step(e,n,r).name();t.includes(i)||(t=t.concat(i))}return t}}]),t}(),x=function(t){s(n,t);var e=u(n);function n(t,r,i,o,a,s){var u;p(this,n),(u=e.call(this)).ept=t,u.key=new b(u.ept,r||u.ept.boundingBox,i||0,o,a,s),u.id=n.IDCount++,u.geometry=null,u.boundingBox=u.key.b,u.tightBoundingBox=u.boundingBox,u.spacing=u.ept.spacing/Math.pow(2,u.key.d),u.boundingSphere=g.sphereFrom(u.boundingBox),u.hasChildren=!1,u.children={},u.numPoints=-1,u.level=u.key.d,u.loaded=!1,u.loading=!1,u.oneTimeDisposeHandlers=[];var c=u.key;return u.name=u.toPotreeName(c.d,c.x,c.y,c.z),u.index=parseInt(u.name.charAt(u.name.length-1)),u}return m(n,[{key:"isGeometryNode",value:function(){return!0}},{key:"getLevel",value:function(){return this.level}},{key:"isTreeNode",value:function(){return!1}},{key:"isLoaded",value:function(){return this.loaded}},{key:"getBoundingSphere",value:function(){return this.boundingSphere}},{key:"getBoundingBox",value:function(){return this.boundingBox}},{key:"url",value:function(){return this.ept.url+"ept-data/"+this.filename()}},{key:"getNumPoints",value:function(){return this.numPoints}},{key:"filename",value:function(){return this.key.name()}},{key:"getChildren",value:function(){for(var t=[],e=0;e<8;e++)this.children[e]&&t.push(this.children[e]);return t}},{key:"addChild",value:function(t){this.children[t.index]=t,t.parent=this}},{key:"load",value:function(){this.loaded||this.loading||h.Global.numNodesLoading>=h.Global.maxNodesLoading||(this.loading=!0,h.Global.numNodesLoading++,-1===this.numPoints&&this.loadHierarchy(),this.loadPoints())}},{key:"loadPoints",value:function(){this.ept.loader.load(this)}},{key:"loadHierarchy",value:function(){var t=d(l.mark((function t(){var e,r,o,a,s=this;return l.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e={})[this.filename()]=this,this.hasChildren=!1,r="".concat(this.ept.url,"ept-hierarchy/").concat(this.filename(),".json"),t.next=6,v.XHRFactory.fetch(r);case 6:return o=t.sent,t.next=9,o.json();case 9:a=t.sent,Object.keys(a).sort((function(t,e){var n=t.split("-").map((function(t){return parseInt(t,10)})),r=i(n,4),o=r[0],a=r[1],s=r[2],u=r[3],c=e.split("-").map((function(t){return parseInt(t,10)})),l=i(c,4),d=l[0],f=l[1],h=l[2],p=l[3];return o<d?-1:o>d?1:a<f?-1:a>f?1:s<h?-1:s>h?1:u<p?-1:u>p?1:0})).forEach((function(t){var r=t.split("-").map((function(t){return parseInt(t,10)})),o=i(r,4),u=o[0],c=o[1],l=o[2],d=o[3],f=1&c,h=1&l,p=1&d,m=e[u-1+"-"+(c>>1)+"-"+(l>>1)+"-"+(d>>1)];if(m){m.hasChildren=!0;var v=m.key.step(f,h,p),g=new n(s.ept,v.b,v.d,v.x,v.y,v.z);g.level=u,g.numPoints=a[t],m.addChild(g),e[v.name()]=g}}));case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"doneLoading",value:function(t,e,n,r){t.boundingBox=this.boundingBox,this.geometry=t,this.tightBoundingBox=e,this.numPoints=n,this.mean=r,this.loaded=!0,this.loading=!1,h.Global.numNodesLoading--}},{key:"toPotreeName",value:function(t,e,n,r){for(var i="r",o=0;o<t;++o){var a=1<<t-o-1,s=0;e&a&&(s+=4),n&a&&(s+=2),r&a&&(s+=1),i+=s}return i}},{key:"dispose",value:function(){if(this.geometry&&null!=this.parent){this.geometry.dispose(),this.geometry=null,this.loaded=!1;for(var t=0;t<this.oneTimeDisposeHandlers.length;t++){(0,this.oneTimeDisposeHandlers[t])()}this.oneTimeDisposeHandlers=[]}}}]),n}(f.PointCloudTreeNode);x.IDCount=0},"./source/pointcloud/geometries/PointCloudGreyhoundGeometry.js":function(t,e,n){"use strict";n.r(e),n.d(e,"PointCloudGreyhoundGeometry",(function(){return s})),n.d(e,"PointCloudGreyhoundGeometryNode",(function(){return u}));var r=n("three"),i=n("./source/loaders/GreyhoundLoader.js"),o=n("./source/Global.js"),a=n("./source/pointcloud/PointCloudTree.js"),s=function t(){p(this,t),this.spacing=0,this.boundingBox=null,this.root=null,this.nodes=null,this.pointAttributes={},this.hierarchyStepSize=-1,this.loader=null,this.schema=null,this.baseDepth=null,this.offset=null,this.projection=null,this.boundingSphere=null,this.serverURL=null,this.normalize={color:!1,intensity:!1}};function u(t,e,n,i,o){this.id=u.IDCount++,this.name=t,this.index=parseInt(t.charAt(t.length-1)),this.pcoGeometry=e,this.geometry=null,this.boundingBox=n,this.boundingSphere=n.getBoundingSphere(new r.Sphere),this.scale=i,this.offset=o,this.children={},this.numPoints=0,this.level=null,this.loaded=!1,this.oneTimeDisposeHandlers=[],this.baseLoaded=!1;var a=new r.Vector3,s=this.boundingBox.clone();s.min.sub(this.pcoGeometry.boundingBox.getCenter(a)),s.max.sub(this.pcoGeometry.boundingBox.getCenter(a)),this.scale&&(s.min.multiplyScalar(1/this.scale),s.max.multiplyScalar(1/this.scale)),this.greyhoundBounds=s,this.greyhoundOffset=this.pcoGeometry.offset.clone().add(this.pcoGeometry.boundingBox.getSize(new r.Vector3).multiplyScalar(.5))}u.IDCount=0,u.prototype=Object.create(a.PointCloudTreeNode.prototype),u.prototype.isGeometryNode=function(){return!0},u.prototype.isTreeNode=function(){return!1},u.prototype.isLoaded=function(){return this.loaded},u.prototype.getBoundingSphere=function(){return this.boundingSphere},u.prototype.getBoundingBox=function(){return this.boundingBox},u.prototype.getLevel=function(){return this.level},u.prototype.getChildren=function(){for(var t=[],e=0;e<8;++e)this.children[e]&&t.push(this.children[e]);return t},u.prototype.getURL=function(){var t=this.pcoGeometry.schema,e=this.greyhoundBounds,n=e.min.x+","+e.min.y+","+e.min.z+","+e.max.x+","+e.max.y+","+e.max.z,r=this.pcoGeometry.serverURL+"read?depthBegin="+(this.baseLoaded?this.level+this.pcoGeometry.baseDepth:0)+"&depthEnd="+(this.level+this.pcoGeometry.baseDepth+1)+"&bounds=["+n+"]&schema="+JSON.stringify(t)+"&compress=true";if(this.scale&&(r+="&scale="+this.scale),this.greyhoundOffset){var i=this.greyhoundOffset;r+="&offset=["+i.x+","+i.y+","+i.z+"]"}return this.baseLoaded||(this.baseLoaded=!0),r},u.prototype.addChild=function(t){this.children[t.index]=t,t.parent=this},u.prototype.load=function(){!0===this.loading||!0===this.loaded||o.Global.numNodesLoading>=o.Global.maxNodesLoading||(this.loading=!0,o.Global.numNodesLoading++,this.level%this.pcoGeometry.hierarchyStepSize===0&&this.hasChildren?this.loadHierarchyThenPoints():this.loadPoints())},u.prototype.loadPoints=function(){this.pcoGeometry.loader.load(this)},u.prototype.loadHierarchyThenPoints=function(){var t=[0,2,1,3,4,6,5,7],e=function(e){var n=0;return Object.keys(e).forEach((function(e){"swd"===e?n+=1<<t[0]:"nwd"===e?n+=1<<t[1]:"swu"===e?n+=1<<t[2]:"nwu"===e?n+=1<<t[3]:"sed"===e?n+=1<<t[4]:"ned"===e?n+=1<<t[5]:"seu"===e?n+=1<<t[6]:"neu"===e&&(n+=1<<t[7])})),n},n=function(n,r){var o=[];n.numPoints=r.n,function n(r,i,o){var a,s;Object.keys(r).forEach((function(u){if("n"!==u){switch(u){case"swd":a=r.swd,s=i+t[0];break;case"nwd":a=r.nwd,s=i+t[1];break;case"swu":a=r.swu,s=i+t[2];break;case"nwu":a=r.nwu,s=i+t[3];break;case"sed":a=r.sed,s=i+t[4];break;case"ned":a=r.ned,s=i+t[5];break;case"seu":a=r.seu,s=i+t[6];break;case"neu":a=r.neu,s=i+t[7]}o.push({children:e(a),numPoints:a.n,name:s}),n(a,s,o)}}))}(r,n.name,o);var a={};a[n.name]=n;for(var s=n.pcoGeometry,c=0;c<o.length;c++){var l=o[c].name,d=o[c].numPoints,f=parseInt(l.charAt(l.length-1)),h=a[l.substring(0,l.length-1)],p=l.length-1,m=new u(l,s,i.GreyhoundLoader.createChildAABB(h.boundingBox,f),n.scale,n.offset);m.level=p,m.numPoints=d,m.hasChildren=o[c].children>0,m.spacing=s.spacing/Math.pow(2,p),h.addChild(m),a[l]=m}n.loadPoints()};if(this.level%this.pcoGeometry.hierarchyStepSize===0){var r=this.level+this.pcoGeometry.baseDepth,a=r+this.pcoGeometry.hierarchyStepSize+2,s=this.greyhoundBounds,c=s.min.x+","+s.min.y+","+s.min.z+","+s.max.x+","+s.max.y+","+s.max.z,l=this.pcoGeometry.serverURL+"hierarchy?bounds=["+c+"]&depthBegin="+r+"&depthEnd="+a;if(this.scale&&(l+="&scale="+this.scale),this.greyhoundOffset){var d=this.greyhoundOffset;l+="&offset=["+d.x+","+d.y+","+d.z+"]"}var f=this,h=XHRFactory.createXMLHttpRequest();h.overrideMimeType("text/plain"),h.open("GET",l,!0),h.onload=function(t){try{n(f,JSON.parse(h.responseText)||{})}catch(e){o.Global.numNodesLoading--,console.error("Potree: Exception thrown parsing points.",e)}},h.onerror=function(t){console.log("Potree: Failed to load file! HTTP status "+h.status+", file:"+l,t)},h.send(null)}},u.prototype.getNumPoints=function(){return this.numPoints},u.prototype.dispose=function(){if(this.geometry&&null!=this.parent){this.geometry.dispose(),this.geometry=null,this.loaded=!1;for(var t=0;t<this.oneTimeDisposeHandlers.length;t++){(0,this.oneTimeDisposeHandlers[t])()}this.oneTimeDisposeHandlers=[]}},Object.assign(u.prototype,r.EventDispatcher.prototype)},"./source/pointcloud/geometries/PointCloudOctreeGeometry.js":function(t,e,n){"use strict";n.r(e),n.d(e,"PointCloudOctreeGeometry",(function(){return l})),n.d(e,"PointCloudOctreeGeometryNode",(function(){return d}));var r=n("three"),i=n("./source/loaders/POCLoader.js"),o=n("./source/Global.js"),a=n("./source/pointcloud/PointCloudTree.js"),c=n("./source/XHRFactory.js"),l=function t(){p(this,t),this.url=null,this.octreeDir=null,this.spacing=0,this.boundingBox=null,this.root=null,this.nodes=null,this.pointAttributes=null,this.hierarchyStepSize=-1,this.loader=null},d=function(t){s(n,t);var e=u(n);function n(t,i,o){var a;return p(this,n),(a=e.call(this)).id=n.IDCount++,a.name=t,a.index=parseInt(t.charAt(t.length-1)),a.pcoGeometry=i,a.geometry=null,a.boundingBox=o,a.boundingSphere=o.getBoundingSphere(new r.Sphere),a.children={},a.numPoints=0,a.level=null,a.loaded=!1,a.oneTimeDisposeHandlers=[],a}return m(n,[{key:"isGeometryNode",value:function(){return!0}},{key:"getLevel",value:function(){return this.level}},{key:"isTreeNode",value:function(){return!1}},{key:"isLoaded",value:function(){return this.loaded}},{key:"getBoundingSphere",value:function(){return this.boundingSphere}},{key:"getBoundingBox",value:function(){return this.boundingBox}},{key:"getChildren",value:function(){for(var t=[],e=0;e<8;e++)this.children[e]&&t.push(this.children[e]);return t}},{key:"getURL",value:function(){var t="",e=this.pcoGeometry.loader.version;return e.equalOrHigher("1.5")?t=this.pcoGeometry.octreeDir+"/"+this.getHierarchyPath()+"/"+this.name:(e.equalOrHigher("1.4")||e.upTo("1.3"))&&(t=this.pcoGeometry.octreeDir+"/"+this.name),t}},{key:"getHierarchyPath",value:function(){for(var t="r/",e=this.pcoGeometry.hierarchyStepSize,n=this.name.substr(1),r=Math.floor(n.length/e),i=0;i<r;i++)t+=n.substr(i*e,e)+"/";return t=t.slice(0,-1)}},{key:"addChild",value:function(t){this.children[t.index]=t,t.parent=this}},{key:"load",value:function(){if(!(!0===this.loading||!0===this.loaded||o.Global.numNodesLoading>=o.Global.maxNodesLoading)){this.loading=!0,o.Global.numNodesLoading++;try{this.pcoGeometry.loader.version.equalOrHigher("1.5")&&this.level%this.pcoGeometry.hierarchyStepSize===0&&this.hasChildren?this.loadHierachyThenPoints():this.loadPoints()}catch(t){o.Global.numNodesLoading--,console.error("Potree: Exception thrown loading points file.",t)}}}},{key:"loadPoints",value:function(){this.pcoGeometry.loader.load(this)}},{key:"loadHierachyThenPoints",value:function(){var t=this;if(t.level%t.pcoGeometry.hierarchyStepSize===0){var e=t.pcoGeometry.octreeDir+"/"+t.getHierarchyPath()+"/"+t.name+".hrc",r=c.XHRFactory.createXMLHttpRequest();r.open("GET",e,!0),r.responseType="arraybuffer",r.overrideMimeType("text/plain; charset=x-user-defined"),r.onload=function(e){try{!function(t,e){var r=new DataView(e),o=[],a=r.getUint8(0),s=r.getUint32(1,!0);t.numPoints=s,o.push({children:a,numPoints:s,name:t.name});for(var u=[],c=5;o.length>0;){for(var l=o.shift(),d=1,f=0;f<8;f++){if(0!==(l.children&d)){var h=l.name+f,p=r.getUint8(c),m=r.getUint32(c+1,!0);o.push({children:p,numPoints:m,name:h}),u.push({children:p,numPoints:m,name:h}),c+=5}d*=2}if(c===e.byteLength)break}var v={};v[t.name]=t;var g=t.pcoGeometry;for(f=0;f<u.length;f++){var y=u[f].name,b=u[f].numPoints,x=parseInt(y.charAt(y.length-1)),_=v[y.substring(0,y.length-1)],w=y.length-1,T=new n(y,g,i.POCLoader.createChildAABB(_.boundingBox,x));T.level=w,T.numPoints=b,T.hasChildren=u[f].children>0,T.spacing=g.spacing/Math.pow(2,w),_.addChild(T),v[y]=T}t.loadPoints()}(t,r.response)}catch(a){o.Global.numNodesLoading--,console.error("Potree: Exception thrown parsing points.",a)}},r.onerror=function(t){o.Global.numNodesLoading--,console.error("Potree: Failed to load file.",r.status,e,t)},r.send(null)}}},{key:"getNumPoints",value:function(){return this.numPoints}},{key:"dispose",value:function(){if(this.geometry&&null!=this.parent){this.geometry.dispose(),this.geometry=null,this.loaded=!1;for(var t=0;t<this.oneTimeDisposeHandlers.length;t++){(0,this.oneTimeDisposeHandlers[t])()}this.oneTimeDisposeHandlers=[]}}}]),n}(a.PointCloudTreeNode);d.IDCount=0,Object.assign(d.prototype,r.EventDispatcher.prototype)},"./source/pointcloud/materials/PointCloudMaterial.js":function(t,e,n){"use strict";n.r(e),n.d(e,"PointCloudMaterial",(function(){return d}));var r=n("three"),o=n("./source/utils/HelperUtils.js"),a=n("./source/Gradients.js"),c=n("./source/Shaders.js"),l=n("./source/Potree.js"),d=function(t){s(n,t);var e=u(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this,n),(t=e.call(this)).visibleNodesTexture=o.HelperUtils.generateDataTexture(2048,1,new r.Color(16777215)),t.visibleNodesTexture.minFilter=r.NearestFilter,t.visibleNodesTexture.magFilter=r.NearestFilter;var s=function(t,e){return void 0!==t?t:e},u=s(i.size,1),d=s(i.minSize,2),f=s(i.maxSize,50),h=s(i.treeType,l.TreeType.OCTREE);t._pointSizeType=l.PointSizeType.FIXED,t._shape=l.PointShape.SQUARE,t._pointColorType=l.PointColorType.RGB,t._useClipBox=!1,t._weighted=!1,t._gradient=a.Gradients.SPECTRAL,t._treeType=h,t._useEDL=!1,t._snapEnabled=!1,t._numSnapshots=0,t._defaultIntensityRangeChanged=!1,t._defaultElevationRangeChanged=!1,t.clipBoxes=[],t.clipPolygons=[],t.gradientTexture=n.generateGradientTexture(t._gradient),t.lights=!1,t.fog=!1,t.defines=new Map,t.attributes={position:{type:"fv",value:[]},color:{type:"fv",value:[]},normal:{type:"fv",value:[]},intensity:{type:"f",value:[]},classification:{type:"f",value:[]},returnNumber:{type:"f",value:[]},numberOfReturns:{type:"f",value:[]},pointSourceID:{type:"f",value:[]},indices:{type:"fv",value:[]}},t.uniforms={level:{type:"f",value:0},vnStart:{type:"f",value:0},spacing:{type:"f",value:1},blendHardness:{type:"f",value:2},blendDepthSupplement:{type:"f",value:0},fov:{type:"f",value:1},screenWidth:{type:"f",value:1},screenHeight:{type:"f",value:1},near:{type:"f",value:.1},far:{type:"f",value:1},uColor:{type:"c",value:new r.Color(16777215)},uOpacity:{type:"f",value:1},size:{type:"f",value:u},minSize:{type:"f",value:d},maxSize:{type:"f",value:f},octreeSize:{type:"f",value:0},bbSize:{type:"fv",value:[0,0,0]},elevationRange:{type:"2fv",value:[0,0]},clipBoxCount:{type:"f",value:0},clipPolygonCount:{type:"i",value:0},clipBoxes:{type:"Matrix4fv",value:[]},clipPolygons:{type:"3fv",value:[]},clipPolygonVCount:{type:"iv",value:[]},clipPolygonVP:{type:"Matrix4fv",value:[]},visibleNodes:{type:"t",value:t.visibleNodesTexture},pcIndex:{type:"f",value:0},gradient:{type:"t",value:t.gradientTexture},classificationLUT:{type:"t",value:t.classificationTexture},uHQDepthMap:{type:"t",value:null},toModel:{type:"Matrix4f",value:[]},diffuse:{type:"fv",value:[1,1,1]},transition:{type:"f",value:.5},intensityRange:{type:"fv",value:[0,65e3]},intensityGamma:{type:"f",value:1},intensityContrast:{type:"f",value:0},intensityBrightness:{type:"f",value:0},rgbGamma:{type:"f",value:1},rgbContrast:{type:"f",value:0},rgbBrightness:{type:"f",value:0},wRGB:{type:"f",value:1},wIntensity:{type:"f",value:0},wElevation:{type:"f",value:0},wClassification:{type:"f",value:0},wReturnNumber:{type:"f",value:0},wSourceID:{type:"f",value:0},useOrthographicCamera:{type:"b",value:!1},clipTask:{type:"i",value:1},clipMethod:{type:"i",value:1},uSnapshot:{type:"tv",value:[]},uSnapshotDepth:{type:"tv",value:[]},uSnapView:{type:"Matrix4fv",value:[]},uSnapProj:{type:"Matrix4fv",value:[]},uSnapProjInv:{type:"Matrix4fv",value:[]},uSnapViewInv:{type:"Matrix4fv",value:[]},uShadowColor:{type:"3fv",value:[0,0,0]},uFilterReturnNumberRange:{type:"fv",value:[0,7]},uFilterNumberOfReturnsRange:{type:"fv",value:[0,7]},uFilterGPSTimeClipRange:{type:"fv",value:[0,7]}},t.classification=l.Classification.DEFAULT,t.defaultAttributeValues.normal=[0,0,0],t.defaultAttributeValues.classification=[0,0,0],t.defaultAttributeValues.indices=[0,0,0,0];var m=t.getDefines();return t.vertexShader=m+c.Shaders.vertex,t.fragmentShader=m+c.Shaders.fragment,t.vertexColors=r.VertexColors,t}return m(n,[{key:"setDefine",value:function(t,e){void 0!==e&&null!==e?this.defines.get(t)!==e&&(this.defines.set(t,e),this.updateShaderSource()):this.removeDefine(t)}},{key:"removeDefine",value:function(t){this.defines.delete(t)}},{key:"updateShaderSource",value:function(){var t=this.getDefines();this.vertexShader=t+c.Shaders.vertex,this.fragmentShader=t+c.Shaders.fragment,1===this.opacity?(this.blending=r.NoBlending,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.depthFunc=r.LessEqualDepth):this.opacity<1&&!this.useEDL&&(this.blending=r.AdditiveBlending,this.transparent=!0,this.depthTest=!1,this.depthWrite=!0,this.depthFunc=r.AlwaysDepth),this.weighted&&(this.blending=r.AdditiveBlending,this.transparent=!0,this.depthTest=!0,this.depthWrite=!1),this.needsUpdate=!0}},{key:"onBeforeCompile",value:function(t,e){if(e.capabilities.logarithmicDepthBuffer){var n="#define USE_LOGDEPTHBUF\n#define USE_LOGDEPTHBUF_EXT\n#define EPSILON 1e-6\n";t.fragmentShader=n+t.fragmentShader,t.vertexShader=n+t.vertexShader}}},{key:"getDefines",value:function(){var t=[];this.pointSizeType===l.PointSizeType.FIXED?t.push("#define fixed_point_size"):this.pointSizeType===l.PointSizeType.ATTENUATED?t.push("#define attenuated_point_size"):this.pointSizeType===l.PointSizeType.ADAPTIVE&&t.push("#define adaptive_point_size"),this.shape===l.PointShape.SQUARE?t.push("#define square_point_shape"):this.shape===l.PointShape.CIRCLE?t.push("#define circle_point_shape"):this.shape===l.PointShape.PARABOLOID&&t.push("#define paraboloid_point_shape"),this._useEDL&&t.push("#define use_edl"),this._snapEnabled&&t.push("#define snap_enabled"),this._pointColorType===l.PointColorType.RGB?t.push("#define color_type_rgb"):this._pointColorType===l.PointColorType.COLOR?t.push("#define color_type_color"):this._pointColorType===l.PointColorType.DEPTH?t.push("#define color_type_depth"):this._pointColorType===l.PointColorType.HEIGHT?t.push("#define color_type_height"):this._pointColorType===l.PointColorType.INTENSITY?t.push("#define color_type_intensity"):this._pointColorType===l.PointColorType.INTENSITY_GRADIENT?t.push("#define color_type_intensity_gradient"):this._pointColorType===l.PointColorType.LOD?t.push("#define color_type_lod"):this._pointColorType===l.PointColorType.POINT_INDEX?t.push("#define color_type_point_index"):this._pointColorType===l.PointColorType.CLASSIFICATION?t.push("#define color_type_classification"):this._pointColorType===l.PointColorType.RETURN_NUMBER?t.push("#define color_type_return_number"):this._pointColorType===l.PointColorType.SOURCE?t.push("#define color_type_source"):this._pointColorType===l.PointColorType.NORMAL?t.push("#define color_type_normal"):this._pointColorType===l.PointColorType.PHONG?t.push("#define color_type_phong"):this._pointColorType===l.PointColorType.RGB_HEIGHT?t.push("#define color_type_rgb_height"):this._pointColorType===l.PointColorType.COMPOSITE&&t.push("#define color_type_composite"),this._treeType===l.TreeType.OCTREE?t.push("#define tree_type_octree"):this._treeType===l.TreeType.KDTREE&&t.push("#define tree_type_kdtree"),this.weighted&&t.push("#define weighted_splats");var e,n=f(this.defines);try{for(n.s();!(e=n.n()).done;){var r=i(e.value,2),o=(r[0],r[1]);t.push(o)}}catch(a){n.e(a)}finally{n.f()}return t.join("\n")}},{key:"setClipBoxes",value:function(t){if(t){var e=this.clipBoxes.length!==t.length&&(0===t.length||0===this.clipBoxes.length);this.uniforms.clipBoxCount.value=this.clipBoxes.length,this.clipBoxes=t,e&&this.updateShaderSource(),this.uniforms.clipBoxes.value=new Float32Array(16*this.clipBoxes.length);for(var n=0;n<this.clipBoxes.length;n++){var r=t[n];this.uniforms.clipBoxes.value.set(r.inverse.elements,16*n)}for(n=0;n<this.uniforms.clipBoxes.value.length;n++)Number.isNaN(this.uniforms.clipBoxes.value[n])&&(this.uniforms.clipBoxes.value[n]=1/0)}}},{key:"setClipPolygons",value:function(t,e){t&&(this.clipPolygons=t,this.clipPolygons.length!==t.length&&this.updateShaderSource())}},{key:"recomputeClassification",value:function(){this.classificationTexture=n.generateClassificationTexture(this._classification),this.uniforms.classificationLUT.value=this.classificationTexture,this.dispatchEvent({type:"material_property_changed",target:this})}},{key:"disableEvents",value:function(){void 0===this._hiddenListeners&&(this._hiddenListeners=this._listeners,this._listeners={})}},{key:"enableEvents",value:function(){this._listeners=this._hiddenListeners,this._hiddenListeners=void 0}},{key:"copyFrom",value:function(t){var e,n=f(this.uniforms);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.uniforms[r].value=t.uniforms[r].value}}catch(i){n.e(i)}finally{n.f()}}},{key:"gradient",get:function(){return this._gradient},set:function(t){this._gradient!==t&&(this._gradient=t,this.gradientTexture=n.generateGradientTexture(this._gradient),this.uniforms.gradient.value=this.gradientTexture)}},{key:"useOrthographicCamera",get:function(){return this.uniforms.useOrthographicCamera.value},set:function(t){this.uniforms.useOrthographicCamera.value!==t&&(this.uniforms.useOrthographicCamera.value=t)}},{key:"classification",get:function(){return this._classification},set:function(t){for(var e={},n=0,r=Object.keys(t);n<r.length;n++){e[s=r[n]]=t[s].clone()}var i=!1;if(void 0===this._classification)i=!1;else{i=Object.keys(e).length===Object.keys(this._classification).length;for(var o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];i=(i=i&&void 0!==this._classification[s])&&e[s].equals(this._classification[s])}}i||(this._classification=e,this.recomputeClassification())}},{key:"numSnapshots",get:function(){return this._numSnapshots},set:function(t){this._numSnapshots=t}},{key:"snapEnabled",get:function(){return this._snapEnabled},set:function(t){this._snapEnabled!==t&&(this._snapEnabled=t,this.updateShaderSource())}},{key:"spacing",get:function(){return this.uniforms.spacing.value},set:function(t){this.uniforms.spacing.value!==t&&(this.uniforms.spacing.value=t)}},{key:"useClipBox",get:function(){return this._useClipBox},set:function(t){this._useClipBox!==t&&(this._useClipBox=t,this.updateShaderSource())}},{key:"clipTask",get:function(){return this.uniforms.clipTask.value},set:function(t){this.uniforms.clipTask.value=t}},{key:"clipMethod",get:function(){return this.uniforms.clipMethod.value},set:function(t){this.uniforms.clipMethod.value=t}},{key:"weighted",get:function(){return this._weighted},set:function(t){this._weighted!==t&&(this._weighted=t,this.updateShaderSource())}},{key:"fov",get:function(){return this.uniforms.fov.value},set:function(t){this.uniforms.fov.value!==t&&(this.uniforms.fov.value=t,this.updateShaderSource())}},{key:"screenWidth",get:function(){return this.uniforms.screenWidth.value},set:function(t){this.uniforms.screenWidth.value!==t&&(this.uniforms.screenWidth.value=t,this.updateShaderSource())}},{key:"screenHeight",get:function(){return this.uniforms.screenHeight.value},set:function(t){this.uniforms.screenHeight.value!==t&&(this.uniforms.screenHeight.value=t,this.updateShaderSource())}},{key:"near",get:function(){return this.uniforms.near.value},set:function(t){this.uniforms.near.value!==t&&(this.uniforms.near.value=t)}},{key:"far",get:function(){return this.uniforms.far.value},set:function(t){this.uniforms.far.value!==t&&(this.uniforms.far.value=t)}},{key:"opacity",get:function(){return this.uniforms.uOpacity.value},set:function(t){this.uniforms&&this.uniforms.uOpacity&&this.uniforms.uOpacity.value!==t&&(this.uniforms.uOpacity.value=t,this.updateShaderSource(),this.dispatchEvent({type:"opacity_changed",target:this}),this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"pointColorType",get:function(){return this._pointColorType},set:function(t){this._pointColorType!==t&&(this._pointColorType=t,this.updateShaderSource(),this.dispatchEvent({type:"point_color_type_changed",target:this}),this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"pointSizeType",get:function(){return this._pointSizeType},set:function(t){this._pointSizeType!==t&&(this._pointSizeType=t,this.updateShaderSource(),this.dispatchEvent({type:"point_size_type_changed",target:this}),this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"useEDL",get:function(){return this._useEDL},set:function(t){this._useEDL!==t&&(this._useEDL=t,this.updateShaderSource())}},{key:"color",get:function(){return this.uniforms.uColor.value},set:function(t){this.uniforms.uColor.value.equals(t)||(this.uniforms.uColor.value.copy(t),this.dispatchEvent({type:"color_changed",target:this}),this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"shape",get:function(){return this._shape},set:function(t){this._shape!==t&&(this._shape=t,this.updateShaderSource(),this.dispatchEvent({type:"point_shape_changed",target:this}),this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"treeType",get:function(){return this._treeType},set:function(t){this._treeType!==t&&(this._treeType=t,this.updateShaderSource())}},{key:"bbSize",get:function(){return this.uniforms.bbSize.value},set:function(t){this.uniforms.bbSize.value=t}},{key:"size",get:function(){return this.uniforms.size.value},set:function(t){this.uniforms.size.value!==t&&(this.uniforms.size.value=t,this.dispatchEvent({type:"point_size_changed",target:this}),this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"elevationRange",get:function(){return this.uniforms.elevationRange.value},set:function(t){(this.uniforms.elevationRange.value[0]!==t[0]||this.uniforms.elevationRange.value[1]!==t[1])&&(this.uniforms.elevationRange.value=t,this._defaultElevationRangeChanged=!0,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"heightMin",get:function(){return this.uniforms.elevationRange.value[0]},set:function(t){this.elevationRange=[t,this.elevationRange[1]]}},{key:"heightMax",get:function(){return this.uniforms.elevationRange.value[1]},set:function(t){this.elevationRange=[this.elevationRange[0],t]}},{key:"transition",get:function(){return this.uniforms.transition.value},set:function(t){this.uniforms.transition.value=t}},{key:"intensityRange",get:function(){return this.uniforms.intensityRange.value},set:function(t){t instanceof Array&&2===t.length&&(t[0]===this.uniforms.intensityRange.value[0]&&t[1]===this.uniforms.intensityRange.value[1]||(this.uniforms.intensityRange.value=t,this._defaultIntensityRangeChanged=!0,this.dispatchEvent({type:"material_property_changed",target:this})))}},{key:"intensityGamma",get:function(){return this.uniforms.intensityGamma.value},set:function(t){this.uniforms.intensityGamma.value!==t&&(this.uniforms.intensityGamma.value=t,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"intensityContrast",get:function(){return this.uniforms.intensityContrast.value},set:function(t){this.uniforms.intensityContrast.value!==t&&(this.uniforms.intensityContrast.value=t,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"intensityBrightness",get:function(){return this.uniforms.intensityBrightness.value},set:function(t){this.uniforms.intensityBrightness.value!==t&&(this.uniforms.intensityBrightness.value=t,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"rgbGamma",get:function(){return this.uniforms.rgbGamma.value},set:function(t){this.uniforms.rgbGamma.value!==t&&(this.uniforms.rgbGamma.value=t,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"rgbContrast",get:function(){return this.uniforms.rgbContrast.value},set:function(t){this.uniforms.rgbContrast.value!==t&&(this.uniforms.rgbContrast.value=t,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"rgbBrightness",get:function(){return this.uniforms.rgbBrightness.value},set:function(t){this.uniforms.rgbBrightness.value!==t&&(this.uniforms.rgbBrightness.value=t,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"weightRGB",get:function(){return this.uniforms.wRGB.value},set:function(t){this.uniforms.wRGB.value!==t&&(this.uniforms.wRGB.value=t,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"weightIntensity",get:function(){return this.uniforms.wIntensity.value},set:function(t){this.uniforms.wIntensity.value!==t&&(this.uniforms.wIntensity.value=t,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"weightElevation",get:function(){return this.uniforms.wElevation.value},set:function(t){this.uniforms.wElevation.value!==t&&(this.uniforms.wElevation.value=t,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"weightClassification",get:function(){return this.uniforms.wClassification.value},set:function(t){this.uniforms.wClassification.value!==t&&(this.uniforms.wClassification.value=t,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"weightReturnNumber",get:function(){return this.uniforms.wReturnNumber.value},set:function(t){this.uniforms.wReturnNumber.value!==t&&(this.uniforms.wReturnNumber.value=t,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"weightSourceID",get:function(){return this.uniforms.wSourceID.value},set:function(t){this.uniforms.wSourceID.value!==t&&(this.uniforms.wSourceID.value=t,this.dispatchEvent({type:"material_property_changed",target:this}))}}],[{key:"generateGradientTexture",value:function(t){var e=document.createElement("canvas");e.width=64,e.height=64;var n=e.getContext("2d");n.rect(0,0,64,64);for(var i=n.createLinearGradient(0,0,64,64),o=0;o<t.length;o++){var a=t[o];i.addColorStop(a[0],"#"+a[1].getHexString())}n.fillStyle=i,n.fill();var s=new r.CanvasTexture(e);return s.needsUpdate=!0,s.minFilter=r.LinearFilter,s}},{key:"generateClassificationTexture",value:function(t){for(var e=new Uint8Array(262144),n=0;n<256;n++)for(var i=0;i<256;i++){var o,a=n+256*i;o=t[n]?t[n]:t[n%32]?t[n%32]:t.DEFAULT,e[4*a+0]=255*o.x,e[4*a+1]=255*o.y,e[4*a+2]=255*o.z,e[4*a+3]=255*o.w}var s=new r.DataTexture(e,256,256,r.RGBAFormat);return s.magFilter=r.NearestFilter,s.needsUpdate=!0,s}}]),n}(r.RawShaderMaterial)},"./source/utils/HelperUtils.js":function(t,e,n){"use strict";n.r(e),n.d(e,"HelperUtils",(function(){return i}));var r=n("three"),i=function(){function t(){p(this,t)}return m(t,null,[{key:"generateDataTexture",value:function(t,e,n){for(var i=t*e,o=new Uint8Array(4*t*e),a=Math.floor(255*n.r),s=Math.floor(255*n.g),u=Math.floor(255*n.b),c=0;c<i;c++)o[3*c]=a,o[3*c+1]=s,o[3*c+2]=u;var l=new r.DataTexture(o,t,e,r.RGBAFormat);return l.needsUpdate=!0,l.magFilter=r.NearestFilter,l}},{key:"computeTransformedBoundingBox",value:function(t,e){var n=[new r.Vector3(t.min.x,t.min.y,t.min.z).applyMatrix4(e),new r.Vector3(t.min.x,t.min.y,t.min.z).applyMatrix4(e),new r.Vector3(t.max.x,t.min.y,t.min.z).applyMatrix4(e),new r.Vector3(t.min.x,t.max.y,t.min.z).applyMatrix4(e),new r.Vector3(t.min.x,t.min.y,t.max.z).applyMatrix4(e),new r.Vector3(t.min.x,t.max.y,t.max.z).applyMatrix4(e),new r.Vector3(t.max.x,t.max.y,t.min.z).applyMatrix4(e),new r.Vector3(t.max.x,t.min.y,t.max.z).applyMatrix4(e),new r.Vector3(t.max.x,t.max.y,t.max.z).applyMatrix4(e)],i=new r.Box3;return i.setFromPoints(n),i}}]),t}()},"./source/utils/LRU.js":function(t,e,n){"use strict";n.r(e),n.d(e,"LRU",(function(){return o})),n.d(e,"LRUItem",(function(){return i}));var r=n("./source/Global.js"),i=function t(e){p(this,t),this.previous=null,this.next=null,this.node=e},o=function(){function t(){p(this,t),this.first=null,this.last=null,this.items={},this.elements=0,this.numPoints=0}return m(t,[{key:"size",value:function(){return this.elements}},{key:"contains",value:function(t){return null==this.items[t.id]}},{key:"touch",value:function(t){var e;t.loaded&&(null==this.items[t.id]?((e=new i(t)).previous=this.last,this.last=e,null!==e.previous&&(e.previous.next=e),this.items[t.id]=e,this.elements++,null===this.first&&(this.first=e),this.numPoints+=t.numPoints):null===(e=this.items[t.id]).previous?null!==e.next&&(this.first=e.next,this.first.previous=null,e.previous=this.last,e.next=null,this.last=e,e.previous.next=e):null!==e.next&&(e.previous.next=e.next,e.next.previous=e.previous,e.previous=this.last,e.next=null,this.last=e,e.previous.next=e))}},{key:"remove",value:function(t){var e=this.items[t.id];e&&(1===this.elements?(this.first=null,this.last=null):(e.previous||(this.first=e.next,this.first.previous=null),e.next||(this.last=e.previous,this.last.next=null),e.previous&&e.next&&(e.previous.next=e.next,e.next.previous=e.previous)),delete this.items[t.id],this.elements--,this.numPoints-=t.numPoints)}},{key:"getLRUItem",value:function(){return null===this.first?null:this.first.node}},{key:"toString",value:function(){for(var t="{ ",e=this.first;null!==e;)t+=e.node.id,null!==e.next&&(t+=", "),e=e.next;return t+="}",t+="("+this.size()+")"}},{key:"freeMemory",value:function(){if(!(this.elements<=1))for(;this.numPoints>r.Global.pointLoadLimit;){var t=this.first.node;this.disposeDescendants(t)}}},{key:"disposeDescendants",value:function(t){var e=[];for(e.push(t);e.length>0;){var n=e.pop();for(var r in n.dispose(),this.remove(n),n.children){if(n.children.hasOwnProperty(r))n.children[r].loaded&&e.push(n.children[r])}}}}]),t}()},"./source/utils/VersionUtils.js":function(t,e,n){"use strict";function r(t){this.version=t;var e=-1===t.indexOf(".")?t.length:t.indexOf(".");this.versionMajor=parseInt(t.substr(0,e)),this.versionMinor=parseInt(t.substr(e+1)),0===this.versionMinor.length&&(this.versionMinor=0)}n.r(e),n.d(e,"VersionUtils",(function(){return r})),r.prototype.newerThan=function(t){var e=new r(t);return this.versionMajor>e.versionMajor||this.versionMajor===e.versionMajor&&this.versionMinor>e.versionMinor},r.prototype.equalOrHigher=function(t){var e=new r(t);return this.versionMajor>e.versionMajor||this.versionMajor===e.versionMajor&&this.versionMinor>=e.versionMinor},r.prototype.upTo=function(t){return!this.newerThan(t)}},"./source/utils/WorkerManager.js":function(t,e,n){"use strict";n.r(e),n.d(e,"WorkerManager",(function(){return h}));n("./source/Global.js");var r=n("./source/workers/BinaryDecoderWorker.js"),i=n.n(r),o=n("./source/workers/LASDecoderWorker.js"),a=n.n(o),s=n("./source/workers/DEMWorker.js"),u=n.n(s),c=n("./source/workers/EptLaszipDecoderWorker.js"),l=n.n(c),d=n("./source/workers/EptBinaryDecoderWorker.js"),f=n.n(d),h=function(){function t(){p(this,t),this.workers=[];for(var e=0;e<7;e++)this.workers.push([])}return m(t,[{key:"getWorker",value:function(t){if(this.workers[t].length>0)return this.workers[t].pop();switch(t){case 0:return new i.a;case 1:throw"LASLAZWorker not implemented";case 2:return new a.a;case 3:throw"GreyhoundBinaryDecoderWorker not implemented";case 4:return new u.a;case 5:return new l.a;case 6:return new f.a}}},{key:"returnWorker",value:function(t,e){this.workers[t].push(e)}},{key:"runTask",value:function(t,e,n,r){var i=this,o=this.getWorker(t);o.onmessage=function(n){e(n),i.returnWorker(t,o)},void 0!==r?o.postMessage(n,r):o.postMessage(n)}}]),t}();h.BINARY_DECODER=0,h.LAS_LAZ=1,h.LAS_DECODER=2,h.GREYHOUND=3,h.DEM=4,h.EPT_LAS_ZIP_DECODER=5,h.EPT_BINARY_DECODER=6},"./source/workers/BinaryDecoderWorker.js":function(t,e,n){t.exports=function(){return n("./node_modules/worker-loader/dist/workers/InlineWorker.js")("/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = \"./source/workers/BinaryDecoderWorker.js\");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./source/workers/BinaryDecoderWorker.js\":\n/*!***********************************************!*\\\n  !*** ./source/workers/BinaryDecoderWorker.js ***!\n  \\***********************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nfunction CustomView(buffer)\n{\n\tthis.buffer = buffer;\n\tthis.u8 = new Uint8Array(buffer);\n\n\tvar tmp = new ArrayBuffer(4);\n\tvar tmpf = new Float32Array(tmp);\n\tvar tmpu8 = new Uint8Array(tmp);\n\n\tthis.getUint32 = function(i)\n\t{\n\t\treturn (this.u8[i + 3] << 24) | (this.u8[i + 2] << 16) | (this.u8[i + 1] << 8) | this.u8[i];\n\t};\n\n\tthis.getUint16 = function(i)\n\t{\n\t\treturn (this.u8[i + 1] << 8) | this.u8[i];\n\t};\n\n\tthis.getFloat32 = function(i)\n\t{\n\t\ttmpu8[0] = this.u8[i + 0];\n\t\ttmpu8[1] = this.u8[i + 1];\n\t\ttmpu8[2] = this.u8[i + 2];\n\t\ttmpu8[3] = this.u8[i + 3];\n\n\t\treturn tmpf[0];\n\t};\n\n\tthis.getUint8 = function(i)\n\t{\n\t\treturn this.u8[i];\n\t};\n}\n\nonmessage = function(event)\n{\n  if (!event.data || !event.data.buffer) {\n    return;\n  }\n\ttry\n\t{\n\t\tvar buffer = event.data.buffer;\n\t\tvar pointAttributes = event.data.pointAttributes;\n\t\tvar numPoints = buffer.byteLength / pointAttributes.byteSize;\n\t\tvar cv = new CustomView(buffer);\n\t\tvar version = new Version(event.data.version);\n\t\tvar nodeOffset = event.data.offset;\n\t\tvar scale = event.data.scale;\n\t\tvar spacing = event.data.spacing;\n\t\tvar hasChildren = event.data.hasChildren;\n\t\tvar name = event.data.name;\n\t\t\n\t\tvar tightBoxMin = [ Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY ];\n\t\tvar tightBoxMax = [ Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY ];\n\t\tvar mean = [0, 0, 0];\n\n\t\tvar attributeBuffers = {};\n\t\tvar inOffset = 0;\n\n\t\tfor(var pointAttribute of pointAttributes.attributes)\n\t\t{\n\t\t\tif(pointAttribute.name === PointAttribute.POSITION_CARTESIAN.name)\n\t\t\t{\n\t\t\t\tvar buff = new ArrayBuffer(numPoints * 4 * 3);\n\t\t\t\tvar positions = new Float32Array(buff);\n\t\t\t\n\t\t\t\tfor(var j = 0; j < numPoints; j++)\n\t\t\t\t{\n\t\t\t\t\tvar x, y, z;\n\n\t\t\t\t\tif(version.newerThan(\"1.3\"))\n\t\t\t\t\t{\n\t\t\t\t\t\tx = (cv.getUint32(inOffset + j * pointAttributes.byteSize + 0, true) * scale);\n\t\t\t\t\t\ty = (cv.getUint32(inOffset + j * pointAttributes.byteSize + 4, true) * scale);\n\t\t\t\t\t\tz = (cv.getUint32(inOffset + j * pointAttributes.byteSize + 8, true) * scale);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tx = cv.getFloat32(j * pointAttributes.byteSize + 0, true) + nodeOffset[0];\n\t\t\t\t\t\ty = cv.getFloat32(j * pointAttributes.byteSize + 4, true) + nodeOffset[1];\n\t\t\t\t\t\tz = cv.getFloat32(j * pointAttributes.byteSize + 8, true) + nodeOffset[2];\n\t\t\t\t\t}\n\n\t\t\t\t\tpositions[3 * j + 0] = x;\n\t\t\t\t\tpositions[3 * j + 1] = y;\n\t\t\t\t\tpositions[3 * j + 2] = z;\n\n\t\t\t\t\tmean[0] += x / numPoints;\n\t\t\t\t\tmean[1] += y / numPoints;\n\t\t\t\t\tmean[2] += z / numPoints;\n\n\t\t\t\t\ttightBoxMin[0] = Math.min(tightBoxMin[0], x);\n\t\t\t\t\ttightBoxMin[1] = Math.min(tightBoxMin[1], y);\n\t\t\t\t\ttightBoxMin[2] = Math.min(tightBoxMin[2], z);\n\n\t\t\t\t\ttightBoxMax[0] = Math.max(tightBoxMax[0], x);\n\t\t\t\t\ttightBoxMax[1] = Math.max(tightBoxMax[1], y);\n\t\t\t\t\ttightBoxMax[2] = Math.max(tightBoxMax[2], z);\n\t\t\t\t}\n\n\t\t\t\tattributeBuffers[pointAttribute.name] = {buffer: buff, attribute: pointAttribute};\n\t\t\t} else if(pointAttribute.name === PointAttribute.COLOR_PACKED.name)\n\t\t\t{\n\t\t\t\tvar buff = new ArrayBuffer(numPoints * 4);\n\t\t\t\tvar colors = new Uint8Array(buff);\n\n\t\t\t\tfor(var j = 0; j < numPoints; j++)\n\t\t\t\t{\n\t\t\t\t\tcolors[4 * j + 0] = cv.getUint8(inOffset + j * pointAttributes.byteSize + 0);\n\t\t\t\t\tcolors[4 * j + 1] = cv.getUint8(inOffset + j * pointAttributes.byteSize + 1);\n\t\t\t\t\tcolors[4 * j + 2] = cv.getUint8(inOffset + j * pointAttributes.byteSize + 2);\n\t\t\t\t}\n\n\t\t\t\tattributeBuffers[pointAttribute.name] = {buffer: buff, attribute: pointAttribute};\n\t\t\t}\n\t\t\telse if(pointAttribute.name === PointAttribute.INTENSITY.name)\n\t\t\t{\n\t\t\t\tvar buff = new ArrayBuffer(numPoints * 4);\n\t\t\t\tvar intensities = new Float32Array(buff);\n\n\t\t\t\tfor(var j = 0; j < numPoints; j++)\n\t\t\t\t{\n\t\t\t\t\tvar intensity = cv.getUint16(inOffset + j * pointAttributes.byteSize, true);\n\t\t\t\t\tintensities[j] = intensity;\n\t\t\t\t}\n\n\t\t\t\tattributeBuffers[pointAttribute.name] = {buffer: buff, attribute: pointAttribute};\n\t\t\t}\n\t\t\telse if(pointAttribute.name === PointAttribute.CLASSIFICATION.name)\n\t\t\t{\n\t\t\t\tvar buff = new ArrayBuffer(numPoints);\n\t\t\t\tvar classifications = new Uint8Array(buff);\n\n\t\t\t\tfor(var j = 0; j < numPoints; j++)\n\t\t\t\t{\n\t\t\t\t\tvar classification = cv.getUint8(inOffset + j * pointAttributes.byteSize);\n\t\t\t\t\tclassifications[j] = classification;\n\t\t\t\t}\n\n\t\t\t\tattributeBuffers[pointAttribute.name] = {buffer: buff, attribute: pointAttribute};\n\t\t\t}\n\t\t\telse if(pointAttribute.name === PointAttribute.NORMAL_SPHEREMAPPED.name)\n\t\t\t{\n\t\t\t\tvar buff = new ArrayBuffer(numPoints * 4 * 3);\n\t\t\t\tvar normals = new Float32Array(buff);\n\n\t\t\t\tfor(var j = 0; j < numPoints; j++)\n\t\t\t\t{\n\t\t\t\t\tvar bx = cv.getUint8(inOffset + j * pointAttributes.byteSize + 0);\n\t\t\t\t\tvar by = cv.getUint8(inOffset + j * pointAttributes.byteSize + 1);\n\n\t\t\t\t\tvar ex = bx / 255;\n\t\t\t\t\tvar ey = by / 255;\n\n\t\t\t\t\tvar nx = ex * 2 - 1;\n\t\t\t\t\tvar ny = ey * 2 - 1;\n\t\t\t\t\tvar nz = 1;\n\t\t\t\t\tvar nw = -1;\n\n\t\t\t\t\tvar l = (nx * (-nx)) + (ny * (-ny)) + (nz * (-nw));\n\t\t\t\t\tnz = l;\n\t\t\t\t\tnx = nx * Math.sqrt(l);\n\t\t\t\t\tny = ny * Math.sqrt(l);\n\n\t\t\t\t\tnx = nx * 2;\n\t\t\t\t\tny = ny * 2;\n\t\t\t\t\tnz = nz * 2 - 1;\n\n\t\t\t\t\tnormals[3 * j + 0] = nx;\n\t\t\t\t\tnormals[3 * j + 1] = ny;\n\t\t\t\t\tnormals[3 * j + 2] = nz;\n\t\t\t\t}\n\n\t\t\t\tattributeBuffers[pointAttribute.name] = {buffer: buff, attribute: pointAttribute};\n\t\t\t}\n\t\t\telse if(pointAttribute.name === PointAttribute.NORMAL_OCT16.name)\n\t\t\t{\n\t\t\t\tvar buff = new ArrayBuffer(numPoints * 4 * 3);\n\t\t\t\tvar normals = new Float32Array(buff);\n\n\t\t\t\tfor(var j = 0; j < numPoints; j++) {\n\t\t\t\t\tvar bx = cv.getUint8(inOffset + j * pointAttributes.byteSize + 0);\n\t\t\t\t\tvar by = cv.getUint8(inOffset + j * pointAttributes.byteSize + 1);\n\n\t\t\t\t\tvar u = (bx / 255) * 2 - 1;\n\t\t\t\t\tvar v = (by / 255) * 2 - 1;\n\n\t\t\t\t\tvar z = 1 - Math.abs(u) - Math.abs(v);\n\n\t\t\t\t\tvar x = 0;\n\t\t\t\t\tvar y = 0;\n\t\t\t\t\tif(z >= 0) {\n\t\t\t\t\t\tx = u;\n\t\t\t\t\t\ty = v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tx = -(v / Math.sign(v) - 1) / Math.sign(u);\n\t\t\t\t\t\ty = -(u / Math.sign(u) - 1) / Math.sign(v);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar length = Math.sqrt(x * x + y * y + z * z);\n\t\t\t\t\tx = x / length;\n\t\t\t\t\ty = y / length;\n\t\t\t\t\tz = z / length;\n\t\t\t\t\t\n\t\t\t\t\tnormals[3 * j + 0] = x;\n\t\t\t\t\tnormals[3 * j + 1] = y;\n\t\t\t\t\tnormals[3 * j + 2] = z;\n\t\t\t\t}\n\n\t\t\t\tattributeBuffers[pointAttribute.name] = {buffer: buff, attribute: pointAttribute};\n\t\t\t} else if(pointAttribute.name === PointAttribute.NORMAL.name) {\n\t\t\t\tvar buff = new ArrayBuffer(numPoints * 4 * 3);\n\t\t\t\tvar normals = new Float32Array(buff);\n\n\t\t\t\tfor(var j = 0; j < numPoints; j++) {\n\t\t\t\t\tvar x = cv.getFloat32(inOffset + j * pointAttributes.byteSize + 0, true);\n\t\t\t\t\tvar y = cv.getFloat32(inOffset + j * pointAttributes.byteSize + 4, true);\n\t\t\t\t\tvar z = cv.getFloat32(inOffset + j * pointAttributes.byteSize + 8, true);\n\t\t\t\t\t\n\t\t\t\t\tnormals[3 * j + 0] = x;\n\t\t\t\t\tnormals[3 * j + 1] = y;\n\t\t\t\t\tnormals[3 * j + 2] = z;\n\t\t\t\t}\n\n\t\t\t\tattributeBuffers[pointAttribute.name] = {buffer: buff, attribute: pointAttribute};\n\t\t\t}\n\n\t\t\tinOffset += pointAttribute.byteSize;\n\t\t}\n\n\t\t//add indices\n\t\tvar buff = new ArrayBuffer(numPoints * 4);\n\t\tvar indices = new Uint32Array(buff);\n\n\t\tfor(var i = 0; i < numPoints; i++)\n\t\t{\n\t\t\tindices[i] = i;\n\t\t}\n\t\t\n\t\tattributeBuffers[PointAttribute.INDICES.name] = {buffer: buff, attribute: PointAttribute.INDICES};\n\n\t\tvar message =\n\t\t{\n\t\t\tbuffer: buffer,\n\t\t\tmean: mean,\n\t\t\tattributeBuffers: attributeBuffers,\n\t\t\ttightBoundingBox: {min: tightBoxMin, max: tightBoxMax},\n\t\t};\n\n\t\tvar transferables = [];\n\t\tfor(var property in message.attributeBuffers)\n\t\t{\n\t\t\ttransferables.push(message.attributeBuffers[property].buffer);\n\t\t}\n\t\ttransferables.push(buffer);\n\n\t\tpostMessage(message, transferables);\n\t}\n\tcatch(e)\n\t{\n\t\tpostMessage({error: \"Exeption thrown during execution.\"});\n\t}\n};\n\n\nfunction Version(version)\n{\n\tthis.version = version;\n\tvar vmLength = (version.indexOf(\".\") === -1) ? version.length : version.indexOf(\".\");\n\tthis.versionMajor = parseInt(version.substr(0, vmLength));\n\tthis.versionMinor = parseInt(version.substr(vmLength + 1));\n\n\tif(this.versionMinor.length === 0)\n\t{\n\t\tthis.versionMinor = 0;\n\t}\n};\n\nVersion.prototype.newerThan = function(version)\n{\n\tvar v = new Version(version);\n\n\tif((this.versionMajor > v.versionMajor) || (this.versionMajor === v.versionMajor && this.versionMinor > v.versionMinor))\n\t{\n\t\treturn true;\n\t}\n\t\n\treturn false;\n};\n\nvar PointAttributeNames =\n{\n\tPOSITION_CARTESIAN: 0, //float x, y, z,\n\tCOLOR_PACKED: 1, //byte r, g, b, a, I: [0,1]\n\tCOLOR_FLOATS_1: 2, //float r, g, b, I: [0,1]\n\tCOLOR_FLOATS_255: 3, //float r, g, b, I: [0,255]\n\tNORMAL_FLOATS: 4, //float x, y, z,\n\tFILLER: 5,\n\tINTENSITY: 6,\n\tCLASSIFICATION: 7,\n\tNORMAL_SPHEREMAPPED: 8,\n\tNORMAL_OCT16: 9,\n\tNORMAL: 10,\n\tRETURN_NUMBER: 11,\n\tNUMBER_OF_RETURNS: 12,\n\tSOURCE_ID: 13,\n\tINDICES: 14,\n\tSPACING: 15\n};\n\n/**\n * Some types of possible point attribute data formats\n *\n * @class\n */\nvar PointAttributeTypes =\n{\n\tDATA_TYPE_DOUBLE: {ordinal: 0, size: 8},\n\tDATA_TYPE_FLOAT: {ordinal: 1, size: 4},\n\tDATA_TYPE_INT8: {ordinal: 2, size: 1},\n\tDATA_TYPE_UINT8: {ordinal: 3, size: 1},\n\tDATA_TYPE_INT16: {ordinal: 4, size: 2},\n\tDATA_TYPE_UINT16: {ordinal: 5, size: 2},\n\tDATA_TYPE_INT32: {ordinal: 6, size: 4},\n\tDATA_TYPE_UINT32: {ordinal: 7, size: 4},\n\tDATA_TYPE_INT64: {ordinal: 8, size: 8},\n\tDATA_TYPE_UINT64: {ordinal: 9, size: 8}\n};\n\nvar i = 0;\nfor(var obj in PointAttributeTypes)\n{\n\tPointAttributeTypes[i] = PointAttributeTypes[obj];\n\ti++;\n}\n\nfunction PointAttribute(name, type, numElements)\n{\n\tthis.name = name;\n\tthis.type = type;\n\tthis.numElements = numElements;\n\tthis.byteSize = this.numElements * this.type.size;\n};\n\nPointAttribute.POSITION_CARTESIAN = new PointAttribute(PointAttributeNames.POSITION_CARTESIAN, PointAttributeTypes.DATA_TYPE_FLOAT, 3);\nPointAttribute.RGBA_PACKED = new PointAttribute(PointAttributeNames.COLOR_PACKED, PointAttributeTypes.DATA_TYPE_INT8, 4);\nPointAttribute.COLOR_PACKED = PointAttribute.RGBA_PACKED;\nPointAttribute.RGB_PACKED = new PointAttribute(PointAttributeNames.COLOR_PACKED, PointAttributeTypes.DATA_TYPE_INT8, 3);\nPointAttribute.NORMAL_FLOATS = new PointAttribute(PointAttributeNames.NORMAL_FLOATS, PointAttributeTypes.DATA_TYPE_FLOAT, 3);\nPointAttribute.FILLER_1B = new PointAttribute(PointAttributeNames.FILLER, PointAttributeTypes.DATA_TYPE_UINT8, 1);\nPointAttribute.INTENSITY = new PointAttribute(PointAttributeNames.INTENSITY, PointAttributeTypes.DATA_TYPE_UINT16, 1);\nPointAttribute.CLASSIFICATION = new PointAttribute(PointAttributeNames.CLASSIFICATION, PointAttributeTypes.DATA_TYPE_UINT8, 1);\nPointAttribute.NORMAL_SPHEREMAPPED = new PointAttribute(PointAttributeNames.NORMAL_SPHEREMAPPED, PointAttributeTypes.DATA_TYPE_UINT8, 2);\nPointAttribute.NORMAL_OCT16 = new PointAttribute(PointAttributeNames.NORMAL_OCT16, PointAttributeTypes.DATA_TYPE_UINT8, 2);\nPointAttribute.NORMAL = new PointAttribute(PointAttributeNames.NORMAL, PointAttributeTypes.DATA_TYPE_FLOAT, 3);\nPointAttribute.RETURN_NUMBER = new PointAttribute(PointAttributeNames.RETURN_NUMBER, PointAttributeTypes.DATA_TYPE_UINT8, 1);\nPointAttribute.NUMBER_OF_RETURNS = new PointAttribute(PointAttributeNames.NUMBER_OF_RETURNS, PointAttributeTypes.DATA_TYPE_UINT8, 1);\nPointAttribute.SOURCE_ID = new PointAttribute(PointAttributeNames.SOURCE_ID, PointAttributeTypes.DATA_TYPE_UINT8, 1);\nPointAttribute.INDICES = new PointAttribute(PointAttributeNames.INDICES, PointAttributeTypes.DATA_TYPE_UINT32, 1);\nPointAttribute.SPACING = new PointAttribute(PointAttributeNames.SPACING, PointAttributeTypes.DATA_TYPE_FLOAT, 1);\n\nfunction PointAttributes(pointAttributes)\n{\n\tthis.attributes = [];\n\tthis.byteSize = 0;\n\tthis.size = 0;\n\n\tif(pointAttributes != null)\n\t{\n\t\tfor(var i = 0; i < pointAttributes.length; i++)\n\t\t{\n\t\t\tvar pointAttributeName = pointAttributes[i];\n\t\t\tvar pointAttribute = PointAttribute[pointAttributeName];\n\t\t\tthis.attributes.push(pointAttribute);\n\t\t\tthis.byteSize += pointAttribute.byteSize;\n\t\t\tthis.size++;\n\t\t}\n\t}\n};\n\nPointAttributes.prototype.add = function(pointAttribute)\n{\n\tthis.attributes.push(pointAttribute);\n\tthis.byteSize += pointAttribute.byteSize;\n\tthis.size++;\n};\n\nPointAttributes.prototype.hasColors = function()\n{\n\tfor(var name in this.attributes)\n\t{\n\t\tvar pointAttribute = this.attributes[name];\n\t\tif(pointAttribute.name === PointAttributeNames.COLOR_PACKED)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n};\n\nPointAttributes.prototype.hasNormals = function()\n{\n\tfor(var name in this.attributes)\n\t{\n\t\tvar pointAttribute = this.attributes[name];\n\t\tif(\n\t\t\tpointAttribute === PointAttribute.NORMAL_SPHEREMAPPED ||\n\t\t\tpointAttribute === PointAttribute.NORMAL_FLOATS ||\n\t\t\tpointAttribute === PointAttribute.NORMAL ||\n\t\t\tpointAttribute === PointAttribute.NORMAL_OCT16) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n};\n\n\n/***/ })\n\n/******/ });\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc291cmNlL3dvcmtlcnMvQmluYXJ5RGVjb2Rlcldvcmtlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO1FBQUE7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7OztRQUdBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQSwwQ0FBMEMsZ0NBQWdDO1FBQzFFO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0Esd0RBQXdELGtCQUFrQjtRQUMxRTtRQUNBLGlEQUFpRCxjQUFjO1FBQy9EOztRQUVBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQSx5Q0FBeUMsaUNBQWlDO1FBQzFFLGdIQUFnSCxtQkFBbUIsRUFBRTtRQUNySTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBLDJCQUEyQiwwQkFBMEIsRUFBRTtRQUN2RCxpQ0FBaUMsZUFBZTtRQUNoRDtRQUNBO1FBQ0E7O1FBRUE7UUFDQSxzREFBc0QsK0RBQStEOztRQUVySDtRQUNBOzs7UUFHQTtRQUNBOzs7Ozs7Ozs7Ozs7O0FDbEZhOztBQUViO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGtCQUFrQixlQUFlO0FBQ2pDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDZDQUE2QztBQUM3QyxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBLGtCQUFrQixlQUFlO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsNkNBQTZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsa0JBQWtCLGVBQWU7QUFDakM7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsNkNBQTZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsa0JBQWtCLGVBQWU7QUFDakM7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsNkNBQTZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsa0JBQWtCLGVBQWU7QUFDakM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDZDQUE2QztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGtCQUFrQixlQUFlO0FBQ2pDO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSw2Q0FBNkM7QUFDN0MsSUFBSTtBQUNKO0FBQ0E7O0FBRUEsa0JBQWtCLGVBQWU7QUFDakM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDZDQUE2QztBQUM3Qzs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxnQkFBZ0IsZUFBZTtBQUMvQjtBQUNBO0FBQ0E7O0FBRUEsbURBQW1EOztBQUVuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLG1DQUFtQztBQUN6RDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDJDQUEyQztBQUMxRDtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixvQkFBb0I7QUFDeEMsbUJBQW1CLG9CQUFvQjtBQUN2QyxrQkFBa0Isb0JBQW9CO0FBQ3RDLG1CQUFtQixvQkFBb0I7QUFDdkMsbUJBQW1CLG9CQUFvQjtBQUN2QyxvQkFBb0Isb0JBQW9CO0FBQ3hDLG1CQUFtQixvQkFBb0I7QUFDdkMsb0JBQW9CLG9CQUFvQjtBQUN4QyxtQkFBbUIsb0JBQW9CO0FBQ3ZDLG9CQUFvQjtBQUNwQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0JBQWdCLDRCQUE0QjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSIsImZpbGUiOiIxNjBiYzg5ZDRlMjZlZmI4Zjg3YS53b3JrZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gXCIuL3NvdXJjZS93b3JrZXJzL0JpbmFyeURlY29kZXJXb3JrZXIuanNcIik7XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gQ3VzdG9tVmlldyhidWZmZXIpXG57XG5cdHRoaXMuYnVmZmVyID0gYnVmZmVyO1xuXHR0aGlzLnU4ID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKTtcblxuXHR2YXIgdG1wID0gbmV3IEFycmF5QnVmZmVyKDQpO1xuXHR2YXIgdG1wZiA9IG5ldyBGbG9hdDMyQXJyYXkodG1wKTtcblx0dmFyIHRtcHU4ID0gbmV3IFVpbnQ4QXJyYXkodG1wKTtcblxuXHR0aGlzLmdldFVpbnQzMiA9IGZ1bmN0aW9uKGkpXG5cdHtcblx0XHRyZXR1cm4gKHRoaXMudThbaSArIDNdIDw8IDI0KSB8ICh0aGlzLnU4W2kgKyAyXSA8PCAxNikgfCAodGhpcy51OFtpICsgMV0gPDwgOCkgfCB0aGlzLnU4W2ldO1xuXHR9O1xuXG5cdHRoaXMuZ2V0VWludDE2ID0gZnVuY3Rpb24oaSlcblx0e1xuXHRcdHJldHVybiAodGhpcy51OFtpICsgMV0gPDwgOCkgfCB0aGlzLnU4W2ldO1xuXHR9O1xuXG5cdHRoaXMuZ2V0RmxvYXQzMiA9IGZ1bmN0aW9uKGkpXG5cdHtcblx0XHR0bXB1OFswXSA9IHRoaXMudThbaSArIDBdO1xuXHRcdHRtcHU4WzFdID0gdGhpcy51OFtpICsgMV07XG5cdFx0dG1wdThbMl0gPSB0aGlzLnU4W2kgKyAyXTtcblx0XHR0bXB1OFszXSA9IHRoaXMudThbaSArIDNdO1xuXG5cdFx0cmV0dXJuIHRtcGZbMF07XG5cdH07XG5cblx0dGhpcy5nZXRVaW50OCA9IGZ1bmN0aW9uKGkpXG5cdHtcblx0XHRyZXR1cm4gdGhpcy51OFtpXTtcblx0fTtcbn1cblxub25tZXNzYWdlID0gZnVuY3Rpb24oZXZlbnQpXG57XG4gIGlmICghZXZlbnQuZGF0YSB8fCAhZXZlbnQuZGF0YS5idWZmZXIpIHtcbiAgICByZXR1cm47XG4gIH1cblx0dHJ5XG5cdHtcblx0XHR2YXIgYnVmZmVyID0gZXZlbnQuZGF0YS5idWZmZXI7XG5cdFx0dmFyIHBvaW50QXR0cmlidXRlcyA9IGV2ZW50LmRhdGEucG9pbnRBdHRyaWJ1dGVzO1xuXHRcdHZhciBudW1Qb2ludHMgPSBidWZmZXIuYnl0ZUxlbmd0aCAvIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZTtcblx0XHR2YXIgY3YgPSBuZXcgQ3VzdG9tVmlldyhidWZmZXIpO1xuXHRcdHZhciB2ZXJzaW9uID0gbmV3IFZlcnNpb24oZXZlbnQuZGF0YS52ZXJzaW9uKTtcblx0XHR2YXIgbm9kZU9mZnNldCA9IGV2ZW50LmRhdGEub2Zmc2V0O1xuXHRcdHZhciBzY2FsZSA9IGV2ZW50LmRhdGEuc2NhbGU7XG5cdFx0dmFyIHNwYWNpbmcgPSBldmVudC5kYXRhLnNwYWNpbmc7XG5cdFx0dmFyIGhhc0NoaWxkcmVuID0gZXZlbnQuZGF0YS5oYXNDaGlsZHJlbjtcblx0XHR2YXIgbmFtZSA9IGV2ZW50LmRhdGEubmFtZTtcblx0XHRcblx0XHR2YXIgdGlnaHRCb3hNaW4gPSBbIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgXTtcblx0XHR2YXIgdGlnaHRCb3hNYXggPSBbIE51bWJlci5ORUdBVElWRV9JTkZJTklUWSwgTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLCBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkgXTtcblx0XHR2YXIgbWVhbiA9IFswLCAwLCAwXTtcblxuXHRcdHZhciBhdHRyaWJ1dGVCdWZmZXJzID0ge307XG5cdFx0dmFyIGluT2Zmc2V0ID0gMDtcblxuXHRcdGZvcih2YXIgcG9pbnRBdHRyaWJ1dGUgb2YgcG9pbnRBdHRyaWJ1dGVzLmF0dHJpYnV0ZXMpXG5cdFx0e1xuXHRcdFx0aWYocG9pbnRBdHRyaWJ1dGUubmFtZSA9PT0gUG9pbnRBdHRyaWJ1dGUuUE9TSVRJT05fQ0FSVEVTSUFOLm5hbWUpXG5cdFx0XHR7XG5cdFx0XHRcdHZhciBidWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDQgKiAzKTtcblx0XHRcdFx0dmFyIHBvc2l0aW9ucyA9IG5ldyBGbG9hdDMyQXJyYXkoYnVmZik7XG5cdFx0XHRcblx0XHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IG51bVBvaW50czsgaisrKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dmFyIHgsIHksIHo7XG5cblx0XHRcdFx0XHRpZih2ZXJzaW9uLm5ld2VyVGhhbihcIjEuM1wiKSlcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHR4ID0gKGN2LmdldFVpbnQzMihpbk9mZnNldCArIGogKiBwb2ludEF0dHJpYnV0ZXMuYnl0ZVNpemUgKyAwLCB0cnVlKSAqIHNjYWxlKTtcblx0XHRcdFx0XHRcdHkgPSAoY3YuZ2V0VWludDMyKGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSArIDQsIHRydWUpICogc2NhbGUpO1xuXHRcdFx0XHRcdFx0eiA9IChjdi5nZXRVaW50MzIoaW5PZmZzZXQgKyBqICogcG9pbnRBdHRyaWJ1dGVzLmJ5dGVTaXplICsgOCwgdHJ1ZSkgKiBzY2FsZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHR4ID0gY3YuZ2V0RmxvYXQzMihqICogcG9pbnRBdHRyaWJ1dGVzLmJ5dGVTaXplICsgMCwgdHJ1ZSkgKyBub2RlT2Zmc2V0WzBdO1xuXHRcdFx0XHRcdFx0eSA9IGN2LmdldEZsb2F0MzIoaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSArIDQsIHRydWUpICsgbm9kZU9mZnNldFsxXTtcblx0XHRcdFx0XHRcdHogPSBjdi5nZXRGbG9hdDMyKGogKiBwb2ludEF0dHJpYnV0ZXMuYnl0ZVNpemUgKyA4LCB0cnVlKSArIG5vZGVPZmZzZXRbMl07XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cG9zaXRpb25zWzMgKiBqICsgMF0gPSB4O1xuXHRcdFx0XHRcdHBvc2l0aW9uc1szICogaiArIDFdID0geTtcblx0XHRcdFx0XHRwb3NpdGlvbnNbMyAqIGogKyAyXSA9IHo7XG5cblx0XHRcdFx0XHRtZWFuWzBdICs9IHggLyBudW1Qb2ludHM7XG5cdFx0XHRcdFx0bWVhblsxXSArPSB5IC8gbnVtUG9pbnRzO1xuXHRcdFx0XHRcdG1lYW5bMl0gKz0geiAvIG51bVBvaW50cztcblxuXHRcdFx0XHRcdHRpZ2h0Qm94TWluWzBdID0gTWF0aC5taW4odGlnaHRCb3hNaW5bMF0sIHgpO1xuXHRcdFx0XHRcdHRpZ2h0Qm94TWluWzFdID0gTWF0aC5taW4odGlnaHRCb3hNaW5bMV0sIHkpO1xuXHRcdFx0XHRcdHRpZ2h0Qm94TWluWzJdID0gTWF0aC5taW4odGlnaHRCb3hNaW5bMl0sIHopO1xuXG5cdFx0XHRcdFx0dGlnaHRCb3hNYXhbMF0gPSBNYXRoLm1heCh0aWdodEJveE1heFswXSwgeCk7XG5cdFx0XHRcdFx0dGlnaHRCb3hNYXhbMV0gPSBNYXRoLm1heCh0aWdodEJveE1heFsxXSwgeSk7XG5cdFx0XHRcdFx0dGlnaHRCb3hNYXhbMl0gPSBNYXRoLm1heCh0aWdodEJveE1heFsyXSwgeik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRhdHRyaWJ1dGVCdWZmZXJzW3BvaW50QXR0cmlidXRlLm5hbWVdID0ge2J1ZmZlcjogYnVmZiwgYXR0cmlidXRlOiBwb2ludEF0dHJpYnV0ZX07XG5cdFx0XHR9IGVsc2UgaWYocG9pbnRBdHRyaWJ1dGUubmFtZSA9PT0gUG9pbnRBdHRyaWJ1dGUuQ09MT1JfUEFDS0VELm5hbWUpXG5cdFx0XHR7XG5cdFx0XHRcdHZhciBidWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDQpO1xuXHRcdFx0XHR2YXIgY29sb3JzID0gbmV3IFVpbnQ4QXJyYXkoYnVmZik7XG5cblx0XHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IG51bVBvaW50czsgaisrKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0Y29sb3JzWzQgKiBqICsgMF0gPSBjdi5nZXRVaW50OChpbk9mZnNldCArIGogKiBwb2ludEF0dHJpYnV0ZXMuYnl0ZVNpemUgKyAwKTtcblx0XHRcdFx0XHRjb2xvcnNbNCAqIGogKyAxXSA9IGN2LmdldFVpbnQ4KGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSArIDEpO1xuXHRcdFx0XHRcdGNvbG9yc1s0ICogaiArIDJdID0gY3YuZ2V0VWludDgoaW5PZmZzZXQgKyBqICogcG9pbnRBdHRyaWJ1dGVzLmJ5dGVTaXplICsgMik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRhdHRyaWJ1dGVCdWZmZXJzW3BvaW50QXR0cmlidXRlLm5hbWVdID0ge2J1ZmZlcjogYnVmZiwgYXR0cmlidXRlOiBwb2ludEF0dHJpYnV0ZX07XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmKHBvaW50QXR0cmlidXRlLm5hbWUgPT09IFBvaW50QXR0cmlidXRlLklOVEVOU0lUWS5uYW1lKVxuXHRcdFx0e1xuXHRcdFx0XHR2YXIgYnVmZiA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMgKiA0KTtcblx0XHRcdFx0dmFyIGludGVuc2l0aWVzID0gbmV3IEZsb2F0MzJBcnJheShidWZmKTtcblxuXHRcdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgbnVtUG9pbnRzOyBqKyspXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR2YXIgaW50ZW5zaXR5ID0gY3YuZ2V0VWludDE2KGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSwgdHJ1ZSk7XG5cdFx0XHRcdFx0aW50ZW5zaXRpZXNbal0gPSBpbnRlbnNpdHk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRhdHRyaWJ1dGVCdWZmZXJzW3BvaW50QXR0cmlidXRlLm5hbWVdID0ge2J1ZmZlcjogYnVmZiwgYXR0cmlidXRlOiBwb2ludEF0dHJpYnV0ZX07XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmKHBvaW50QXR0cmlidXRlLm5hbWUgPT09IFBvaW50QXR0cmlidXRlLkNMQVNTSUZJQ0FUSU9OLm5hbWUpXG5cdFx0XHR7XG5cdFx0XHRcdHZhciBidWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyk7XG5cdFx0XHRcdHZhciBjbGFzc2lmaWNhdGlvbnMgPSBuZXcgVWludDhBcnJheShidWZmKTtcblxuXHRcdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgbnVtUG9pbnRzOyBqKyspXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR2YXIgY2xhc3NpZmljYXRpb24gPSBjdi5nZXRVaW50OChpbk9mZnNldCArIGogKiBwb2ludEF0dHJpYnV0ZXMuYnl0ZVNpemUpO1xuXHRcdFx0XHRcdGNsYXNzaWZpY2F0aW9uc1tqXSA9IGNsYXNzaWZpY2F0aW9uO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0YXR0cmlidXRlQnVmZmVyc1twb2ludEF0dHJpYnV0ZS5uYW1lXSA9IHtidWZmZXI6IGJ1ZmYsIGF0dHJpYnV0ZTogcG9pbnRBdHRyaWJ1dGV9O1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZihwb2ludEF0dHJpYnV0ZS5uYW1lID09PSBQb2ludEF0dHJpYnV0ZS5OT1JNQUxfU1BIRVJFTUFQUEVELm5hbWUpXG5cdFx0XHR7XG5cdFx0XHRcdHZhciBidWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDQgKiAzKTtcblx0XHRcdFx0dmFyIG5vcm1hbHMgPSBuZXcgRmxvYXQzMkFycmF5KGJ1ZmYpO1xuXG5cdFx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBudW1Qb2ludHM7IGorKylcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHZhciBieCA9IGN2LmdldFVpbnQ4KGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSArIDApO1xuXHRcdFx0XHRcdHZhciBieSA9IGN2LmdldFVpbnQ4KGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSArIDEpO1xuXG5cdFx0XHRcdFx0dmFyIGV4ID0gYnggLyAyNTU7XG5cdFx0XHRcdFx0dmFyIGV5ID0gYnkgLyAyNTU7XG5cblx0XHRcdFx0XHR2YXIgbnggPSBleCAqIDIgLSAxO1xuXHRcdFx0XHRcdHZhciBueSA9IGV5ICogMiAtIDE7XG5cdFx0XHRcdFx0dmFyIG56ID0gMTtcblx0XHRcdFx0XHR2YXIgbncgPSAtMTtcblxuXHRcdFx0XHRcdHZhciBsID0gKG54ICogKC1ueCkpICsgKG55ICogKC1ueSkpICsgKG56ICogKC1udykpO1xuXHRcdFx0XHRcdG56ID0gbDtcblx0XHRcdFx0XHRueCA9IG54ICogTWF0aC5zcXJ0KGwpO1xuXHRcdFx0XHRcdG55ID0gbnkgKiBNYXRoLnNxcnQobCk7XG5cblx0XHRcdFx0XHRueCA9IG54ICogMjtcblx0XHRcdFx0XHRueSA9IG55ICogMjtcblx0XHRcdFx0XHRueiA9IG56ICogMiAtIDE7XG5cblx0XHRcdFx0XHRub3JtYWxzWzMgKiBqICsgMF0gPSBueDtcblx0XHRcdFx0XHRub3JtYWxzWzMgKiBqICsgMV0gPSBueTtcblx0XHRcdFx0XHRub3JtYWxzWzMgKiBqICsgMl0gPSBuejtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGF0dHJpYnV0ZUJ1ZmZlcnNbcG9pbnRBdHRyaWJ1dGUubmFtZV0gPSB7YnVmZmVyOiBidWZmLCBhdHRyaWJ1dGU6IHBvaW50QXR0cmlidXRlfTtcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYocG9pbnRBdHRyaWJ1dGUubmFtZSA9PT0gUG9pbnRBdHRyaWJ1dGUuTk9STUFMX09DVDE2Lm5hbWUpXG5cdFx0XHR7XG5cdFx0XHRcdHZhciBidWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDQgKiAzKTtcblx0XHRcdFx0dmFyIG5vcm1hbHMgPSBuZXcgRmxvYXQzMkFycmF5KGJ1ZmYpO1xuXG5cdFx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBudW1Qb2ludHM7IGorKykge1xuXHRcdFx0XHRcdHZhciBieCA9IGN2LmdldFVpbnQ4KGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSArIDApO1xuXHRcdFx0XHRcdHZhciBieSA9IGN2LmdldFVpbnQ4KGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSArIDEpO1xuXG5cdFx0XHRcdFx0dmFyIHUgPSAoYnggLyAyNTUpICogMiAtIDE7XG5cdFx0XHRcdFx0dmFyIHYgPSAoYnkgLyAyNTUpICogMiAtIDE7XG5cblx0XHRcdFx0XHR2YXIgeiA9IDEgLSBNYXRoLmFicyh1KSAtIE1hdGguYWJzKHYpO1xuXG5cdFx0XHRcdFx0dmFyIHggPSAwO1xuXHRcdFx0XHRcdHZhciB5ID0gMDtcblx0XHRcdFx0XHRpZih6ID49IDApIHtcblx0XHRcdFx0XHRcdHggPSB1O1xuXHRcdFx0XHRcdFx0eSA9IHY7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHggPSAtKHYgLyBNYXRoLnNpZ24odikgLSAxKSAvIE1hdGguc2lnbih1KTtcblx0XHRcdFx0XHRcdHkgPSAtKHUgLyBNYXRoLnNpZ24odSkgLSAxKSAvIE1hdGguc2lnbih2KTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR2YXIgbGVuZ3RoID0gTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkgKyB6ICogeik7XG5cdFx0XHRcdFx0eCA9IHggLyBsZW5ndGg7XG5cdFx0XHRcdFx0eSA9IHkgLyBsZW5ndGg7XG5cdFx0XHRcdFx0eiA9IHogLyBsZW5ndGg7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0bm9ybWFsc1szICogaiArIDBdID0geDtcblx0XHRcdFx0XHRub3JtYWxzWzMgKiBqICsgMV0gPSB5O1xuXHRcdFx0XHRcdG5vcm1hbHNbMyAqIGogKyAyXSA9IHo7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRhdHRyaWJ1dGVCdWZmZXJzW3BvaW50QXR0cmlidXRlLm5hbWVdID0ge2J1ZmZlcjogYnVmZiwgYXR0cmlidXRlOiBwb2ludEF0dHJpYnV0ZX07XG5cdFx0XHR9IGVsc2UgaWYocG9pbnRBdHRyaWJ1dGUubmFtZSA9PT0gUG9pbnRBdHRyaWJ1dGUuTk9STUFMLm5hbWUpIHtcblx0XHRcdFx0dmFyIGJ1ZmYgPSBuZXcgQXJyYXlCdWZmZXIobnVtUG9pbnRzICogNCAqIDMpO1xuXHRcdFx0XHR2YXIgbm9ybWFscyA9IG5ldyBGbG9hdDMyQXJyYXkoYnVmZik7XG5cblx0XHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IG51bVBvaW50czsgaisrKSB7XG5cdFx0XHRcdFx0dmFyIHggPSBjdi5nZXRGbG9hdDMyKGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSArIDAsIHRydWUpO1xuXHRcdFx0XHRcdHZhciB5ID0gY3YuZ2V0RmxvYXQzMihpbk9mZnNldCArIGogKiBwb2ludEF0dHJpYnV0ZXMuYnl0ZVNpemUgKyA0LCB0cnVlKTtcblx0XHRcdFx0XHR2YXIgeiA9IGN2LmdldEZsb2F0MzIoaW5PZmZzZXQgKyBqICogcG9pbnRBdHRyaWJ1dGVzLmJ5dGVTaXplICsgOCwgdHJ1ZSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0bm9ybWFsc1szICogaiArIDBdID0geDtcblx0XHRcdFx0XHRub3JtYWxzWzMgKiBqICsgMV0gPSB5O1xuXHRcdFx0XHRcdG5vcm1hbHNbMyAqIGogKyAyXSA9IHo7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRhdHRyaWJ1dGVCdWZmZXJzW3BvaW50QXR0cmlidXRlLm5hbWVdID0ge2J1ZmZlcjogYnVmZiwgYXR0cmlidXRlOiBwb2ludEF0dHJpYnV0ZX07XG5cdFx0XHR9XG5cblx0XHRcdGluT2Zmc2V0ICs9IHBvaW50QXR0cmlidXRlLmJ5dGVTaXplO1xuXHRcdH1cblxuXHRcdC8vYWRkIGluZGljZXNcblx0XHR2YXIgYnVmZiA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMgKiA0KTtcblx0XHR2YXIgaW5kaWNlcyA9IG5ldyBVaW50MzJBcnJheShidWZmKTtcblxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBudW1Qb2ludHM7IGkrKylcblx0XHR7XG5cdFx0XHRpbmRpY2VzW2ldID0gaTtcblx0XHR9XG5cdFx0XG5cdFx0YXR0cmlidXRlQnVmZmVyc1tQb2ludEF0dHJpYnV0ZS5JTkRJQ0VTLm5hbWVdID0ge2J1ZmZlcjogYnVmZiwgYXR0cmlidXRlOiBQb2ludEF0dHJpYnV0ZS5JTkRJQ0VTfTtcblxuXHRcdHZhciBtZXNzYWdlID1cblx0XHR7XG5cdFx0XHRidWZmZXI6IGJ1ZmZlcixcblx0XHRcdG1lYW46IG1lYW4sXG5cdFx0XHRhdHRyaWJ1dGVCdWZmZXJzOiBhdHRyaWJ1dGVCdWZmZXJzLFxuXHRcdFx0dGlnaHRCb3VuZGluZ0JveDoge21pbjogdGlnaHRCb3hNaW4sIG1heDogdGlnaHRCb3hNYXh9LFxuXHRcdH07XG5cblx0XHR2YXIgdHJhbnNmZXJhYmxlcyA9IFtdO1xuXHRcdGZvcih2YXIgcHJvcGVydHkgaW4gbWVzc2FnZS5hdHRyaWJ1dGVCdWZmZXJzKVxuXHRcdHtcblx0XHRcdHRyYW5zZmVyYWJsZXMucHVzaChtZXNzYWdlLmF0dHJpYnV0ZUJ1ZmZlcnNbcHJvcGVydHldLmJ1ZmZlcik7XG5cdFx0fVxuXHRcdHRyYW5zZmVyYWJsZXMucHVzaChidWZmZXIpO1xuXG5cdFx0cG9zdE1lc3NhZ2UobWVzc2FnZSwgdHJhbnNmZXJhYmxlcyk7XG5cdH1cblx0Y2F0Y2goZSlcblx0e1xuXHRcdHBvc3RNZXNzYWdlKHtlcnJvcjogXCJFeGVwdGlvbiB0aHJvd24gZHVyaW5nIGV4ZWN1dGlvbi5cIn0pO1xuXHR9XG59O1xuXG5cbmZ1bmN0aW9uIFZlcnNpb24odmVyc2lvbilcbntcblx0dGhpcy52ZXJzaW9uID0gdmVyc2lvbjtcblx0dmFyIHZtTGVuZ3RoID0gKHZlcnNpb24uaW5kZXhPZihcIi5cIikgPT09IC0xKSA/IHZlcnNpb24ubGVuZ3RoIDogdmVyc2lvbi5pbmRleE9mKFwiLlwiKTtcblx0dGhpcy52ZXJzaW9uTWFqb3IgPSBwYXJzZUludCh2ZXJzaW9uLnN1YnN0cigwLCB2bUxlbmd0aCkpO1xuXHR0aGlzLnZlcnNpb25NaW5vciA9IHBhcnNlSW50KHZlcnNpb24uc3Vic3RyKHZtTGVuZ3RoICsgMSkpO1xuXG5cdGlmKHRoaXMudmVyc2lvbk1pbm9yLmxlbmd0aCA9PT0gMClcblx0e1xuXHRcdHRoaXMudmVyc2lvbk1pbm9yID0gMDtcblx0fVxufTtcblxuVmVyc2lvbi5wcm90b3R5cGUubmV3ZXJUaGFuID0gZnVuY3Rpb24odmVyc2lvbilcbntcblx0dmFyIHYgPSBuZXcgVmVyc2lvbih2ZXJzaW9uKTtcblxuXHRpZigodGhpcy52ZXJzaW9uTWFqb3IgPiB2LnZlcnNpb25NYWpvcikgfHwgKHRoaXMudmVyc2lvbk1ham9yID09PSB2LnZlcnNpb25NYWpvciAmJiB0aGlzLnZlcnNpb25NaW5vciA+IHYudmVyc2lvbk1pbm9yKSlcblx0e1xuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cdFxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG52YXIgUG9pbnRBdHRyaWJ1dGVOYW1lcyA9XG57XG5cdFBPU0lUSU9OX0NBUlRFU0lBTjogMCwgLy9mbG9hdCB4LCB5LCB6LFxuXHRDT0xPUl9QQUNLRUQ6IDEsIC8vYnl0ZSByLCBnLCBiLCBhLCBJOiBbMCwxXVxuXHRDT0xPUl9GTE9BVFNfMTogMiwgLy9mbG9hdCByLCBnLCBiLCBJOiBbMCwxXVxuXHRDT0xPUl9GTE9BVFNfMjU1OiAzLCAvL2Zsb2F0IHIsIGcsIGIsIEk6IFswLDI1NV1cblx0Tk9STUFMX0ZMT0FUUzogNCwgLy9mbG9hdCB4LCB5LCB6LFxuXHRGSUxMRVI6IDUsXG5cdElOVEVOU0lUWTogNixcblx0Q0xBU1NJRklDQVRJT046IDcsXG5cdE5PUk1BTF9TUEhFUkVNQVBQRUQ6IDgsXG5cdE5PUk1BTF9PQ1QxNjogOSxcblx0Tk9STUFMOiAxMCxcblx0UkVUVVJOX05VTUJFUjogMTEsXG5cdE5VTUJFUl9PRl9SRVRVUk5TOiAxMixcblx0U09VUkNFX0lEOiAxMyxcblx0SU5ESUNFUzogMTQsXG5cdFNQQUNJTkc6IDE1XG59O1xuXG4vKipcbiAqIFNvbWUgdHlwZXMgb2YgcG9zc2libGUgcG9pbnQgYXR0cmlidXRlIGRhdGEgZm9ybWF0c1xuICpcbiAqIEBjbGFzc1xuICovXG52YXIgUG9pbnRBdHRyaWJ1dGVUeXBlcyA9XG57XG5cdERBVEFfVFlQRV9ET1VCTEU6IHtvcmRpbmFsOiAwLCBzaXplOiA4fSxcblx0REFUQV9UWVBFX0ZMT0FUOiB7b3JkaW5hbDogMSwgc2l6ZTogNH0sXG5cdERBVEFfVFlQRV9JTlQ4OiB7b3JkaW5hbDogMiwgc2l6ZTogMX0sXG5cdERBVEFfVFlQRV9VSU5UODoge29yZGluYWw6IDMsIHNpemU6IDF9LFxuXHREQVRBX1RZUEVfSU5UMTY6IHtvcmRpbmFsOiA0LCBzaXplOiAyfSxcblx0REFUQV9UWVBFX1VJTlQxNjoge29yZGluYWw6IDUsIHNpemU6IDJ9LFxuXHREQVRBX1RZUEVfSU5UMzI6IHtvcmRpbmFsOiA2LCBzaXplOiA0fSxcblx0REFUQV9UWVBFX1VJTlQzMjoge29yZGluYWw6IDcsIHNpemU6IDR9LFxuXHREQVRBX1RZUEVfSU5UNjQ6IHtvcmRpbmFsOiA4LCBzaXplOiA4fSxcblx0REFUQV9UWVBFX1VJTlQ2NDoge29yZGluYWw6IDksIHNpemU6IDh9XG59O1xuXG52YXIgaSA9IDA7XG5mb3IodmFyIG9iaiBpbiBQb2ludEF0dHJpYnV0ZVR5cGVzKVxue1xuXHRQb2ludEF0dHJpYnV0ZVR5cGVzW2ldID0gUG9pbnRBdHRyaWJ1dGVUeXBlc1tvYmpdO1xuXHRpKys7XG59XG5cbmZ1bmN0aW9uIFBvaW50QXR0cmlidXRlKG5hbWUsIHR5cGUsIG51bUVsZW1lbnRzKVxue1xuXHR0aGlzLm5hbWUgPSBuYW1lO1xuXHR0aGlzLnR5cGUgPSB0eXBlO1xuXHR0aGlzLm51bUVsZW1lbnRzID0gbnVtRWxlbWVudHM7XG5cdHRoaXMuYnl0ZVNpemUgPSB0aGlzLm51bUVsZW1lbnRzICogdGhpcy50eXBlLnNpemU7XG59O1xuXG5Qb2ludEF0dHJpYnV0ZS5QT1NJVElPTl9DQVJURVNJQU4gPSBuZXcgUG9pbnRBdHRyaWJ1dGUoUG9pbnRBdHRyaWJ1dGVOYW1lcy5QT1NJVElPTl9DQVJURVNJQU4sIFBvaW50QXR0cmlidXRlVHlwZXMuREFUQV9UWVBFX0ZMT0FULCAzKTtcblBvaW50QXR0cmlidXRlLlJHQkFfUEFDS0VEID0gbmV3IFBvaW50QXR0cmlidXRlKFBvaW50QXR0cmlidXRlTmFtZXMuQ09MT1JfUEFDS0VELCBQb2ludEF0dHJpYnV0ZVR5cGVzLkRBVEFfVFlQRV9JTlQ4LCA0KTtcblBvaW50QXR0cmlidXRlLkNPTE9SX1BBQ0tFRCA9IFBvaW50QXR0cmlidXRlLlJHQkFfUEFDS0VEO1xuUG9pbnRBdHRyaWJ1dGUuUkdCX1BBQ0tFRCA9IG5ldyBQb2ludEF0dHJpYnV0ZShQb2ludEF0dHJpYnV0ZU5hbWVzLkNPTE9SX1BBQ0tFRCwgUG9pbnRBdHRyaWJ1dGVUeXBlcy5EQVRBX1RZUEVfSU5UOCwgMyk7XG5Qb2ludEF0dHJpYnV0ZS5OT1JNQUxfRkxPQVRTID0gbmV3IFBvaW50QXR0cmlidXRlKFBvaW50QXR0cmlidXRlTmFtZXMuTk9STUFMX0ZMT0FUUywgUG9pbnRBdHRyaWJ1dGVUeXBlcy5EQVRBX1RZUEVfRkxPQVQsIDMpO1xuUG9pbnRBdHRyaWJ1dGUuRklMTEVSXzFCID0gbmV3IFBvaW50QXR0cmlidXRlKFBvaW50QXR0cmlidXRlTmFtZXMuRklMTEVSLCBQb2ludEF0dHJpYnV0ZVR5cGVzLkRBVEFfVFlQRV9VSU5UOCwgMSk7XG5Qb2ludEF0dHJpYnV0ZS5JTlRFTlNJVFkgPSBuZXcgUG9pbnRBdHRyaWJ1dGUoUG9pbnRBdHRyaWJ1dGVOYW1lcy5JTlRFTlNJVFksIFBvaW50QXR0cmlidXRlVHlwZXMuREFUQV9UWVBFX1VJTlQxNiwgMSk7XG5Qb2ludEF0dHJpYnV0ZS5DTEFTU0lGSUNBVElPTiA9IG5ldyBQb2ludEF0dHJpYnV0ZShQb2ludEF0dHJpYnV0ZU5hbWVzLkNMQVNTSUZJQ0FUSU9OLCBQb2ludEF0dHJpYnV0ZVR5cGVzLkRBVEFfVFlQRV9VSU5UOCwgMSk7XG5Qb2ludEF0dHJpYnV0ZS5OT1JNQUxfU1BIRVJFTUFQUEVEID0gbmV3IFBvaW50QXR0cmlidXRlKFBvaW50QXR0cmlidXRlTmFtZXMuTk9STUFMX1NQSEVSRU1BUFBFRCwgUG9pbnRBdHRyaWJ1dGVUeXBlcy5EQVRBX1RZUEVfVUlOVDgsIDIpO1xuUG9pbnRBdHRyaWJ1dGUuTk9STUFMX09DVDE2ID0gbmV3IFBvaW50QXR0cmlidXRlKFBvaW50QXR0cmlidXRlTmFtZXMuTk9STUFMX09DVDE2LCBQb2ludEF0dHJpYnV0ZVR5cGVzLkRBVEFfVFlQRV9VSU5UOCwgMik7XG5Qb2ludEF0dHJpYnV0ZS5OT1JNQUwgPSBuZXcgUG9pbnRBdHRyaWJ1dGUoUG9pbnRBdHRyaWJ1dGVOYW1lcy5OT1JNQUwsIFBvaW50QXR0cmlidXRlVHlwZXMuREFUQV9UWVBFX0ZMT0FULCAzKTtcblBvaW50QXR0cmlidXRlLlJFVFVSTl9OVU1CRVIgPSBuZXcgUG9pbnRBdHRyaWJ1dGUoUG9pbnRBdHRyaWJ1dGVOYW1lcy5SRVRVUk5fTlVNQkVSLCBQb2ludEF0dHJpYnV0ZVR5cGVzLkRBVEFfVFlQRV9VSU5UOCwgMSk7XG5Qb2ludEF0dHJpYnV0ZS5OVU1CRVJfT0ZfUkVUVVJOUyA9IG5ldyBQb2ludEF0dHJpYnV0ZShQb2ludEF0dHJpYnV0ZU5hbWVzLk5VTUJFUl9PRl9SRVRVUk5TLCBQb2ludEF0dHJpYnV0ZVR5cGVzLkRBVEFfVFlQRV9VSU5UOCwgMSk7XG5Qb2ludEF0dHJpYnV0ZS5TT1VSQ0VfSUQgPSBuZXcgUG9pbnRBdHRyaWJ1dGUoUG9pbnRBdHRyaWJ1dGVOYW1lcy5TT1VSQ0VfSUQsIFBvaW50QXR0cmlidXRlVHlwZXMuREFUQV9UWVBFX1VJTlQ4LCAxKTtcblBvaW50QXR0cmlidXRlLklORElDRVMgPSBuZXcgUG9pbnRBdHRyaWJ1dGUoUG9pbnRBdHRyaWJ1dGVOYW1lcy5JTkRJQ0VTLCBQb2ludEF0dHJpYnV0ZVR5cGVzLkRBVEFfVFlQRV9VSU5UMzIsIDEpO1xuUG9pbnRBdHRyaWJ1dGUuU1BBQ0lORyA9IG5ldyBQb2ludEF0dHJpYnV0ZShQb2ludEF0dHJpYnV0ZU5hbWVzLlNQQUNJTkcsIFBvaW50QXR0cmlidXRlVHlwZXMuREFUQV9UWVBFX0ZMT0FULCAxKTtcblxuZnVuY3Rpb24gUG9pbnRBdHRyaWJ1dGVzKHBvaW50QXR0cmlidXRlcylcbntcblx0dGhpcy5hdHRyaWJ1dGVzID0gW107XG5cdHRoaXMuYnl0ZVNpemUgPSAwO1xuXHR0aGlzLnNpemUgPSAwO1xuXG5cdGlmKHBvaW50QXR0cmlidXRlcyAhPSBudWxsKVxuXHR7XG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHBvaW50QXR0cmlidXRlcy5sZW5ndGg7IGkrKylcblx0XHR7XG5cdFx0XHR2YXIgcG9pbnRBdHRyaWJ1dGVOYW1lID0gcG9pbnRBdHRyaWJ1dGVzW2ldO1xuXHRcdFx0dmFyIHBvaW50QXR0cmlidXRlID0gUG9pbnRBdHRyaWJ1dGVbcG9pbnRBdHRyaWJ1dGVOYW1lXTtcblx0XHRcdHRoaXMuYXR0cmlidXRlcy5wdXNoKHBvaW50QXR0cmlidXRlKTtcblx0XHRcdHRoaXMuYnl0ZVNpemUgKz0gcG9pbnRBdHRyaWJ1dGUuYnl0ZVNpemU7XG5cdFx0XHR0aGlzLnNpemUrKztcblx0XHR9XG5cdH1cbn07XG5cblBvaW50QXR0cmlidXRlcy5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24ocG9pbnRBdHRyaWJ1dGUpXG57XG5cdHRoaXMuYXR0cmlidXRlcy5wdXNoKHBvaW50QXR0cmlidXRlKTtcblx0dGhpcy5ieXRlU2l6ZSArPSBwb2ludEF0dHJpYnV0ZS5ieXRlU2l6ZTtcblx0dGhpcy5zaXplKys7XG59O1xuXG5Qb2ludEF0dHJpYnV0ZXMucHJvdG90eXBlLmhhc0NvbG9ycyA9IGZ1bmN0aW9uKClcbntcblx0Zm9yKHZhciBuYW1lIGluIHRoaXMuYXR0cmlidXRlcylcblx0e1xuXHRcdHZhciBwb2ludEF0dHJpYnV0ZSA9IHRoaXMuYXR0cmlidXRlc1tuYW1lXTtcblx0XHRpZihwb2ludEF0dHJpYnV0ZS5uYW1lID09PSBQb2ludEF0dHJpYnV0ZU5hbWVzLkNPTE9SX1BBQ0tFRClcblx0XHR7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG5Qb2ludEF0dHJpYnV0ZXMucHJvdG90eXBlLmhhc05vcm1hbHMgPSBmdW5jdGlvbigpXG57XG5cdGZvcih2YXIgbmFtZSBpbiB0aGlzLmF0dHJpYnV0ZXMpXG5cdHtcblx0XHR2YXIgcG9pbnRBdHRyaWJ1dGUgPSB0aGlzLmF0dHJpYnV0ZXNbbmFtZV07XG5cdFx0aWYoXG5cdFx0XHRwb2ludEF0dHJpYnV0ZSA9PT0gUG9pbnRBdHRyaWJ1dGUuTk9STUFMX1NQSEVSRU1BUFBFRCB8fFxuXHRcdFx0cG9pbnRBdHRyaWJ1dGUgPT09IFBvaW50QXR0cmlidXRlLk5PUk1BTF9GTE9BVFMgfHxcblx0XHRcdHBvaW50QXR0cmlidXRlID09PSBQb2ludEF0dHJpYnV0ZS5OT1JNQUwgfHxcblx0XHRcdHBvaW50QXR0cmlidXRlID09PSBQb2ludEF0dHJpYnV0ZS5OT1JNQUxfT0NUMTYpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBmYWxzZTtcbn07XG4iXSwic291cmNlUm9vdCI6IiJ9",null)}},"./source/workers/DEMWorker.js":function(t,e,n){t.exports=function(){return n("./node_modules/worker-loader/dist/workers/InlineWorker.js")("/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = \"./source/workers/DEMWorker.js\");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./source/workers/DEMWorker.js\":\n/*!*************************************!*\\\n  !*** ./source/workers/DEMWorker.js ***!\n  \\*************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nonmessage = function(event)\n{\n\tvar boundingBox = event.data.boundingBox;\n\tvar position = new Float32Array(event.data.position);\n\tvar numPoints = position.length / 3;\n\tvar width = 64, height = 64;\n\n\tvar boxSize =\n\t{\n\t\tx: boundingBox.max[0] - boundingBox.min[0],\n\t\ty: boundingBox.max[1] - boundingBox.min[1],\n\t\tz: boundingBox.max[2] - boundingBox.min[2]\n\t};\n\n\tvar dem = new Float32Array(width * height);\n\tdem.fill(-Infinity);\n\n\tfor(var i = 0; i < numPoints; i++)\n\t{\n\t\tvar x = position[3 * i + 0];\n\t\tvar y = position[3 * i + 1];\n\t\tvar z = position[3 * i + 2];\n\n\t\tvar dx = x / boxSize.x;\n\t\tvar dy = y / boxSize.y;\n\n\t\tvar ix = parseInt(Math.min(width * dx, width - 1));\n\t\tvar iy = parseInt(Math.min(height * dy, height - 1));\n\n\t\tvar index = ix + width * iy;\n\t\tdem[index] = z;\n\t}\n\n\tvar message =\n\t{\n\t\tdem:\n\t\t{\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\tdata: dem.buffer\n\t\t}\n\t};\n\n\tpostMessage(message, [message.dem.data]);\n};\n\n\n/***/ })\n\n/******/ });\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc291cmNlL3dvcmtlcnMvREVNV29ya2VyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7UUFBQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7UUFDQTs7O1FBR0E7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBLDBDQUEwQyxnQ0FBZ0M7UUFDMUU7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQSx3REFBd0Qsa0JBQWtCO1FBQzFFO1FBQ0EsaURBQWlELGNBQWM7UUFDL0Q7O1FBRUE7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBLHlDQUF5QyxpQ0FBaUM7UUFDMUUsZ0hBQWdILG1CQUFtQixFQUFFO1FBQ3JJO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0EsMkJBQTJCLDBCQUEwQixFQUFFO1FBQ3ZELGlDQUFpQyxlQUFlO1FBQ2hEO1FBQ0E7UUFDQTs7UUFFQTtRQUNBLHNEQUFzRCwrREFBK0Q7O1FBRXJIO1FBQ0E7OztRQUdBO1FBQ0E7Ozs7Ozs7Ozs7Ozs7QUNsRmE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLGVBQWUsZUFBZTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBIiwiZmlsZSI6ImY3NDM4YmJiODU0Y2M1MjE4MTE5Lndvcmtlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBcIi4vc291cmNlL3dvcmtlcnMvREVNV29ya2VyLmpzXCIpO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KVxue1xuXHR2YXIgYm91bmRpbmdCb3ggPSBldmVudC5kYXRhLmJvdW5kaW5nQm94O1xuXHR2YXIgcG9zaXRpb24gPSBuZXcgRmxvYXQzMkFycmF5KGV2ZW50LmRhdGEucG9zaXRpb24pO1xuXHR2YXIgbnVtUG9pbnRzID0gcG9zaXRpb24ubGVuZ3RoIC8gMztcblx0dmFyIHdpZHRoID0gNjQsIGhlaWdodCA9IDY0O1xuXG5cdHZhciBib3hTaXplID1cblx0e1xuXHRcdHg6IGJvdW5kaW5nQm94Lm1heFswXSAtIGJvdW5kaW5nQm94Lm1pblswXSxcblx0XHR5OiBib3VuZGluZ0JveC5tYXhbMV0gLSBib3VuZGluZ0JveC5taW5bMV0sXG5cdFx0ejogYm91bmRpbmdCb3gubWF4WzJdIC0gYm91bmRpbmdCb3gubWluWzJdXG5cdH07XG5cblx0dmFyIGRlbSA9IG5ldyBGbG9hdDMyQXJyYXkod2lkdGggKiBoZWlnaHQpO1xuXHRkZW0uZmlsbCgtSW5maW5pdHkpO1xuXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBudW1Qb2ludHM7IGkrKylcblx0e1xuXHRcdHZhciB4ID0gcG9zaXRpb25bMyAqIGkgKyAwXTtcblx0XHR2YXIgeSA9IHBvc2l0aW9uWzMgKiBpICsgMV07XG5cdFx0dmFyIHogPSBwb3NpdGlvblszICogaSArIDJdO1xuXG5cdFx0dmFyIGR4ID0geCAvIGJveFNpemUueDtcblx0XHR2YXIgZHkgPSB5IC8gYm94U2l6ZS55O1xuXG5cdFx0dmFyIGl4ID0gcGFyc2VJbnQoTWF0aC5taW4od2lkdGggKiBkeCwgd2lkdGggLSAxKSk7XG5cdFx0dmFyIGl5ID0gcGFyc2VJbnQoTWF0aC5taW4oaGVpZ2h0ICogZHksIGhlaWdodCAtIDEpKTtcblxuXHRcdHZhciBpbmRleCA9IGl4ICsgd2lkdGggKiBpeTtcblx0XHRkZW1baW5kZXhdID0gejtcblx0fVxuXG5cdHZhciBtZXNzYWdlID1cblx0e1xuXHRcdGRlbTpcblx0XHR7XG5cdFx0XHR3aWR0aDogd2lkdGgsXG5cdFx0XHRoZWlnaHQ6IGhlaWdodCxcblx0XHRcdGRhdGE6IGRlbS5idWZmZXJcblx0XHR9XG5cdH07XG5cblx0cG9zdE1lc3NhZ2UobWVzc2FnZSwgW21lc3NhZ2UuZGVtLmRhdGFdKTtcbn07XG4iXSwic291cmNlUm9vdCI6IiJ9",null)}},"./source/workers/EptBinaryDecoderWorker.js":function(t,e,n){t.exports=function(){return n("./node_modules/worker-loader/dist/workers/InlineWorker.js")('/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== \'undefined\' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: \'Module\' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, \'__esModule\', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === \'object\' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, \'default\', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != \'string\') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module[\'default\']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, \'a\', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = "";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = "./source/workers/EptBinaryDecoderWorker.js");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ "./source/workers/EptBinaryDecoderWorker.js":\n/*!**************************************************!*\\\n  !*** ./source/workers/EptBinaryDecoderWorker.js ***!\n  \\**************************************************/\n/*! no static exports found */\n/***/ (function(module, exports) {\n\nPotree = { };\n\nonmessage = function(event) {\n  if (!event.data || !event.data.buffer) {\n    return;\n  }\n\tlet buffer = event.data.buffer;\n\tlet view = new DataView(buffer);\n\tlet schema = event.data.schema;\n\tlet scale = event.data.scale;\n\tlet offset = event.data.offset;\n\tlet mins = event.data.mins;\n\n\tlet dimensions = schema.reduce((p, c) => {\n\t\tp[c.name] = c;\n\t\treturn p;\n\t}, { });\n\n\tlet dimOffset = (name) => {\n\t\tlet offset = 0;\n\t\tfor (var i = 0; i < schema.length; ++i) {\n\t\t\tif (schema[i].name == name) return offset;\n\t\t\toffset += schema[i].size;\n\t\t}\n\t\treturn undefined;\n\t};\n\n\tlet getExtractor = (name) => {\n\t\tlet offset = dimOffset(name);\n\t\tlet type = dimensions[name].type;\n\t\tlet size = dimensions[name].size;\n\n\t\tif (type == "signed") switch (size) {\n\t\t\tcase 1: return (p) => view.getInt8(p + offset);\n\t\t\tcase 2: return (p) => view.getInt16(p + offset, true);\n\t\t\tcase 4: return (p) => view.getInt32(p + offset, true);\n\t\t\tcase 8: return (p) => view.getInt64(p + offset, true);\n\t\t}\n\t\tif (type == "unsigned") switch (size) {\n\t\t\tcase 1: return (p) => view.getUint8(p + offset);\n\t\t\tcase 2: return (p) => view.getUint16(p + offset, true);\n\t\t\tcase 4: return (p) => view.getUint32(p + offset, true);\n\t\t\tcase 8: return (p) => view.getUint64(p + offset, true);\n\t\t}\n\t\tif (type == "float") switch (size) {\n\t\t\tcase 4: return (p) => view.getFloat32(p + offset, true);\n\t\t\tcase 8: return (p) => view.getFloat64(p + offset, true);\n\t\t}\n\n\t\tlet str = JSON.stringify(dimensions[name]);\n\t\tthrow new Error(`Invalid dimension specification for ${name}: ${str}`);\n\t};\n\n\tlet pointSize = schema.reduce((p, c) => p + c.size, 0);\n\tlet numPoints = buffer.byteLength / pointSize;\n\n\tlet xyzBuffer, rgbBuffer, intensityBuffer, classificationBuffer,\n\t\treturnNumberBuffer, numberOfReturnsBuffer, pointSourceIdBuffer;\n\tlet xyz, rgb, intensity, classification, returnNumber, numberOfReturns,\n\t\tpointSourceId;\n\tlet xyzExtractor, rgbExtractor, intensityExtractor, classificationExtractor,\n\t\treturnNumberExtractor, numberOfReturnsExtractor, pointSourceIdExtractor;\n\tlet twoByteColor = false;\n\n\tif (dimensions["X"] && dimensions["Y"] && dimensions["Z"]) {\n\t\txyzBuffer = new ArrayBuffer(numPoints * 4 * 3);\n\t\txyz = new Float32Array(xyzBuffer);\n\t\txyzExtractor = [\n\t\t\tgetExtractor("X"),\n\t\t\tgetExtractor("Y"),\n\t\t\tgetExtractor("Z")\n\t\t];\n\t}\n\n\tif (dimensions["Red"] && dimensions["Green"] && dimensions["Blue"]) {\n\t\trgbBuffer = new ArrayBuffer(numPoints * 4);\n\t\trgb = new Uint8Array(rgbBuffer);\n\t\trgbExtractor = [\n\t\t\tgetExtractor("Red"),\n\t\t\tgetExtractor("Green"),\n\t\t\tgetExtractor("Blue")\n\t\t];\n\n\t\tlet r, g, b, pos;\n\t\tfor (let i = 0; i < numPoints && !twoByteColor; ++i) {\n\t\t\tpos = i * pointSize;\n\t\t\tr = rgbExtractor[0](pos);\n\t\t\tg = rgbExtractor[1](pos);\n\t\t\tb = rgbExtractor[2](pos);\n\t\t\tif (r > 255 || g > 255 || b > 255) twoByteColor = true;\n\t\t}\n\t}\n\n\tif (dimensions["Intensity"]) {\n\t\tintensityBuffer = new ArrayBuffer(numPoints * 4);\n\t\tintensity = new Float32Array(intensityBuffer);\n\t\tintensityExtractor = getExtractor("Intensity");\n\t}\n\n\tif (dimensions["Classification"]) {\n\t\tclassificationBuffer = new ArrayBuffer(numPoints);\n\t\tclassification = new Uint8Array(classificationBuffer);\n\t\tclassificationExtractor = getExtractor("Classification");\n\t}\n\n\tif (dimensions["ReturnNumber"]) {\n\t\treturnNumberBuffer = new ArrayBuffer(numPoints);\n\t\treturnNumber = new Uint8Array(returnNumberBuffer);\n\t\treturnNumberExtractor = getExtractor("ReturnNumber");\n\t}\n\n\tif (dimensions["NumberOfReturns"]) {\n\t\tnumberOfReturnsBuffer = new ArrayBuffer(numPoints);\n\t\tnumberOfReturns = new Uint8Array(numberOfReturnsBuffer);\n\t\tnumberOfReturnsExtractor = getExtractor("NumberOfReturns");\n\t}\n\n\tif (dimensions["PointSourceId"]) {\n\t\tpointSourceIdBuffer = new ArrayBuffer(numPoints * 2);\n\t\tpointSourceId = new Uint16Array(pointSourceIdBuffer);\n\t\tpointSourceIdExtractor = getExtractor("PointSourceId");\n\t}\n\n\tlet mean = [0, 0, 0];\n\tlet bounds = {\n\t\tmin: [Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE],\n\t\tmax: [-Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE],\n\t};\n\n\tlet x, y, z, r, g, b;\n\tfor (let i = 0; i < numPoints; ++i) {\n\t\tlet pos = i * pointSize;\n\t\tif (xyz) {\n\t\t\tx = xyzExtractor[0](pos) * scale.x + offset.x - mins[0];\n\t\t\ty = xyzExtractor[1](pos) * scale.y + offset.y - mins[1];\n\t\t\tz = xyzExtractor[2](pos) * scale.z + offset.z - mins[2];\n\n\t\t\tmean[0] += x / numPoints;\n\t\t\tmean[1] += y / numPoints;\n\t\t\tmean[2] += z / numPoints;\n\n\t\t\tbounds.min[0] = Math.min(bounds.min[0], x);\n\t\t\tbounds.min[1] = Math.min(bounds.min[1], y);\n\t\t\tbounds.min[2] = Math.min(bounds.min[2], z);\n\n\t\t\tbounds.max[0] = Math.max(bounds.max[0], x);\n\t\t\tbounds.max[1] = Math.max(bounds.max[1], y);\n\t\t\tbounds.max[2] = Math.max(bounds.max[2], z);\n\n\t\t\txyz[3 * i + 0] = x;\n\t\t\txyz[3 * i + 1] = y;\n\t\t\txyz[3 * i + 2] = z;\n\t\t}\n\n\t\tif (rgb) {\n\t\t\tr = rgbExtractor[0](pos);\n\t\t\tg = rgbExtractor[1](pos);\n\t\t\tb = rgbExtractor[2](pos);\n\n\t\t\tif (twoByteColor) {\n\t\t\t\tr /= 256;\n\t\t\t\tg /= 256;\n\t\t\t\tb /= 256;\n\t\t\t}\n\n\t\t\trgb[4 * i + 0] = r;\n\t\t\trgb[4 * i + 1] = g;\n\t\t\trgb[4 * i + 2] = b;\n\t\t}\n\n\t\tif (intensity) intensity[i] = intensityExtractor(pos);\n\t\tif (classification) classification[i] = classificationExtractor(pos);\n\t\tif (returnNumber) returnNumber[i] = returnNumberExtractor(pos);\n\t\tif (numberOfReturns) numberOfReturns[i] = numberOfReturnsExtractor(pos);\n\t\tif (pointSourceId) pointSourceId[i] = pointSourceIdExtractor(pos);\n\t}\n\n\tlet indicesBuffer = new ArrayBuffer(numPoints * 4);\n\tlet indices = new Uint32Array(indicesBuffer);\n\tfor (let i = 0; i < numPoints; ++i) {\n\t\tindices[i] = i;\n\t}\n\n\tlet message = {\n\t\tnumPoints: numPoints,\n\t\ttightBoundingBox: bounds,\n\t\tmean: mean,\n\n\t\tposition: xyzBuffer,\n\t\tcolor: rgbBuffer,\n\t\tintensity: intensityBuffer,\n\t\tclassification: classificationBuffer,\n\t\treturnNumber: returnNumberBuffer,\n\t\tnumberOfReturns: numberOfReturnsBuffer,\n\t\tpointSourceId: pointSourceIdBuffer,\n\t\tindices: indicesBuffer\n\t};\n\n\tlet transferables = [\n\t\tmessage.position,\n\t\tmessage.color,\n\t\tmessage.intensity,\n\t\tmessage.classification,\n\t\tmessage.returnNumber,\n\t\tmessage.numberOfReturns,\n\t\tmessage.pointSourceId,\n\t\tmessage.indices\n\t].filter((v) => v);\n\n\tpostMessage(message, transferables);\n}\n\n\n\n/***/ })\n\n/******/ });\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc291cmNlL3dvcmtlcnMvRXB0QmluYXJ5RGVjb2Rlcldvcmtlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO1FBQUE7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7OztRQUdBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQSwwQ0FBMEMsZ0NBQWdDO1FBQzFFO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0Esd0RBQXdELGtCQUFrQjtRQUMxRTtRQUNBLGlEQUFpRCxjQUFjO1FBQy9EOztRQUVBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQSx5Q0FBeUMsaUNBQWlDO1FBQzFFLGdIQUFnSCxtQkFBbUIsRUFBRTtRQUNySTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBLDJCQUEyQiwwQkFBMEIsRUFBRTtRQUN2RCxpQ0FBaUMsZUFBZTtRQUNoRDtRQUNBO1FBQ0E7O1FBRUE7UUFDQSxzREFBc0QsK0RBQStEOztRQUVySDtRQUNBOzs7UUFHQTtRQUNBOzs7Ozs7Ozs7Ozs7QUNsRkEsVUFBVTs7QUFFVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLEdBQUcsRUFBRTs7QUFFUDtBQUNBO0FBQ0EsaUJBQWlCLG1CQUFtQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EseURBQXlELEtBQUssSUFBSSxJQUFJO0FBQ3RFOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQkFBaUIsZ0NBQWdDO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZ0JBQWdCLGVBQWU7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0JBQWdCLGVBQWU7QUFDL0I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSIsImZpbGUiOiI0MTdlZjc0M2NlNDU3MDUxNDdhNi53b3JrZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gXCIuL3NvdXJjZS93b3JrZXJzL0VwdEJpbmFyeURlY29kZXJXb3JrZXIuanNcIik7XG4iLCJQb3RyZWUgPSB7IH07XG5cbm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gIGlmICghZXZlbnQuZGF0YSB8fCAhZXZlbnQuZGF0YS5idWZmZXIpIHtcbiAgICByZXR1cm47XG4gIH1cblx0bGV0IGJ1ZmZlciA9IGV2ZW50LmRhdGEuYnVmZmVyO1xuXHRsZXQgdmlldyA9IG5ldyBEYXRhVmlldyhidWZmZXIpO1xuXHRsZXQgc2NoZW1hID0gZXZlbnQuZGF0YS5zY2hlbWE7XG5cdGxldCBzY2FsZSA9IGV2ZW50LmRhdGEuc2NhbGU7XG5cdGxldCBvZmZzZXQgPSBldmVudC5kYXRhLm9mZnNldDtcblx0bGV0IG1pbnMgPSBldmVudC5kYXRhLm1pbnM7XG5cblx0bGV0IGRpbWVuc2lvbnMgPSBzY2hlbWEucmVkdWNlKChwLCBjKSA9PiB7XG5cdFx0cFtjLm5hbWVdID0gYztcblx0XHRyZXR1cm4gcDtcblx0fSwgeyB9KTtcblxuXHRsZXQgZGltT2Zmc2V0ID0gKG5hbWUpID0+IHtcblx0XHRsZXQgb2Zmc2V0ID0gMDtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHNjaGVtYS5sZW5ndGg7ICsraSkge1xuXHRcdFx0aWYgKHNjaGVtYVtpXS5uYW1lID09IG5hbWUpIHJldHVybiBvZmZzZXQ7XG5cdFx0XHRvZmZzZXQgKz0gc2NoZW1hW2ldLnNpemU7XG5cdFx0fVxuXHRcdHJldHVybiB1bmRlZmluZWQ7XG5cdH07XG5cblx0bGV0IGdldEV4dHJhY3RvciA9IChuYW1lKSA9PiB7XG5cdFx0bGV0IG9mZnNldCA9IGRpbU9mZnNldChuYW1lKTtcblx0XHRsZXQgdHlwZSA9IGRpbWVuc2lvbnNbbmFtZV0udHlwZTtcblx0XHRsZXQgc2l6ZSA9IGRpbWVuc2lvbnNbbmFtZV0uc2l6ZTtcblxuXHRcdGlmICh0eXBlID09IFwic2lnbmVkXCIpIHN3aXRjaCAoc2l6ZSkge1xuXHRcdFx0Y2FzZSAxOiByZXR1cm4gKHApID0+IHZpZXcuZ2V0SW50OChwICsgb2Zmc2V0KTtcblx0XHRcdGNhc2UgMjogcmV0dXJuIChwKSA9PiB2aWV3LmdldEludDE2KHAgKyBvZmZzZXQsIHRydWUpO1xuXHRcdFx0Y2FzZSA0OiByZXR1cm4gKHApID0+IHZpZXcuZ2V0SW50MzIocCArIG9mZnNldCwgdHJ1ZSk7XG5cdFx0XHRjYXNlIDg6IHJldHVybiAocCkgPT4gdmlldy5nZXRJbnQ2NChwICsgb2Zmc2V0LCB0cnVlKTtcblx0XHR9XG5cdFx0aWYgKHR5cGUgPT0gXCJ1bnNpZ25lZFwiKSBzd2l0Y2ggKHNpemUpIHtcblx0XHRcdGNhc2UgMTogcmV0dXJuIChwKSA9PiB2aWV3LmdldFVpbnQ4KHAgKyBvZmZzZXQpO1xuXHRcdFx0Y2FzZSAyOiByZXR1cm4gKHApID0+IHZpZXcuZ2V0VWludDE2KHAgKyBvZmZzZXQsIHRydWUpO1xuXHRcdFx0Y2FzZSA0OiByZXR1cm4gKHApID0+IHZpZXcuZ2V0VWludDMyKHAgKyBvZmZzZXQsIHRydWUpO1xuXHRcdFx0Y2FzZSA4OiByZXR1cm4gKHApID0+IHZpZXcuZ2V0VWludDY0KHAgKyBvZmZzZXQsIHRydWUpO1xuXHRcdH1cblx0XHRpZiAodHlwZSA9PSBcImZsb2F0XCIpIHN3aXRjaCAoc2l6ZSkge1xuXHRcdFx0Y2FzZSA0OiByZXR1cm4gKHApID0+IHZpZXcuZ2V0RmxvYXQzMihwICsgb2Zmc2V0LCB0cnVlKTtcblx0XHRcdGNhc2UgODogcmV0dXJuIChwKSA9PiB2aWV3LmdldEZsb2F0NjQocCArIG9mZnNldCwgdHJ1ZSk7XG5cdFx0fVxuXG5cdFx0bGV0IHN0ciA9IEpTT04uc3RyaW5naWZ5KGRpbWVuc2lvbnNbbmFtZV0pO1xuXHRcdHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBkaW1lbnNpb24gc3BlY2lmaWNhdGlvbiBmb3IgJHtuYW1lfTogJHtzdHJ9YCk7XG5cdH07XG5cblx0bGV0IHBvaW50U2l6ZSA9IHNjaGVtYS5yZWR1Y2UoKHAsIGMpID0+IHAgKyBjLnNpemUsIDApO1xuXHRsZXQgbnVtUG9pbnRzID0gYnVmZmVyLmJ5dGVMZW5ndGggLyBwb2ludFNpemU7XG5cblx0bGV0IHh5ekJ1ZmZlciwgcmdiQnVmZmVyLCBpbnRlbnNpdHlCdWZmZXIsIGNsYXNzaWZpY2F0aW9uQnVmZmVyLFxuXHRcdHJldHVybk51bWJlckJ1ZmZlciwgbnVtYmVyT2ZSZXR1cm5zQnVmZmVyLCBwb2ludFNvdXJjZUlkQnVmZmVyO1xuXHRsZXQgeHl6LCByZ2IsIGludGVuc2l0eSwgY2xhc3NpZmljYXRpb24sIHJldHVybk51bWJlciwgbnVtYmVyT2ZSZXR1cm5zLFxuXHRcdHBvaW50U291cmNlSWQ7XG5cdGxldCB4eXpFeHRyYWN0b3IsIHJnYkV4dHJhY3RvciwgaW50ZW5zaXR5RXh0cmFjdG9yLCBjbGFzc2lmaWNhdGlvbkV4dHJhY3Rvcixcblx0XHRyZXR1cm5OdW1iZXJFeHRyYWN0b3IsIG51bWJlck9mUmV0dXJuc0V4dHJhY3RvciwgcG9pbnRTb3VyY2VJZEV4dHJhY3Rvcjtcblx0bGV0IHR3b0J5dGVDb2xvciA9IGZhbHNlO1xuXG5cdGlmIChkaW1lbnNpb25zW1wiWFwiXSAmJiBkaW1lbnNpb25zW1wiWVwiXSAmJiBkaW1lbnNpb25zW1wiWlwiXSkge1xuXHRcdHh5ekJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMgKiA0ICogMyk7XG5cdFx0eHl6ID0gbmV3IEZsb2F0MzJBcnJheSh4eXpCdWZmZXIpO1xuXHRcdHh5ekV4dHJhY3RvciA9IFtcblx0XHRcdGdldEV4dHJhY3RvcihcIlhcIiksXG5cdFx0XHRnZXRFeHRyYWN0b3IoXCJZXCIpLFxuXHRcdFx0Z2V0RXh0cmFjdG9yKFwiWlwiKVxuXHRcdF07XG5cdH1cblxuXHRpZiAoZGltZW5zaW9uc1tcIlJlZFwiXSAmJiBkaW1lbnNpb25zW1wiR3JlZW5cIl0gJiYgZGltZW5zaW9uc1tcIkJsdWVcIl0pIHtcblx0XHRyZ2JCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIobnVtUG9pbnRzICogNCk7XG5cdFx0cmdiID0gbmV3IFVpbnQ4QXJyYXkocmdiQnVmZmVyKTtcblx0XHRyZ2JFeHRyYWN0b3IgPSBbXG5cdFx0XHRnZXRFeHRyYWN0b3IoXCJSZWRcIiksXG5cdFx0XHRnZXRFeHRyYWN0b3IoXCJHcmVlblwiKSxcblx0XHRcdGdldEV4dHJhY3RvcihcIkJsdWVcIilcblx0XHRdO1xuXG5cdFx0bGV0IHIsIGcsIGIsIHBvcztcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IG51bVBvaW50cyAmJiAhdHdvQnl0ZUNvbG9yOyArK2kpIHtcblx0XHRcdHBvcyA9IGkgKiBwb2ludFNpemU7XG5cdFx0XHRyID0gcmdiRXh0cmFjdG9yWzBdKHBvcyk7XG5cdFx0XHRnID0gcmdiRXh0cmFjdG9yWzFdKHBvcyk7XG5cdFx0XHRiID0gcmdiRXh0cmFjdG9yWzJdKHBvcyk7XG5cdFx0XHRpZiAociA+IDI1NSB8fCBnID4gMjU1IHx8IGIgPiAyNTUpIHR3b0J5dGVDb2xvciA9IHRydWU7XG5cdFx0fVxuXHR9XG5cblx0aWYgKGRpbWVuc2lvbnNbXCJJbnRlbnNpdHlcIl0pIHtcblx0XHRpbnRlbnNpdHlCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIobnVtUG9pbnRzICogNCk7XG5cdFx0aW50ZW5zaXR5ID0gbmV3IEZsb2F0MzJBcnJheShpbnRlbnNpdHlCdWZmZXIpO1xuXHRcdGludGVuc2l0eUV4dHJhY3RvciA9IGdldEV4dHJhY3RvcihcIkludGVuc2l0eVwiKTtcblx0fVxuXG5cdGlmIChkaW1lbnNpb25zW1wiQ2xhc3NpZmljYXRpb25cIl0pIHtcblx0XHRjbGFzc2lmaWNhdGlvbkJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMpO1xuXHRcdGNsYXNzaWZpY2F0aW9uID0gbmV3IFVpbnQ4QXJyYXkoY2xhc3NpZmljYXRpb25CdWZmZXIpO1xuXHRcdGNsYXNzaWZpY2F0aW9uRXh0cmFjdG9yID0gZ2V0RXh0cmFjdG9yKFwiQ2xhc3NpZmljYXRpb25cIik7XG5cdH1cblxuXHRpZiAoZGltZW5zaW9uc1tcIlJldHVybk51bWJlclwiXSkge1xuXHRcdHJldHVybk51bWJlckJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMpO1xuXHRcdHJldHVybk51bWJlciA9IG5ldyBVaW50OEFycmF5KHJldHVybk51bWJlckJ1ZmZlcik7XG5cdFx0cmV0dXJuTnVtYmVyRXh0cmFjdG9yID0gZ2V0RXh0cmFjdG9yKFwiUmV0dXJuTnVtYmVyXCIpO1xuXHR9XG5cblx0aWYgKGRpbWVuc2lvbnNbXCJOdW1iZXJPZlJldHVybnNcIl0pIHtcblx0XHRudW1iZXJPZlJldHVybnNCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIobnVtUG9pbnRzKTtcblx0XHRudW1iZXJPZlJldHVybnMgPSBuZXcgVWludDhBcnJheShudW1iZXJPZlJldHVybnNCdWZmZXIpO1xuXHRcdG51bWJlck9mUmV0dXJuc0V4dHJhY3RvciA9IGdldEV4dHJhY3RvcihcIk51bWJlck9mUmV0dXJuc1wiKTtcblx0fVxuXG5cdGlmIChkaW1lbnNpb25zW1wiUG9pbnRTb3VyY2VJZFwiXSkge1xuXHRcdHBvaW50U291cmNlSWRCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIobnVtUG9pbnRzICogMik7XG5cdFx0cG9pbnRTb3VyY2VJZCA9IG5ldyBVaW50MTZBcnJheShwb2ludFNvdXJjZUlkQnVmZmVyKTtcblx0XHRwb2ludFNvdXJjZUlkRXh0cmFjdG9yID0gZ2V0RXh0cmFjdG9yKFwiUG9pbnRTb3VyY2VJZFwiKTtcblx0fVxuXG5cdGxldCBtZWFuID0gWzAsIDAsIDBdO1xuXHRsZXQgYm91bmRzID0ge1xuXHRcdG1pbjogW051bWJlci5NQVhfVkFMVUUsIE51bWJlci5NQVhfVkFMVUUsIE51bWJlci5NQVhfVkFMVUVdLFxuXHRcdG1heDogWy1OdW1iZXIuTUFYX1ZBTFVFLCAtTnVtYmVyLk1BWF9WQUxVRSwgLU51bWJlci5NQVhfVkFMVUVdLFxuXHR9O1xuXG5cdGxldCB4LCB5LCB6LCByLCBnLCBiO1xuXHRmb3IgKGxldCBpID0gMDsgaSA8IG51bVBvaW50czsgKytpKSB7XG5cdFx0bGV0IHBvcyA9IGkgKiBwb2ludFNpemU7XG5cdFx0aWYgKHh5eikge1xuXHRcdFx0eCA9IHh5ekV4dHJhY3RvclswXShwb3MpICogc2NhbGUueCArIG9mZnNldC54IC0gbWluc1swXTtcblx0XHRcdHkgPSB4eXpFeHRyYWN0b3JbMV0ocG9zKSAqIHNjYWxlLnkgKyBvZmZzZXQueSAtIG1pbnNbMV07XG5cdFx0XHR6ID0geHl6RXh0cmFjdG9yWzJdKHBvcykgKiBzY2FsZS56ICsgb2Zmc2V0LnogLSBtaW5zWzJdO1xuXG5cdFx0XHRtZWFuWzBdICs9IHggLyBudW1Qb2ludHM7XG5cdFx0XHRtZWFuWzFdICs9IHkgLyBudW1Qb2ludHM7XG5cdFx0XHRtZWFuWzJdICs9IHogLyBudW1Qb2ludHM7XG5cblx0XHRcdGJvdW5kcy5taW5bMF0gPSBNYXRoLm1pbihib3VuZHMubWluWzBdLCB4KTtcblx0XHRcdGJvdW5kcy5taW5bMV0gPSBNYXRoLm1pbihib3VuZHMubWluWzFdLCB5KTtcblx0XHRcdGJvdW5kcy5taW5bMl0gPSBNYXRoLm1pbihib3VuZHMubWluWzJdLCB6KTtcblxuXHRcdFx0Ym91bmRzLm1heFswXSA9IE1hdGgubWF4KGJvdW5kcy5tYXhbMF0sIHgpO1xuXHRcdFx0Ym91bmRzLm1heFsxXSA9IE1hdGgubWF4KGJvdW5kcy5tYXhbMV0sIHkpO1xuXHRcdFx0Ym91bmRzLm1heFsyXSA9IE1hdGgubWF4KGJvdW5kcy5tYXhbMl0sIHopO1xuXG5cdFx0XHR4eXpbMyAqIGkgKyAwXSA9IHg7XG5cdFx0XHR4eXpbMyAqIGkgKyAxXSA9IHk7XG5cdFx0XHR4eXpbMyAqIGkgKyAyXSA9IHo7XG5cdFx0fVxuXG5cdFx0aWYgKHJnYikge1xuXHRcdFx0ciA9IHJnYkV4dHJhY3RvclswXShwb3MpO1xuXHRcdFx0ZyA9IHJnYkV4dHJhY3RvclsxXShwb3MpO1xuXHRcdFx0YiA9IHJnYkV4dHJhY3RvclsyXShwb3MpO1xuXG5cdFx0XHRpZiAodHdvQnl0ZUNvbG9yKSB7XG5cdFx0XHRcdHIgLz0gMjU2O1xuXHRcdFx0XHRnIC89IDI1Njtcblx0XHRcdFx0YiAvPSAyNTY7XG5cdFx0XHR9XG5cblx0XHRcdHJnYls0ICogaSArIDBdID0gcjtcblx0XHRcdHJnYls0ICogaSArIDFdID0gZztcblx0XHRcdHJnYls0ICogaSArIDJdID0gYjtcblx0XHR9XG5cblx0XHRpZiAoaW50ZW5zaXR5KSBpbnRlbnNpdHlbaV0gPSBpbnRlbnNpdHlFeHRyYWN0b3IocG9zKTtcblx0XHRpZiAoY2xhc3NpZmljYXRpb24pIGNsYXNzaWZpY2F0aW9uW2ldID0gY2xhc3NpZmljYXRpb25FeHRyYWN0b3IocG9zKTtcblx0XHRpZiAocmV0dXJuTnVtYmVyKSByZXR1cm5OdW1iZXJbaV0gPSByZXR1cm5OdW1iZXJFeHRyYWN0b3IocG9zKTtcblx0XHRpZiAobnVtYmVyT2ZSZXR1cm5zKSBudW1iZXJPZlJldHVybnNbaV0gPSBudW1iZXJPZlJldHVybnNFeHRyYWN0b3IocG9zKTtcblx0XHRpZiAocG9pbnRTb3VyY2VJZCkgcG9pbnRTb3VyY2VJZFtpXSA9IHBvaW50U291cmNlSWRFeHRyYWN0b3IocG9zKTtcblx0fVxuXG5cdGxldCBpbmRpY2VzQnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDQpO1xuXHRsZXQgaW5kaWNlcyA9IG5ldyBVaW50MzJBcnJheShpbmRpY2VzQnVmZmVyKTtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBudW1Qb2ludHM7ICsraSkge1xuXHRcdGluZGljZXNbaV0gPSBpO1xuXHR9XG5cblx0bGV0IG1lc3NhZ2UgPSB7XG5cdFx0bnVtUG9pbnRzOiBudW1Qb2ludHMsXG5cdFx0dGlnaHRCb3VuZGluZ0JveDogYm91bmRzLFxuXHRcdG1lYW46IG1lYW4sXG5cblx0XHRwb3NpdGlvbjogeHl6QnVmZmVyLFxuXHRcdGNvbG9yOiByZ2JCdWZmZXIsXG5cdFx0aW50ZW5zaXR5OiBpbnRlbnNpdHlCdWZmZXIsXG5cdFx0Y2xhc3NpZmljYXRpb246IGNsYXNzaWZpY2F0aW9uQnVmZmVyLFxuXHRcdHJldHVybk51bWJlcjogcmV0dXJuTnVtYmVyQnVmZmVyLFxuXHRcdG51bWJlck9mUmV0dXJuczogbnVtYmVyT2ZSZXR1cm5zQnVmZmVyLFxuXHRcdHBvaW50U291cmNlSWQ6IHBvaW50U291cmNlSWRCdWZmZXIsXG5cdFx0aW5kaWNlczogaW5kaWNlc0J1ZmZlclxuXHR9O1xuXG5cdGxldCB0cmFuc2ZlcmFibGVzID0gW1xuXHRcdG1lc3NhZ2UucG9zaXRpb24sXG5cdFx0bWVzc2FnZS5jb2xvcixcblx0XHRtZXNzYWdlLmludGVuc2l0eSxcblx0XHRtZXNzYWdlLmNsYXNzaWZpY2F0aW9uLFxuXHRcdG1lc3NhZ2UucmV0dXJuTnVtYmVyLFxuXHRcdG1lc3NhZ2UubnVtYmVyT2ZSZXR1cm5zLFxuXHRcdG1lc3NhZ2UucG9pbnRTb3VyY2VJZCxcblx0XHRtZXNzYWdlLmluZGljZXNcblx0XS5maWx0ZXIoKHYpID0+IHYpO1xuXG5cdHBvc3RNZXNzYWdlKG1lc3NhZ2UsIHRyYW5zZmVyYWJsZXMpO1xufVxuXG4iXSwic291cmNlUm9vdCI6IiJ9',null)}},"./source/workers/EptLaszipDecoderWorker.js":function(t,e,n){t.exports=function(){return n("./node_modules/worker-loader/dist/workers/InlineWorker.js")('/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== \'undefined\' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: \'Module\' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, \'__esModule\', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === \'object\' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, \'default\', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != \'string\') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module[\'default\']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, \'a\', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = "";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = "./source/workers/EptLaszipDecoderWorker.js");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ "./source/workers/EptLaszipDecoderWorker.js":\n/*!**************************************************!*\\\n  !*** ./source/workers/EptLaszipDecoderWorker.js ***!\n  \\**************************************************/\n/*! no static exports found */\n/***/ (function(module, exports) {\n\nfunction readUsingDataView(event) {\n  performance.mark("laslaz-start");\n\n  if (!event.data || !event.data.buffer) {\n    return;\n  }\n\n\tlet buffer = event.data.buffer;\n\tlet numPoints = event.data.numPoints;\n\tlet pointSize = event.data.pointSize;\n\tlet pointFormat = event.data.pointFormatID;\n\tlet scale = event.data.scale;\n\tlet offset = event.data.offset;\n\n\tlet sourceUint8 = new Uint8Array(buffer);\n\tlet sourceView = new DataView(buffer);\n\n\tlet tightBoundingBox = {\n\t\tmin: [\n\t\t\tNumber.POSITIVE_INFINITY,\n\t\t\tNumber.POSITIVE_INFINITY,\n\t\t\tNumber.POSITIVE_INFINITY\n\t\t],\n\t\tmax: [\n\t\t\tNumber.NEGATIVE_INFINITY,\n\t\t\tNumber.NEGATIVE_INFINITY,\n\t\t\tNumber.NEGATIVE_INFINITY\n\t\t]\n\t};\n\n\tlet mean = [0, 0, 0];\n\n\tlet pBuff = new ArrayBuffer(numPoints * 3 * 4);\n\tlet cBuff = new ArrayBuffer(numPoints * 4);\n\tlet iBuff = new ArrayBuffer(numPoints * 4);\n\tlet clBuff = new ArrayBuffer(numPoints);\n\tlet rnBuff = new ArrayBuffer(numPoints);\n\tlet nrBuff = new ArrayBuffer(numPoints);\n\tlet psBuff = new ArrayBuffer(numPoints * 2);\n\n\tlet positions = new Float32Array(pBuff);\n\tlet colors = new Uint8Array(cBuff);\n\tlet intensities = new Float32Array(iBuff);\n\tlet classifications = new Uint8Array(clBuff);\n\tlet returnNumbers = new Uint8Array(rnBuff);\n\tlet numberOfReturns = new Uint8Array(nrBuff);\n\tlet pointSourceIDs = new Uint16Array(psBuff);\n\n\t// Point format 3 contains an 8-byte GpsTime before RGB values, so make\n\t// sure we have the correct color offset.\n\tlet hasColor = pointFormat == 2 || pointFormat == 3;\n\tlet co = pointFormat == 2 ? 20 : 28;\n\n\t// TODO This should be cached per-resource since this is an expensive check.\n\tlet twoByteColor = false;\n\tif (hasColor) {\n\t\tlet r, g, b, pos;\n\t\tfor (let i = 0; i < numPoints && !twoByteColor; ++i) {\n\t\t\tpos = i * pointSize;\n\t\t\tr = sourceView.getUint16(pos + co, true)\n\t\t\tg = sourceView.getUint16(pos + co + 2, true)\n\t\t\tb = sourceView.getUint16(pos + co + 4, true)\n\t\t\tif (r > 255 || g > 255 || b > 255) twoByteColor = true;\n\t\t}\n\t}\n\n\tfor (let i = 0; i < numPoints; i++) {\n\t\t// POSITION\n\t\tlet ux = sourceView.getInt32(i * pointSize + 0, true);\n\t\tlet uy = sourceView.getInt32(i * pointSize + 4, true);\n\t\tlet uz = sourceView.getInt32(i * pointSize + 8, true);\n\n\t\tx = ux * scale[0] + offset[0] - event.data.mins[0];\n\t\ty = uy * scale[1] + offset[1] - event.data.mins[1];\n\t\tz = uz * scale[2] + offset[2] - event.data.mins[2];\n\n\t\tpositions[3 * i + 0] = x;\n\t\tpositions[3 * i + 1] = y;\n\t\tpositions[3 * i + 2] = z;\n\n\t\tmean[0] += x / numPoints;\n\t\tmean[1] += y / numPoints;\n\t\tmean[2] += z / numPoints;\n\n\t\ttightBoundingBox.min[0] = Math.min(tightBoundingBox.min[0], x);\n\t\ttightBoundingBox.min[1] = Math.min(tightBoundingBox.min[1], y);\n\t\ttightBoundingBox.min[2] = Math.min(tightBoundingBox.min[2], z);\n\n\t\ttightBoundingBox.max[0] = Math.max(tightBoundingBox.max[0], x);\n\t\ttightBoundingBox.max[1] = Math.max(tightBoundingBox.max[1], y);\n\t\ttightBoundingBox.max[2] = Math.max(tightBoundingBox.max[2], z);\n\n\t\t// INTENSITY\n\t\tlet intensity = sourceView.getUint16(i * pointSize + 12, true);\n\t\tintensities[i] = intensity;\n\n\t\t// RETURN NUMBER, stored in the first 3 bits - 00000111\n\t\t// number of returns stored in next 3 bits\t - 00111000\n\t\tlet returnNumberAndNumberOfReturns = sourceView.getUint8(i * pointSize + 14, true);\n\t\tlet returnNumber = returnNumberAndNumberOfReturns & 0b0111;\n\t\tlet numberOfReturn = (returnNumberAndNumberOfReturns & 0b00111000) >> 3;\n\t\treturnNumbers[i] = returnNumber;\n\t\tnumberOfReturns[i] = numberOfReturn;\n\n\t\t// CLASSIFICATION\n\t\tlet classification = sourceView.getUint8(i * pointSize + 15, true);\n\t\tclassifications[i] = classification;\n\n\t\t// POINT SOURCE ID\n\t\tlet pointSourceID = sourceView.getUint16(i * pointSize + 18, true);\n\t\tpointSourceIDs[i] = pointSourceID;\n\n\t\t// COLOR, if available\n\t\tif (hasColor) {\n\t\t\tlet r = sourceView.getUint16(i * pointSize + co, true)\n\t\t\tlet g = sourceView.getUint16(i * pointSize + co + 2, true)\n\t\t\tlet b = sourceView.getUint16(i * pointSize + co + 4, true)\n\n\t\t\tif (twoByteColor) {\n\t\t\t\tr /= 256;\n\t\t\t\tg /= 256;\n\t\t\t\tb /= 256;\n\t\t\t}\n\n\t\t\tcolors[4 * i + 0] = r;\n\t\t\tcolors[4 * i + 1] = g;\n\t\t\tcolors[4 * i + 2] = b;\n\t\t\tcolors[4 * i + 3] = 255;\n\t\t}\n\t}\n\n\tlet indices = new ArrayBuffer(numPoints * 4);\n\tlet iIndices = new Uint32Array(indices);\n\tfor (let i = 0; i < numPoints; i++) {\n\t\tiIndices[i] = i;\n\t}\n\n\tperformance.mark("laslaz-end");\n\n\t//{ // print timings\n\t//\t  performance.measure("laslaz", "laslaz-start", "laslaz-end");\n\t//\t  let measure = performance.getEntriesByType("measure")[0];\n\t//\t  let dpp = 1000 * measure.duration / numPoints;\n\t//\t  let debugMessage = `${measure.duration.toFixed(3)} ms, ${numPoints} points, ${dpp.toFixed(3)} \xb5s / point`;\n\t//\t  console.log(debugMessage);\n\t//}\n\tperformance.clearMarks();\n\tperformance.clearMeasures();\n\n\tlet message = {\n\t\tmean: mean,\n\t\tposition: pBuff,\n\t\tcolor: cBuff,\n\t\tintensity: iBuff,\n\t\tclassification: clBuff,\n\t\treturnNumber: rnBuff,\n\t\tnumberOfReturns: nrBuff,\n\t\tpointSourceID: psBuff,\n\t\ttightBoundingBox: tightBoundingBox,\n\t\tindices: indices\n\t};\n\n\tlet transferables = [\n\t\tmessage.position,\n\t\tmessage.color,\n\t\tmessage.intensity,\n\t\tmessage.classification,\n\t\tmessage.returnNumber,\n\t\tmessage.numberOfReturns,\n\t\tmessage.pointSourceID,\n\t\tmessage.indices\n\t];\n\n\tpostMessage(message, transferables);\n};\n\n\n\nonmessage = readUsingDataView;\n\n\n\n/***/ })\n\n/******/ });\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc291cmNlL3dvcmtlcnMvRXB0TGFzemlwRGVjb2Rlcldvcmtlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO1FBQUE7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7OztRQUdBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQSwwQ0FBMEMsZ0NBQWdDO1FBQzFFO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0Esd0RBQXdELGtCQUFrQjtRQUMxRTtRQUNBLGlEQUFpRCxjQUFjO1FBQy9EOztRQUVBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQSx5Q0FBeUMsaUNBQWlDO1FBQzFFLGdIQUFnSCxtQkFBbUIsRUFBRTtRQUNySTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBLDJCQUEyQiwwQkFBMEIsRUFBRTtRQUN2RCxpQ0FBaUMsZUFBZTtRQUNoRDtRQUNBO1FBQ0E7O1FBRUE7UUFDQSxzREFBc0QsK0RBQStEOztRQUVySDtRQUNBOzs7UUFHQTtRQUNBOzs7Ozs7Ozs7Ozs7QUNsRkE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGdDQUFnQztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxnQkFBZ0IsZUFBZTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdCQUFnQixlQUFlO0FBQy9CO0FBQ0E7O0FBRUE7O0FBRUEsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qiw0QkFBNEIsT0FBTyxVQUFVLFdBQVcsZUFBZTtBQUNuRztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7OztBQUlBIiwiZmlsZSI6IjdjNDZhZWFhMWY1MTUxOWJlYzBlLndvcmtlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBcIi4vc291cmNlL3dvcmtlcnMvRXB0TGFzemlwRGVjb2Rlcldvcmtlci5qc1wiKTtcbiIsImZ1bmN0aW9uIHJlYWRVc2luZ0RhdGFWaWV3KGV2ZW50KSB7XG4gIHBlcmZvcm1hbmNlLm1hcmsoXCJsYXNsYXotc3RhcnRcIik7XG5cbiAgaWYgKCFldmVudC5kYXRhIHx8ICFldmVudC5kYXRhLmJ1ZmZlcikge1xuICAgIHJldHVybjtcbiAgfVxuXG5cdGxldCBidWZmZXIgPSBldmVudC5kYXRhLmJ1ZmZlcjtcblx0bGV0IG51bVBvaW50cyA9IGV2ZW50LmRhdGEubnVtUG9pbnRzO1xuXHRsZXQgcG9pbnRTaXplID0gZXZlbnQuZGF0YS5wb2ludFNpemU7XG5cdGxldCBwb2ludEZvcm1hdCA9IGV2ZW50LmRhdGEucG9pbnRGb3JtYXRJRDtcblx0bGV0IHNjYWxlID0gZXZlbnQuZGF0YS5zY2FsZTtcblx0bGV0IG9mZnNldCA9IGV2ZW50LmRhdGEub2Zmc2V0O1xuXG5cdGxldCBzb3VyY2VVaW50OCA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlcik7XG5cdGxldCBzb3VyY2VWaWV3ID0gbmV3IERhdGFWaWV3KGJ1ZmZlcik7XG5cblx0bGV0IHRpZ2h0Qm91bmRpbmdCb3ggPSB7XG5cdFx0bWluOiBbXG5cdFx0XHROdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksXG5cdFx0XHROdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksXG5cdFx0XHROdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFlcblx0XHRdLFxuXHRcdG1heDogW1xuXHRcdFx0TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLFxuXHRcdFx0TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLFxuXHRcdFx0TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZXG5cdFx0XVxuXHR9O1xuXG5cdGxldCBtZWFuID0gWzAsIDAsIDBdO1xuXG5cdGxldCBwQnVmZiA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMgKiAzICogNCk7XG5cdGxldCBjQnVmZiA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMgKiA0KTtcblx0bGV0IGlCdWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDQpO1xuXHRsZXQgY2xCdWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyk7XG5cdGxldCBybkJ1ZmYgPSBuZXcgQXJyYXlCdWZmZXIobnVtUG9pbnRzKTtcblx0bGV0IG5yQnVmZiA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMpO1xuXHRsZXQgcHNCdWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDIpO1xuXG5cdGxldCBwb3NpdGlvbnMgPSBuZXcgRmxvYXQzMkFycmF5KHBCdWZmKTtcblx0bGV0IGNvbG9ycyA9IG5ldyBVaW50OEFycmF5KGNCdWZmKTtcblx0bGV0IGludGVuc2l0aWVzID0gbmV3IEZsb2F0MzJBcnJheShpQnVmZik7XG5cdGxldCBjbGFzc2lmaWNhdGlvbnMgPSBuZXcgVWludDhBcnJheShjbEJ1ZmYpO1xuXHRsZXQgcmV0dXJuTnVtYmVycyA9IG5ldyBVaW50OEFycmF5KHJuQnVmZik7XG5cdGxldCBudW1iZXJPZlJldHVybnMgPSBuZXcgVWludDhBcnJheShuckJ1ZmYpO1xuXHRsZXQgcG9pbnRTb3VyY2VJRHMgPSBuZXcgVWludDE2QXJyYXkocHNCdWZmKTtcblxuXHQvLyBQb2ludCBmb3JtYXQgMyBjb250YWlucyBhbiA4LWJ5dGUgR3BzVGltZSBiZWZvcmUgUkdCIHZhbHVlcywgc28gbWFrZVxuXHQvLyBzdXJlIHdlIGhhdmUgdGhlIGNvcnJlY3QgY29sb3Igb2Zmc2V0LlxuXHRsZXQgaGFzQ29sb3IgPSBwb2ludEZvcm1hdCA9PSAyIHx8IHBvaW50Rm9ybWF0ID09IDM7XG5cdGxldCBjbyA9IHBvaW50Rm9ybWF0ID09IDIgPyAyMCA6IDI4O1xuXG5cdC8vIFRPRE8gVGhpcyBzaG91bGQgYmUgY2FjaGVkIHBlci1yZXNvdXJjZSBzaW5jZSB0aGlzIGlzIGFuIGV4cGVuc2l2ZSBjaGVjay5cblx0bGV0IHR3b0J5dGVDb2xvciA9IGZhbHNlO1xuXHRpZiAoaGFzQ29sb3IpIHtcblx0XHRsZXQgciwgZywgYiwgcG9zO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbnVtUG9pbnRzICYmICF0d29CeXRlQ29sb3I7ICsraSkge1xuXHRcdFx0cG9zID0gaSAqIHBvaW50U2l6ZTtcblx0XHRcdHIgPSBzb3VyY2VWaWV3LmdldFVpbnQxNihwb3MgKyBjbywgdHJ1ZSlcblx0XHRcdGcgPSBzb3VyY2VWaWV3LmdldFVpbnQxNihwb3MgKyBjbyArIDIsIHRydWUpXG5cdFx0XHRiID0gc291cmNlVmlldy5nZXRVaW50MTYocG9zICsgY28gKyA0LCB0cnVlKVxuXHRcdFx0aWYgKHIgPiAyNTUgfHwgZyA+IDI1NSB8fCBiID4gMjU1KSB0d29CeXRlQ29sb3IgPSB0cnVlO1xuXHRcdH1cblx0fVxuXG5cdGZvciAobGV0IGkgPSAwOyBpIDwgbnVtUG9pbnRzOyBpKyspIHtcblx0XHQvLyBQT1NJVElPTlxuXHRcdGxldCB1eCA9IHNvdXJjZVZpZXcuZ2V0SW50MzIoaSAqIHBvaW50U2l6ZSArIDAsIHRydWUpO1xuXHRcdGxldCB1eSA9IHNvdXJjZVZpZXcuZ2V0SW50MzIoaSAqIHBvaW50U2l6ZSArIDQsIHRydWUpO1xuXHRcdGxldCB1eiA9IHNvdXJjZVZpZXcuZ2V0SW50MzIoaSAqIHBvaW50U2l6ZSArIDgsIHRydWUpO1xuXG5cdFx0eCA9IHV4ICogc2NhbGVbMF0gKyBvZmZzZXRbMF0gLSBldmVudC5kYXRhLm1pbnNbMF07XG5cdFx0eSA9IHV5ICogc2NhbGVbMV0gKyBvZmZzZXRbMV0gLSBldmVudC5kYXRhLm1pbnNbMV07XG5cdFx0eiA9IHV6ICogc2NhbGVbMl0gKyBvZmZzZXRbMl0gLSBldmVudC5kYXRhLm1pbnNbMl07XG5cblx0XHRwb3NpdGlvbnNbMyAqIGkgKyAwXSA9IHg7XG5cdFx0cG9zaXRpb25zWzMgKiBpICsgMV0gPSB5O1xuXHRcdHBvc2l0aW9uc1szICogaSArIDJdID0gejtcblxuXHRcdG1lYW5bMF0gKz0geCAvIG51bVBvaW50cztcblx0XHRtZWFuWzFdICs9IHkgLyBudW1Qb2ludHM7XG5cdFx0bWVhblsyXSArPSB6IC8gbnVtUG9pbnRzO1xuXG5cdFx0dGlnaHRCb3VuZGluZ0JveC5taW5bMF0gPSBNYXRoLm1pbih0aWdodEJvdW5kaW5nQm94Lm1pblswXSwgeCk7XG5cdFx0dGlnaHRCb3VuZGluZ0JveC5taW5bMV0gPSBNYXRoLm1pbih0aWdodEJvdW5kaW5nQm94Lm1pblsxXSwgeSk7XG5cdFx0dGlnaHRCb3VuZGluZ0JveC5taW5bMl0gPSBNYXRoLm1pbih0aWdodEJvdW5kaW5nQm94Lm1pblsyXSwgeik7XG5cblx0XHR0aWdodEJvdW5kaW5nQm94Lm1heFswXSA9IE1hdGgubWF4KHRpZ2h0Qm91bmRpbmdCb3gubWF4WzBdLCB4KTtcblx0XHR0aWdodEJvdW5kaW5nQm94Lm1heFsxXSA9IE1hdGgubWF4KHRpZ2h0Qm91bmRpbmdCb3gubWF4WzFdLCB5KTtcblx0XHR0aWdodEJvdW5kaW5nQm94Lm1heFsyXSA9IE1hdGgubWF4KHRpZ2h0Qm91bmRpbmdCb3gubWF4WzJdLCB6KTtcblxuXHRcdC8vIElOVEVOU0lUWVxuXHRcdGxldCBpbnRlbnNpdHkgPSBzb3VyY2VWaWV3LmdldFVpbnQxNihpICogcG9pbnRTaXplICsgMTIsIHRydWUpO1xuXHRcdGludGVuc2l0aWVzW2ldID0gaW50ZW5zaXR5O1xuXG5cdFx0Ly8gUkVUVVJOIE5VTUJFUiwgc3RvcmVkIGluIHRoZSBmaXJzdCAzIGJpdHMgLSAwMDAwMDExMVxuXHRcdC8vIG51bWJlciBvZiByZXR1cm5zIHN0b3JlZCBpbiBuZXh0IDMgYml0c1x0IC0gMDAxMTEwMDBcblx0XHRsZXQgcmV0dXJuTnVtYmVyQW5kTnVtYmVyT2ZSZXR1cm5zID0gc291cmNlVmlldy5nZXRVaW50OChpICogcG9pbnRTaXplICsgMTQsIHRydWUpO1xuXHRcdGxldCByZXR1cm5OdW1iZXIgPSByZXR1cm5OdW1iZXJBbmROdW1iZXJPZlJldHVybnMgJiAwYjAxMTE7XG5cdFx0bGV0IG51bWJlck9mUmV0dXJuID0gKHJldHVybk51bWJlckFuZE51bWJlck9mUmV0dXJucyAmIDBiMDAxMTEwMDApID4+IDM7XG5cdFx0cmV0dXJuTnVtYmVyc1tpXSA9IHJldHVybk51bWJlcjtcblx0XHRudW1iZXJPZlJldHVybnNbaV0gPSBudW1iZXJPZlJldHVybjtcblxuXHRcdC8vIENMQVNTSUZJQ0FUSU9OXG5cdFx0bGV0IGNsYXNzaWZpY2F0aW9uID0gc291cmNlVmlldy5nZXRVaW50OChpICogcG9pbnRTaXplICsgMTUsIHRydWUpO1xuXHRcdGNsYXNzaWZpY2F0aW9uc1tpXSA9IGNsYXNzaWZpY2F0aW9uO1xuXG5cdFx0Ly8gUE9JTlQgU09VUkNFIElEXG5cdFx0bGV0IHBvaW50U291cmNlSUQgPSBzb3VyY2VWaWV3LmdldFVpbnQxNihpICogcG9pbnRTaXplICsgMTgsIHRydWUpO1xuXHRcdHBvaW50U291cmNlSURzW2ldID0gcG9pbnRTb3VyY2VJRDtcblxuXHRcdC8vIENPTE9SLCBpZiBhdmFpbGFibGVcblx0XHRpZiAoaGFzQ29sb3IpIHtcblx0XHRcdGxldCByID0gc291cmNlVmlldy5nZXRVaW50MTYoaSAqIHBvaW50U2l6ZSArIGNvLCB0cnVlKVxuXHRcdFx0bGV0IGcgPSBzb3VyY2VWaWV3LmdldFVpbnQxNihpICogcG9pbnRTaXplICsgY28gKyAyLCB0cnVlKVxuXHRcdFx0bGV0IGIgPSBzb3VyY2VWaWV3LmdldFVpbnQxNihpICogcG9pbnRTaXplICsgY28gKyA0LCB0cnVlKVxuXG5cdFx0XHRpZiAodHdvQnl0ZUNvbG9yKSB7XG5cdFx0XHRcdHIgLz0gMjU2O1xuXHRcdFx0XHRnIC89IDI1Njtcblx0XHRcdFx0YiAvPSAyNTY7XG5cdFx0XHR9XG5cblx0XHRcdGNvbG9yc1s0ICogaSArIDBdID0gcjtcblx0XHRcdGNvbG9yc1s0ICogaSArIDFdID0gZztcblx0XHRcdGNvbG9yc1s0ICogaSArIDJdID0gYjtcblx0XHRcdGNvbG9yc1s0ICogaSArIDNdID0gMjU1O1xuXHRcdH1cblx0fVxuXG5cdGxldCBpbmRpY2VzID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDQpO1xuXHRsZXQgaUluZGljZXMgPSBuZXcgVWludDMyQXJyYXkoaW5kaWNlcyk7XG5cdGZvciAobGV0IGkgPSAwOyBpIDwgbnVtUG9pbnRzOyBpKyspIHtcblx0XHRpSW5kaWNlc1tpXSA9IGk7XG5cdH1cblxuXHRwZXJmb3JtYW5jZS5tYXJrKFwibGFzbGF6LWVuZFwiKTtcblxuXHQvL3sgLy8gcHJpbnQgdGltaW5nc1xuXHQvL1x0ICBwZXJmb3JtYW5jZS5tZWFzdXJlKFwibGFzbGF6XCIsIFwibGFzbGF6LXN0YXJ0XCIsIFwibGFzbGF6LWVuZFwiKTtcblx0Ly9cdCAgbGV0IG1lYXN1cmUgPSBwZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlUeXBlKFwibWVhc3VyZVwiKVswXTtcblx0Ly9cdCAgbGV0IGRwcCA9IDEwMDAgKiBtZWFzdXJlLmR1cmF0aW9uIC8gbnVtUG9pbnRzO1xuXHQvL1x0ICBsZXQgZGVidWdNZXNzYWdlID0gYCR7bWVhc3VyZS5kdXJhdGlvbi50b0ZpeGVkKDMpfSBtcywgJHtudW1Qb2ludHN9IHBvaW50cywgJHtkcHAudG9GaXhlZCgzKX0gwrVzIC8gcG9pbnRgO1xuXHQvL1x0ICBjb25zb2xlLmxvZyhkZWJ1Z01lc3NhZ2UpO1xuXHQvL31cblx0cGVyZm9ybWFuY2UuY2xlYXJNYXJrcygpO1xuXHRwZXJmb3JtYW5jZS5jbGVhck1lYXN1cmVzKCk7XG5cblx0bGV0IG1lc3NhZ2UgPSB7XG5cdFx0bWVhbjogbWVhbixcblx0XHRwb3NpdGlvbjogcEJ1ZmYsXG5cdFx0Y29sb3I6IGNCdWZmLFxuXHRcdGludGVuc2l0eTogaUJ1ZmYsXG5cdFx0Y2xhc3NpZmljYXRpb246IGNsQnVmZixcblx0XHRyZXR1cm5OdW1iZXI6IHJuQnVmZixcblx0XHRudW1iZXJPZlJldHVybnM6IG5yQnVmZixcblx0XHRwb2ludFNvdXJjZUlEOiBwc0J1ZmYsXG5cdFx0dGlnaHRCb3VuZGluZ0JveDogdGlnaHRCb3VuZGluZ0JveCxcblx0XHRpbmRpY2VzOiBpbmRpY2VzXG5cdH07XG5cblx0bGV0IHRyYW5zZmVyYWJsZXMgPSBbXG5cdFx0bWVzc2FnZS5wb3NpdGlvbixcblx0XHRtZXNzYWdlLmNvbG9yLFxuXHRcdG1lc3NhZ2UuaW50ZW5zaXR5LFxuXHRcdG1lc3NhZ2UuY2xhc3NpZmljYXRpb24sXG5cdFx0bWVzc2FnZS5yZXR1cm5OdW1iZXIsXG5cdFx0bWVzc2FnZS5udW1iZXJPZlJldHVybnMsXG5cdFx0bWVzc2FnZS5wb2ludFNvdXJjZUlELFxuXHRcdG1lc3NhZ2UuaW5kaWNlc1xuXHRdO1xuXG5cdHBvc3RNZXNzYWdlKG1lc3NhZ2UsIHRyYW5zZmVyYWJsZXMpO1xufTtcblxuXG5cbm9ubWVzc2FnZSA9IHJlYWRVc2luZ0RhdGFWaWV3O1xuXG4iXSwic291cmNlUm9vdCI6IiJ9',null)}},"./source/workers/LASDecoderWorker.js":function(t,e,n){t.exports=function(){return n("./node_modules/worker-loader/dist/workers/InlineWorker.js")("/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = \"./source/workers/LASDecoderWorker.js\");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./source/workers/LASDecoderWorker.js\":\n/*!********************************************!*\\\n  !*** ./source/workers/LASDecoderWorker.js ***!\n  \\********************************************/\n/*! no static exports found */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nonmessage = function(event)\n{\n  if (!event.data || !event.data.buffer) {\n    return;\n  }\n\tvar buffer = event.data.buffer;\n\tvar numPoints = event.data.numPoints;\n\tvar sourcePointSize = event.data.pointSize;\n\tvar pointFormatID = event.data.pointFormatID;\n\tvar scale = event.data.scale;\n\tvar offset = event.data.offset;\n\n\tvar sourceUint8 = new Uint8Array(buffer);\n\tvar sourceView = new DataView(buffer);\n\t\n\tvar targetPointSize = 40;\n\tvar targetBuffer = new ArrayBuffer(numPoints * targetPointSize);\n\tvar targetView = new DataView(targetBuffer);\n\n\tvar tightBoundingBox =\n\t{\n\t\tmin: [ Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY ],\n\t\tmax: [ Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY ]\n\t};\n\n\tvar mean = [0, 0, 0];\n\n\tvar pBuff = new ArrayBuffer(numPoints * 3 * 4);\n\tvar cBuff = new ArrayBuffer(numPoints * 4);\n\tvar iBuff = new ArrayBuffer(numPoints * 4);\n\tvar clBuff = new ArrayBuffer(numPoints);\n\tvar rnBuff = new ArrayBuffer(numPoints);\n\tvar nrBuff = new ArrayBuffer(numPoints);\n\tvar psBuff = new ArrayBuffer(numPoints * 2);\n\n\tvar positions = new Float32Array(pBuff);\n\tvar colors = new Uint8Array(cBuff);\n\tvar intensities = new Float32Array(iBuff);\n\tvar classifications = new Uint8Array(clBuff);\n\tvar returnNumbers = new Uint8Array(rnBuff);\n\tvar numberOfReturns = new Uint8Array(nrBuff);\n\tvar pointSourceIDs = new Uint16Array(psBuff);\n\t\n\tfor (var i = 0; i < numPoints; i++)\n\t{\n\t\t//POSITION\n\t\tvar ux = sourceView.getInt32(i * sourcePointSize + 0, true);\n\t\tvar uy = sourceView.getInt32(i * sourcePointSize + 4, true);\n\t\tvar uz = sourceView.getInt32(i * sourcePointSize + 8, true);\n\n\t\tvar x = ux * scale[0] + offset[0] - event.data.mins[0];\n\t\tvar y = uy * scale[1] + offset[1] - event.data.mins[1];\n\t\tvar z = uz * scale[2] + offset[2] - event.data.mins[2];\n\n\t\tpositions[3 * i + 0] = x;\n\t\tpositions[3 * i + 1] = y;\n\t\tpositions[3 * i + 2] = z;\n\n\t\tmean[0] += x / numPoints;\n\t\tmean[1] += y / numPoints;\n\t\tmean[2] += z / numPoints;\n\n\t\ttightBoundingBox.min[0] = Math.min(tightBoundingBox.min[0], x);\n\t\ttightBoundingBox.min[1] = Math.min(tightBoundingBox.min[1], y);\n\t\ttightBoundingBox.min[2] = Math.min(tightBoundingBox.min[2], z);\n\n\t\ttightBoundingBox.max[0] = Math.max(tightBoundingBox.max[0], x);\n\t\ttightBoundingBox.max[1] = Math.max(tightBoundingBox.max[1], y);\n\t\ttightBoundingBox.max[2] = Math.max(tightBoundingBox.max[2], z);\n\n\t\t//INTENSITY\n\t\tvar intensity = sourceView.getUint16(i * sourcePointSize + 12, true);\n\t\tintensities[i] = intensity;\n\n\t\t//RETURN NUMBER, stored in the first 3 bits - 00000111\n\t\t//number of returns stored in next 3 bits   - 00111000\n\t\tvar returnNumberAndNumberOfReturns = sourceView.getUint8(i * sourcePointSize + 14, true);\n\t\tvar returnNumber = returnNumberAndNumberOfReturns & 0b0111;\n\t\tvar numberOfReturn = (returnNumberAndNumberOfReturns & 0b00111000) >> 3;\n\t\treturnNumbers[i] = returnNumber;\n\t\tnumberOfReturns[i] = numberOfReturn;\n\n\t\t//CLASSIFICATION\n\t\tvar classification = sourceView.getUint8(i * sourcePointSize + 15, true);\n\t\tclassifications[i] = classification;\n\n\t\t//POINT SOURCE ID\n\t\tvar pointSourceID = sourceView.getUint16(i * sourcePointSize + 18, true);\n\t\tpointSourceIDs[i] = pointSourceID;\n\n\t\t//COLOR, if available\n\t\tif (pointFormatID === 2) {\t\t\t\n\t\t\tvar r = sourceView.getUint16(i * sourcePointSize + 20, true) / 256;\n\t\t\tvar g = sourceView.getUint16(i * sourcePointSize + 22, true) / 256;\n\t\t\tvar b = sourceView.getUint16(i * sourcePointSize + 24, true) / 256;\n\n\t\t\tcolors[4 * i + 0] = r;\n\t\t\tcolors[4 * i + 1] = g;\n\t\t\tcolors[4 * i + 2] = b;\n\t\t\tcolors[4 * i + 3] = 255;\n\t\t}\n\t}\n\n\tvar indices = new ArrayBuffer(numPoints * 4);\n\tvar iIndices = new Uint32Array(indices);\n\tfor (var i = 0; i < numPoints; i++)\n\t{\n\t\tiIndices[i] = i;\n\t}\n\n\tvar message =\n\t{\n\t\tmean: mean,\n\t\tposition: pBuff,\n\t\tcolor: cBuff,\n\t\tintensity: iBuff,\n\t\tclassification: clBuff,\n\t\treturnNumber: rnBuff,\n\t\tnumberOfReturns: nrBuff,\n\t\tpointSourceID: psBuff,\n\t\ttightBoundingBox: tightBoundingBox,\n\t\tindices: indices\n\t};\n\n\tvar transferables =\n\t[\n\t\tmessage.position,\n\t\tmessage.color,\n\t\tmessage.intensity,\n\t\tmessage.classification,\n\t\tmessage.returnNumber,\n\t\tmessage.numberOfReturns,\n\t\tmessage.pointSourceID,\n\t\tmessage.indices\n\t];\n\n\tpostMessage(message, transferables);\n};\n\n\n/***/ })\n\n/******/ });\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc291cmNlL3dvcmtlcnMvTEFTRGVjb2Rlcldvcmtlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO1FBQUE7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7OztRQUdBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQSwwQ0FBMEMsZ0NBQWdDO1FBQzFFO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0Esd0RBQXdELGtCQUFrQjtRQUMxRTtRQUNBLGlEQUFpRCxjQUFjO1FBQy9EOztRQUVBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQSx5Q0FBeUMsaUNBQWlDO1FBQzFFLGdIQUFnSCxtQkFBbUIsRUFBRTtRQUNySTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBLDJCQUEyQiwwQkFBMEIsRUFBRTtRQUN2RCxpQ0FBaUMsZUFBZTtRQUNoRDtRQUNBO1FBQ0E7O1FBRUE7UUFDQSxzREFBc0QsK0RBQStEOztRQUVySDtRQUNBOzs7UUFHQTtRQUNBOzs7Ozs7Ozs7Ozs7O0FDbEZhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxnQkFBZ0IsZUFBZTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw0QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdCQUFnQixlQUFlO0FBQy9CO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EiLCJmaWxlIjoiOTdjNGViOGVlNDAyNzM0MTk5Mjcud29ya2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IFwiLi9zb3VyY2Uvd29ya2Vycy9MQVNEZWNvZGVyV29ya2VyLmpzXCIpO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KVxue1xuICBpZiAoIWV2ZW50LmRhdGEgfHwgIWV2ZW50LmRhdGEuYnVmZmVyKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cdHZhciBidWZmZXIgPSBldmVudC5kYXRhLmJ1ZmZlcjtcblx0dmFyIG51bVBvaW50cyA9IGV2ZW50LmRhdGEubnVtUG9pbnRzO1xuXHR2YXIgc291cmNlUG9pbnRTaXplID0gZXZlbnQuZGF0YS5wb2ludFNpemU7XG5cdHZhciBwb2ludEZvcm1hdElEID0gZXZlbnQuZGF0YS5wb2ludEZvcm1hdElEO1xuXHR2YXIgc2NhbGUgPSBldmVudC5kYXRhLnNjYWxlO1xuXHR2YXIgb2Zmc2V0ID0gZXZlbnQuZGF0YS5vZmZzZXQ7XG5cblx0dmFyIHNvdXJjZVVpbnQ4ID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKTtcblx0dmFyIHNvdXJjZVZpZXcgPSBuZXcgRGF0YVZpZXcoYnVmZmVyKTtcblx0XG5cdHZhciB0YXJnZXRQb2ludFNpemUgPSA0MDtcblx0dmFyIHRhcmdldEJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMgKiB0YXJnZXRQb2ludFNpemUpO1xuXHR2YXIgdGFyZ2V0VmlldyA9IG5ldyBEYXRhVmlldyh0YXJnZXRCdWZmZXIpO1xuXG5cdHZhciB0aWdodEJvdW5kaW5nQm94ID1cblx0e1xuXHRcdG1pbjogWyBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIF0sXG5cdFx0bWF4OiBbIE51bWJlci5ORUdBVElWRV9JTkZJTklUWSwgTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLCBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkgXVxuXHR9O1xuXG5cdHZhciBtZWFuID0gWzAsIDAsIDBdO1xuXG5cdHZhciBwQnVmZiA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMgKiAzICogNCk7XG5cdHZhciBjQnVmZiA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMgKiA0KTtcblx0dmFyIGlCdWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDQpO1xuXHR2YXIgY2xCdWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyk7XG5cdHZhciBybkJ1ZmYgPSBuZXcgQXJyYXlCdWZmZXIobnVtUG9pbnRzKTtcblx0dmFyIG5yQnVmZiA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMpO1xuXHR2YXIgcHNCdWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDIpO1xuXG5cdHZhciBwb3NpdGlvbnMgPSBuZXcgRmxvYXQzMkFycmF5KHBCdWZmKTtcblx0dmFyIGNvbG9ycyA9IG5ldyBVaW50OEFycmF5KGNCdWZmKTtcblx0dmFyIGludGVuc2l0aWVzID0gbmV3IEZsb2F0MzJBcnJheShpQnVmZik7XG5cdHZhciBjbGFzc2lmaWNhdGlvbnMgPSBuZXcgVWludDhBcnJheShjbEJ1ZmYpO1xuXHR2YXIgcmV0dXJuTnVtYmVycyA9IG5ldyBVaW50OEFycmF5KHJuQnVmZik7XG5cdHZhciBudW1iZXJPZlJldHVybnMgPSBuZXcgVWludDhBcnJheShuckJ1ZmYpO1xuXHR2YXIgcG9pbnRTb3VyY2VJRHMgPSBuZXcgVWludDE2QXJyYXkocHNCdWZmKTtcblx0XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgbnVtUG9pbnRzOyBpKyspXG5cdHtcblx0XHQvL1BPU0lUSU9OXG5cdFx0dmFyIHV4ID0gc291cmNlVmlldy5nZXRJbnQzMihpICogc291cmNlUG9pbnRTaXplICsgMCwgdHJ1ZSk7XG5cdFx0dmFyIHV5ID0gc291cmNlVmlldy5nZXRJbnQzMihpICogc291cmNlUG9pbnRTaXplICsgNCwgdHJ1ZSk7XG5cdFx0dmFyIHV6ID0gc291cmNlVmlldy5nZXRJbnQzMihpICogc291cmNlUG9pbnRTaXplICsgOCwgdHJ1ZSk7XG5cblx0XHR2YXIgeCA9IHV4ICogc2NhbGVbMF0gKyBvZmZzZXRbMF0gLSBldmVudC5kYXRhLm1pbnNbMF07XG5cdFx0dmFyIHkgPSB1eSAqIHNjYWxlWzFdICsgb2Zmc2V0WzFdIC0gZXZlbnQuZGF0YS5taW5zWzFdO1xuXHRcdHZhciB6ID0gdXogKiBzY2FsZVsyXSArIG9mZnNldFsyXSAtIGV2ZW50LmRhdGEubWluc1syXTtcblxuXHRcdHBvc2l0aW9uc1szICogaSArIDBdID0geDtcblx0XHRwb3NpdGlvbnNbMyAqIGkgKyAxXSA9IHk7XG5cdFx0cG9zaXRpb25zWzMgKiBpICsgMl0gPSB6O1xuXG5cdFx0bWVhblswXSArPSB4IC8gbnVtUG9pbnRzO1xuXHRcdG1lYW5bMV0gKz0geSAvIG51bVBvaW50cztcblx0XHRtZWFuWzJdICs9IHogLyBudW1Qb2ludHM7XG5cblx0XHR0aWdodEJvdW5kaW5nQm94Lm1pblswXSA9IE1hdGgubWluKHRpZ2h0Qm91bmRpbmdCb3gubWluWzBdLCB4KTtcblx0XHR0aWdodEJvdW5kaW5nQm94Lm1pblsxXSA9IE1hdGgubWluKHRpZ2h0Qm91bmRpbmdCb3gubWluWzFdLCB5KTtcblx0XHR0aWdodEJvdW5kaW5nQm94Lm1pblsyXSA9IE1hdGgubWluKHRpZ2h0Qm91bmRpbmdCb3gubWluWzJdLCB6KTtcblxuXHRcdHRpZ2h0Qm91bmRpbmdCb3gubWF4WzBdID0gTWF0aC5tYXgodGlnaHRCb3VuZGluZ0JveC5tYXhbMF0sIHgpO1xuXHRcdHRpZ2h0Qm91bmRpbmdCb3gubWF4WzFdID0gTWF0aC5tYXgodGlnaHRCb3VuZGluZ0JveC5tYXhbMV0sIHkpO1xuXHRcdHRpZ2h0Qm91bmRpbmdCb3gubWF4WzJdID0gTWF0aC5tYXgodGlnaHRCb3VuZGluZ0JveC5tYXhbMl0sIHopO1xuXG5cdFx0Ly9JTlRFTlNJVFlcblx0XHR2YXIgaW50ZW5zaXR5ID0gc291cmNlVmlldy5nZXRVaW50MTYoaSAqIHNvdXJjZVBvaW50U2l6ZSArIDEyLCB0cnVlKTtcblx0XHRpbnRlbnNpdGllc1tpXSA9IGludGVuc2l0eTtcblxuXHRcdC8vUkVUVVJOIE5VTUJFUiwgc3RvcmVkIGluIHRoZSBmaXJzdCAzIGJpdHMgLSAwMDAwMDExMVxuXHRcdC8vbnVtYmVyIG9mIHJldHVybnMgc3RvcmVkIGluIG5leHQgMyBiaXRzICAgLSAwMDExMTAwMFxuXHRcdHZhciByZXR1cm5OdW1iZXJBbmROdW1iZXJPZlJldHVybnMgPSBzb3VyY2VWaWV3LmdldFVpbnQ4KGkgKiBzb3VyY2VQb2ludFNpemUgKyAxNCwgdHJ1ZSk7XG5cdFx0dmFyIHJldHVybk51bWJlciA9IHJldHVybk51bWJlckFuZE51bWJlck9mUmV0dXJucyAmIDBiMDExMTtcblx0XHR2YXIgbnVtYmVyT2ZSZXR1cm4gPSAocmV0dXJuTnVtYmVyQW5kTnVtYmVyT2ZSZXR1cm5zICYgMGIwMDExMTAwMCkgPj4gMztcblx0XHRyZXR1cm5OdW1iZXJzW2ldID0gcmV0dXJuTnVtYmVyO1xuXHRcdG51bWJlck9mUmV0dXJuc1tpXSA9IG51bWJlck9mUmV0dXJuO1xuXG5cdFx0Ly9DTEFTU0lGSUNBVElPTlxuXHRcdHZhciBjbGFzc2lmaWNhdGlvbiA9IHNvdXJjZVZpZXcuZ2V0VWludDgoaSAqIHNvdXJjZVBvaW50U2l6ZSArIDE1LCB0cnVlKTtcblx0XHRjbGFzc2lmaWNhdGlvbnNbaV0gPSBjbGFzc2lmaWNhdGlvbjtcblxuXHRcdC8vUE9JTlQgU09VUkNFIElEXG5cdFx0dmFyIHBvaW50U291cmNlSUQgPSBzb3VyY2VWaWV3LmdldFVpbnQxNihpICogc291cmNlUG9pbnRTaXplICsgMTgsIHRydWUpO1xuXHRcdHBvaW50U291cmNlSURzW2ldID0gcG9pbnRTb3VyY2VJRDtcblxuXHRcdC8vQ09MT1IsIGlmIGF2YWlsYWJsZVxuXHRcdGlmIChwb2ludEZvcm1hdElEID09PSAyKSB7XHRcdFx0XG5cdFx0XHR2YXIgciA9IHNvdXJjZVZpZXcuZ2V0VWludDE2KGkgKiBzb3VyY2VQb2ludFNpemUgKyAyMCwgdHJ1ZSkgLyAyNTY7XG5cdFx0XHR2YXIgZyA9IHNvdXJjZVZpZXcuZ2V0VWludDE2KGkgKiBzb3VyY2VQb2ludFNpemUgKyAyMiwgdHJ1ZSkgLyAyNTY7XG5cdFx0XHR2YXIgYiA9IHNvdXJjZVZpZXcuZ2V0VWludDE2KGkgKiBzb3VyY2VQb2ludFNpemUgKyAyNCwgdHJ1ZSkgLyAyNTY7XG5cblx0XHRcdGNvbG9yc1s0ICogaSArIDBdID0gcjtcblx0XHRcdGNvbG9yc1s0ICogaSArIDFdID0gZztcblx0XHRcdGNvbG9yc1s0ICogaSArIDJdID0gYjtcblx0XHRcdGNvbG9yc1s0ICogaSArIDNdID0gMjU1O1xuXHRcdH1cblx0fVxuXG5cdHZhciBpbmRpY2VzID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDQpO1xuXHR2YXIgaUluZGljZXMgPSBuZXcgVWludDMyQXJyYXkoaW5kaWNlcyk7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgbnVtUG9pbnRzOyBpKyspXG5cdHtcblx0XHRpSW5kaWNlc1tpXSA9IGk7XG5cdH1cblxuXHR2YXIgbWVzc2FnZSA9XG5cdHtcblx0XHRtZWFuOiBtZWFuLFxuXHRcdHBvc2l0aW9uOiBwQnVmZixcblx0XHRjb2xvcjogY0J1ZmYsXG5cdFx0aW50ZW5zaXR5OiBpQnVmZixcblx0XHRjbGFzc2lmaWNhdGlvbjogY2xCdWZmLFxuXHRcdHJldHVybk51bWJlcjogcm5CdWZmLFxuXHRcdG51bWJlck9mUmV0dXJuczogbnJCdWZmLFxuXHRcdHBvaW50U291cmNlSUQ6IHBzQnVmZixcblx0XHR0aWdodEJvdW5kaW5nQm94OiB0aWdodEJvdW5kaW5nQm94LFxuXHRcdGluZGljZXM6IGluZGljZXNcblx0fTtcblxuXHR2YXIgdHJhbnNmZXJhYmxlcyA9XG5cdFtcblx0XHRtZXNzYWdlLnBvc2l0aW9uLFxuXHRcdG1lc3NhZ2UuY29sb3IsXG5cdFx0bWVzc2FnZS5pbnRlbnNpdHksXG5cdFx0bWVzc2FnZS5jbGFzc2lmaWNhdGlvbixcblx0XHRtZXNzYWdlLnJldHVybk51bWJlcixcblx0XHRtZXNzYWdlLm51bWJlck9mUmV0dXJucyxcblx0XHRtZXNzYWdlLnBvaW50U291cmNlSUQsXG5cdFx0bWVzc2FnZS5pbmRpY2VzXG5cdF07XG5cblx0cG9zdE1lc3NhZ2UobWVzc2FnZSwgdHJhbnNmZXJhYmxlcyk7XG59O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==",null)}},three:function(t,e){t.exports=n(14)}}))},function(t,e,n){var r=n(134);function i(e,n,o){return"undefined"!==typeof Reflect&&Reflect.get?t.exports=i=Reflect.get:t.exports=i=function(t,e,n){var i=r(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}},i(e,n,o||e)}t.exports=i},function(t,e,n){var r=n(82);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t}},function(t,e,n){var r=n(91),i=n(93);function o(e,n,a){return i()?t.exports=o=Reflect.construct:t.exports=o=function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o},o.apply(null,arguments)}t.exports=o},function(t,e,n){"use strict";n.r(e),n.d(e,"audit",(function(){return a})),n.d(e,"auditTime",(function(){return d})),n.d(e,"buffer",(function(){return f})),n.d(e,"bufferCount",(function(){return v})),n.d(e,"bufferTime",(function(){return _})),n.d(e,"bufferToggle",(function(){return B})),n.d(e,"bufferWhen",(function(){return F})),n.d(e,"catchError",(function(){return U})),n.d(e,"combineAll",(function(){return V})),n.d(e,"combineLatest",(function(){return z})),n.d(e,"concat",(function(){return W})),n.d(e,"concatAll",(function(){return j.a})),n.d(e,"concatMap",(function(){return Q})),n.d(e,"concatMapTo",(function(){return Y})),n.d(e,"count",(function(){return J})),n.d(e,"debounce",(function(){return $})),n.d(e,"debounceTime",(function(){return nt})),n.d(e,"defaultIfEmpty",(function(){return at})),n.d(e,"delay",(function(){return dt})),n.d(e,"delayWhen",(function(){return vt})),n.d(e,"dematerialize",(function(){return _t})),n.d(e,"distinct",(function(){return St})),n.d(e,"distinctUntilChanged",(function(){return Rt})),n.d(e,"distinctUntilKeyChanged",(function(){return At})),n.d(e,"elementAt",(function(){return kt})),n.d(e,"endWith",(function(){return Xt})),n.d(e,"every",(function(){return Wt})),n.d(e,"exhaust",(function(){return Qt})),n.d(e,"exhaustMap",(function(){return Kt})),n.d(e,"expand",(function(){return ee})),n.d(e,"filter",(function(){return Ft.a})),n.d(e,"finalize",(function(){return ie})),n.d(e,"find",(function(){return se})),n.d(e,"findIndex",(function(){return le})),n.d(e,"first",(function(){return fe})),n.d(e,"groupBy",(function(){return he.b})),n.d(e,"ignoreElements",(function(){return pe})),n.d(e,"isEmpty",(function(){return ge})),n.d(e,"last",(function(){return Te})),n.d(e,"map",(function(){return qt.a})),n.d(e,"mapTo",(function(){return Se})),n.d(e,"materialize",(function(){return Re})),n.d(e,"max",(function(){return Oe})),n.d(e,"merge",(function(){return Le})),n.d(e,"mergeAll",(function(){return Ge.a})),n.d(e,"mergeMap",(function(){return Z.a})),n.d(e,"flatMap",(function(){return Z.a})),n.d(e,"mergeMapTo",(function(){return De})),n.d(e,"mergeScan",(function(){return Ve})),n.d(e,"min",(function(){return ze})),n.d(e,"multicast",(function(){return We})),n.d(e,"observeOn",(function(){return Ze.b})),n.d(e,"onErrorResumeNext",(function(){return Qe})),n.d(e,"pairwise",(function(){return qe})),n.d(e,"partition",(function(){return en})),n.d(e,"pluck",(function(){return nn})),n.d(e,"publish",(function(){return an})),n.d(e,"publishBehavior",(function(){return un})),n.d(e,"publishLast",(function(){return ln})),n.d(e,"publishReplay",(function(){return fn})),n.d(e,"race",(function(){return pn})),n.d(e,"reduce",(function(){return Ne})),n.d(e,"repeat",(function(){return mn})),n.d(e,"repeatWhen",(function(){return yn})),n.d(e,"retry",(function(){return _n})),n.d(e,"retryWhen",(function(){return Sn})),n.d(e,"refCount",(function(){return Rn.a})),n.d(e,"sample",(function(){return In})),n.d(e,"sampleTime",(function(){return Cn})),n.d(e,"scan",(function(){return Ae})),n.d(e,"sequenceEqual",(function(){return On})),n.d(e,"share",(function(){return Vn})),n.d(e,"shareReplay",(function(){return Hn})),n.d(e,"single",(function(){return kn})),n.d(e,"skip",(function(){return Wn})),n.d(e,"skipLast",(function(){return Qn})),n.d(e,"skipUntil",(function(){return qn})),n.d(e,"skipWhile",(function(){return tr})),n.d(e,"startWith",(function(){return rr})),n.d(e,"subscribeOn",(function(){return sr})),n.d(e,"switchAll",(function(){return fr})),n.d(e,"switchMap",(function(){return cr})),n.d(e,"switchMapTo",(function(){return hr})),n.d(e,"take",(function(){return Dt})),n.d(e,"takeLast",(function(){return xe})),n.d(e,"takeUntil",(function(){return pr})),n.d(e,"takeWhile",(function(){return gr})),n.d(e,"tap",(function(){return wr})),n.d(e,"throttle",(function(){return Er})),n.d(e,"throttleTime",(function(){return Br})),n.d(e,"throwIfEmpty",(function(){return Nt})),n.d(e,"timeInterval",(function(){return Nr})),n.d(e,"timeout",(function(){return Hr})),n.d(e,"timeoutWith",(function(){return Lr})),n.d(e,"timestamp",(function(){return kr})),n.d(e,"toArray",(function(){return Wr})),n.d(e,"window",(function(){return jr})),n.d(e,"windowCount",(function(){return Yr})),n.d(e,"windowTime",(function(){return Kr})),n.d(e,"windowToggle",(function(){return oi})),n.d(e,"windowWhen",(function(){return ui})),n.d(e,"withLatestFrom",(function(){return di})),n.d(e,"zip",(function(){return mi})),n.d(e,"zipAll",(function(){return vi}));var r=n(0),i=n(4),o=n(3);function a(t){return function(e){return e.lift(new s(t))}}var s=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.durationSelector))},t}(),u=function(t){function e(e,n){var r=t.call(this,e)||this;return r.durationSelector=n,r.hasValue=!1,r}return r.a(e,t),e.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=void 0;try{e=(0,this.durationSelector)(t)}catch(r){return this.destination.error(r)}var n=Object(o.a)(this,e);!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}},e.prototype.clearThrottle=function(){var t=this.value,e=this.hasValue,n=this.throttled;n&&(this.remove(n),this.throttled=null,n.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))},e.prototype.notifyNext=function(t,e,n,r){this.clearThrottle()},e.prototype.notifyComplete=function(){this.clearThrottle()},e}(i.a),c=n(9),l=n(61);function d(t,e){return void 0===e&&(e=c.a),a((function(){return Object(l.a)(t,e)}))}function f(t){return function(e){return e.lift(new h(t))}}var h=function(){function t(t){this.closingNotifier=t}return t.prototype.call=function(t,e){return e.subscribe(new p(t,this.closingNotifier))},t}(),p=function(t){function e(e,n){var r=t.call(this,e)||this;return r.buffer=[],r.add(Object(o.a)(r,n)),r}return r.a(e,t),e.prototype._next=function(t){this.buffer.push(t)},e.prototype.notifyNext=function(t,e,n,r,i){var o=this.buffer;this.buffer=[],this.destination.next(o)},e}(i.a),m=n(1);function v(t,e){return void 0===e&&(e=null),function(n){return n.lift(new g(t,e))}}var g=function(){function t(t,e){this.bufferSize=t,this.startBufferEvery=e,this.subscriberClass=e&&t!==e?b:y}return t.prototype.call=function(t,e){return e.subscribe(new this.subscriberClass(t,this.bufferSize,this.startBufferEvery))},t}(),y=function(t){function e(e,n){var r=t.call(this,e)||this;return r.bufferSize=n,r.buffer=[],r}return r.a(e,t),e.prototype._next=function(t){var e=this.buffer;e.push(t),e.length==this.bufferSize&&(this.destination.next(e),this.buffer=[])},e.prototype._complete=function(){var e=this.buffer;e.length>0&&this.destination.next(e),t.prototype._complete.call(this)},e}(m.a),b=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.bufferSize=n,i.startBufferEvery=r,i.buffers=[],i.count=0,i}return r.a(e,t),e.prototype._next=function(t){var e=this.bufferSize,n=this.startBufferEvery,r=this.buffers,i=this.count;this.count++,i%n===0&&r.push([]);for(var o=r.length;o--;){var a=r[o];a.push(t),a.length===e&&(r.splice(o,1),this.destination.next(a))}},e.prototype._complete=function(){for(var e=this.buffers,n=this.destination;e.length>0;){var r=e.shift();r.length>0&&n.next(r)}t.prototype._complete.call(this)},e}(m.a),x=n(11);function _(t){var e=arguments.length,n=c.a;Object(x.a)(arguments[arguments.length-1])&&(n=arguments[arguments.length-1],e--);var r=null;e>=2&&(r=arguments[1]);var i=Number.POSITIVE_INFINITY;return e>=3&&(i=arguments[2]),function(e){return e.lift(new w(t,r,i,n))}}var w=function(){function t(t,e,n,r){this.bufferTimeSpan=t,this.bufferCreationInterval=e,this.maxBufferSize=n,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new S(t,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},t}(),T=function(){return function(){this.buffer=[]}}(),S=function(t){function e(e,n,r,i,o){var a=t.call(this,e)||this;a.bufferTimeSpan=n,a.bufferCreationInterval=r,a.maxBufferSize=i,a.scheduler=o,a.contexts=[];var s=a.openContext();if(a.timespanOnly=null==r||r<0,a.timespanOnly){var u={subscriber:a,context:s,bufferTimeSpan:n};a.add(s.closeAction=o.schedule(M,n,u))}else{var c={subscriber:a,context:s},l={bufferTimeSpan:n,bufferCreationInterval:r,subscriber:a,scheduler:o};a.add(s.closeAction=o.schedule(R,n,c)),a.add(o.schedule(E,r,l))}return a}return r.a(e,t),e.prototype._next=function(t){for(var e,n=this.contexts,r=n.length,i=0;i<r;i++){var o=n[i],a=o.buffer;a.push(t),a.length==this.maxBufferSize&&(e=o)}e&&this.onBufferFull(e)},e.prototype._error=function(e){this.contexts.length=0,t.prototype._error.call(this,e)},e.prototype._complete=function(){for(var e=this.contexts,n=this.destination;e.length>0;){var r=e.shift();n.next(r.buffer)}t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.contexts=null},e.prototype.onBufferFull=function(t){this.closeContext(t);var e=t.closeAction;if(e.unsubscribe(),this.remove(e),!this.closed&&this.timespanOnly){t=this.openContext();var n=this.bufferTimeSpan,r={subscriber:this,context:t,bufferTimeSpan:n};this.add(t.closeAction=this.scheduler.schedule(M,n,r))}},e.prototype.openContext=function(){var t=new T;return this.contexts.push(t),t},e.prototype.closeContext=function(t){this.destination.next(t.buffer);var e=this.contexts;(e?e.indexOf(t):-1)>=0&&e.splice(e.indexOf(t),1)},e}(m.a);function M(t){var e=t.subscriber,n=t.context;n&&e.closeContext(n),e.closed||(t.context=e.openContext(),t.context.closeAction=this.schedule(t,t.bufferTimeSpan))}function E(t){var e=t.bufferCreationInterval,n=t.bufferTimeSpan,r=t.subscriber,i=t.scheduler,o=r.openContext();r.closed||(r.add(o.closeAction=i.schedule(R,n,{subscriber:r,context:o})),this.schedule(t,e))}function R(t){var e=t.subscriber,n=t.context;e.closeContext(n)}var I=n(5);function B(t,e){return function(n){return n.lift(new A(t,e))}}var A=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new C(t,this.openings,this.closingSelector))},t}(),C=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.openings=n,i.closingSelector=r,i.contexts=[],i.add(Object(o.a)(i,n)),i}return r.a(e,t),e.prototype._next=function(t){for(var e=this.contexts,n=e.length,r=0;r<n;r++)e[r].buffer.push(t)},e.prototype._error=function(e){for(var n=this.contexts;n.length>0;){var r=n.shift();r.subscription.unsubscribe(),r.buffer=null,r.subscription=null}this.contexts=null,t.prototype._error.call(this,e)},e.prototype._complete=function(){for(var e=this.contexts;e.length>0;){var n=e.shift();this.destination.next(n.buffer),n.subscription.unsubscribe(),n.buffer=null,n.subscription=null}this.contexts=null,t.prototype._complete.call(this)},e.prototype.notifyNext=function(t,e,n,r,i){t?this.closeBuffer(t):this.openBuffer(e)},e.prototype.notifyComplete=function(t){this.closeBuffer(t.context)},e.prototype.openBuffer=function(t){try{var e=this.closingSelector.call(this,t);e&&this.trySubscribe(e)}catch(n){this._error(n)}},e.prototype.closeBuffer=function(t){var e=this.contexts;if(e&&t){var n=t.buffer,r=t.subscription;this.destination.next(n),e.splice(e.indexOf(t),1),this.remove(r),r.unsubscribe()}},e.prototype.trySubscribe=function(t){var e=this.contexts,n=new I.a,r={buffer:[],subscription:n};e.push(r);var i=Object(o.a)(this,t,r);!i||i.closed?this.closeBuffer(r):(i.context=r,this.add(i),n.add(i))},e}(i.a);function F(t){return function(e){return e.lift(new P(t))}}var P=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new N(t,this.closingSelector))},t}(),N=function(t){function e(e,n){var r=t.call(this,e)||this;return r.closingSelector=n,r.subscribing=!1,r.openBuffer(),r}return r.a(e,t),e.prototype._next=function(t){this.buffer.push(t)},e.prototype._complete=function(){var e=this.buffer;e&&this.destination.next(e),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.buffer=null,this.subscribing=!1},e.prototype.notifyNext=function(t,e,n,r,i){this.openBuffer()},e.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},e.prototype.openBuffer=function(){var t=this.closingSubscription;t&&(this.remove(t),t.unsubscribe());var e,n=this.buffer;this.buffer&&this.destination.next(n),this.buffer=[];try{e=(0,this.closingSelector)()}catch(r){return this.error(r)}t=new I.a,this.closingSubscription=t,this.add(t),this.subscribing=!0,t.add(Object(o.a)(this,e)),this.subscribing=!1},e}(i.a),O=n(16);function U(t){return function(e){var n=new L(t),r=e.lift(n);return n.caught=r}}var L=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new G(t,this.selector,this.caught))},t}(),G=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.selector=n,i.caught=r,i}return r.a(e,t),e.prototype.error=function(e){if(!this.isStopped){var n=void 0;try{n=this.selector(e,this.caught)}catch(a){return void t.prototype.error.call(this,a)}this._unsubscribeAndRecycle();var r=new O.a(this,void 0,void 0);this.add(r);var i=Object(o.a)(this,n,void 0,void 0,r);i!==r&&this.add(i)}},e}(i.a),D=n(43);function V(t){return function(e){return e.lift(new D.a(t))}}var H=n(8),k=n(13);function z(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=null;return"function"===typeof t[t.length-1]&&(n=t.pop()),1===t.length&&Object(H.a)(t[0])&&(t=t[0].slice()),function(e){return e.lift.call(Object(k.a)([e].concat(t)),new D.a(n))}}var X=n(34);function W(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(X.a.apply(void 0,[e].concat(t)))}}var j=n(62),Z=n(25);function Q(t,e){return Object(Z.a)(t,e,1)}function Y(t,e){return Q((function(){return t}),e)}function J(t){return function(e){return e.lift(new q(t,e))}}var q=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new K(t,this.predicate,this.source))},t}(),K=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.source=r,i.count=0,i.index=0,i}return r.a(e,t),e.prototype._next=function(t){this.predicate?this._tryPredicate(t):this.count++},e.prototype._tryPredicate=function(t){var e;try{e=this.predicate(t,this.index++,this.source)}catch(n){return void this.destination.error(n)}e&&this.count++},e.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},e}(m.a);function $(t){return function(e){return e.lift(new tt(t))}}var tt=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new et(t,this.durationSelector))},t}(),et=function(t){function e(e,n){var r=t.call(this,e)||this;return r.durationSelector=n,r.hasValue=!1,r.durationSubscription=null,r}return r.a(e,t),e.prototype._next=function(t){try{var e=this.durationSelector.call(this,t);e&&this._tryNext(t,e)}catch(n){this.destination.error(n)}},e.prototype._complete=function(){this.emitValue(),this.destination.complete()},e.prototype._tryNext=function(t,e){var n=this.durationSubscription;this.value=t,this.hasValue=!0,n&&(n.unsubscribe(),this.remove(n)),(n=Object(o.a)(this,e))&&!n.closed&&this.add(this.durationSubscription=n)},e.prototype.notifyNext=function(t,e,n,r,i){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){if(this.hasValue){var e=this.value,n=this.durationSubscription;n&&(this.durationSubscription=null,n.unsubscribe(),this.remove(n)),this.value=null,this.hasValue=!1,t.prototype._next.call(this,e)}},e}(i.a);function nt(t,e){return void 0===e&&(e=c.a),function(n){return n.lift(new rt(t,e))}}var rt=function(){function t(t,e){this.dueTime=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new it(t,this.dueTime,this.scheduler))},t}(),it=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.dueTime=n,i.scheduler=r,i.debouncedSubscription=null,i.lastValue=null,i.hasValue=!1,i}return r.a(e,t),e.prototype._next=function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(ot,this.dueTime,this))},e.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},e.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var t=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}},e.prototype.clearDebounce=function(){var t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)},e}(m.a);function ot(t){t.debouncedNext()}function at(t){return void 0===t&&(t=null),function(e){return e.lift(new st(t))}}var st=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new ut(t,this.defaultValue))},t}(),ut=function(t){function e(e,n){var r=t.call(this,e)||this;return r.defaultValue=n,r.isEmpty=!0,r}return r.a(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(m.a);function ct(t){return t instanceof Date&&!isNaN(+t)}var lt=n(20);function dt(t,e){void 0===e&&(e=c.a);var n=ct(t)?+t-e.now():Math.abs(t);return function(t){return t.lift(new ft(n,e))}}var ft=function(){function t(t,e){this.delay=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new ht(t,this.delay,this.scheduler))},t}(),ht=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.delay=n,i.scheduler=r,i.queue=[],i.active=!1,i.errored=!1,i}return r.a(e,t),e.dispatch=function(t){for(var e=t.source,n=e.queue,r=t.scheduler,i=t.destination;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(i);if(n.length>0){var o=Math.max(0,n[0].time-r.now());this.schedule(t,o)}else this.unsubscribe(),e.active=!1},e.prototype._schedule=function(t){this.active=!0,this.destination.add(t.schedule(e.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))},e.prototype.scheduleNotification=function(t){if(!0!==this.errored){var e=this.scheduler,n=new pt(e.now()+this.delay,t);this.queue.push(n),!1===this.active&&this._schedule(e)}},e.prototype._next=function(t){this.scheduleNotification(lt.a.createNext(t))},e.prototype._error=function(t){this.errored=!0,this.queue=[],this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.scheduleNotification(lt.a.createComplete()),this.unsubscribe()},e}(m.a),pt=function(){return function(t,e){this.time=t,this.notification=e}}(),mt=n(2);function vt(t,e){return e?function(n){return new bt(n,e).lift(new gt(t))}:function(e){return e.lift(new gt(t))}}var gt=function(){function t(t){this.delayDurationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new yt(t,this.delayDurationSelector))},t}(),yt=function(t){function e(e,n){var r=t.call(this,e)||this;return r.delayDurationSelector=n,r.completed=!1,r.delayNotifierSubscriptions=[],r.index=0,r}return r.a(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(t),this.removeSubscription(i),this.tryComplete()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){var e=this.removeSubscription(t);e&&this.destination.next(e),this.tryComplete()},e.prototype._next=function(t){var e=this.index++;try{var n=this.delayDurationSelector(t,e);n&&this.tryDelay(n,t)}catch(r){this.destination.error(r)}},e.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},e.prototype.removeSubscription=function(t){t.unsubscribe();var e=this.delayNotifierSubscriptions.indexOf(t);return-1!==e&&this.delayNotifierSubscriptions.splice(e,1),t.outerValue},e.prototype.tryDelay=function(t,e){var n=Object(o.a)(this,t,e);n&&!n.closed&&(this.destination.add(n),this.delayNotifierSubscriptions.push(n))},e.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},e}(i.a),bt=function(t){function e(e,n){var r=t.call(this)||this;return r.source=e,r.subscriptionDelay=n,r}return r.a(e,t),e.prototype._subscribe=function(t){this.subscriptionDelay.subscribe(new xt(t,this.source))},e}(mt.a),xt=function(t){function e(e,n){var r=t.call(this)||this;return r.parent=e,r.source=n,r.sourceSubscribed=!1,r}return r.a(e,t),e.prototype._next=function(t){this.subscribeToSource()},e.prototype._error=function(t){this.unsubscribe(),this.parent.error(t)},e.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},e.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},e}(m.a);function _t(){return function(t){return t.lift(new wt)}}var wt=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Tt(t))},t}(),Tt=function(t){function e(e){return t.call(this,e)||this}return r.a(e,t),e.prototype._next=function(t){t.observe(this.destination)},e}(m.a);function St(t,e){return function(n){return n.lift(new Mt(t,e))}}var Mt=function(){function t(t,e){this.keySelector=t,this.flushes=e}return t.prototype.call=function(t,e){return e.subscribe(new Et(t,this.keySelector,this.flushes))},t}(),Et=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.keySelector=n,i.values=new Set,r&&i.add(Object(o.a)(i,r)),i}return r.a(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.values.clear()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype._next=function(t){this.keySelector?this._useKeySelector(t):this._finalizeNext(t,t)},e.prototype._useKeySelector=function(t){var e,n=this.destination;try{e=this.keySelector(t)}catch(r){return void n.error(r)}this._finalizeNext(e,t)},e.prototype._finalizeNext=function(t,e){var n=this.values;n.has(t)||(n.add(t),this.destination.next(e))},e}(i.a);function Rt(t,e){return function(n){return n.lift(new It(t,e))}}var It=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new Bt(t,this.compare,this.keySelector))},t}(),Bt=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.keySelector=r,i.hasKey=!1,"function"===typeof n&&(i.compare=n),i}return r.a(e,t),e.prototype.compare=function(t,e){return t===e},e.prototype._next=function(t){var e;try{var n=this.keySelector;e=n?n(t):t}catch(i){return this.destination.error(i)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,e)}catch(i){return this.destination.error(i)}else this.hasKey=!0;r||(this.key=e,this.destination.next(t))},e}(m.a);function At(t,e){return Rt((function(n,r){return e?e(n[t],r[t]):n[t]===r[t]}))}var Ct=n(26),Ft=n(19),Pt=n(28);function Nt(t){return void 0===t&&(t=Lt),function(e){return e.lift(new Ot(t))}}var Ot=function(){function t(t){this.errorFactory=t}return t.prototype.call=function(t,e){return e.subscribe(new Ut(t,this.errorFactory))},t}(),Ut=function(t){function e(e,n){var r=t.call(this,e)||this;return r.errorFactory=n,r.hasValue=!1,r}return r.a(e,t),e.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)},e}(m.a);function Lt(){return new Pt.a}var Gt=n(12);function Dt(t){return function(e){return 0===t?Object(Gt.b)():e.lift(new Vt(t))}}var Vt=function(){function t(t){if(this.total=t,this.total<0)throw new Ct.a}return t.prototype.call=function(t,e){return e.subscribe(new Ht(t,this.total))},t}(),Ht=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.count=0,r}return r.a(e,t),e.prototype._next=function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))},e}(m.a);function kt(t,e){if(t<0)throw new Ct.a;var n=arguments.length>=2;return function(r){return r.pipe(Object(Ft.a)((function(e,n){return n===t})),Dt(1),n?at(e):Nt((function(){return new Ct.a})))}}var zt=n(38);function Xt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return Object(X.a)(e,zt.a.apply(void 0,t))}}function Wt(t,e){return function(n){return n.lift(new jt(t,e,n))}}var jt=function(){function t(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}return t.prototype.call=function(t,e){return e.subscribe(new Zt(t,this.predicate,this.thisArg,this.source))},t}(),Zt=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.predicate=n,o.thisArg=r,o.source=i,o.index=0,o.thisArg=r||o,o}return r.a(e,t),e.prototype.notifyComplete=function(t){this.destination.next(t),this.destination.complete()},e.prototype._next=function(t){var e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(n){return void this.destination.error(n)}e||this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(m.a);function Qt(){return function(t){return t.lift(new Yt)}}var Yt=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Jt(t))},t}(),Jt=function(t){function e(e){var n=t.call(this,e)||this;return n.hasCompleted=!1,n.hasSubscription=!1,n}return r.a(e,t),e.prototype._next=function(t){this.hasSubscription||(this.hasSubscription=!0,this.add(Object(o.a)(this,t)))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},e.prototype.notifyComplete=function(t){this.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(i.a),qt=n(10);function Kt(t,e){return e?function(n){return n.pipe(Kt((function(n,r){return Object(k.a)(t(n,r)).pipe(Object(qt.a)((function(t,i){return e(n,t,r,i)})))})))}:function(e){return e.lift(new $t(t))}}var $t=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new te(t,this.project))},t}(),te=function(t){function e(e,n){var r=t.call(this,e)||this;return r.project=n,r.hasSubscription=!1,r.hasCompleted=!1,r.index=0,r}return r.a(e,t),e.prototype._next=function(t){this.hasSubscription||this.tryNext(t)},e.prototype.tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.hasSubscription=!0,this._innerSub(e,t,n)},e.prototype._innerSub=function(t,e,n){var r=new O.a(this,e,n),i=this.destination;i.add(r);var a=Object(o.a)(this,t,void 0,void 0,r);a!==r&&i.add(a)},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(i.a);function ee(t,e,n){return void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===n&&(n=void 0),e=(e||0)<1?Number.POSITIVE_INFINITY:e,function(r){return r.lift(new ne(t,e,n))}}var ne=function(){function t(t,e,n){this.project=t,this.concurrent=e,this.scheduler=n}return t.prototype.call=function(t,e){return e.subscribe(new re(t,this.project,this.concurrent,this.scheduler))},t}(),re=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.project=n,o.concurrent=r,o.scheduler=i,o.index=0,o.active=0,o.hasCompleted=!1,r<Number.POSITIVE_INFINITY&&(o.buffer=[]),o}return r.a(e,t),e.dispatch=function(t){var e=t.subscriber,n=t.result,r=t.value,i=t.index;e.subscribeToProjection(n,r,i)},e.prototype._next=function(t){var n=this.destination;if(n.closed)this._complete();else{var r=this.index++;if(this.active<this.concurrent){n.next(t);try{var i=(0,this.project)(t,r);if(this.scheduler){var o={subscriber:this,result:i,value:t,index:r};this.destination.add(this.scheduler.schedule(e.dispatch,0,o))}else this.subscribeToProjection(i,t,r)}catch(a){n.error(a)}}else this.buffer.push(t)}},e.prototype.subscribeToProjection=function(t,e,n){this.active++,this.destination.add(Object(o.a)(this,t,e,n))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t,e,n,r,i){this._next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.destination.remove(t),this.active--,e&&e.length>0&&this._next(e.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},e}(i.a);function ie(t){return function(e){return e.lift(new oe(t))}}var oe=function(){function t(t){this.callback=t}return t.prototype.call=function(t,e){return e.subscribe(new ae(t,this.callback))},t}(),ae=function(t){function e(e,n){var r=t.call(this,e)||this;return r.add(new I.a(n)),r}return r.a(e,t),e}(m.a);function se(t,e){if("function"!==typeof t)throw new TypeError("predicate is not a function");return function(n){return n.lift(new ue(t,n,!1,e))}}var ue=function(){function t(t,e,n,r){this.predicate=t,this.source=e,this.yieldIndex=n,this.thisArg=r}return t.prototype.call=function(t,e){return e.subscribe(new ce(t,this.predicate,this.source,this.yieldIndex,this.thisArg))},t}(),ce=function(t){function e(e,n,r,i,o){var a=t.call(this,e)||this;return a.predicate=n,a.source=r,a.yieldIndex=i,a.thisArg=o,a.index=0,a}return r.a(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete(),this.unsubscribe()},e.prototype._next=function(t){var e=this.predicate,n=this.thisArg,r=this.index++;try{e.call(n||this,t,r,this.source)&&this.notifyComplete(this.yieldIndex?r:t)}catch(i){this.destination.error(i)}},e.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},e}(m.a);function le(t,e){return function(n){return n.lift(new ue(t,n,!0,e))}}var de=n(18);function fe(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?Object(Ft.a)((function(e,n){return t(e,n,r)})):de.a,Dt(1),n?at(e):Nt((function(){return new Pt.a})))}}var he=n(60);function pe(){return function(t){return t.lift(new me)}}var me=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new ve(t))},t}(),ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.a(e,t),e.prototype._next=function(t){},e}(m.a);function ge(){return function(t){return t.lift(new ye)}}var ye=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new be(t))},t}(),be=function(t){function e(e){return t.call(this,e)||this}return r.a(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype._next=function(t){this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(m.a);function xe(t){return function(e){return 0===t?Object(Gt.b)():e.lift(new _e(t))}}var _e=function(){function t(t){if(this.total=t,this.total<0)throw new Ct.a}return t.prototype.call=function(t,e){return e.subscribe(new we(t,this.total))},t}(),we=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.ring=new Array,r.count=0,r}return r.a(e,t),e.prototype._next=function(t){var e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t},e.prototype._complete=function(){var t=this.destination,e=this.count;if(e>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var o=e++%n;t.next(r[o])}t.complete()},e}(m.a);function Te(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?Object(Ft.a)((function(e,n){return t(e,n,r)})):de.a,xe(1),n?at(e):Nt((function(){return new Pt.a})))}}function Se(t){return function(e){return e.lift(new Me(t))}}var Me=function(){function t(t){this.value=t}return t.prototype.call=function(t,e){return e.subscribe(new Ee(t,this.value))},t}(),Ee=function(t){function e(e,n){var r=t.call(this,e)||this;return r.value=n,r}return r.a(e,t),e.prototype._next=function(t){this.destination.next(this.value)},e}(m.a);function Re(){return function(t){return t.lift(new Ie)}}var Ie=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Be(t))},t}(),Be=function(t){function e(e){return t.call(this,e)||this}return r.a(e,t),e.prototype._next=function(t){this.destination.next(lt.a.createNext(t))},e.prototype._error=function(t){var e=this.destination;e.next(lt.a.createError(t)),e.complete()},e.prototype._complete=function(){var t=this.destination;t.next(lt.a.createComplete()),t.complete()},e}(m.a);function Ae(t,e){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new Ce(t,e,n))}}var Ce=function(){function t(t,e,n){void 0===n&&(n=!1),this.accumulator=t,this.seed=e,this.hasSeed=n}return t.prototype.call=function(t,e){return e.subscribe(new Fe(t,this.accumulator,this.seed,this.hasSeed))},t}(),Fe=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.accumulator=n,o._seed=r,o.hasSeed=i,o.index=0,o}return r.a(e,t),Object.defineProperty(e.prototype,"seed",{get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t},enumerable:!0,configurable:!0}),e.prototype._next=function(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.accumulator(this.seed,t,n)}catch(r){this.destination.error(r)}this.seed=e,this.destination.next(e)},e}(m.a),Pe=n(39);function Ne(t,e){return arguments.length>=2?function(n){return Object(Pe.a)(Ae(t,e),xe(1),at(e))(n)}:function(e){return Object(Pe.a)(Ae((function(e,n,r){return t(e,n,r+1)})),xe(1))(e)}}function Oe(t){return Ne("function"===typeof t?function(e,n){return t(e,n)>0?e:n}:function(t,e){return t>e?t:e})}var Ue=n(63);function Le(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(Ue.a.apply(void 0,[e].concat(t)))}}var Ge=n(44);function De(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"===typeof e?Object(Z.a)((function(){return t}),e,n):("number"===typeof e&&(n=e),Object(Z.a)((function(){return t}),n))}function Ve(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),function(r){return r.lift(new He(t,e,n))}}var He=function(){function t(t,e,n){this.accumulator=t,this.seed=e,this.concurrent=n}return t.prototype.call=function(t,e){return e.subscribe(new ke(t,this.accumulator,this.seed,this.concurrent))},t}(),ke=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.accumulator=n,o.acc=r,o.concurrent=i,o.hasValue=!1,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return r.a(e,t),e.prototype._next=function(t){if(this.active<this.concurrent){var e=this.index++,n=this.destination,r=void 0;try{r=(0,this.accumulator)(this.acc,t,e)}catch(i){return n.error(i)}this.active++,this._innerSub(r,t,e)}else this.buffer.push(t)},e.prototype._innerSub=function(t,e,n){var r=new O.a(this,e,n),i=this.destination;i.add(r);var a=Object(o.a)(this,t,void 0,void 0,r);a!==r&&i.add(a)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},e.prototype.notifyNext=function(t,e,n,r,i){var o=this.destination;this.acc=e,this.hasValue=!0,o.next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.destination.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},e}(i.a);function ze(t){return Ne("function"===typeof t?function(e,n){return t(e,n)<0?e:n}:function(t,e){return t<e?t:e})}var Xe=n(64);function We(t,e){return function(n){var r;if(r="function"===typeof t?t:function(){return t},"function"===typeof e)return n.lift(new je(r,e));var i=Object.create(n,Xe.b);return i.source=n,i.subjectFactory=r,i}}var je=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var n=this.selector,r=this.subjectFactory(),i=n(r).subscribe(t);return i.add(e.subscribe(r)),i},t}(),Ze=n(65);function Qe(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 1===t.length&&Object(H.a)(t[0])&&(t=t[0]),function(e){return e.lift(new Ye(t))}}var Ye=function(){function t(t){this.nextSources=t}return t.prototype.call=function(t,e){return e.subscribe(new Je(t,this.nextSources))},t}(),Je=function(t){function e(e,n){var r=t.call(this,e)||this;return r.destination=e,r.nextSources=n,r}return r.a(e,t),e.prototype.notifyError=function(t,e){this.subscribeToNextSource()},e.prototype.notifyComplete=function(t){this.subscribeToNextSource()},e.prototype._error=function(t){this.subscribeToNextSource(),this.unsubscribe()},e.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},e.prototype.subscribeToNextSource=function(){var t=this.nextSources.shift();if(t){var e=new O.a(this,void 0,void 0),n=this.destination;n.add(e);var r=Object(o.a)(this,t,void 0,void 0,e);r!==e&&n.add(r)}else this.destination.complete()},e}(i.a);function qe(){return function(t){return t.lift(new Ke)}}var Ke=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new $e(t))},t}(),$e=function(t){function e(e){var n=t.call(this,e)||this;return n.hasPrev=!1,n}return r.a(e,t),e.prototype._next=function(t){var e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)},e}(m.a),tn=n(77);function en(t,e){return function(n){return[Object(Ft.a)(t,e)(n),Object(Ft.a)(Object(tn.a)(t,e))(n)]}}function nn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.length;if(0===n)throw new Error("list of properties cannot be empty.");return function(e){return Object(qt.a)(rn(t,n))(e)}}function rn(t,e){return function(n){for(var r=n,i=0;i<e;i++){var o=r[t[i]];if("undefined"===typeof o)return;r=o}return r}}var on=n(7);function an(t){return t?We((function(){return new on.a}),t):We(new on.a)}var sn=n(66);function un(t){return function(e){return We(new sn.a(t))(e)}}var cn=n(31);function ln(){return function(t){return We(new cn.a)(t)}}var dn=n(47);function fn(t,e,n,r){n&&"function"!==typeof n&&(r=n);var i="function"===typeof n?n:void 0,o=new dn.a(t,e,r);return function(t){return We((function(){return o}),i)(t)}}var hn=n(67);function pn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return 1===t.length&&Object(H.a)(t[0])&&(t=t[0]),e.lift.call(hn.a.apply(void 0,[e].concat(t)))}}function mn(t){return void 0===t&&(t=-1),function(e){return 0===t?Object(Gt.b)():t<0?e.lift(new vn(-1,e)):e.lift(new vn(t-1,e))}}var vn=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new gn(t,this.count,this.source))},t}(),gn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.count=n,i.source=r,i}return r.a(e,t),e.prototype.complete=function(){if(!this.isStopped){var e=this.source,n=this.count;if(0===n)return t.prototype.complete.call(this);n>-1&&(this.count=n-1),e.subscribe(this._unsubscribeAndRecycle())}},e}(m.a);function yn(t){return function(e){return e.lift(new bn(t))}}var bn=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new xn(t,this.notifier,e))},t}(),xn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.notifier=n,i.source=r,i.sourceIsBeingSubscribedTo=!0,i}return r.a(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},e.prototype.notifyComplete=function(e){if(!1===this.sourceIsBeingSubscribedTo)return t.prototype.complete.call(this)},e.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return t.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next()}},e.prototype._unsubscribe=function(){var t=this.notifications,e=this.retriesSubscription;t&&(t.unsubscribe(),this.notifications=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},e.prototype._unsubscribeAndRecycle=function(){var e=this._unsubscribe;return this._unsubscribe=null,t.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=e,this},e.prototype.subscribeToRetries=function(){var e;this.notifications=new on.a;try{e=(0,this.notifier)(this.notifications)}catch(n){return t.prototype.complete.call(this)}this.retries=e,this.retriesSubscription=Object(o.a)(this,e)},e}(i.a);function _n(t){return void 0===t&&(t=-1),function(e){return e.lift(new wn(t,e))}}var wn=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new Tn(t,this.count,this.source))},t}(),Tn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.count=n,i.source=r,i}return r.a(e,t),e.prototype.error=function(e){if(!this.isStopped){var n=this.source,r=this.count;if(0===r)return t.prototype.error.call(this,e);r>-1&&(this.count=r-1),n.subscribe(this._unsubscribeAndRecycle())}},e}(m.a);function Sn(t){return function(e){return e.lift(new Mn(t,e))}}var Mn=function(){function t(t,e){this.notifier=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new En(t,this.notifier,this.source))},t}(),En=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.notifier=n,i.source=r,i}return r.a(e,t),e.prototype.error=function(e){if(!this.isStopped){var n=this.errors,r=this.retries,i=this.retriesSubscription;if(r)this.errors=null,this.retriesSubscription=null;else{n=new on.a;try{r=(0,this.notifier)(n)}catch(a){return t.prototype.error.call(this,a)}i=Object(o.a)(this,r)}this._unsubscribeAndRecycle(),this.errors=n,this.retries=r,this.retriesSubscription=i,n.next(e)}},e.prototype._unsubscribe=function(){var t=this.errors,e=this.retriesSubscription;t&&(t.unsubscribe(),this.errors=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},e.prototype.notifyNext=function(t,e,n,r,i){var o=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=o,this.source.subscribe(this)},e}(i.a),Rn=n(46);function In(t){return function(e){return e.lift(new Bn(t))}}var Bn=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var n=new An(t),r=e.subscribe(n);return r.add(Object(o.a)(n,this.notifier)),r},t}(),An=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasValue=!1,e}return r.a(e,t),e.prototype._next=function(t){this.value=t,this.hasValue=!0},e.prototype.notifyNext=function(t,e,n,r,i){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},e}(i.a);function Cn(t,e){return void 0===e&&(e=c.a),function(n){return n.lift(new Fn(t,e))}}var Fn=function(){function t(t,e){this.period=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new Pn(t,this.period,this.scheduler))},t}(),Pn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.period=n,i.scheduler=r,i.hasValue=!1,i.add(r.schedule(Nn,n,{subscriber:i,period:n})),i}return r.a(e,t),e.prototype._next=function(t){this.lastValue=t,this.hasValue=!0},e.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},e}(m.a);function Nn(t){var e=t.subscriber,n=t.period;e.notifyNext(),this.schedule(t,n)}function On(t,e){return function(n){return n.lift(new Un(t,e))}}var Un=function(){function t(t,e){this.compareTo=t,this.comparator=e}return t.prototype.call=function(t,e){return e.subscribe(new Ln(t,this.compareTo,this.comparator))},t}(),Ln=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.compareTo=n,i.comparator=r,i._a=[],i._b=[],i._oneComplete=!1,i.destination.add(n.subscribe(new Gn(e,i))),i}return r.a(e,t),e.prototype._next=function(t){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(t),this.checkValues())},e.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0,this.unsubscribe()},e.prototype.checkValues=function(){for(var t=this._a,e=this._b,n=this.comparator;t.length>0&&e.length>0;){var r=t.shift(),i=e.shift(),o=!1;try{o=n?n(r,i):r===i}catch(a){this.destination.error(a)}o||this.emit(!1)}},e.prototype.emit=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype.nextB=function(t){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(t),this.checkValues())},e.prototype.completeB=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},e}(m.a),Gn=function(t){function e(e,n){var r=t.call(this,e)||this;return r.parent=n,r}return r.a(e,t),e.prototype._next=function(t){this.parent.nextB(t)},e.prototype._error=function(t){this.parent.error(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},e}(m.a);function Dn(){return new on.a}function Vn(){return function(t){return Object(Rn.a)()(We(Dn)(t))}}function Hn(t,e,n){var r;return r=t&&"object"===typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:n},function(t){return t.lift(function(t){var e,n,r=t.bufferSize,i=void 0===r?Number.POSITIVE_INFINITY:r,o=t.windowTime,a=void 0===o?Number.POSITIVE_INFINITY:o,s=t.refCount,u=t.scheduler,c=0,l=!1,d=!1;return function(t){c++,e&&!l||(l=!1,e=new dn.a(i,a,u),n=t.subscribe({next:function(t){e.next(t)},error:function(t){l=!0,e.error(t)},complete:function(){d=!0,n=void 0,e.complete()}}));var r=e.subscribe(this);this.add((function(){c--,r.unsubscribe(),n&&!d&&s&&0===c&&(n.unsubscribe(),n=void 0,e=void 0)}))}}(r))}}function kn(t){return function(e){return e.lift(new zn(t,e))}}var zn=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new Xn(t,this.predicate,this.source))},t}(),Xn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.source=r,i.seenValue=!1,i.index=0,i}return r.a(e,t),e.prototype.applySingleValue=function(t){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=t)},e.prototype._next=function(t){var e=this.index++;this.predicate?this.tryNext(t,e):this.applySingleValue(t)},e.prototype.tryNext=function(t,e){try{this.predicate(t,e,this.source)&&this.applySingleValue(t)}catch(n){this.destination.error(n)}},e.prototype._complete=function(){var t=this.destination;this.index>0?(t.next(this.seenValue?this.singleValue:void 0),t.complete()):t.error(new Pt.a)},e}(m.a);function Wn(t){return function(e){return e.lift(new jn(t))}}var jn=function(){function t(t){this.total=t}return t.prototype.call=function(t,e){return e.subscribe(new Zn(t,this.total))},t}(),Zn=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.count=0,r}return r.a(e,t),e.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)},e}(m.a);function Qn(t){return function(e){return e.lift(new Yn(t))}}var Yn=function(){function t(t){if(this._skipCount=t,this._skipCount<0)throw new Ct.a}return t.prototype.call=function(t,e){return 0===this._skipCount?e.subscribe(new m.a(t)):e.subscribe(new Jn(t,this._skipCount))},t}(),Jn=function(t){function e(e,n){var r=t.call(this,e)||this;return r._skipCount=n,r._count=0,r._ring=new Array(n),r}return r.a(e,t),e.prototype._next=function(t){var e=this._skipCount,n=this._count++;if(n<e)this._ring[n]=t;else{var r=n%e,i=this._ring,o=i[r];i[r]=t,this.destination.next(o)}},e}(m.a);function qn(t){return function(e){return e.lift(new Kn(t))}}var Kn=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new $n(t,this.notifier))},t}(),$n=function(t){function e(e,n){var r=t.call(this,e)||this;r.hasValue=!1;var i=new O.a(r,void 0,void 0);r.add(i),r.innerSubscription=i;var a=Object(o.a)(r,n,void 0,void 0,i);return a!==i&&(r.add(a),r.innerSubscription=a),r}return r.a(e,t),e.prototype._next=function(e){this.hasValue&&t.prototype._next.call(this,e)},e.prototype.notifyNext=function(t,e,n,r,i){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},e.prototype.notifyComplete=function(){},e}(i.a);function tr(t){return function(e){return e.lift(new er(t))}}var er=function(){function t(t){this.predicate=t}return t.prototype.call=function(t,e){return e.subscribe(new nr(t,this.predicate))},t}(),nr=function(t){function e(e,n){var r=t.call(this,e)||this;return r.predicate=n,r.skipping=!0,r.index=0,r}return r.a(e,t),e.prototype._next=function(t){var e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)},e.prototype.tryCallPredicate=function(t){try{var e=this.predicate(t,this.index++);this.skipping=Boolean(e)}catch(n){this.destination.error(n)}},e}(m.a);function rr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return Object(x.a)(n)?(t.pop(),function(e){return Object(X.a)(t,e,n)}):function(e){return Object(X.a)(t,e)}}var ir=n(54),or=n(33),ar=function(t){function e(e,n,r){void 0===n&&(n=0),void 0===r&&(r=ir.a);var i=t.call(this)||this;return i.source=e,i.delayTime=n,i.scheduler=r,(!Object(or.a)(n)||n<0)&&(i.delayTime=0),r&&"function"===typeof r.schedule||(i.scheduler=ir.a),i}return r.a(e,t),e.create=function(t,n,r){return void 0===n&&(n=0),void 0===r&&(r=ir.a),new e(t,n,r)},e.dispatch=function(t){var e=t.source,n=t.subscriber;return this.add(e.subscribe(n))},e.prototype._subscribe=function(t){var n=this.delayTime,r=this.source;return this.scheduler.schedule(e.dispatch,n,{source:r,subscriber:t})},e}(mt.a);function sr(t,e){return void 0===e&&(e=0),function(n){return n.lift(new ur(t,e))}}var ur=function(){function t(t,e){this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return new ar(e,this.delay,this.scheduler).subscribe(t)},t}();function cr(t,e){return"function"===typeof e?function(n){return n.pipe(cr((function(n,r){return Object(k.a)(t(n,r)).pipe(Object(qt.a)((function(t,i){return e(n,t,r,i)})))})))}:function(e){return e.lift(new lr(t))}}var lr=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new dr(t,this.project))},t}(),dr=function(t){function e(e,n){var r=t.call(this,e)||this;return r.project=n,r.index=0,r}return r.a(e,t),e.prototype._next=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e,t,n)},e.prototype._innerSub=function(t,e,n){var r=this.innerSubscription;r&&r.unsubscribe();var i=new O.a(this,e,n),a=this.destination;a.add(i),this.innerSubscription=Object(o.a)(this,t,void 0,void 0,i),this.innerSubscription!==i&&a.add(this.innerSubscription)},e.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this),this.unsubscribe()},e.prototype._unsubscribe=function(){this.innerSubscription=null},e.prototype.notifyComplete=function(e){this.destination.remove(e),this.innerSubscription=null,this.isStopped&&t.prototype._complete.call(this)},e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},e}(i.a);function fr(){return cr(de.a)}function hr(t,e){return e?cr((function(){return t}),e):cr((function(){return t}))}function pr(t){return function(e){return e.lift(new mr(t))}}var mr=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var n=new vr(t),r=Object(o.a)(n,this.notifier);return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n},t}(),vr=function(t){function e(e){var n=t.call(this,e)||this;return n.seenValue=!1,n}return r.a(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.seenValue=!0,this.complete()},e.prototype.notifyComplete=function(){},e}(i.a);function gr(t,e){return void 0===e&&(e=!1),function(n){return n.lift(new yr(t,e))}}var yr=function(){function t(t,e){this.predicate=t,this.inclusive=e}return t.prototype.call=function(t,e){return e.subscribe(new br(t,this.predicate,this.inclusive))},t}(),br=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.inclusive=r,i.index=0,i}return r.a(e,t),e.prototype._next=function(t){var e,n=this.destination;try{e=this.predicate(t,this.index++)}catch(r){return void n.error(r)}this.nextOrComplete(t,e)},e.prototype.nextOrComplete=function(t,e){var n=this.destination;Boolean(e)?n.next(t):(this.inclusive&&n.next(t),n.complete())},e}(m.a),xr=n(22),_r=n(27);function wr(t,e,n){return function(r){return r.lift(new Tr(t,e,n))}}var Tr=function(){function t(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}return t.prototype.call=function(t,e){return e.subscribe(new Sr(t,this.nextOrObserver,this.error,this.complete))},t}(),Sr=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o._tapNext=xr.a,o._tapError=xr.a,o._tapComplete=xr.a,o._tapError=r||xr.a,o._tapComplete=i||xr.a,Object(_r.a)(n)?(o._context=o,o._tapNext=n):n&&(o._context=n,o._tapNext=n.next||xr.a,o._tapError=n.error||xr.a,o._tapComplete=n.complete||xr.a),o}return r.a(e,t),e.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)},e.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},e}(m.a),Mr={leading:!0,trailing:!1};function Er(t,e){return void 0===e&&(e=Mr),function(n){return n.lift(new Rr(t,e.leading,e.trailing))}}var Rr=function(){function t(t,e,n){this.durationSelector=t,this.leading=e,this.trailing=n}return t.prototype.call=function(t,e){return e.subscribe(new Ir(t,this.durationSelector,this.leading,this.trailing))},t}(),Ir=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.destination=e,o.durationSelector=n,o._leading=r,o._trailing=i,o._hasValue=!1,o}return r.a(e,t),e.prototype._next=function(t){this._hasValue=!0,this._sendValue=t,this._throttled||(this._leading?this.send():this.throttle(t))},e.prototype.send=function(){var t=this._hasValue,e=this._sendValue;t&&(this.destination.next(e),this.throttle(e)),this._hasValue=!1,this._sendValue=null},e.prototype.throttle=function(t){var e=this.tryDurationSelector(t);e&&this.add(this._throttled=Object(o.a)(this,e))},e.prototype.tryDurationSelector=function(t){try{return this.durationSelector(t)}catch(e){return this.destination.error(e),null}},e.prototype.throttlingDone=function(){var t=this._throttled,e=this._trailing;t&&t.unsubscribe(),this._throttled=null,e&&this.send()},e.prototype.notifyNext=function(t,e,n,r,i){this.throttlingDone()},e.prototype.notifyComplete=function(){this.throttlingDone()},e}(i.a);function Br(t,e,n){return void 0===e&&(e=c.a),void 0===n&&(n=Mr),function(r){return r.lift(new Ar(t,e,n.leading,n.trailing))}}var Ar=function(){function t(t,e,n,r){this.duration=t,this.scheduler=e,this.leading=n,this.trailing=r}return t.prototype.call=function(t,e){return e.subscribe(new Cr(t,this.duration,this.scheduler,this.leading,this.trailing))},t}(),Cr=function(t){function e(e,n,r,i,o){var a=t.call(this,e)||this;return a.duration=n,a.scheduler=r,a.leading=i,a.trailing=o,a._hasTrailingValue=!1,a._trailingValue=null,a}return r.a(e,t),e.prototype._next=function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Fr,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))},e.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},e.prototype.clearThrottle=function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)},e}(m.a);function Fr(t){t.subscriber.clearThrottle()}var Pr=n(48);function Nr(t){return void 0===t&&(t=c.a),function(e){return Object(Pr.a)((function(){return e.pipe(Ae((function(e,n){var r=e.current;return{value:n,current:t.now(),last:r}}),{current:t.now(),value:void 0,last:void 0}),Object(qt.a)((function(t){var e=t.current,n=t.last,r=t.value;return new Or(r,e-n)})))}))}}var Or=function(){return function(t,e){this.value=t,this.interval=e}}(),Ur=n(68);function Lr(t,e,n){return void 0===n&&(n=c.a),function(r){var i=ct(t),o=i?+t-n.now():Math.abs(t);return r.lift(new Gr(o,i,e,n))}}var Gr=function(){function t(t,e,n,r){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=n,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new Dr(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},t}(),Dr=function(t){function e(e,n,r,i,o){var a=t.call(this,e)||this;return a.absoluteTimeout=n,a.waitFor=r,a.withObservable=i,a.scheduler=o,a.action=null,a.scheduleTimeout(),a}return r.a(e,t),e.dispatchTimeout=function(t){var e=t.withObservable;t._unsubscribeAndRecycle(),t.add(Object(o.a)(t,e))},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),t.prototype._next.call(this,e)},e.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.withObservable=null},e}(i.a),Vr=n(45);function Hr(t,e){return void 0===e&&(e=c.a),Lr(t,Object(Vr.a)(new Ur.a),e)}function kr(t){return void 0===t&&(t=c.a),Object(qt.a)((function(e){return new zr(e,t.now())}))}var zr=function(){return function(t,e){this.value=t,this.timestamp=e}}();function Xr(t,e,n){return 0===n?[e]:(t.push(e),t)}function Wr(){return Ne(Xr,[])}function jr(t){return function(e){return e.lift(new Zr(t))}}var Zr=function(){function t(t){this.windowBoundaries=t}return t.prototype.call=function(t,e){var n=new Qr(t),r=e.subscribe(n);return r.closed||n.add(Object(o.a)(n,this.windowBoundaries)),r},t}(),Qr=function(t){function e(e){var n=t.call(this,e)||this;return n.window=new on.a,e.next(n.window),n}return r.a(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.openWindow()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){this._complete()},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t)},e.prototype._complete=function(){this.window.complete(),this.destination.complete()},e.prototype._unsubscribe=function(){this.window=null},e.prototype.openWindow=function(){var t=this.window;t&&t.complete();var e=this.destination,n=this.window=new on.a;e.next(n)},e}(i.a);function Yr(t,e){return void 0===e&&(e=0),function(n){return n.lift(new Jr(t,e))}}var Jr=function(){function t(t,e){this.windowSize=t,this.startWindowEvery=e}return t.prototype.call=function(t,e){return e.subscribe(new qr(t,this.windowSize,this.startWindowEvery))},t}(),qr=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.destination=e,i.windowSize=n,i.startWindowEvery=r,i.windows=[new on.a],i.count=0,e.next(i.windows[0]),i}return r.a(e,t),e.prototype._next=function(t){for(var e=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,n=this.destination,r=this.windowSize,i=this.windows,o=i.length,a=0;a<o&&!this.closed;a++)i[a].next(t);var s=this.count-r+1;if(s>=0&&s%e===0&&!this.closed&&i.shift().complete(),++this.count%e===0&&!this.closed){var u=new on.a;i.push(u),n.next(u)}},e.prototype._error=function(t){var e=this.windows;if(e)for(;e.length>0&&!this.closed;)e.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){var t=this.windows;if(t)for(;t.length>0&&!this.closed;)t.shift().complete();this.destination.complete()},e.prototype._unsubscribe=function(){this.count=0,this.windows=null},e}(m.a);function Kr(t){var e=c.a,n=null,r=Number.POSITIVE_INFINITY;return Object(x.a)(arguments[3])&&(e=arguments[3]),Object(x.a)(arguments[2])?e=arguments[2]:Object(or.a)(arguments[2])&&(r=arguments[2]),Object(x.a)(arguments[1])?e=arguments[1]:Object(or.a)(arguments[1])&&(n=arguments[1]),function(i){return i.lift(new $r(t,n,r,e))}}var $r=function(){function t(t,e,n,r){this.windowTimeSpan=t,this.windowCreationInterval=e,this.maxWindowSize=n,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new ei(t,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},t}(),ti=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._numberOfNextedValues=0,e}return r.a(e,t),e.prototype.next=function(e){this._numberOfNextedValues++,t.prototype.next.call(this,e)},Object.defineProperty(e.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),e}(on.a),ei=function(t){function e(e,n,r,i,o){var a=t.call(this,e)||this;a.destination=e,a.windowTimeSpan=n,a.windowCreationInterval=r,a.maxWindowSize=i,a.scheduler=o,a.windows=[];var s=a.openWindow();if(null!==r&&r>=0){var u={subscriber:a,window:s,context:null},c={windowTimeSpan:n,windowCreationInterval:r,subscriber:a,scheduler:o};a.add(o.schedule(ii,n,u)),a.add(o.schedule(ri,r,c))}else{var l={subscriber:a,window:s,windowTimeSpan:n};a.add(o.schedule(ni,n,l))}return a}return r.a(e,t),e.prototype._next=function(t){for(var e=this.windows,n=e.length,r=0;r<n;r++){var i=e[r];i.closed||(i.next(t),i.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(i))}},e.prototype._error=function(t){for(var e=this.windows;e.length>0;)e.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){for(var t=this.windows;t.length>0;){var e=t.shift();e.closed||e.complete()}this.destination.complete()},e.prototype.openWindow=function(){var t=new ti;return this.windows.push(t),this.destination.next(t),t},e.prototype.closeWindow=function(t){t.complete();var e=this.windows;e.splice(e.indexOf(t),1)},e}(m.a);function ni(t){var e=t.subscriber,n=t.windowTimeSpan,r=t.window;r&&e.closeWindow(r),t.window=e.openWindow(),this.schedule(t,n)}function ri(t){var e=t.windowTimeSpan,n=t.subscriber,r=t.scheduler,i=t.windowCreationInterval,o=n.openWindow(),a={action:this,subscription:null},s={subscriber:n,window:o,context:a};a.subscription=r.schedule(ii,e,s),this.add(a.subscription),this.schedule(t,i)}function ii(t){var e=t.subscriber,n=t.window,r=t.context;r&&r.action&&r.subscription&&r.action.remove(r.subscription),e.closeWindow(n)}function oi(t,e){return function(n){return n.lift(new ai(t,e))}}var ai=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new si(t,this.openings,this.closingSelector))},t}(),si=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.openings=n,i.closingSelector=r,i.contexts=[],i.add(i.openSubscription=Object(o.a)(i,n,n)),i}return r.a(e,t),e.prototype._next=function(t){var e=this.contexts;if(e)for(var n=e.length,r=0;r<n;r++)e[r].window.next(t)},e.prototype._error=function(e){var n=this.contexts;if(this.contexts=null,n)for(var r=n.length,i=-1;++i<r;){var o=n[i];o.window.error(e),o.subscription.unsubscribe()}t.prototype._error.call(this,e)},e.prototype._complete=function(){var e=this.contexts;if(this.contexts=null,e)for(var n=e.length,r=-1;++r<n;){var i=e[r];i.window.complete(),i.subscription.unsubscribe()}t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.contexts;if(this.contexts=null,t)for(var e=t.length,n=-1;++n<e;){var r=t[n];r.window.unsubscribe(),r.subscription.unsubscribe()}},e.prototype.notifyNext=function(t,e,n,r,i){if(t===this.openings){var a=void 0;try{a=(0,this.closingSelector)(e)}catch(d){return this.error(d)}var s=new on.a,u=new I.a,c={window:s,subscription:u};this.contexts.push(c);var l=Object(o.a)(this,a,c);l.closed?this.closeWindow(this.contexts.length-1):(l.context=c,u.add(l)),this.destination.next(s)}else this.closeWindow(this.contexts.indexOf(t))},e.prototype.notifyError=function(t){this.error(t)},e.prototype.notifyComplete=function(t){t!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(t.context))},e.prototype.closeWindow=function(t){if(-1!==t){var e=this.contexts,n=e[t],r=n.window,i=n.subscription;e.splice(t,1),r.complete(),i.unsubscribe()}},e}(i.a);function ui(t){return function(e){return e.lift(new ci(t))}}var ci=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new li(t,this.closingSelector))},t}(),li=function(t){function e(e,n){var r=t.call(this,e)||this;return r.destination=e,r.closingSelector=n,r.openWindow(),r}return r.a(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.openWindow(i)},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){this.openWindow(t)},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t),this.unsubscribeClosingNotification()},e.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},e.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},e.prototype.openWindow=function(t){void 0===t&&(t=null),t&&(this.remove(t),t.unsubscribe());var e=this.window;e&&e.complete();var n,r=this.window=new on.a;this.destination.next(r);try{n=(0,this.closingSelector)()}catch(i){return this.destination.error(i),void this.window.error(i)}this.add(this.closingNotification=Object(o.a)(this,n))},e}(i.a);function di(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var n;"function"===typeof t[t.length-1]&&(n=t.pop());var r=t;return e.lift(new fi(r,n))}}var fi=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new hi(t,this.observables,this.project))},t}(),hi=function(t){function e(e,n,r){var i=t.call(this,e)||this;i.observables=n,i.project=r,i.toRespond=[];var a=n.length;i.values=new Array(a);for(var s=0;s<a;s++)i.toRespond.push(s);for(s=0;s<a;s++){var u=n[s];i.add(Object(o.a)(i,u,u,s))}return i}return r.a(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.values[n]=e;var o=this.toRespond;if(o.length>0){var a=o.indexOf(n);-1!==a&&o.splice(a,1)}},e.prototype.notifyComplete=function(){},e.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)},e}(i.a),pi=n(49);function mi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(pi.b.apply(void 0,[e].concat(t)))}}function vi(t){return function(e){return e.lift(new pi.a(t))}}},function(t,e,n){"use strict";n.r(e),n.d(e,"Observable",(function(){return r.a})),n.d(e,"ConnectableObservable",(function(){return i.a})),n.d(e,"GroupedObservable",(function(){return o.a})),n.d(e,"observable",(function(){return a.a})),n.d(e,"Subject",(function(){return s.a})),n.d(e,"BehaviorSubject",(function(){return u.a})),n.d(e,"ReplaySubject",(function(){return c.a})),n.d(e,"AsyncSubject",(function(){return l.a})),n.d(e,"asapScheduler",(function(){return d.a})),n.d(e,"asyncScheduler",(function(){return f.a})),n.d(e,"queueScheduler",(function(){return h.a})),n.d(e,"animationFrameScheduler",(function(){return y})),n.d(e,"VirtualTimeScheduler",(function(){return b})),n.d(e,"VirtualAction",(function(){return x})),n.d(e,"Scheduler",(function(){return _.a})),n.d(e,"Subscription",(function(){return w.a})),n.d(e,"Subscriber",(function(){return T.a})),n.d(e,"Notification",(function(){return S.a})),n.d(e,"NotificationKind",(function(){return S.b})),n.d(e,"pipe",(function(){return M.a})),n.d(e,"noop",(function(){return E.a})),n.d(e,"identity",(function(){return R.a})),n.d(e,"isObservable",(function(){return I})),n.d(e,"ArgumentOutOfRangeError",(function(){return B.a})),n.d(e,"EmptyError",(function(){return A.a})),n.d(e,"ObjectUnsubscribedError",(function(){return C.a})),n.d(e,"UnsubscriptionError",(function(){return F.a})),n.d(e,"TimeoutError",(function(){return P.a})),n.d(e,"bindCallback",(function(){return G})),n.d(e,"bindNodeCallback",(function(){return H})),n.d(e,"combineLatest",(function(){return W.b})),n.d(e,"concat",(function(){return j.a})),n.d(e,"defer",(function(){return Z.a})),n.d(e,"empty",(function(){return Q.b})),n.d(e,"forkJoin",(function(){return q})),n.d(e,"from",(function(){return J.a})),n.d(e,"fromEvent",(function(){return tt})),n.d(e,"fromEventPattern",(function(){return et})),n.d(e,"generate",(function(){return nt})),n.d(e,"iif",(function(){return it})),n.d(e,"interval",(function(){return at})),n.d(e,"merge",(function(){return ut.a})),n.d(e,"never",(function(){return lt})),n.d(e,"of",(function(){return dt.a})),n.d(e,"onErrorResumeNext",(function(){return ft})),n.d(e,"pairs",(function(){return ht})),n.d(e,"partition",(function(){return yt})),n.d(e,"race",(function(){return bt.a})),n.d(e,"range",(function(){return xt})),n.d(e,"throwError",(function(){return wt.a})),n.d(e,"timer",(function(){return Tt.a})),n.d(e,"using",(function(){return St})),n.d(e,"zip",(function(){return Mt.b})),n.d(e,"scheduled",(function(){return Et.a})),n.d(e,"EMPTY",(function(){return Q.a})),n.d(e,"NEVER",(function(){return ct})),n.d(e,"config",(function(){return Rt.a}));var r=n(2),i=n(64),o=n(60),a=n(23),s=n(7),u=n(66),c=n(47),l=n(31),d=n(54),f=n(9),h=n(70),p=n(0),m=n(32),v=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return p.a(e,t),e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0?t.prototype.requestAsyncId.call(this,e,n,r):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame((function(){return e.flush(null)}))))},e.prototype.recycleAsyncId=function(e,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,r);0===e.actions.length&&(cancelAnimationFrame(n),e.scheduled=void 0)},e}(m.a),g=n(29),y=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p.a(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,r=-1,i=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++r<i&&(t=n.shift()));if(this.active=!1,e){for(;++r<i&&(t=n.shift());)t.unsubscribe();throw e}},e}(g.a))(v),b=function(t){function e(e,n){void 0===e&&(e=x),void 0===n&&(n=Number.POSITIVE_INFINITY);var r=t.call(this,e,(function(){return r.frame}))||this;return r.maxFrames=n,r.frame=0,r.index=-1,r}return p.a(e,t),e.prototype.flush=function(){for(var t,e,n=this.actions,r=this.maxFrames;(e=n[0])&&e.delay<=r&&(n.shift(),this.frame=e.delay,!(t=e.execute(e.state,e.delay))););if(t){for(;e=n.shift();)e.unsubscribe();throw t}},e.frameTimeFactor=10,e}(g.a),x=function(t){function e(e,n,r){void 0===r&&(r=e.index+=1);var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i.index=r,i.active=!0,i.index=e.index=r,i}return p.a(e,t),e.prototype.schedule=function(n,r){if(void 0===r&&(r=0),!this.id)return t.prototype.schedule.call(this,n,r);this.active=!1;var i=new e(this.scheduler,this.work);return this.add(i),i.schedule(n,r)},e.prototype.requestAsyncId=function(t,n,r){void 0===r&&(r=0),this.delay=t.frame+r;var i=t.actions;return i.push(this),i.sort(e.sortActions),!0},e.prototype.recycleAsyncId=function(t,e,n){void 0===n&&(n=0)},e.prototype._execute=function(e,n){if(!0===this.active)return t.prototype._execute.call(this,e,n)},e.sortActions=function(t,e){return t.delay===e.delay?t.index===e.index?0:t.index>e.index?1:-1:t.delay>e.delay?1:-1},e}(m.a),_=n(58),w=n(5),T=n(1),S=n(20),M=n(39),E=n(22),R=n(18);function I(t){return!!t&&(t instanceof r.a||"function"===typeof t.lift&&"function"===typeof t.subscribe)}var B=n(26),A=n(28),C=n(24),F=n(41),P=n(68),N=n(10),O=n(52),U=n(8),L=n(11);function G(t,e,n){if(e){if(!Object(L.a)(e))return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return G(t,n).apply(void 0,r).pipe(Object(N.a)((function(t){return Object(U.a)(t)?e.apply(void 0,t):e(t)})))};n=e}return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var o,a=this,s={context:a,subject:o,callbackFunc:t,scheduler:n};return new r.a((function(r){if(n){var i={args:e,subscriber:r,params:s};return n.schedule(D,0,i)}if(!o){o=new l.a;try{t.apply(a,e.concat([function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];o.next(t.length<=1?t[0]:t),o.complete()}]))}catch(u){Object(O.a)(o)?o.error(u):console.warn(u)}}return o.subscribe(r)}))}}function D(t){var e=this,n=t.args,r=t.subscriber,i=t.params,o=i.callbackFunc,a=i.context,s=i.scheduler,u=i.subject;if(!u){u=i.subject=new l.a;try{o.apply(a,n.concat([function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.length<=1?t[0]:t;e.add(s.schedule(V,0,{value:r,subject:u}))}]))}catch(c){u.error(c)}}this.add(u.subscribe(r))}function V(t){var e=t.value,n=t.subject;n.next(e),n.complete()}function H(t,e,n){if(e){if(!Object(L.a)(e))return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return H(t,n).apply(void 0,r).pipe(Object(N.a)((function(t){return Object(U.a)(t)?e.apply(void 0,t):e(t)})))};n=e}return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var o={subject:void 0,args:e,callbackFunc:t,scheduler:n,context:this};return new r.a((function(r){var i=o.context,a=o.subject;if(n)return n.schedule(k,0,{params:o,subscriber:r,context:i});if(!a){a=o.subject=new l.a;try{t.apply(i,e.concat([function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.shift();n?a.error(n):(a.next(t.length<=1?t[0]:t),a.complete())}]))}catch(s){Object(O.a)(a)?a.error(s):console.warn(s)}}return a.subscribe(r)}))}}function k(t){var e=this,n=t.params,r=t.subscriber,i=t.context,o=n.callbackFunc,a=n.args,s=n.scheduler,u=n.subject;if(!u){u=n.subject=new l.a;try{o.apply(i,a.concat([function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.shift();if(r)e.add(s.schedule(X,0,{err:r,subject:u}));else{var i=t.length<=1?t[0]:t;e.add(s.schedule(z,0,{value:i,subject:u}))}}]))}catch(c){this.add(s.schedule(X,0,{err:c,subject:u}))}}this.add(u.subscribe(r))}function z(t){var e=t.value,n=t.subject;n.next(e),n.complete()}function X(t){var e=t.err;t.subject.error(e)}var W=n(43),j=n(34),Z=n(48),Q=n(12),Y=n(51),J=n(13);function q(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length){var n=t[0];if(Object(U.a)(n))return K(n,null);if(Object(Y.a)(n)&&Object.getPrototypeOf(n)===Object.prototype){var r=Object.keys(n);return K(r.map((function(t){return n[t]})),r)}}if("function"===typeof t[t.length-1]){var i=t.pop();return K(t=1===t.length&&Object(U.a)(t[0])?t[0]:t,null).pipe(Object(N.a)((function(t){return i.apply(void 0,t)})))}return K(t,null)}function K(t,e){return new r.a((function(n){var r=t.length;if(0!==r)for(var i=new Array(r),o=0,a=0,s=function(s){var u=Object(J.a)(t[s]),c=!1;n.add(u.subscribe({next:function(t){c||(c=!0,a++),i[s]=t},error:function(t){return n.error(t)},complete:function(){++o!==r&&c||(a===r&&n.next(e?e.reduce((function(t,e,n){return t[e]=i[n],t}),{}):i),n.complete())}}))},u=0;u<r;u++)s(u);else n.complete()}))}var $=n(27);function tt(t,e,n,i){return Object($.a)(n)&&(i=n,n=void 0),i?tt(t,e,n).pipe(Object(N.a)((function(t){return Object(U.a)(t)?i.apply(void 0,t):i(t)}))):new r.a((function(r){!function t(e,n,r,i,o){var a;if(function(t){return t&&"function"===typeof t.addEventListener&&"function"===typeof t.removeEventListener}(e)){var s=e;e.addEventListener(n,r,o),a=function(){return s.removeEventListener(n,r,o)}}else if(function(t){return t&&"function"===typeof t.on&&"function"===typeof t.off}(e)){var u=e;e.on(n,r),a=function(){return u.off(n,r)}}else if(function(t){return t&&"function"===typeof t.addListener&&"function"===typeof t.removeListener}(e)){var c=e;e.addListener(n,r),a=function(){return c.removeListener(n,r)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var l=0,d=e.length;l<d;l++)t(e[l],n,r,i,o)}i.add(a)}(t,e,(function(t){arguments.length>1?r.next(Array.prototype.slice.call(arguments)):r.next(t)}),r,n)}))}function et(t,e,n){return n?et(t,e).pipe(Object(N.a)((function(t){return Object(U.a)(t)?n.apply(void 0,t):n(t)}))):new r.a((function(n){var r,i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.next(1===t.length?t[0]:t)};try{r=t(i)}catch(o){return void n.error(o)}if(Object($.a)(e))return function(){return e(i,r)}}))}function nt(t,e,n,i,o){var a,s;if(1==arguments.length){var u=t;s=u.initialState,e=u.condition,n=u.iterate,a=u.resultSelector||R.a,o=u.scheduler}else void 0===i||Object(L.a)(i)?(s=t,a=R.a,o=i):(s=t,a=i);return new r.a((function(t){var r=s;if(o)return o.schedule(rt,0,{subscriber:t,iterate:n,condition:e,resultSelector:a,state:r});for(;;){if(e){var i=void 0;try{i=e(r)}catch(c){return void t.error(c)}if(!i){t.complete();break}}var u=void 0;try{u=a(r)}catch(c){return void t.error(c)}if(t.next(u),t.closed)break;try{r=n(r)}catch(c){return void t.error(c)}}}))}function rt(t){var e=t.subscriber,n=t.condition;if(!e.closed){if(t.needIterate)try{t.state=t.iterate(t.state)}catch(o){return void e.error(o)}else t.needIterate=!0;if(n){var r=void 0;try{r=n(t.state)}catch(o){return void e.error(o)}if(!r)return void e.complete();if(e.closed)return}var i;try{i=t.resultSelector(t.state)}catch(o){return void e.error(o)}if(!e.closed&&(e.next(i),!e.closed))return this.schedule(t)}}function it(t,e,n){return void 0===e&&(e=Q.a),void 0===n&&(n=Q.a),Object(Z.a)((function(){return t()?e:n}))}var ot=n(33);function at(t,e){return void 0===t&&(t=0),void 0===e&&(e=f.a),(!Object(ot.a)(t)||t<0)&&(t=0),e&&"function"===typeof e.schedule||(e=f.a),new r.a((function(n){return n.add(e.schedule(st,t,{subscriber:n,counter:0,period:t})),n}))}function st(t){var e=t.subscriber,n=t.counter,r=t.period;e.next(n),this.schedule({subscriber:e,counter:n+1,period:r},r)}var ut=n(63),ct=new r.a(E.a);function lt(){return ct}var dt=n(38);function ft(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===t.length)return Q.a;var n=t[0],i=t.slice(1);return 1===t.length&&Object(U.a)(n)?ft.apply(void 0,n):new r.a((function(t){var e=function(){return t.add(ft.apply(void 0,i).subscribe(t))};return Object(J.a)(n).subscribe({next:function(e){t.next(e)},error:e,complete:e})}))}function ht(t,e){return e?new r.a((function(n){var r=Object.keys(t),i=new w.a;return i.add(e.schedule(pt,0,{keys:r,index:0,subscriber:n,subscription:i,obj:t})),i})):new r.a((function(e){for(var n=Object.keys(t),r=0;r<n.length&&!e.closed;r++){var i=n[r];t.hasOwnProperty(i)&&e.next([i,t[i]])}e.complete()}))}function pt(t){var e=t.keys,n=t.index,r=t.subscriber,i=t.subscription,o=t.obj;if(!r.closed)if(n<e.length){var a=e[n];r.next([a,o[a]]),i.add(this.schedule({keys:e,index:n+1,subscriber:r,subscription:i,obj:o}))}else r.complete()}var mt=n(77),vt=n(42),gt=n(19);function yt(t,e,n){return[Object(gt.a)(e,n)(new r.a(Object(vt.a)(t))),Object(gt.a)(Object(mt.a)(e,n))(new r.a(Object(vt.a)(t)))]}var bt=n(67);function xt(t,e,n){return void 0===t&&(t=0),new r.a((function(r){void 0===e&&(e=t,t=0);var i=0,o=t;if(n)return n.schedule(_t,0,{index:i,count:e,start:t,subscriber:r});for(;;){if(i++>=e){r.complete();break}if(r.next(o++),r.closed)break}}))}function _t(t){var e=t.start,n=t.index,r=t.count,i=t.subscriber;n>=r?i.complete():(i.next(e),i.closed||(t.index=n+1,t.start=e+1,this.schedule(t)))}var wt=n(45),Tt=n(61);function St(t,e){return new r.a((function(n){var r,i;try{r=t()}catch(a){return void n.error(a)}try{i=e(r)}catch(a){return void n.error(a)}var o=(i?Object(J.a)(i):Q.a).subscribe(n);return function(){o.unsubscribe(),r&&r.unsubscribe()}}))}var Mt=n(49),Et=n(69),Rt=n(17)},function(t,e,n){"use strict";n.r(e),n.d(e,"glMatrix",(function(){return r})),n.d(e,"mat2",(function(){return i})),n.d(e,"mat2d",(function(){return o})),n.d(e,"mat3",(function(){return a})),n.d(e,"mat4",(function(){return s})),n.d(e,"quat",(function(){return l})),n.d(e,"quat2",(function(){return d})),n.d(e,"vec2",(function(){return f})),n.d(e,"vec3",(function(){return u})),n.d(e,"vec4",(function(){return c}));var r={};n.r(r),n.d(r,"EPSILON",(function(){return h})),n.d(r,"ARRAY_TYPE",(function(){return p})),n.d(r,"RANDOM",(function(){return m})),n.d(r,"setMatrixArrayType",(function(){return v})),n.d(r,"toRadian",(function(){return y})),n.d(r,"equals",(function(){return b}));var i={};n.r(i),n.d(i,"create",(function(){return x})),n.d(i,"clone",(function(){return _})),n.d(i,"copy",(function(){return w})),n.d(i,"identity",(function(){return T})),n.d(i,"fromValues",(function(){return S})),n.d(i,"set",(function(){return M})),n.d(i,"transpose",(function(){return E})),n.d(i,"invert",(function(){return R})),n.d(i,"adjoint",(function(){return I})),n.d(i,"determinant",(function(){return B})),n.d(i,"multiply",(function(){return A})),n.d(i,"rotate",(function(){return C})),n.d(i,"scale",(function(){return F})),n.d(i,"fromRotation",(function(){return P})),n.d(i,"fromScaling",(function(){return N})),n.d(i,"str",(function(){return O})),n.d(i,"frob",(function(){return U})),n.d(i,"LDU",(function(){return L})),n.d(i,"add",(function(){return G})),n.d(i,"subtract",(function(){return D})),n.d(i,"exactEquals",(function(){return V})),n.d(i,"equals",(function(){return H})),n.d(i,"multiplyScalar",(function(){return k})),n.d(i,"multiplyScalarAndAdd",(function(){return z})),n.d(i,"mul",(function(){return X})),n.d(i,"sub",(function(){return W}));var o={};n.r(o),n.d(o,"create",(function(){return j})),n.d(o,"clone",(function(){return Z})),n.d(o,"copy",(function(){return Q})),n.d(o,"identity",(function(){return Y})),n.d(o,"fromValues",(function(){return J})),n.d(o,"set",(function(){return q})),n.d(o,"invert",(function(){return K})),n.d(o,"determinant",(function(){return $})),n.d(o,"multiply",(function(){return tt})),n.d(o,"rotate",(function(){return et})),n.d(o,"scale",(function(){return nt})),n.d(o,"translate",(function(){return rt})),n.d(o,"fromRotation",(function(){return it})),n.d(o,"fromScaling",(function(){return ot})),n.d(o,"fromTranslation",(function(){return at})),n.d(o,"str",(function(){return st})),n.d(o,"frob",(function(){return ut})),n.d(o,"add",(function(){return ct})),n.d(o,"subtract",(function(){return lt})),n.d(o,"multiplyScalar",(function(){return dt})),n.d(o,"multiplyScalarAndAdd",(function(){return ft})),n.d(o,"exactEquals",(function(){return ht})),n.d(o,"equals",(function(){return pt})),n.d(o,"mul",(function(){return mt})),n.d(o,"sub",(function(){return vt}));var a={};n.r(a),n.d(a,"create",(function(){return gt})),n.d(a,"fromMat4",(function(){return yt})),n.d(a,"clone",(function(){return bt})),n.d(a,"copy",(function(){return xt})),n.d(a,"fromValues",(function(){return _t})),n.d(a,"set",(function(){return wt})),n.d(a,"identity",(function(){return Tt})),n.d(a,"transpose",(function(){return St})),n.d(a,"invert",(function(){return Mt})),n.d(a,"adjoint",(function(){return Et})),n.d(a,"determinant",(function(){return Rt})),n.d(a,"multiply",(function(){return It})),n.d(a,"translate",(function(){return Bt})),n.d(a,"rotate",(function(){return At})),n.d(a,"scale",(function(){return Ct})),n.d(a,"fromTranslation",(function(){return Ft})),n.d(a,"fromRotation",(function(){return Pt})),n.d(a,"fromScaling",(function(){return Nt})),n.d(a,"fromMat2d",(function(){return Ot})),n.d(a,"fromQuat",(function(){return Ut})),n.d(a,"normalFromMat4",(function(){return Lt})),n.d(a,"projection",(function(){return Gt})),n.d(a,"str",(function(){return Dt})),n.d(a,"frob",(function(){return Vt})),n.d(a,"add",(function(){return Ht})),n.d(a,"subtract",(function(){return kt})),n.d(a,"multiplyScalar",(function(){return zt})),n.d(a,"multiplyScalarAndAdd",(function(){return Xt})),n.d(a,"exactEquals",(function(){return Wt})),n.d(a,"equals",(function(){return jt})),n.d(a,"mul",(function(){return Zt})),n.d(a,"sub",(function(){return Qt}));var s={};n.r(s),n.d(s,"create",(function(){return Yt})),n.d(s,"clone",(function(){return Jt})),n.d(s,"copy",(function(){return qt})),n.d(s,"fromValues",(function(){return Kt})),n.d(s,"set",(function(){return $t})),n.d(s,"identity",(function(){return te})),n.d(s,"transpose",(function(){return ee})),n.d(s,"invert",(function(){return ne})),n.d(s,"adjoint",(function(){return re})),n.d(s,"determinant",(function(){return ie})),n.d(s,"multiply",(function(){return oe})),n.d(s,"translate",(function(){return ae})),n.d(s,"scale",(function(){return se})),n.d(s,"rotate",(function(){return ue})),n.d(s,"rotateX",(function(){return ce})),n.d(s,"rotateY",(function(){return le})),n.d(s,"rotateZ",(function(){return de})),n.d(s,"fromTranslation",(function(){return fe})),n.d(s,"fromScaling",(function(){return he})),n.d(s,"fromRotation",(function(){return pe})),n.d(s,"fromXRotation",(function(){return me})),n.d(s,"fromYRotation",(function(){return ve})),n.d(s,"fromZRotation",(function(){return ge})),n.d(s,"fromRotationTranslation",(function(){return ye})),n.d(s,"fromQuat2",(function(){return be})),n.d(s,"getTranslation",(function(){return xe})),n.d(s,"getScaling",(function(){return _e})),n.d(s,"getRotation",(function(){return we})),n.d(s,"fromRotationTranslationScale",(function(){return Te})),n.d(s,"fromRotationTranslationScaleOrigin",(function(){return Se})),n.d(s,"fromQuat",(function(){return Me})),n.d(s,"frustum",(function(){return Ee})),n.d(s,"perspective",(function(){return Re})),n.d(s,"perspectiveFromFieldOfView",(function(){return Ie})),n.d(s,"ortho",(function(){return Be})),n.d(s,"lookAt",(function(){return Ae})),n.d(s,"targetTo",(function(){return Ce})),n.d(s,"str",(function(){return Fe})),n.d(s,"frob",(function(){return Pe})),n.d(s,"add",(function(){return Ne})),n.d(s,"subtract",(function(){return Oe})),n.d(s,"multiplyScalar",(function(){return Ue})),n.d(s,"multiplyScalarAndAdd",(function(){return Le})),n.d(s,"exactEquals",(function(){return Ge})),n.d(s,"equals",(function(){return De})),n.d(s,"mul",(function(){return Ve})),n.d(s,"sub",(function(){return He}));var u={};n.r(u),n.d(u,"create",(function(){return ke})),n.d(u,"clone",(function(){return ze})),n.d(u,"length",(function(){return Xe})),n.d(u,"fromValues",(function(){return We})),n.d(u,"copy",(function(){return je})),n.d(u,"set",(function(){return Ze})),n.d(u,"add",(function(){return Qe})),n.d(u,"subtract",(function(){return Ye})),n.d(u,"multiply",(function(){return Je})),n.d(u,"divide",(function(){return qe})),n.d(u,"ceil",(function(){return Ke})),n.d(u,"floor",(function(){return $e})),n.d(u,"min",(function(){return tn})),n.d(u,"max",(function(){return en})),n.d(u,"round",(function(){return nn})),n.d(u,"scale",(function(){return rn})),n.d(u,"scaleAndAdd",(function(){return on})),n.d(u,"distance",(function(){return an})),n.d(u,"squaredDistance",(function(){return sn})),n.d(u,"squaredLength",(function(){return un})),n.d(u,"negate",(function(){return cn})),n.d(u,"inverse",(function(){return ln})),n.d(u,"normalize",(function(){return dn})),n.d(u,"dot",(function(){return fn})),n.d(u,"cross",(function(){return hn})),n.d(u,"lerp",(function(){return pn})),n.d(u,"hermite",(function(){return mn})),n.d(u,"bezier",(function(){return vn})),n.d(u,"random",(function(){return gn})),n.d(u,"transformMat4",(function(){return yn})),n.d(u,"transformMat3",(function(){return bn})),n.d(u,"transformQuat",(function(){return xn})),n.d(u,"rotateX",(function(){return _n})),n.d(u,"rotateY",(function(){return wn})),n.d(u,"rotateZ",(function(){return Tn})),n.d(u,"angle",(function(){return Sn})),n.d(u,"zero",(function(){return Mn})),n.d(u,"str",(function(){return En})),n.d(u,"exactEquals",(function(){return Rn})),n.d(u,"equals",(function(){return In})),n.d(u,"sub",(function(){return Bn})),n.d(u,"mul",(function(){return An})),n.d(u,"div",(function(){return Cn})),n.d(u,"dist",(function(){return Fn})),n.d(u,"sqrDist",(function(){return Pn})),n.d(u,"len",(function(){return Nn})),n.d(u,"sqrLen",(function(){return On})),n.d(u,"forEach",(function(){return Un}));var c={};n.r(c),n.d(c,"create",(function(){return Ln})),n.d(c,"clone",(function(){return Gn})),n.d(c,"fromValues",(function(){return Dn})),n.d(c,"copy",(function(){return Vn})),n.d(c,"set",(function(){return Hn})),n.d(c,"add",(function(){return kn})),n.d(c,"subtract",(function(){return zn})),n.d(c,"multiply",(function(){return Xn})),n.d(c,"divide",(function(){return Wn})),n.d(c,"ceil",(function(){return jn})),n.d(c,"floor",(function(){return Zn})),n.d(c,"min",(function(){return Qn})),n.d(c,"max",(function(){return Yn})),n.d(c,"round",(function(){return Jn})),n.d(c,"scale",(function(){return qn})),n.d(c,"scaleAndAdd",(function(){return Kn})),n.d(c,"distance",(function(){return $n})),n.d(c,"squaredDistance",(function(){return tr})),n.d(c,"length",(function(){return er})),n.d(c,"squaredLength",(function(){return nr})),n.d(c,"negate",(function(){return rr})),n.d(c,"inverse",(function(){return ir})),n.d(c,"normalize",(function(){return or})),n.d(c,"dot",(function(){return ar})),n.d(c,"cross",(function(){return sr})),n.d(c,"lerp",(function(){return ur})),n.d(c,"random",(function(){return cr})),n.d(c,"transformMat4",(function(){return lr})),n.d(c,"transformQuat",(function(){return dr})),n.d(c,"zero",(function(){return fr})),n.d(c,"str",(function(){return hr})),n.d(c,"exactEquals",(function(){return pr})),n.d(c,"equals",(function(){return mr})),n.d(c,"sub",(function(){return vr})),n.d(c,"mul",(function(){return gr})),n.d(c,"div",(function(){return yr})),n.d(c,"dist",(function(){return br})),n.d(c,"sqrDist",(function(){return xr})),n.d(c,"len",(function(){return _r})),n.d(c,"sqrLen",(function(){return wr})),n.d(c,"forEach",(function(){return Tr}));var l={};n.r(l),n.d(l,"create",(function(){return Sr})),n.d(l,"identity",(function(){return Mr})),n.d(l,"setAxisAngle",(function(){return Er})),n.d(l,"getAxisAngle",(function(){return Rr})),n.d(l,"getAngle",(function(){return Ir})),n.d(l,"multiply",(function(){return Br})),n.d(l,"rotateX",(function(){return Ar})),n.d(l,"rotateY",(function(){return Cr})),n.d(l,"rotateZ",(function(){return Fr})),n.d(l,"calculateW",(function(){return Pr})),n.d(l,"exp",(function(){return Nr})),n.d(l,"ln",(function(){return Or})),n.d(l,"pow",(function(){return Ur})),n.d(l,"slerp",(function(){return Lr})),n.d(l,"random",(function(){return Gr})),n.d(l,"invert",(function(){return Dr})),n.d(l,"conjugate",(function(){return Vr})),n.d(l,"fromMat3",(function(){return Hr})),n.d(l,"fromEuler",(function(){return kr})),n.d(l,"str",(function(){return zr})),n.d(l,"clone",(function(){return Xr})),n.d(l,"fromValues",(function(){return Wr})),n.d(l,"copy",(function(){return jr})),n.d(l,"set",(function(){return Zr})),n.d(l,"add",(function(){return Qr})),n.d(l,"mul",(function(){return Yr})),n.d(l,"scale",(function(){return Jr})),n.d(l,"dot",(function(){return qr})),n.d(l,"lerp",(function(){return Kr})),n.d(l,"length",(function(){return $r})),n.d(l,"len",(function(){return ti})),n.d(l,"squaredLength",(function(){return ei})),n.d(l,"sqrLen",(function(){return ni})),n.d(l,"normalize",(function(){return ri})),n.d(l,"exactEquals",(function(){return ii})),n.d(l,"equals",(function(){return oi})),n.d(l,"rotationTo",(function(){return ai})),n.d(l,"sqlerp",(function(){return si})),n.d(l,"setAxes",(function(){return ui}));var d={};n.r(d),n.d(d,"create",(function(){return ci})),n.d(d,"clone",(function(){return li})),n.d(d,"fromValues",(function(){return di})),n.d(d,"fromRotationTranslationValues",(function(){return fi})),n.d(d,"fromRotationTranslation",(function(){return hi})),n.d(d,"fromTranslation",(function(){return pi})),n.d(d,"fromRotation",(function(){return mi})),n.d(d,"fromMat4",(function(){return vi})),n.d(d,"copy",(function(){return gi})),n.d(d,"identity",(function(){return yi})),n.d(d,"set",(function(){return bi})),n.d(d,"getReal",(function(){return xi})),n.d(d,"getDual",(function(){return _i})),n.d(d,"setReal",(function(){return wi})),n.d(d,"setDual",(function(){return Ti})),n.d(d,"getTranslation",(function(){return Si})),n.d(d,"translate",(function(){return Mi})),n.d(d,"rotateX",(function(){return Ei})),n.d(d,"rotateY",(function(){return Ri})),n.d(d,"rotateZ",(function(){return Ii})),n.d(d,"rotateByQuatAppend",(function(){return Bi})),n.d(d,"rotateByQuatPrepend",(function(){return Ai})),n.d(d,"rotateAroundAxis",(function(){return Ci})),n.d(d,"add",(function(){return Fi})),n.d(d,"multiply",(function(){return Pi})),n.d(d,"mul",(function(){return Ni})),n.d(d,"scale",(function(){return Oi})),n.d(d,"dot",(function(){return Ui})),n.d(d,"lerp",(function(){return Li})),n.d(d,"invert",(function(){return Gi})),n.d(d,"conjugate",(function(){return Di})),n.d(d,"length",(function(){return Vi})),n.d(d,"len",(function(){return Hi})),n.d(d,"squaredLength",(function(){return ki})),n.d(d,"sqrLen",(function(){return zi})),n.d(d,"normalize",(function(){return Xi})),n.d(d,"str",(function(){return Wi})),n.d(d,"exactEquals",(function(){return ji})),n.d(d,"equals",(function(){return Zi}));var f={};n.r(f),n.d(f,"create",(function(){return Qi})),n.d(f,"clone",(function(){return Yi})),n.d(f,"fromValues",(function(){return Ji})),n.d(f,"copy",(function(){return qi})),n.d(f,"set",(function(){return Ki})),n.d(f,"add",(function(){return $i})),n.d(f,"subtract",(function(){return to})),n.d(f,"multiply",(function(){return eo})),n.d(f,"divide",(function(){return no})),n.d(f,"ceil",(function(){return ro})),n.d(f,"floor",(function(){return io})),n.d(f,"min",(function(){return oo})),n.d(f,"max",(function(){return ao})),n.d(f,"round",(function(){return so})),n.d(f,"scale",(function(){return uo})),n.d(f,"scaleAndAdd",(function(){return co})),n.d(f,"distance",(function(){return lo})),n.d(f,"squaredDistance",(function(){return fo})),n.d(f,"length",(function(){return ho})),n.d(f,"squaredLength",(function(){return po})),n.d(f,"negate",(function(){return mo})),n.d(f,"inverse",(function(){return vo})),n.d(f,"normalize",(function(){return go})),n.d(f,"dot",(function(){return yo})),n.d(f,"cross",(function(){return bo})),n.d(f,"lerp",(function(){return xo})),n.d(f,"random",(function(){return _o})),n.d(f,"transformMat2",(function(){return wo})),n.d(f,"transformMat2d",(function(){return To})),n.d(f,"transformMat3",(function(){return So})),n.d(f,"transformMat4",(function(){return Mo})),n.d(f,"rotate",(function(){return Eo})),n.d(f,"angle",(function(){return Ro})),n.d(f,"zero",(function(){return Io})),n.d(f,"str",(function(){return Bo})),n.d(f,"exactEquals",(function(){return Ao})),n.d(f,"equals",(function(){return Co})),n.d(f,"len",(function(){return Fo})),n.d(f,"sub",(function(){return Po})),n.d(f,"mul",(function(){return No})),n.d(f,"div",(function(){return Oo})),n.d(f,"dist",(function(){return Uo})),n.d(f,"sqrDist",(function(){return Lo})),n.d(f,"sqrLen",(function(){return Go})),n.d(f,"forEach",(function(){return Do}));var h=1e-6,p="undefined"!==typeof Float32Array?Float32Array:Array,m=Math.random;function v(t){p=t}var g=Math.PI/180;function y(t){return t*g}function b(t,e){return Math.abs(t-e)<=h*Math.max(1,Math.abs(t),Math.abs(e))}function x(){var t=new p(4);return p!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function _(t){var e=new p(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function w(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function T(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function S(t,e,n,r){var i=new p(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function M(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function E(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function R(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*o-i*r;return a?(a=1/a,t[0]=o*a,t[1]=-r*a,t[2]=-i*a,t[3]=n*a,t):null}function I(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t}function B(t){return t[0]*t[3]-t[2]*t[1]}function A(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*s+o*u,t[1]=i*s+a*u,t[2]=r*c+o*l,t[3]=i*c+a*l,t}function C(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*-s+o*u,t[3]=i*-s+a*u,t}function F(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1];return t[0]=r*s,t[1]=i*s,t[2]=o*u,t[3]=a*u,t}function P(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t}function N(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function O(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function U(t){return Math.hypot(t[0],t[1],t[2],t[3])}function L(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]}function G(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function D(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function V(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function H(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=h*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=h*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=h*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=h*Math.max(1,Math.abs(o),Math.abs(c))}function k(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function z(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var X=A,W=D;function j(){var t=new p(6);return p!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function Z(t){var e=new p(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Q(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Y(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function J(t,e,n,r,i,o){var a=new p(6);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a[4]=i,a[5]=o,a}function q(t,e,n,r,i,o,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t}function K(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=n*o-r*i;return u?(u=1/u,t[0]=o*u,t[1]=-r*u,t[2]=-i*u,t[3]=n*u,t[4]=(i*s-o*a)*u,t[5]=(r*a-n*s)*u,t):null}function $(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=n[0],l=n[1],d=n[2],f=n[3],h=n[4],p=n[5];return t[0]=r*c+o*l,t[1]=i*c+a*l,t[2]=r*d+o*f,t[3]=i*d+a*f,t[4]=r*h+o*p+s,t[5]=i*h+a*p+u,t}function et(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=Math.sin(n),l=Math.cos(n);return t[0]=r*l+o*c,t[1]=i*l+a*c,t[2]=r*-c+o*l,t[3]=i*-c+a*l,t[4]=s,t[5]=u,t}function nt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=n[0],l=n[1];return t[0]=r*c,t[1]=i*c,t[2]=o*l,t[3]=a*l,t[4]=s,t[5]=u,t}function rt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=n[0],l=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=r*c+o*l+s,t[5]=i*c+a*l+u,t}function it(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t}function ot(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function at(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function st(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ct(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function lt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function dt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function ft(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t}function ht(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function pt(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=e[0],c=e[1],l=e[2],d=e[3],f=e[4],p=e[5];return Math.abs(n-u)<=h*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-c)<=h*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-l)<=h*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-d)<=h*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-f)<=h*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(s-p)<=h*Math.max(1,Math.abs(s),Math.abs(p))}var mt=tt,vt=lt;function gt(){var t=new p(9);return p!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function yt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function bt(t){var e=new p(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function xt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function _t(t,e,n,r,i,o,a,s,u){var c=new p(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=i,c[5]=o,c[6]=a,c[7]=s,c[8]=u,c}function wt(t,e,n,r,i,o,a,s,u,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t}function Tt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function St(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Mt(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],d=l*a-s*c,f=-l*o+s*u,h=c*o-a*u,p=n*d+r*f+i*h;return p?(p=1/p,t[0]=d*p,t[1]=(-l*r+i*c)*p,t[2]=(s*r-i*a)*p,t[3]=f*p,t[4]=(l*n-i*u)*p,t[5]=(-s*n+i*o)*p,t[6]=h*p,t[7]=(-c*n+r*u)*p,t[8]=(a*n-r*o)*p,t):null}function Et(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8];return t[0]=a*l-s*c,t[1]=i*c-r*l,t[2]=r*s-i*a,t[3]=s*u-o*l,t[4]=n*l-i*u,t[5]=i*o-n*s,t[6]=o*c-a*u,t[7]=r*u-n*c,t[8]=n*a-r*o,t}function Rt(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*(c*o-a*u)+n*(-c*i+a*s)+r*(u*i-o*s)}function It(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=e[8],f=n[0],h=n[1],p=n[2],m=n[3],v=n[4],g=n[5],y=n[6],b=n[7],x=n[8];return t[0]=f*r+h*a+p*c,t[1]=f*i+h*s+p*l,t[2]=f*o+h*u+p*d,t[3]=m*r+v*a+g*c,t[4]=m*i+v*s+g*l,t[5]=m*o+v*u+g*d,t[6]=y*r+b*a+x*c,t[7]=y*i+b*s+x*l,t[8]=y*o+b*u+x*d,t}function Bt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=e[8],f=n[0],h=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=f*r+h*a+c,t[7]=f*i+h*s+l,t[8]=f*o+h*u+d,t}function At(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=e[8],f=Math.sin(n),h=Math.cos(n);return t[0]=h*r+f*a,t[1]=h*i+f*s,t[2]=h*o+f*u,t[3]=h*a-f*r,t[4]=h*s-f*i,t[5]=h*u-f*o,t[6]=c,t[7]=l,t[8]=d,t}function Ct(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Ft(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Pt(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Nt(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Ot(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Ut(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,d=r*s,f=i*a,h=i*s,p=i*u,m=o*a,v=o*s,g=o*u;return t[0]=1-d-p,t[3]=l-g,t[6]=f+v,t[1]=l+g,t[4]=1-c-p,t[7]=h-m,t[2]=f-v,t[5]=h+m,t[8]=1-c-d,t}function Lt(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],d=e[9],f=e[10],h=e[11],p=e[12],m=e[13],v=e[14],g=e[15],y=n*s-r*a,b=n*u-i*a,x=n*c-o*a,_=r*u-i*s,w=r*c-o*s,T=i*c-o*u,S=l*m-d*p,M=l*v-f*p,E=l*g-h*p,R=d*v-f*m,I=d*g-h*m,B=f*g-h*v,A=y*B-b*I+x*R+_*E-w*M+T*S;return A?(A=1/A,t[0]=(s*B-u*I+c*R)*A,t[1]=(u*E-a*B-c*M)*A,t[2]=(a*I-s*E+c*S)*A,t[3]=(i*I-r*B-o*R)*A,t[4]=(n*B-i*E+o*M)*A,t[5]=(r*E-n*I-o*S)*A,t[6]=(m*T-v*w+g*_)*A,t[7]=(v*x-p*T-g*b)*A,t[8]=(p*w-m*x+g*y)*A,t):null}function Gt(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Dt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Vt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Ht(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function kt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function zt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function Xt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function Wt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function jt(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],d=e[0],f=e[1],p=e[2],m=e[3],v=e[4],g=e[5],y=e[6],b=e[7],x=e[8];return Math.abs(n-d)<=h*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(r-f)<=h*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-p)<=h*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-m)<=h*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-v)<=h*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-g)<=h*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(u-y)<=h*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(c-b)<=h*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(l-x)<=h*Math.max(1,Math.abs(l),Math.abs(x))}var Zt=It,Qt=kt;function Yt(){var t=new p(16);return p!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Jt(t){var e=new p(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function qt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Kt(t,e,n,r,i,o,a,s,u,c,l,d,f,h,m,v){var g=new p(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=r,g[4]=i,g[5]=o,g[6]=a,g[7]=s,g[8]=u,g[9]=c,g[10]=l,g[11]=d,g[12]=f,g[13]=h,g[14]=m,g[15]=v,g}function $t(t,e,n,r,i,o,a,s,u,c,l,d,f,h,p,m,v){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t[9]=l,t[10]=d,t[11]=f,t[12]=h,t[13]=p,t[14]=m,t[15]=v,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ne(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],d=e[9],f=e[10],h=e[11],p=e[12],m=e[13],v=e[14],g=e[15],y=n*s-r*a,b=n*u-i*a,x=n*c-o*a,_=r*u-i*s,w=r*c-o*s,T=i*c-o*u,S=l*m-d*p,M=l*v-f*p,E=l*g-h*p,R=d*v-f*m,I=d*g-h*m,B=f*g-h*v,A=y*B-b*I+x*R+_*E-w*M+T*S;return A?(A=1/A,t[0]=(s*B-u*I+c*R)*A,t[1]=(i*I-r*B-o*R)*A,t[2]=(m*T-v*w+g*_)*A,t[3]=(f*w-d*T-h*_)*A,t[4]=(u*E-a*B-c*M)*A,t[5]=(n*B-i*E+o*M)*A,t[6]=(v*x-p*T-g*b)*A,t[7]=(l*T-f*x+h*b)*A,t[8]=(a*I-s*E+c*S)*A,t[9]=(r*E-n*I-o*S)*A,t[10]=(p*w-m*x+g*y)*A,t[11]=(d*x-l*w-h*y)*A,t[12]=(s*M-a*R-u*S)*A,t[13]=(n*R-r*M+i*S)*A,t[14]=(m*b-p*_-v*y)*A,t[15]=(l*_-d*b+f*y)*A,t):null}function re(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],d=e[9],f=e[10],h=e[11],p=e[12],m=e[13],v=e[14],g=e[15];return t[0]=s*(f*g-h*v)-d*(u*g-c*v)+m*(u*h-c*f),t[1]=-(r*(f*g-h*v)-d*(i*g-o*v)+m*(i*h-o*f)),t[2]=r*(u*g-c*v)-s*(i*g-o*v)+m*(i*c-o*u),t[3]=-(r*(u*h-c*f)-s*(i*h-o*f)+d*(i*c-o*u)),t[4]=-(a*(f*g-h*v)-l*(u*g-c*v)+p*(u*h-c*f)),t[5]=n*(f*g-h*v)-l*(i*g-o*v)+p*(i*h-o*f),t[6]=-(n*(u*g-c*v)-a*(i*g-o*v)+p*(i*c-o*u)),t[7]=n*(u*h-c*f)-a*(i*h-o*f)+l*(i*c-o*u),t[8]=a*(d*g-h*m)-l*(s*g-c*m)+p*(s*h-c*d),t[9]=-(n*(d*g-h*m)-l*(r*g-o*m)+p*(r*h-o*d)),t[10]=n*(s*g-c*m)-a*(r*g-o*m)+p*(r*c-o*s),t[11]=-(n*(s*h-c*d)-a*(r*h-o*d)+l*(r*c-o*s)),t[12]=-(a*(d*v-f*m)-l*(s*v-u*m)+p*(s*f-u*d)),t[13]=n*(d*v-f*m)-l*(r*v-i*m)+p*(r*f-i*d),t[14]=-(n*(s*v-u*m)-a*(r*v-i*m)+p*(r*u-i*s)),t[15]=n*(s*f-u*d)-a*(r*f-i*d)+l*(r*u-i*s),t}function ie(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],d=t[10],f=t[11],h=t[12],p=t[13],m=t[14],v=t[15];return(e*a-n*o)*(d*v-f*m)-(e*s-r*o)*(l*v-f*p)+(e*u-i*o)*(l*m-d*p)+(n*s-r*a)*(c*v-f*h)-(n*u-i*a)*(c*m-d*h)+(r*u-i*s)*(c*p-l*h)}function oe(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=e[8],f=e[9],h=e[10],p=e[11],m=e[12],v=e[13],g=e[14],y=e[15],b=n[0],x=n[1],_=n[2],w=n[3];return t[0]=b*r+x*s+_*d+w*m,t[1]=b*i+x*u+_*f+w*v,t[2]=b*o+x*c+_*h+w*g,t[3]=b*a+x*l+_*p+w*y,b=n[4],x=n[5],_=n[6],w=n[7],t[4]=b*r+x*s+_*d+w*m,t[5]=b*i+x*u+_*f+w*v,t[6]=b*o+x*c+_*h+w*g,t[7]=b*a+x*l+_*p+w*y,b=n[8],x=n[9],_=n[10],w=n[11],t[8]=b*r+x*s+_*d+w*m,t[9]=b*i+x*u+_*f+w*v,t[10]=b*o+x*c+_*h+w*g,t[11]=b*a+x*l+_*p+w*y,b=n[12],x=n[13],_=n[14],w=n[15],t[12]=b*r+x*s+_*d+w*m,t[13]=b*i+x*u+_*f+w*v,t[14]=b*o+x*c+_*h+w*g,t[15]=b*a+x*l+_*p+w*y,t}function ae(t,e,n){var r,i,o,a,s,u,c,l,d,f,h,p,m=n[0],v=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*g+e[12],t[13]=e[1]*m+e[5]*v+e[9]*g+e[13],t[14]=e[2]*m+e[6]*v+e[10]*g+e[14],t[15]=e[3]*m+e[7]*v+e[11]*g+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=e[8],f=e[9],h=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=d,t[9]=f,t[10]=h,t[11]=p,t[12]=r*m+s*v+d*g+e[12],t[13]=i*m+u*v+f*g+e[13],t[14]=o*m+c*v+h*g+e[14],t[15]=a*m+l*v+p*g+e[15]),t}function se(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ue(t,e,n,r){var i,o,a,s,u,c,l,d,f,p,m,v,g,y,b,x,_,w,T,S,M,E,R,I,B=r[0],A=r[1],C=r[2],F=Math.hypot(B,A,C);return F<h?null:(B*=F=1/F,A*=F,C*=F,i=Math.sin(n),a=1-(o=Math.cos(n)),s=e[0],u=e[1],c=e[2],l=e[3],d=e[4],f=e[5],p=e[6],m=e[7],v=e[8],g=e[9],y=e[10],b=e[11],x=B*B*a+o,_=A*B*a+C*i,w=C*B*a-A*i,T=B*A*a-C*i,S=A*A*a+o,M=C*A*a+B*i,E=B*C*a+A*i,R=A*C*a-B*i,I=C*C*a+o,t[0]=s*x+d*_+v*w,t[1]=u*x+f*_+g*w,t[2]=c*x+p*_+y*w,t[3]=l*x+m*_+b*w,t[4]=s*T+d*S+v*M,t[5]=u*T+f*S+g*M,t[6]=c*T+p*S+y*M,t[7]=l*T+m*S+b*M,t[8]=s*E+d*R+v*I,t[9]=u*E+f*R+g*I,t[10]=c*E+p*R+y*I,t[11]=l*E+m*R+b*I,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ce(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],d=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+d*r,t[7]=u*i+f*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=d*i-s*r,t[11]=f*i-u*r,t}function le(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],d=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-d*r,t[3]=u*i-f*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+d*i,t[11]=u*r+f*i,t}function de(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],d=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+d*r,t[3]=u*i+f*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=d*i-s*r,t[7]=f*i-u*r,t}function fe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function he(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pe(t,e,n){var r,i,o,a=n[0],s=n[1],u=n[2],c=Math.hypot(a,s,u);return c<h?null:(a*=c=1/c,s*=c,u*=c,r=Math.sin(e),o=1-(i=Math.cos(e)),t[0]=a*a*o+i,t[1]=s*a*o+u*r,t[2]=u*a*o-s*r,t[3]=0,t[4]=a*s*o-u*r,t[5]=s*s*o+i,t[6]=u*s*o+a*r,t[7]=0,t[8]=a*u*o+s*r,t[9]=s*u*o-a*r,t[10]=u*u*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function me(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ge(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ye(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=r+r,u=i+i,c=o+o,l=r*s,d=r*u,f=r*c,h=i*u,p=i*c,m=o*c,v=a*s,g=a*u,y=a*c;return t[0]=1-(h+m),t[1]=d+y,t[2]=f-g,t[3]=0,t[4]=d-y,t[5]=1-(l+m),t[6]=p+v,t[7]=0,t[8]=f+g,t[9]=p-v,t[10]=1-(l+h),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function be(t,e){var n=new p(3),r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=r*r+i*i+o*o+a*a;return d>0?(n[0]=2*(s*a+l*r+u*o-c*i)/d,n[1]=2*(u*a+l*i+c*r-s*o)/d,n[2]=2*(c*a+l*o+s*i-u*r)/d):(n[0]=2*(s*a+l*r+u*o-c*i),n[1]=2*(u*a+l*i+c*r-s*o),n[2]=2*(c*a+l*o+s*i-u*r)),ye(t,e,n),t}function xe(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function _e(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(u,c,l),t}function we(t,e){var n=new p(3);_e(n,e);var r=1/n[0],i=1/n[1],o=1/n[2],a=e[0]*r,s=e[1]*i,u=e[2]*o,c=e[4]*r,l=e[5]*i,d=e[6]*o,f=e[8]*r,h=e[9]*i,m=e[10]*o,v=a+l+m,g=0;return v>0?(g=2*Math.sqrt(v+1),t[3]=.25*g,t[0]=(d-h)/g,t[1]=(f-u)/g,t[2]=(s-c)/g):a>l&&a>m?(g=2*Math.sqrt(1+a-l-m),t[3]=(d-h)/g,t[0]=.25*g,t[1]=(s+c)/g,t[2]=(f+u)/g):l>m?(g=2*Math.sqrt(1+l-a-m),t[3]=(f-u)/g,t[0]=(s+c)/g,t[1]=.25*g,t[2]=(d+h)/g):(g=2*Math.sqrt(1+m-a-l),t[3]=(s-c)/g,t[0]=(f+u)/g,t[1]=(d+h)/g,t[2]=.25*g),t}function Te(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3],u=i+i,c=o+o,l=a+a,d=i*u,f=i*c,h=i*l,p=o*c,m=o*l,v=a*l,g=s*u,y=s*c,b=s*l,x=r[0],_=r[1],w=r[2];return t[0]=(1-(p+v))*x,t[1]=(f+b)*x,t[2]=(h-y)*x,t[3]=0,t[4]=(f-b)*_,t[5]=(1-(d+v))*_,t[6]=(m+g)*_,t[7]=0,t[8]=(h+y)*w,t[9]=(m-g)*w,t[10]=(1-(d+p))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Se(t,e,n,r,i){var o=e[0],a=e[1],s=e[2],u=e[3],c=o+o,l=a+a,d=s+s,f=o*c,h=o*l,p=o*d,m=a*l,v=a*d,g=s*d,y=u*c,b=u*l,x=u*d,_=r[0],w=r[1],T=r[2],S=i[0],M=i[1],E=i[2],R=(1-(m+g))*_,I=(h+x)*_,B=(p-b)*_,A=(h-x)*w,C=(1-(f+g))*w,F=(v+y)*w,P=(p+b)*T,N=(v-y)*T,O=(1-(f+m))*T;return t[0]=R,t[1]=I,t[2]=B,t[3]=0,t[4]=A,t[5]=C,t[6]=F,t[7]=0,t[8]=P,t[9]=N,t[10]=O,t[11]=0,t[12]=n[0]+S-(R*S+A*M+P*E),t[13]=n[1]+M-(I*S+C*M+N*E),t[14]=n[2]+E-(B*S+F*M+O*E),t[15]=1,t}function Me(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,d=r*s,f=i*a,h=i*s,p=i*u,m=o*a,v=o*s,g=o*u;return t[0]=1-d-p,t[1]=l+g,t[2]=f-v,t[3]=0,t[4]=l-g,t[5]=1-c-p,t[6]=h+m,t[7]=0,t[8]=f+v,t[9]=h-m,t[10]=1-c-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ee(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}function Re(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function Ie(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(i-o)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function Be(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t}function Ae(t,e,n,r){var i,o,a,s,u,c,l,d,f,p,m=e[0],v=e[1],g=e[2],y=r[0],b=r[1],x=r[2],_=n[0],w=n[1],T=n[2];return Math.abs(m-_)<h&&Math.abs(v-w)<h&&Math.abs(g-T)<h?te(t):(l=m-_,d=v-w,f=g-T,i=b*(f*=p=1/Math.hypot(l,d,f))-x*(d*=p),o=x*(l*=p)-y*f,a=y*d-b*l,(p=Math.hypot(i,o,a))?(i*=p=1/p,o*=p,a*=p):(i=0,o=0,a=0),s=d*a-f*o,u=f*i-l*a,c=l*o-d*i,(p=Math.hypot(s,u,c))?(s*=p=1/p,u*=p,c*=p):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=o,t[5]=u,t[6]=d,t[7]=0,t[8]=a,t[9]=c,t[10]=f,t[11]=0,t[12]=-(i*m+o*v+a*g),t[13]=-(s*m+u*v+c*g),t[14]=-(l*m+d*v+f*g),t[15]=1,t)}function Ce(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=r[0],u=r[1],c=r[2],l=i-n[0],d=o-n[1],f=a-n[2],h=l*l+d*d+f*f;h>0&&(l*=h=1/Math.sqrt(h),d*=h,f*=h);var p=u*f-c*d,m=c*l-s*f,v=s*d-u*l;return(h=p*p+m*m+v*v)>0&&(p*=h=1/Math.sqrt(h),m*=h,v*=h),t[0]=p,t[1]=m,t[2]=v,t[3]=0,t[4]=d*v-f*m,t[5]=f*p-l*v,t[6]=l*m-d*p,t[7]=0,t[8]=l,t[9]=d,t[10]=f,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function Fe(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Pe(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Ne(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function Oe(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Ue(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Le(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function Ge(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function De(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],d=t[9],f=t[10],p=t[11],m=t[12],v=t[13],g=t[14],y=t[15],b=e[0],x=e[1],_=e[2],w=e[3],T=e[4],S=e[5],M=e[6],E=e[7],R=e[8],I=e[9],B=e[10],A=e[11],C=e[12],F=e[13],P=e[14],N=e[15];return Math.abs(n-b)<=h*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(r-x)<=h*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(i-_)<=h*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-w)<=h*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(a-T)<=h*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(s-S)<=h*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(u-M)<=h*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(c-E)<=h*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(l-R)<=h*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(d-I)<=h*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(f-B)<=h*Math.max(1,Math.abs(f),Math.abs(B))&&Math.abs(p-A)<=h*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(m-C)<=h*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(v-F)<=h*Math.max(1,Math.abs(v),Math.abs(F))&&Math.abs(g-P)<=h*Math.max(1,Math.abs(g),Math.abs(P))&&Math.abs(y-N)<=h*Math.max(1,Math.abs(y),Math.abs(N))}var Ve=oe,He=Oe;function ke(){var t=new p(3);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ze(t){var e=new p(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Xe(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function We(t,e,n){var r=new p(3);return r[0]=t,r[1]=e,r[2]=n,r}function je(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Ze(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Qe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Ye(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Je(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function qe(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Ke(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function $e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function tn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function en(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function nn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function rn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function on(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function an(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function sn(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function un(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function cn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function ln(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function dn(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function fn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function hn(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function pn(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t}function mn(t,e,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),l=a*(3-2*o);return t[0]=e[0]*s+n[0]*u+r[0]*c+i[0]*l,t[1]=e[1]*s+n[1]*u+r[1]*c+i[1]*l,t[2]=e[2]*s+n[2]*u+r[2]*c+i[2]*l,t}function vn(t,e,n,r,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,l=3*o*s,d=3*u*a,f=u*o;return t[0]=e[0]*c+n[0]*l+r[0]*d+i[0]*f,t[1]=e[1]*c+n[1]*l+r[1]*d+i[1]*f,t[2]=e[2]*c+n[2]*l+r[2]*d+i[2]*f,t}function gn(t,e){e=e||1;var n=2*m()*Math.PI,r=2*m()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function yn(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function bn(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function xn(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],l=i*c-o*u,d=o*s-r*c,f=r*u-i*s,h=i*f-o*d,p=o*l-r*f,m=r*d-i*l,v=2*a;return l*=v,d*=v,f*=v,h*=2,p*=2,m*=2,t[0]=s+l+h,t[1]=u+d+p,t[2]=c+f+m,t}function _n(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function wn(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Tn(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Sn(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+a*a+s*s),c=u&&fn(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function Mn(t){return t[0]=0,t[1]=0,t[2]=0,t}function En(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Rn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function In(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2];return Math.abs(n-o)<=h*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=h*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=h*Math.max(1,Math.abs(i),Math.abs(s))}var Bn=Ye,An=Je,Cn=qe,Fn=an,Pn=sn,Nn=Xe,On=un,Un=function(){var t=ke();return function(e,n,r,i,o,a){var s,u;for(n||(n=3),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}();function Ln(){var t=new p(4);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Gn(t){var e=new p(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Dn(t,e,n,r){var i=new p(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function Vn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Hn(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function kn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function zn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function Xn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function Wn(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function jn(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Zn(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Qn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Yn(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Jn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function qn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Kn(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function $n(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.hypot(n,r,i,o)}function tr(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function er(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function nr(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function rr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function ir(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function or(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a,t}function ar(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function sr(t,e,n,r){var i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],s=n[1]*r[2]-n[2]*r[1],u=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],l=e[0],d=e[1],f=e[2],h=e[3];return t[0]=d*c-f*u+h*s,t[1]=-l*c+f*a-h*o,t[2]=l*u-d*a+h*i,t[3]=-l*s+d*o-f*i,t}function ur(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t}function cr(t,e){var n,r,i,o,a,s;e=e||1;do{a=(n=2*m()-1)*n+(r=2*m()-1)*r}while(a>=1);do{s=(i=2*m()-1)*i+(o=2*m()-1)*o}while(s>=1);var u=Math.sqrt((1-a)/s);return t[0]=e*n,t[1]=e*r,t[2]=e*i*u,t[3]=e*o*u,t}function lr(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}function dr(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,d=c*i+u*r-a*o,f=c*o+a*i-s*r,h=-a*r-s*i-u*o;return t[0]=l*c+h*-a+d*-u-f*-s,t[1]=d*c+h*-s+f*-a-l*-u,t[2]=f*c+h*-u+l*-s-d*-a,t[3]=e[3],t}function fr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function hr(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function pr(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function mr(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=h*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=h*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=h*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=h*Math.max(1,Math.abs(o),Math.abs(c))}var vr=zn,gr=Xn,yr=Wn,br=$n,xr=tr,_r=er,wr=nr,Tr=function(){var t=Ln();return function(e,n,r,i,o,a){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function Sr(){var t=new p(4);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Mr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Er(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Rr(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>h?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Ir(t,e){var n=qr(t,e);return Math.acos(2*n*n-1)}function Br(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+a*s+i*c-o*u,t[1]=i*l+a*u+o*s-r*c,t[2]=o*l+a*c+r*u-i*s,t[3]=a*l-r*s-i*u-o*c,t}function Ar(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-r*s,t}function Cr(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-o*s,t[1]=i*u+a*s,t[2]=o*u+r*s,t[3]=a*u-i*s,t}function Fr(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t}function Pr(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Nr(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=Math.sqrt(n*n+r*r+i*i),s=Math.exp(o),u=a>0?s*Math.sin(a)/a:0;return t[0]=n*u,t[1]=r*u,t[2]=i*u,t[3]=s*Math.cos(a),t}function Or(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=Math.sqrt(n*n+r*r+i*i),s=a>0?Math.atan2(a,o)/a:0;return t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=.5*Math.log(n*n+r*r+i*i+o*o),t}function Ur(t,e,n){return Or(t,e),Jr(t,t,n),Nr(t,t),t}function Lr(t,e,n,r){var i,o,a,s,u,c=e[0],l=e[1],d=e[2],f=e[3],p=n[0],m=n[1],v=n[2],g=n[3];return(o=c*p+l*m+d*v+f*g)<0&&(o=-o,p=-p,m=-m,v=-v,g=-g),1-o>h?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),t[0]=s*c+u*p,t[1]=s*l+u*m,t[2]=s*d+u*v,t[3]=s*f+u*g,t}function Gr(t){var e=m(),n=m(),r=m(),i=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*r),t[3]=o*Math.cos(2*Math.PI*r),t}function Dr(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,t}function Vr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Hr(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+a]-e[3*a+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t}function kr(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var o=Math.sin(e),a=Math.cos(e),s=Math.sin(n),u=Math.cos(n),c=Math.sin(r),l=Math.cos(r);return t[0]=o*u*l-a*s*c,t[1]=a*s*l+o*u*c,t[2]=a*u*c-o*s*l,t[3]=a*u*l+o*s*c,t}function zr(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Xr=Gn,Wr=Dn,jr=Vn,Zr=Hn,Qr=kn,Yr=Br,Jr=qn,qr=ar,Kr=ur,$r=er,ti=$r,ei=nr,ni=ei,ri=or,ii=pr,oi=mr,ai=function(){var t=ke(),e=We(1,0,0),n=We(0,1,0);return function(r,i,o){var a=fn(i,o);return a<-.999999?(hn(t,e,i),Nn(t)<1e-6&&hn(t,n,i),dn(t,t),Er(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(hn(t,i,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,ri(r,r))}}(),si=function(){var t=Sr(),e=Sr();return function(n,r,i,o,a,s){return Lr(t,r,a,s),Lr(e,i,o,s),Lr(n,t,e,2*s*(1-s)),n}}(),ui=function(){var t=gt();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],ri(e,Hr(e,t))}}();function ci(){var t=new p(8);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function li(t){var e=new p(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function di(t,e,n,r,i,o,a,s){var u=new p(8);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=i,u[5]=o,u[6]=a,u[7]=s,u}function fi(t,e,n,r,i,o,a){var s=new p(8);s[0]=t,s[1]=e,s[2]=n,s[3]=r;var u=.5*i,c=.5*o,l=.5*a;return s[4]=u*r+c*n-l*e,s[5]=c*r+l*t-u*n,s[6]=l*r+u*e-c*t,s[7]=-u*t-c*e-l*n,s}function hi(t,e,n){var r=.5*n[0],i=.5*n[1],o=.5*n[2],a=e[0],s=e[1],u=e[2],c=e[3];return t[0]=a,t[1]=s,t[2]=u,t[3]=c,t[4]=r*c+i*u-o*s,t[5]=i*c+o*a-r*u,t[6]=o*c+r*s-i*a,t[7]=-r*a-i*s-o*u,t}function pi(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function mi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function vi(t,e){var n=Sr();we(n,e);var r=new p(3);return xe(r,e),hi(t,n,r),t}function gi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function yi(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function bi(t,e,n,r,i,o,a,s,u){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t}var xi=jr;function _i(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var wi=jr;function Ti(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Si(t,e){var n=e[4],r=e[5],i=e[6],o=e[7],a=-e[0],s=-e[1],u=-e[2],c=e[3];return t[0]=2*(n*c+o*a+r*u-i*s),t[1]=2*(r*c+o*s+i*a-n*u),t[2]=2*(i*c+o*u+n*s-r*a),t}function Mi(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=.5*n[0],u=.5*n[1],c=.5*n[2],l=e[4],d=e[5],f=e[6],h=e[7];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=a*s+i*c-o*u+l,t[5]=a*u+o*s-r*c+d,t[6]=a*c+r*u-i*s+f,t[7]=-r*s-i*u-o*c+h,t}function Ei(t,e,n){var r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=s*a+l*r+u*o-c*i,f=u*a+l*i+c*r-s*o,h=c*a+l*o+s*i-u*r,p=l*a-s*r-u*i-c*o;return Ar(t,e,n),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=d*a+p*r+f*o-h*i,t[5]=f*a+p*i+h*r-d*o,t[6]=h*a+p*o+d*i-f*r,t[7]=p*a-d*r-f*i-h*o,t}function Ri(t,e,n){var r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=s*a+l*r+u*o-c*i,f=u*a+l*i+c*r-s*o,h=c*a+l*o+s*i-u*r,p=l*a-s*r-u*i-c*o;return Cr(t,e,n),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=d*a+p*r+f*o-h*i,t[5]=f*a+p*i+h*r-d*o,t[6]=h*a+p*o+d*i-f*r,t[7]=p*a-d*r-f*i-h*o,t}function Ii(t,e,n){var r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],d=s*a+l*r+u*o-c*i,f=u*a+l*i+c*r-s*o,h=c*a+l*o+s*i-u*r,p=l*a-s*r-u*i-c*o;return Fr(t,e,n),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=d*a+p*r+f*o-h*i,t[5]=f*a+p*i+h*r-d*o,t[6]=h*a+p*o+d*i-f*r,t[7]=p*a-d*r-f*i-h*o,t}function Bi(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],l=e[3];return t[0]=s*a+l*r+u*o-c*i,t[1]=u*a+l*i+c*r-s*o,t[2]=c*a+l*o+s*i-u*r,t[3]=l*a-s*r-u*i-c*o,s=e[4],u=e[5],c=e[6],l=e[7],t[4]=s*a+l*r+u*o-c*i,t[5]=u*a+l*i+c*r-s*o,t[6]=c*a+l*o+s*i-u*r,t[7]=l*a-s*r-u*i-c*o,t}function Ai(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+a*s+i*c-o*u,t[1]=i*l+a*u+o*s-r*c,t[2]=o*l+a*c+r*u-i*s,t[3]=a*l-r*s-i*u-o*c,s=n[4],u=n[5],c=n[6],l=n[7],t[4]=r*l+a*s+i*c-o*u,t[5]=i*l+a*u+o*s-r*c,t[6]=o*l+a*c+r*u-i*s,t[7]=a*l-r*s-i*u-o*c,t}function Ci(t,e,n,r){if(Math.abs(r)<h)return gi(t,e);var i=Math.hypot(n[0],n[1],n[2]);r*=.5;var o=Math.sin(r),a=o*n[0]/i,s=o*n[1]/i,u=o*n[2]/i,c=Math.cos(r),l=e[0],d=e[1],f=e[2],p=e[3];t[0]=l*c+p*a+d*u-f*s,t[1]=d*c+p*s+f*a-l*u,t[2]=f*c+p*u+l*s-d*a,t[3]=p*c-l*a-d*s-f*u;var m=e[4],v=e[5],g=e[6],y=e[7];return t[4]=m*c+y*a+v*u-g*s,t[5]=v*c+y*s+g*a-m*u,t[6]=g*c+y*u+m*s-v*a,t[7]=y*c-m*a-v*s-g*u,t}function Fi(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function Pi(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[4],u=n[5],c=n[6],l=n[7],d=e[4],f=e[5],h=e[6],p=e[7],m=n[0],v=n[1],g=n[2],y=n[3];return t[0]=r*y+a*m+i*g-o*v,t[1]=i*y+a*v+o*m-r*g,t[2]=o*y+a*g+r*v-i*m,t[3]=a*y-r*m-i*v-o*g,t[4]=r*l+a*s+i*c-o*u+d*y+p*m+f*g-h*v,t[5]=i*l+a*u+o*s-r*c+f*y+p*v+h*m-d*g,t[6]=o*l+a*c+r*u-i*s+h*y+p*g+d*v-f*m,t[7]=a*l-r*s-i*u-o*c+p*y-d*m-f*v-h*g,t}var Ni=Pi;function Oi(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var Ui=qr;function Li(t,e,n,r){var i=1-r;return Ui(e,n)<0&&(r=-r),t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r,t[3]=e[3]*i+n[3]*r,t[4]=e[4]*i+n[4]*r,t[5]=e[5]*i+n[5]*r,t[6]=e[6]*i+n[6]*r,t[7]=e[7]*i+n[7]*r,t}function Gi(t,e){var n=ki(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function Di(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var Vi=$r,Hi=Vi,ki=ei,zi=ki;function Xi(t,e){var n=ki(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,i=e[1]/n,o=e[2]/n,a=e[3]/n,s=e[4],u=e[5],c=e[6],l=e[7],d=r*s+i*u+o*c+a*l;t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=(s-r*d)/n,t[5]=(u-i*d)/n,t[6]=(c-o*d)/n,t[7]=(l-a*d)/n}return t}function Wi(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function ji(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function Zi(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=e[0],d=e[1],f=e[2],p=e[3],m=e[4],v=e[5],g=e[6],y=e[7];return Math.abs(n-l)<=h*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-d)<=h*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(i-f)<=h*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-p)<=h*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-m)<=h*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-v)<=h*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-g)<=h*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-y)<=h*Math.max(1,Math.abs(c),Math.abs(y))}function Qi(){var t=new p(2);return p!=Float32Array&&(t[0]=0,t[1]=0),t}function Yi(t){var e=new p(2);return e[0]=t[0],e[1]=t[1],e}function Ji(t,e){var n=new p(2);return n[0]=t,n[1]=e,n}function qi(t,e){return t[0]=e[0],t[1]=e[1],t}function Ki(t,e,n){return t[0]=e,t[1]=n,t}function $i(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function to(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function eo(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function no(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function ro(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function io(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function oo(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function ao(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function so(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function uo(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function co(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function lo(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.hypot(n,r)}function fo(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function ho(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function po(t){var e=t[0],n=t[1];return e*e+n*n}function mo(t,e){return t[0]=-e[0],t[1]=-e[1],t}function vo(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function go(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function yo(t,e){return t[0]*e[0]+t[1]*e[1]}function bo(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function xo(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function _o(t,e){e=e||1;var n=2*m()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function wo(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function To(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function So(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function Mo(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function Eo(t,e,n,r){var i=e[0]-n[0],o=e[1]-n[1],a=Math.sin(r),s=Math.cos(r);return t[0]=i*s-o*a+n[0],t[1]=i*a+o*s+n[1],t}function Ro(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o),s=a&&(n*i+r*o)/a;return Math.acos(Math.min(Math.max(s,-1),1))}function Io(t){return t[0]=0,t[1]=0,t}function Bo(t){return"vec2("+t[0]+", "+t[1]+")"}function Ao(t,e){return t[0]===e[0]&&t[1]===e[1]}function Co(t,e){var n=t[0],r=t[1],i=e[0],o=e[1];return Math.abs(n-i)<=h*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=h*Math.max(1,Math.abs(r),Math.abs(o))}var Fo=ho,Po=to,No=eo,Oo=no,Uo=lo,Lo=fo,Go=po,Do=function(){var t=Qi();return function(e,n,r,i,o,a){var s,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],o(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}()},function(t,e,n){"use strict";n.r(e),n.d(e,"createEndpoint",(function(){return d})),n.d(e,"expose",(function(){return v})),n.d(e,"proxy",(function(){return T})),n.d(e,"proxyMarker",(function(){return l})),n.d(e,"releaseProxy",(function(){return f})),n.d(e,"transfer",(function(){return w})),n.d(e,"transferHandlers",(function(){return m})),n.d(e,"windowEndpoint",(function(){return S})),n.d(e,"wrap",(function(){return y}));var r=n(50);var i=n(36),o=n(6),a=n(71),s=n(72);function u(t,e,n){return(u=Object(s.a)()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&Object(a.a)(i,n.prototype),i}).apply(null,arguments)}var c=n(56),l=Symbol("Comlink.proxy"),d=Symbol("Comlink.endpoint"),f=Symbol("Comlink.releaseProxy"),h=Symbol("Comlink.thrown"),p=function(t){return"object"===typeof t&&null!==t||"function"===typeof t},m=new Map([["proxy",{canHandle:function(t){return p(t)&&t[l]},serialize:function(t){var e=new MessageChannel,n=e.port1,r=e.port2;return v(t,n),[r,[r]]},deserialize:function(t){return t.start(),y(t)}}],["throw",{canHandle:function(t){return p(t)&&h in t},serialize:function(t){var e=t.value;return[e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[]]},deserialize:function(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self;e.addEventListener("message",(function n(r){if(r&&r.data){var a,s=Object.assign({path:[]},r.data),l=s.id,d=s.type,f=s.path,p=(r.data.argumentList||[]).map(E);try{var m=f.slice(0,-1).reduce((function(t,e){return t[e]}),t),y=f.reduce((function(t,e){return t[e]}),t);switch(d){case 0:a=y;break;case 1:m[f.slice(-1)[0]]=E(r.data.value),a=!0;break;case 2:a=y.apply(m,p);break;case 3:var b;a=T(u(y,Object(c.a)(p)));break;case 4:var x=new MessageChannel,_=x.port1,S=x.port2;v(t,S),a=w(_,[_]);break;case 5:a=void 0}}catch(b){a=Object(o.a)({value:b},h,0)}Promise.resolve(a).catch((function(t){return Object(o.a)({value:t},h,0)})).then((function(t){var r=M(t),o=Object(i.a)(r,2),a=o[0],s=o[1];e.postMessage(Object.assign(Object.assign({},a),{id:l}),s),5===d&&(e.removeEventListener("message",n),g(e))}))}})),e.start&&e.start()}function g(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function y(t,e){return function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=!1,a=new Proxy(r,{get:function(r,i){if(b(o),i===f)return function(){return R(e,{type:5,path:n.map((function(t){return t.toString()}))}).then((function(){g(e),o=!0}))};if("then"===i){if(0===n.length)return{then:function(){return a}};var s=R(e,{type:0,path:n.map((function(t){return t.toString()}))}).then(E);return s.then.bind(s)}return t(e,[].concat(Object(c.a)(n),[i]))},set:function(t,r,a){b(o);var s=M(a),u=Object(i.a)(s,2),l=u[0],d=u[1];return R(e,{type:1,path:[].concat(Object(c.a)(n),[r]).map((function(t){return t.toString()})),value:l},d).then(E)},apply:function(r,a,s){b(o);var u=n[n.length-1];if(u===d)return R(e,{type:4}).then(E);if("bind"===u)return t(e,n.slice(0,-1));var c=x(s),l=Object(i.a)(c,2),f=l[0],h=l[1];return R(e,{type:2,path:n.map((function(t){return t.toString()})),argumentList:f},h).then(E)},construct:function(t,r){b(o);var a=x(r),s=Object(i.a)(a,2),u=s[0],c=s[1];return R(e,{type:3,path:n.map((function(t){return t.toString()})),argumentList:u},c).then(E)}});return a}(t,[],e)}function b(t){if(t)throw new Error("Proxy has been released and is not useable")}function x(t){var e,n=t.map(M);return[n.map((function(t){return t[0]})),(e=n.map((function(t){return t[1]})),Array.prototype.concat.apply([],e))]}var _=new WeakMap;function w(t,e){return _.set(t,e),t}function T(t){return Object.assign(t,Object(o.a)({},l,!0))}function S(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";return{postMessage:function(e,r){return t.postMessage(e,n,r)},addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e)}}function M(t){var e,n=function(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=Object(r.a)(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,a=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}(m);try{for(n.s();!(e=n.n()).done;){var o=Object(i.a)(e.value,2),a=o[0],s=o[1];if(s.canHandle(t)){var u=s.serialize(t),c=Object(i.a)(u,2);return[{type:3,name:a,value:c[0]},c[1]]}}}catch(l){n.e(l)}finally{n.f()}return[{type:0,value:t},_.get(t)||[]]}function E(t){switch(t.type){case 3:return m.get(t.name).deserialize(t.value);case 0:return t.value}}function R(t,e,n){return new Promise((function(r){var i=new Array(4).fill(0).map((function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)})).join("-");t.addEventListener("message",(function e(n){n.data&&n.data.id&&n.data.id===i&&(t.removeEventListener("message",e),r(n.data))})),t.start&&t.start(),t.postMessage(Object.assign({id:i},e),n)}))}}]]);
//# sourceMappingURL=2.98b32324.chunk.js.map